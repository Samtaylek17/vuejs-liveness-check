(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00ee":function(t,e,n){var r=n("b622"),i=r("toStringTag"),o={};o[i]="z",t.exports="[object z]"===String(o)},"0366":function(t,e,n){var r=n("1c0b");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},"0538":function(t,e,n){"use strict";var r=n("1c0b"),i=n("861d"),o=[].slice,a={},s=function(t,e,n){if(!(e in a)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";a[e]=Function("C,a","return new C("+r.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=r(this),n=o.call(arguments,1),a=function(){var r=n.concat(o.call(arguments));return this instanceof a?s(e,r.length,r):e.apply(t,r)};return i(e.prototype)&&(a.prototype=e.prototype),a}},"057f":function(t,e,n){var r=n("fc6a"),i=n("241c").f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==o.call(t)?s(t):i(r(t))}},"06cf":function(t,e,n){var r=n("83ab"),i=n("d1e7"),o=n("5c6c"),a=n("fc6a"),s=n("c04e"),u=n("5135"),c=n("0cfb"),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=a(t),e=s(e,!0),c)try{return l(t,e)}catch(n){}if(u(t,e))return o(!i.f.call(t,e),t[e])}},"0a06":function(t,e,n){"use strict";var r=n("c532"),i=n("30b5"),o=n("f6b4"),a=n("5270"),s=n("4a7b");function u(t){this.defaults=t,this.interceptors={request:new o,response:new o}}u.prototype.request=function(t){"string"===typeof t?(t=arguments[1]||{},t.url=arguments[0]):t=t||{},t=s(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[a,void 0],n=Promise.resolve(t);this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));while(e.length)n=n.then(e.shift(),e.shift());return n},u.prototype.getUri=function(t){return t=s(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){u.prototype[t]=function(e,n){return this.request(s(n||{},{method:t,url:e,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(t){u.prototype[t]=function(e,n,r){return this.request(s(r||{},{method:t,url:e,data:n}))}})),t.exports=u},"0cb2":function(t,e,n){var r=n("7b0b"),i=Math.floor,o="".replace,a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,n,u,c,l){var h=n+t.length,f=u.length,p=s;return void 0!==c&&(c=r(c),p=a),o.call(l,p,(function(r,o){var a;switch(o.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(h);case"<":a=c[o.slice(1,-1)];break;default:var s=+o;if(0===s)return r;if(s>f){var l=i(s/10);return 0===l?r:l<=f?void 0===u[l-1]?o.charAt(1):u[l-1]+o.charAt(1):r}a=u[s-1]}return void 0===a?"":a}))}},"0cfb":function(t,e,n){var r=n("83ab"),i=n("d039"),o=n("cc12");t.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},"0df6":function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},"107c":function(t,e,n){var r=n("d039");t.exports=r((function(){var t=RegExp("(?<a>b)","string".charAt(5));return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},"14c3":function(t,e,n){var r=n("c6b6"),i=n("9263");t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var o=n.call(t,e);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"159b":function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("17c2"),a=n("9112");for(var s in i){var u=r[s],c=u&&u.prototype;if(c&&c.forEach!==o)try{a(c,"forEach",o)}catch(l){c.forEach=o}}},"17c2":function(t,e,n){"use strict";var r=n("b727").forEach,i=n("a640"),o=i("forEach");t.exports=o?[].forEach:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}},1864:function(t,e,n){var r,i;
/*!
 * js-logger - http://github.com/jonnyreeves/js-logger
 * Jonny Reeves, http://jonnyreeves.co.uk/
 * js-logger may be freely distributed under the MIT license.
 */(function(o){"use strict";var a,s={};s.VERSION="1.6.1";var u={},c=function(t,e){return function(){return e.apply(t,arguments)}},l=function(){var t,e,n=arguments,r=n[0];for(e=1;e<n.length;e++)for(t in n[e])!(t in r)&&n[e].hasOwnProperty(t)&&(r[t]=n[e][t]);return r},h=function(t,e){return{value:t,name:e}};s.TRACE=h(1,"TRACE"),s.DEBUG=h(2,"DEBUG"),s.INFO=h(3,"INFO"),s.TIME=h(4,"TIME"),s.WARN=h(5,"WARN"),s.ERROR=h(8,"ERROR"),s.OFF=h(99,"OFF");var f=function(t){this.context=t,this.setLevel(t.filterLevel),this.log=this.info};f.prototype={setLevel:function(t){t&&"value"in t&&(this.context.filterLevel=t)},getLevel:function(){return this.context.filterLevel},enabledFor:function(t){var e=this.context.filterLevel;return t.value>=e.value},trace:function(){this.invoke(s.TRACE,arguments)},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(t){"string"===typeof t&&t.length>0&&this.invoke(s.TIME,[t,"start"])},timeEnd:function(t){"string"===typeof t&&t.length>0&&this.invoke(s.TIME,[t,"end"])},invoke:function(t,e){a&&this.enabledFor(t)&&a(e,l({level:t},this.context))}};var p=new f({filterLevel:s.OFF});(function(){var t=s;t.enabledFor=c(p,p.enabledFor),t.trace=c(p,p.trace),t.debug=c(p,p.debug),t.time=c(p,p.time),t.timeEnd=c(p,p.timeEnd),t.info=c(p,p.info),t.warn=c(p,p.warn),t.error=c(p,p.error),t.log=t.info})(),s.setHandler=function(t){a=t},s.setLevel=function(t){for(var e in p.setLevel(t),u)u.hasOwnProperty(e)&&u[e].setLevel(t)},s.getLevel=function(){return p.getLevel()},s.get=function(t){return u[t]||(u[t]=new f(l({name:t},p.context)))},s.createDefaultHandler=function(t){t=t||{},t.formatter=t.formatter||function(t,e){e.name&&t.unshift("["+e.name+"]")};var e={},n=function(t,e){Function.prototype.apply.call(t,console,e)};return"undefined"===typeof console?function(){}:function(r,i){r=Array.prototype.slice.call(r);var o,a=console.log;i.level===s.TIME?(o=(i.name?"["+i.name+"] ":"")+r[0],"start"===r[1]?console.time?console.time(o):e[o]=(new Date).getTime():console.timeEnd?console.timeEnd(o):n(a,[o+": "+((new Date).getTime()-e[o])+"ms"])):(i.level===s.WARN&&console.warn?a=console.warn:i.level===s.ERROR&&console.error?a=console.error:i.level===s.INFO&&console.info?a=console.info:i.level===s.DEBUG&&console.debug?a=console.debug:i.level===s.TRACE&&console.trace&&(a=console.trace),t.formatter(r,i),n(a,r))}},s.useDefaults=function(t){s.setLevel(t&&t.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(t))},s.setDefaults=s.useDefaults,r=s,i="function"===typeof r?r.call(e,n,e,t):r,void 0===i||(t.exports=i)})()},"19aa":function(t,e){t.exports=function(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}},"1be4":function(t,e,n){var r=n("d066");t.exports=r("document","documentElement")},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1c7e":function(t,e,n){var r=n("b622"),i=r("iterator"),o=!1;try{var a=0,s={next:function(){return{done:!!a++}},return:function(){o=!0}};s[i]=function(){return this},Array.from(s,(function(){throw 2}))}catch(u){}t.exports=function(t,e){if(!e&&!o)return!1;var n=!1;try{var r={};r[i]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(u){}return n}},"1cdc":function(t,e,n){var r=n("342f");t.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(r)},"1d2b":function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"1dde":function(t,e,n){var r=n("d039"),i=n("b622"),o=n("2d00"),a=i("species");t.exports=function(t){return o>=51||!r((function(){var e=[],n=e.constructor={};return n[a]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"1fb5":function(t,e,n){"use strict";e.byteLength=l,e.toByteArray=f,e.fromByteArray=m;for(var r=[],i=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function l(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r}function h(t,e,n){return 3*(e+n)/4-n}function f(t){var e,n,r=c(t),a=r[0],s=r[1],u=new o(h(t,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u}function p(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function d(t,e,n){for(var r,i=[],o=e;o<n;o+=3)r=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),i.push(p(r));return i.join("")}function m(t){for(var e,n=t.length,i=n%3,o=[],a=16383,s=0,u=n-i;s<u;s+=a)o.push(d(t,s,s+a>u?u:s+a));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},2266:function(t,e,n){var r=n("825a"),i=n("e95a"),o=n("50c4"),a=n("0366"),s=n("35a1"),u=n("2a62"),c=function(t,e){this.stopped=t,this.result=e};t.exports=function(t,e,n){var l,h,f,p,d,m,v,g=n&&n.that,y=!(!n||!n.AS_ENTRIES),b=!(!n||!n.IS_ITERATOR),x=!(!n||!n.INTERRUPTED),w=a(e,g,1+y+x),E=function(t){return l&&u(l),new c(!0,t)},_=function(t){return y?(r(t),x?w(t[0],t[1],E):w(t[0],t[1])):x?w(t,E):w(t)};if(b)l=t;else{if(h=s(t),"function"!=typeof h)throw TypeError("Target is not iterable");if(i(h)){for(f=0,p=o(t.length);p>f;f++)if(d=_(t[f]),d&&d instanceof c)return d;return new c(!1)}l=h.call(t)}m=l.next;while(!(v=m.call(l)).done){try{d=_(v.value)}catch(C){throw u(l),C}if("object"==typeof d&&d&&d instanceof c)return d}return new c(!1)}},"23cb":function(t,e,n){var r=n("a691"),i=Math.max,o=Math.min;t.exports=function(t,e){var n=r(t);return n<0?i(n+e,0):o(n,e)}},"23e7":function(t,e,n){var r=n("da84"),i=n("06cf").f,o=n("9112"),a=n("6eeb"),s=n("ce4e"),u=n("e893"),c=n("94ca");t.exports=function(t,e){var n,l,h,f,p,d,m=t.target,v=t.global,g=t.stat;if(l=v?r:g?r[m]||s(m,{}):(r[m]||{}).prototype,l)for(h in e){if(p=e[h],t.noTargetGet?(d=i(l,h),f=d&&d.value):f=l[h],n=c(v?h:m+(g?".":"#")+h,t.forced),!n&&void 0!==f){if(typeof p===typeof f)continue;u(p,f)}(t.sham||f&&f.sham)&&o(p,"sham",!0),a(l,h,p,t)}}},"241c":function(t,e,n){var r=n("ca84"),i=n("7839"),o=i.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,o)}},2444:function(t,e,n){"use strict";(function(e){var r=n("c532"),i=n("c8af"),o={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function s(){var t;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof e&&"[object process]"===Object.prototype.toString.call(e))&&(t=n("b50d")),t}var u={adapter:s(),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"===typeof t)try{t=JSON.parse(t)}catch(e){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(t){u.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){u.headers[t]=r.merge(o)})),t.exports=u}).call(this,n("4362"))},2626:function(t,e,n){"use strict";var r=n("d066"),i=n("9bf2"),o=n("b622"),a=n("83ab"),s=o("species");t.exports=function(t){var e=r(t),n=i.f;a&&e&&!e[s]&&n(e,s,{configurable:!0,get:function(){return this}})}},"262e":function(t,e,n){"use strict";function r(t,e){return r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}function i(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}n.d(e,"a",(function(){return i}))},2877:function(t,e,n){"use strict";function r(t,e,n,r,i,o,a,s){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),o&&(c._scopeId="data-v-"+o),a?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):i&&(u=s?function(){i.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:i),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(t,e){return u.call(e),l(t,e)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,u):[u]}return{exports:t,options:c}}n.d(e,"a",(function(){return r}))},"289e":function(t,e){
/*! (C) Andrea Giammarchi - @WebReflection - ISC Style License */
!function(t,e){"use strict";function n(){var t=k.splice(0,k.length);for(Zt=0;t.length;)t.shift().call(null,t.shift())}function r(t,e){for(var n=0,r=t.length;n<r;n++)v(t[n],e)}function i(t){for(var e,n=0,r=t.length;n<r;n++)e=t[n],F(e,at[a(e)])}function o(t){return function(e){Bt(e)&&(v(e,t),st.length&&r(e.querySelectorAll(st),t))}}function a(t){var e=Ht.call(t,"is"),n=t.nodeName.toUpperCase(),r=ct.call(ot,e?nt+e.toUpperCase():et+n);return e&&-1<r&&!s(n,e)?-1:r}function s(t,e){return-1<st.indexOf(t+'[is="'+e+'"]')}function u(t){var e=t.currentTarget,n=t.attrChange,r=t.attrName,i=t.target,o=t[Y]||2,a=t[J]||3;!oe||i&&i!==e||!e[H]||"style"===r||t.prevValue===t.newValue&&(""!==t.newValue||n!==o&&n!==a)||e[H](r,n===o?null:t.prevValue,n===a?null:t.newValue)}function c(t){var e=o(t);return function(t){k.push(e,t.target),Zt&&clearTimeout(Zt),Zt=setTimeout(n,1)}}function l(t){ie&&(ie=!1,t.currentTarget.removeEventListener(Z,l)),st.length&&r((t.target||C).querySelectorAll(st),t.detail===W?W:z),Nt&&d()}function h(t,e){var n=this;$t.call(n,t,e),T.call(n,{target:n})}function f(t,e,n){var r=e.apply(t,n),o=a(r);return-1<o&&F(r,at[o]),n.pop()&&st.length&&i(r.querySelectorAll(st)),r}function p(t,e){Rt(t,e),D?D.observe(t,Jt):(re&&(t.setAttribute=h,t[B]=P(t),t[V](tt,T)),t[V](Q,u)),t[K]&&oe&&(t.created=!0,t[K](),t.created=!1)}function d(){for(var t,e=0,n=Vt.length;e<n;e++)t=Vt[e],ut.contains(t)||(n--,Vt.splice(e--,1),v(t,W))}function m(t){throw new Error("A "+t+" type is already registered")}function v(t,e){var n,r,i=a(t);-1<i&&!Wt.call(t,"TEMPLATE")&&(M(t,at[i]),i=0,e!==z||t[z]?e!==W||t[W]||(t[z]=!1,t[W]=!0,r="disconnected",i=1):(t[W]=!1,t[z]=!0,r="connected",i=1,Nt&&ct.call(Vt,t)<0&&Vt.push(t)),i&&(n=t[e+j]||t[r+j])&&n.call(t))}function g(){}function y(t,e,n){var r=n&&n[G]||"",i=e.prototype,o=Dt(i),a=e.observedAttributes||dt,s={prototype:o};Lt(o,K,{value:function(){if(At)At=!1;else if(!this[xt]){this[xt]=!0,new e(this),i[K]&&i[K].call(this);var t=kt[It.get(e)];(!Et||t.create.length>1)&&w(this)}}}),Lt(o,H,{value:function(t){-1<ct.call(a,t)&&i[H]&&i[H].apply(this,arguments)}}),i[q]&&Lt(o,U,{value:i[q]}),i[$]&&Lt(o,X,{value:i[$]}),r&&(s[G]=r),t=t.toUpperCase(),kt[t]={constructor:e,create:r?[r,Pt(t)]:[t]},It.set(e,t),C[N](t.toLowerCase(),s),E(t),Tt[t].r()}function b(t){var e=kt[t.toUpperCase()];return e&&e.constructor}function x(t){return"string"==typeof t?t:t&&t.is||""}function w(t){for(var e,n=t[H],r=n?t.attributes:dt,i=r.length;i--;)e=r[i],n.call(t,e.name||e.nodeName,null,e.value||e.nodeValue)}function E(t){return t=t.toUpperCase(),t in Tt||(Tt[t]={},Tt[t].p=new St((function(e){Tt[t].r=e}))),Tt[t].p}function _(){wt&&delete t.customElements,pt(t,"customElements",{configurable:!0,value:new g}),pt(t,"CustomElementRegistry",{configurable:!0,value:g});for(var e=A.get(/^HTML[A-Z]*[a-z]/),n=e.length;n--;function(e){var n=t[e];if(n){t[e]=function(t){var e,r;return t||(t=this),t[xt]||(At=!0,e=kt[It.get(t.constructor)],r=Et&&1===e.create.length,t=r?Reflect.construct(n,dt,e.constructor):C.createElement.apply(C,e.create),t[xt]=!0,At=!1,r||w(t)),t},t[e].prototype=n.prototype;try{n.prototype.constructor=t[e]}catch(r){!0,pt(n,xt,{value:t[e]})}}}(e[n]));C.createElement=function(t,e){var n=x(e);return n?Yt.call(this,t,Pt(n)):Yt.call(this,t)},te||(ne=!0,C[N](""))}var C=t.document,S=t.Object,A=function(t){var e,n,r,i,o=/^[A-Z]+[a-z]/,a=function(t){var e,n=[];for(e in u)t.test(e)&&n.push(e);return n},s=function(t,e){(e=e.toLowerCase())in u||(u[t]=(u[t]||[]).concat(e),u[e]=u[e.toUpperCase()]=t)},u=(S.create||S)(null),c={};for(n in t)for(i in t[n])for(r=t[n][i],u[i]=r,e=0;e<r.length;e++)u[r[e].toLowerCase()]=u[r[e].toUpperCase()]=i;return c.get=function(t){return"string"==typeof t?u[t]||(o.test(t)?[]:""):a(t)},c.set=function(t,e){return o.test(t)?s(t,e):s(e,t),c},c}({collections:{HTMLAllCollection:["all"],HTMLCollection:["forms"],HTMLFormControlsCollection:["elements"],HTMLOptionsCollection:["options"]},elements:{Element:["element"],HTMLAnchorElement:["a"],HTMLAppletElement:["applet"],HTMLAreaElement:["area"],HTMLAttachmentElement:["attachment"],HTMLAudioElement:["audio"],HTMLBRElement:["br"],HTMLBaseElement:["base"],HTMLBodyElement:["body"],HTMLButtonElement:["button"],HTMLCanvasElement:["canvas"],HTMLContentElement:["content"],HTMLDListElement:["dl"],HTMLDataElement:["data"],HTMLDataListElement:["datalist"],HTMLDetailsElement:["details"],HTMLDialogElement:["dialog"],HTMLDirectoryElement:["dir"],HTMLDivElement:["div"],HTMLDocument:["document"],HTMLElement:["element","abbr","address","article","aside","b","bdi","bdo","cite","code","command","dd","dfn","dt","em","figcaption","figure","footer","header","i","kbd","mark","nav","noscript","rp","rt","ruby","s","samp","section","small","strong","sub","summary","sup","u","var","wbr"],HTMLEmbedElement:["embed"],HTMLFieldSetElement:["fieldset"],HTMLFontElement:["font"],HTMLFormElement:["form"],HTMLFrameElement:["frame"],HTMLFrameSetElement:["frameset"],HTMLHRElement:["hr"],HTMLHeadElement:["head"],HTMLHeadingElement:["h1","h2","h3","h4","h5","h6"],HTMLHtmlElement:["html"],HTMLIFrameElement:["iframe"],HTMLImageElement:["img"],HTMLInputElement:["input"],HTMLKeygenElement:["keygen"],HTMLLIElement:["li"],HTMLLabelElement:["label"],HTMLLegendElement:["legend"],HTMLLinkElement:["link"],HTMLMapElement:["map"],HTMLMarqueeElement:["marquee"],HTMLMediaElement:["media"],HTMLMenuElement:["menu"],HTMLMenuItemElement:["menuitem"],HTMLMetaElement:["meta"],HTMLMeterElement:["meter"],HTMLModElement:["del","ins"],HTMLOListElement:["ol"],HTMLObjectElement:["object"],HTMLOptGroupElement:["optgroup"],HTMLOptionElement:["option"],HTMLOutputElement:["output"],HTMLParagraphElement:["p"],HTMLParamElement:["param"],HTMLPictureElement:["picture"],HTMLPreElement:["pre"],HTMLProgressElement:["progress"],HTMLQuoteElement:["blockquote","q","quote"],HTMLScriptElement:["script"],HTMLSelectElement:["select"],HTMLShadowElement:["shadow"],HTMLSlotElement:["slot"],HTMLSourceElement:["source"],HTMLSpanElement:["span"],HTMLStyleElement:["style"],HTMLTableCaptionElement:["caption"],HTMLTableCellElement:["td","th"],HTMLTableColElement:["col","colgroup"],HTMLTableElement:["table"],HTMLTableRowElement:["tr"],HTMLTableSectionElement:["thead","tbody","tfoot"],HTMLTemplateElement:["template"],HTMLTextAreaElement:["textarea"],HTMLTimeElement:["time"],HTMLTitleElement:["title"],HTMLTrackElement:["track"],HTMLUListElement:["ul"],HTMLUnknownElement:["unknown","vhgroupv","vkeygen"],HTMLVideoElement:["video"]},nodes:{Attr:["node"],Audio:["audio"],CDATASection:["node"],CharacterData:["node"],Comment:["#comment"],Document:["#document"],DocumentFragment:["#document-fragment"],DocumentType:["node"],HTMLDocument:["#document"],Image:["img"],Option:["option"],ProcessingInstruction:["node"],ShadowRoot:["#shadow-root"],Text:["#text"],XMLDocument:["xml"]}});"object"!=typeof e&&(e={type:e||"auto"});var k,T,I,P,D,R,M,F,O,N="registerElement",L=1e5*t.Math.random()>>0,B="__"+N+L,V="addEventListener",z="attached",j="Callback",W="detached",G="extends",H="attributeChanged"+j,U=z+j,q="connected"+j,$="disconnected"+j,K="created"+j,X=W+j,Y="ADDITION",J="REMOVAL",Q="DOMAttrModified",Z="DOMContentLoaded",tt="DOMSubtreeModified",et="<",nt="=",rt=/^[A-Z][._A-Z0-9]*-[-._A-Z0-9]*$/,it=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],ot=[],at=[],st="",ut=C.documentElement,ct=ot.indexOf||function(t){for(var e=this.length;e--&&this[e]!==t;);return e},lt=S.prototype,ht=lt.hasOwnProperty,ft=lt.isPrototypeOf,pt=S.defineProperty,dt=[],mt=S.getOwnPropertyDescriptor,vt=S.getOwnPropertyNames,gt=S.getPrototypeOf,yt=S.setPrototypeOf,bt=!!S.__proto__,xt="__dreCEv1",wt=t.customElements,Et=!/^force/.test(e.type)&&!!(wt&&wt.define&&wt.get&&wt.whenDefined),_t=S.create||S,Ct=t.Map||function(){var t,e=[],n=[];return{get:function(t){return n[ct.call(e,t)]},set:function(r,i){t=ct.call(e,r),t<0?n[e.push(r)-1]=i:n[t]=i}}},St=t.Promise||function(t){function e(t){for(r=!0;n.length;)n.shift()(t)}var n=[],r=!1,i={catch:function(){return i},then:function(t){return n.push(t),r&&setTimeout(e,1),i}};return t(e),i},At=!1,kt=_t(null),Tt=_t(null),It=new Ct,Pt=function(t){return t.toLowerCase()},Dt=S.create||function t(e){return e?(t.prototype=e,new t):this},Rt=yt||(bt?function(t,e){return t.__proto__=e,t}:vt&&mt?function(){function t(t,e){for(var n,r=vt(e),i=0,o=r.length;i<o;i++)n=r[i],ht.call(t,n)||pt(t,n,mt(e,n))}return function(e,n){do{t(e,n)}while((n=gt(n))&&!ft.call(n,e));return e}}():function(t,e){for(var n in e)t[n]=e[n];return t}),Mt=t.MutationObserver||t.WebKitMutationObserver,Ft=t.HTMLAnchorElement,Ot=(t.HTMLElement||t.Element||t.Node).prototype,Nt=!ft.call(Ot,ut),Lt=Nt?function(t,e,n){return t[e]=n.value,t}:pt,Bt=Nt?function(t){return 1===t.nodeType}:function(t){return ft.call(Ot,t)},Vt=Nt&&[],zt=Ot.attachShadow,jt=Ot.cloneNode,Wt=Ot.closest||function(t){for(var e=this;e&&e.nodeName!==t;)e=e.parentNode;return e},Gt=Ot.dispatchEvent,Ht=Ot.getAttribute,Ut=Ot.hasAttribute,qt=Ot.removeAttribute,$t=Ot.setAttribute,Kt=C.createElement,Xt=C.importNode,Yt=Kt,Jt=Mt&&{attributes:!0,characterData:!0,attributeOldValue:!0},Qt=Mt||function(t){re=!1,ut.removeEventListener(Q,Qt)},Zt=0,te=N in C&&!/^force-all/.test(e.type),ee=!0,ne=!1,re=!0,ie=!0,oe=!0;if(Mt&&(O=C.createElement("div"),O.innerHTML="<div><div></div></div>",new Mt((function(t,e){if(t[0]&&"childList"==t[0].type&&!t[0].removedNodes[0].childNodes.length){O=mt(Ot,"innerHTML");var n=O&&O.set;n&&pt(Ot,"innerHTML",{set:function(t){for(;this.lastChild;)this.removeChild(this.lastChild);n.call(this,t)}})}e.disconnect(),O=null})).observe(O,{childList:!0,subtree:!0}),O.innerHTML=""),te||(yt||bt?(M=function(t,e){ft.call(e,t)||p(t,e)},F=p):(M=function(t,e){t[B]||(t[B]=S(!0),p(t,e))},F=M),Nt?(re=!1,function(){var t=mt(Ot,V),e=t.value,n=function(t){var e=new CustomEvent(Q,{bubbles:!0});e.attrName=t,e.prevValue=Ht.call(this,t),e.newValue=null,e[J]=e.attrChange=2,qt.call(this,t),Gt.call(this,e)},r=function(t,e){var n=Ut.call(this,t),r=n&&Ht.call(this,t),i=new CustomEvent(Q,{bubbles:!0});$t.call(this,t,e),i.attrName=t,i.prevValue=n?r:null,i.newValue=e,n?i.MODIFICATION=i.attrChange=1:i[Y]=i.attrChange=0,Gt.call(this,i)},i=function(t){var e,n=t.currentTarget,r=n[B],i=t.propertyName;r.hasOwnProperty(i)&&(r=r[i],e=new CustomEvent(Q,{bubbles:!0}),e.attrName=r.name,e.prevValue=r.value||null,e.newValue=r.value=n[i]||null,null==e.prevValue?e[Y]=e.attrChange=0:e.MODIFICATION=e.attrChange=1,Gt.call(n,e))};t.value=function(t,o,a){t===Q&&this[H]&&this.setAttribute!==r&&(this[B]={className:{name:"class",value:this.className}},this.setAttribute=r,this.removeAttribute=n,e.call(this,"propertychange",i)),e.call(this,t,o,a)},pt(Ot,V,t)}()):Mt||(ut[V](Q,Qt),ut.setAttribute(B,1),ut.removeAttribute(B),re&&(T=function(t){var e,n,r,i=this;if(i===t.target){for(r in e=i[B],i[B]=n=P(i),n){if(!(r in e))return I(0,i,r,e[r],n[r],Y);if(n[r]!==e[r])return I(1,i,r,e[r],n[r],"MODIFICATION")}for(r in e)if(!(r in n))return I(2,i,r,e[r],n[r],J)}},I=function(t,e,n,r,i,o){var a={attrChange:t,currentTarget:e,attrName:n,prevValue:r,newValue:i};a[o]=t,u(a)},P=function(t){for(var e,n,r={},i=t.attributes,o=0,a=i.length;o<a;o++)e=i[o],"setAttribute"!==(n=e.name)&&(r[n]=e.value);return r})),C[N]=function(t,e){if(n=t.toUpperCase(),ee&&(ee=!1,Mt?(D=function(t,e){function n(t,e){for(var n=0,r=t.length;n<r;e(t[n++]));}return new Mt((function(r){for(var i,o,a,s=0,u=r.length;s<u;s++)i=r[s],"childList"===i.type?(n(i.addedNodes,t),n(i.removedNodes,e)):(o=i.target,oe&&o[H]&&"style"!==i.attributeName&&(a=Ht.call(o,i.attributeName))!==i.oldValue&&o[H](i.attributeName,i.oldValue,a))}))}(o(z),o(W)),R=function(t){return D.observe(t,{childList:!0,subtree:!0}),t},R(C),zt&&(Ot.attachShadow=function(){return R(zt.apply(this,arguments))})):(k=[],C[V]("DOMNodeInserted",c(z)),C[V]("DOMNodeRemoved",c(W))),C[V](Z,l),C[V]("readystatechange",l),C.importNode=function(t,e){switch(t.nodeType){case 1:return f(C,Xt,[t,!!e]);case 11:for(var n=C.createDocumentFragment(),r=t.childNodes,i=r.length,o=0;o<i;o++)n.appendChild(C.importNode(r[o],!!e));return n;default:return jt.call(t,!!e)}},Ot.cloneNode=function(t){return f(this,jt,[!!t])}),ne)return ne=!1;if(-2<ct.call(ot,nt+n)+ct.call(ot,et+n)&&m(t),!rt.test(n)||-1<ct.call(it,n))throw new Error("The type "+t+" is invalid");var n,i,a=function(){return u?C.createElement(h,n):C.createElement(h)},s=e||lt,u=ht.call(s,G),h=u?e[G].toUpperCase():n;return u&&-1<ct.call(ot,et+h)&&m(h),i=ot.push((u?nt:et)+n)-1,st=st.concat(st.length?",":"",u?h+'[is="'+t.toLowerCase()+'"]':h),a.prototype=at[i]=ht.call(s,"prototype")?s.prototype:Dt(Ot),st.length&&r(C.querySelectorAll(st),z),a},C.createElement=Yt=function(t,e){var n=x(e),r=n?Kt.call(C,t,Pt(n)):Kt.call(C,t),i=""+t,o=ct.call(ot,(n?nt:et)+(n||i).toUpperCase()),a=-1<o;return n&&(r.setAttribute("is",n=n.toLowerCase()),a&&(a=s(i.toUpperCase(),n))),oe=!C.createElement.innerHTMLHelper,a&&F(r,at[o]),r}),addEventListener("beforeunload",(function(){delete C.createElement,delete C.importNode,delete C[N]}),!1),g.prototype={constructor:g,define:Et?function(t,e,n){if(n)y(t,e,n);else{var r=t.toUpperCase();kt[r]={constructor:e,create:[r]},It.set(e,r),wt.define(t,e)}}:y,get:Et?function(t){return wt.get(t)||b(t)}:b,whenDefined:Et?function(t){return St.race([wt.whenDefined(t),E(t)])}:E},!wt||/^force/.test(e.type))_();else if(!e.noBuiltIn)try{!function(e,n,r){var i=new RegExp("^<a\\s+is=('|\")"+r+"\\1></a>$");if(n[G]="a",e.prototype=Dt(Ft.prototype),e.prototype.constructor=e,t.customElements.define(r,e,n),!i.test(C.createElement("a",{is:r}).outerHTML)||!i.test((new e).outerHTML))throw n}((function t(){return Reflect.construct(Ft,[],t)}),{},"document-register-element-a"+L)}catch(ae){_()}if(!e.noBuiltIn)try{if(Kt.call(C,"a","a").outerHTML.indexOf("is")<0)throw{}}catch(se){Pt=function(t){return{is:t.toLowerCase()}}}}(window)},"2a62":function(t,e,n){var r=n("825a");t.exports=function(t){var e=t["return"];if(void 0!==e)return r(e.call(t)).value}},"2b0e":function(t,e,n){"use strict";(function(t){
/*!
 * Vue.js v2.6.14
 * (c) 2014-2021 Evan You
 * Released under the MIT License.
 */
var n=Object.freeze({});function r(t){return void 0===t||null===t}function i(t){return void 0!==t&&null!==t}function o(t){return!0===t}function a(t){return!1===t}function s(t){return"string"===typeof t||"number"===typeof t||"symbol"===typeof t||"boolean"===typeof t}function u(t){return null!==t&&"object"===typeof t}var c=Object.prototype.toString;function l(t){return"[object Object]"===c.call(t)}function h(t){return"[object RegExp]"===c.call(t)}function f(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function p(t){return i(t)&&"function"===typeof t.then&&"function"===typeof t.catch}function d(t){return null==t?"":Array.isArray(t)||l(t)&&t.toString===c?JSON.stringify(t,null,2):String(t)}function m(t){var e=parseFloat(t);return isNaN(e)?t:e}function v(t,e){for(var n=Object.create(null),r=t.split(","),i=0;i<r.length;i++)n[r[i]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}v("slot,component",!0);var g=v("key,ref,slot,slot-scope,is");function y(t,e){if(t.length){var n=t.indexOf(e);if(n>-1)return t.splice(n,1)}}var b=Object.prototype.hasOwnProperty;function x(t,e){return b.call(t,e)}function w(t){var e=Object.create(null);return function(n){var r=e[n];return r||(e[n]=t(n))}}var E=/-(\w)/g,_=w((function(t){return t.replace(E,(function(t,e){return e?e.toUpperCase():""}))})),C=w((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),S=/\B([A-Z])/g,A=w((function(t){return t.replace(S,"-$1").toLowerCase()}));function k(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n}function T(t,e){return t.bind(e)}var I=Function.prototype.bind?T:k;function P(t,e){e=e||0;var n=t.length-e,r=new Array(n);while(n--)r[n]=t[n+e];return r}function D(t,e){for(var n in e)t[n]=e[n];return t}function R(t){for(var e={},n=0;n<t.length;n++)t[n]&&D(e,t[n]);return e}function M(t,e,n){}var F=function(t,e,n){return!1},O=function(t){return t};function N(t,e){if(t===e)return!0;var n=u(t),r=u(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var i=Array.isArray(t),o=Array.isArray(e);if(i&&o)return t.length===e.length&&t.every((function(t,n){return N(t,e[n])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(i||o)return!1;var a=Object.keys(t),s=Object.keys(e);return a.length===s.length&&a.every((function(n){return N(t[n],e[n])}))}catch(c){return!1}}function L(t,e){for(var n=0;n<t.length;n++)if(N(t[n],e))return n;return-1}function B(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}var V="data-server-rendered",z=["component","directive","filter"],j=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],W={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:F,isReservedAttr:F,isUnknownElement:F,getTagNamespace:M,parsePlatformTagName:O,mustUseProp:F,async:!0,_lifecycleHooks:j},G=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function H(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function U(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var q=new RegExp("[^"+G.source+".$_\\d]");function $(t){if(!q.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}var K,X="__proto__"in{},Y="undefined"!==typeof window,J="undefined"!==typeof WXEnvironment&&!!WXEnvironment.platform,Q=J&&WXEnvironment.platform.toLowerCase(),Z=Y&&window.navigator.userAgent.toLowerCase(),tt=Z&&/msie|trident/.test(Z),et=Z&&Z.indexOf("msie 9.0")>0,nt=Z&&Z.indexOf("edge/")>0,rt=(Z&&Z.indexOf("android"),Z&&/iphone|ipad|ipod|ios/.test(Z)||"ios"===Q),it=(Z&&/chrome\/\d+/.test(Z),Z&&/phantomjs/.test(Z),Z&&Z.match(/firefox\/(\d+)/)),ot={}.watch,at=!1;if(Y)try{var st={};Object.defineProperty(st,"passive",{get:function(){at=!0}}),window.addEventListener("test-passive",null,st)}catch(Ca){}var ut=function(){return void 0===K&&(K=!Y&&!J&&"undefined"!==typeof t&&(t["process"]&&"server"===t["process"].env.VUE_ENV)),K},ct=Y&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function lt(t){return"function"===typeof t&&/native code/.test(t.toString())}var ht,ft="undefined"!==typeof Symbol&&lt(Symbol)&&"undefined"!==typeof Reflect&&lt(Reflect.ownKeys);ht="undefined"!==typeof Set&&lt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var pt=M,dt=0,mt=function(){this.id=dt++,this.subs=[]};mt.prototype.addSub=function(t){this.subs.push(t)},mt.prototype.removeSub=function(t){y(this.subs,t)},mt.prototype.depend=function(){mt.target&&mt.target.addDep(this)},mt.prototype.notify=function(){var t=this.subs.slice();for(var e=0,n=t.length;e<n;e++)t[e].update()},mt.target=null;var vt=[];function gt(t){vt.push(t),mt.target=t}function yt(){vt.pop(),mt.target=vt[vt.length-1]}var bt=function(t,e,n,r,i,o,a,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=i,this.ns=void 0,this.context=o,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=a,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},xt={child:{configurable:!0}};xt.child.get=function(){return this.componentInstance},Object.defineProperties(bt.prototype,xt);var wt=function(t){void 0===t&&(t="");var e=new bt;return e.text=t,e.isComment=!0,e};function Et(t){return new bt(void 0,void 0,void 0,String(t))}function _t(t){var e=new bt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}var Ct=Array.prototype,St=Object.create(Ct),At=["push","pop","shift","unshift","splice","sort","reverse"];At.forEach((function(t){var e=Ct[t];U(St,t,(function(){var n=[],r=arguments.length;while(r--)n[r]=arguments[r];var i,o=e.apply(this,n),a=this.__ob__;switch(t){case"push":case"unshift":i=n;break;case"splice":i=n.slice(2);break}return i&&a.observeArray(i),a.dep.notify(),o}))}));var kt=Object.getOwnPropertyNames(St),Tt=!0;function It(t){Tt=t}var Pt=function(t){this.value=t,this.dep=new mt,this.vmCount=0,U(t,"__ob__",this),Array.isArray(t)?(X?Dt(t,St):Rt(t,St,kt),this.observeArray(t)):this.walk(t)};function Dt(t,e){t.__proto__=e}function Rt(t,e,n){for(var r=0,i=n.length;r<i;r++){var o=n[r];U(t,o,e[o])}}function Mt(t,e){var n;if(u(t)&&!(t instanceof bt))return x(t,"__ob__")&&t.__ob__ instanceof Pt?n=t.__ob__:Tt&&!ut()&&(Array.isArray(t)||l(t))&&Object.isExtensible(t)&&!t._isVue&&(n=new Pt(t)),e&&n&&n.vmCount++,n}function Ft(t,e,n,r,i){var o=new mt,a=Object.getOwnPropertyDescriptor(t,e);if(!a||!1!==a.configurable){var s=a&&a.get,u=a&&a.set;s&&!u||2!==arguments.length||(n=t[e]);var c=!i&&Mt(n);Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=s?s.call(t):n;return mt.target&&(o.depend(),c&&(c.dep.depend(),Array.isArray(e)&&Lt(e))),e},set:function(e){var r=s?s.call(t):n;e===r||e!==e&&r!==r||s&&!u||(u?u.call(t,e):n=e,c=!i&&Mt(e),o.notify())}})}}function Ot(t,e,n){if(Array.isArray(t)&&f(e))return t.length=Math.max(t.length,e),t.splice(e,1,n),n;if(e in t&&!(e in Object.prototype))return t[e]=n,n;var r=t.__ob__;return t._isVue||r&&r.vmCount?n:r?(Ft(r.value,e,n),r.dep.notify(),n):(t[e]=n,n)}function Nt(t,e){if(Array.isArray(t)&&f(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||x(t,e)&&(delete t[e],n&&n.dep.notify())}}function Lt(t){for(var e=void 0,n=0,r=t.length;n<r;n++)e=t[n],e&&e.__ob__&&e.__ob__.dep.depend(),Array.isArray(e)&&Lt(e)}Pt.prototype.walk=function(t){for(var e=Object.keys(t),n=0;n<e.length;n++)Ft(t,e[n])},Pt.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Mt(t[e])};var Bt=W.optionMergeStrategies;function Vt(t,e){if(!e)return t;for(var n,r,i,o=ft?Reflect.ownKeys(e):Object.keys(e),a=0;a<o.length;a++)n=o[a],"__ob__"!==n&&(r=t[n],i=e[n],x(t,n)?r!==i&&l(r)&&l(i)&&Vt(r,i):Ot(t,n,i));return t}function zt(t,e,n){return n?function(){var r="function"===typeof e?e.call(n,n):e,i="function"===typeof t?t.call(n,n):t;return r?Vt(r,i):i}:e?t?function(){return Vt("function"===typeof e?e.call(this,this):e,"function"===typeof t?t.call(this,this):t)}:e:t}function jt(t,e){var n=e?t?t.concat(e):Array.isArray(e)?e:[e]:t;return n?Wt(n):n}function Wt(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function Gt(t,e,n,r){var i=Object.create(t||null);return e?D(i,e):i}Bt.data=function(t,e,n){return n?zt(t,e,n):e&&"function"!==typeof e?t:zt(t,e)},j.forEach((function(t){Bt[t]=jt})),z.forEach((function(t){Bt[t+"s"]=Gt})),Bt.watch=function(t,e,n,r){if(t===ot&&(t=void 0),e===ot&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var i={};for(var o in D(i,t),e){var a=i[o],s=e[o];a&&!Array.isArray(a)&&(a=[a]),i[o]=a?a.concat(s):Array.isArray(s)?s:[s]}return i},Bt.props=Bt.methods=Bt.inject=Bt.computed=function(t,e,n,r){if(!t)return e;var i=Object.create(null);return D(i,t),e&&D(i,e),i},Bt.provide=zt;var Ht=function(t,e){return void 0===e?t:e};function Ut(t,e){var n=t.props;if(n){var r,i,o,a={};if(Array.isArray(n)){r=n.length;while(r--)i=n[r],"string"===typeof i&&(o=_(i),a[o]={type:null})}else if(l(n))for(var s in n)i=n[s],o=_(s),a[o]=l(i)?i:{type:i};else 0;t.props=a}}function qt(t,e){var n=t.inject;if(n){var r=t.inject={};if(Array.isArray(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(l(n))for(var o in n){var a=n[o];r[o]=l(a)?D({from:o},a):{from:a}}else 0}}function $t(t){var e=t.directives;if(e)for(var n in e){var r=e[n];"function"===typeof r&&(e[n]={bind:r,update:r})}}function Kt(t,e,n){if("function"===typeof e&&(e=e.options),Ut(e,n),qt(e,n),$t(e),!e._base&&(e.extends&&(t=Kt(t,e.extends,n)),e.mixins))for(var r=0,i=e.mixins.length;r<i;r++)t=Kt(t,e.mixins[r],n);var o,a={};for(o in t)s(o);for(o in e)x(t,o)||s(o);function s(r){var i=Bt[r]||Ht;a[r]=i(t[r],e[r],n,r)}return a}function Xt(t,e,n,r){if("string"===typeof n){var i=t[e];if(x(i,n))return i[n];var o=_(n);if(x(i,o))return i[o];var a=C(o);if(x(i,a))return i[a];var s=i[n]||i[o]||i[a];return s}}function Yt(t,e,n,r){var i=e[t],o=!x(n,t),a=n[t],s=ee(Boolean,i.type);if(s>-1)if(o&&!x(i,"default"))a=!1;else if(""===a||a===A(t)){var u=ee(String,i.type);(u<0||s<u)&&(a=!0)}if(void 0===a){a=Jt(r,i,t);var c=Tt;It(!0),Mt(a),It(c)}return a}function Jt(t,e,n){if(x(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:"function"===typeof r&&"Function"!==Zt(e.type)?r.call(t):r}}var Qt=/^\s*function (\w+)/;function Zt(t){var e=t&&t.toString().match(Qt);return e?e[1]:""}function te(t,e){return Zt(t)===Zt(e)}function ee(t,e){if(!Array.isArray(e))return te(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(te(e[n],t))return n;return-1}function ne(t,e,n){gt();try{if(e){var r=e;while(r=r.$parent){var i=r.$options.errorCaptured;if(i)for(var o=0;o<i.length;o++)try{var a=!1===i[o].call(r,t,e,n);if(a)return}catch(Ca){ie(Ca,r,"errorCaptured hook")}}}ie(t,e,n)}finally{yt()}}function re(t,e,n,r,i){var o;try{o=n?t.apply(e,n):t.call(e),o&&!o._isVue&&p(o)&&!o._handled&&(o.catch((function(t){return ne(t,r,i+" (Promise/async)")})),o._handled=!0)}catch(Ca){ne(Ca,r,i)}return o}function ie(t,e,n){if(W.errorHandler)try{return W.errorHandler.call(null,t,e,n)}catch(Ca){Ca!==t&&oe(Ca,null,"config.errorHandler")}oe(t,e,n)}function oe(t,e,n){if(!Y&&!J||"undefined"===typeof console)throw t;console.error(t)}var ae,se=!1,ue=[],ce=!1;function le(){ce=!1;var t=ue.slice(0);ue.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!==typeof Promise&&lt(Promise)){var he=Promise.resolve();ae=function(){he.then(le),rt&&setTimeout(M)},se=!0}else if(tt||"undefined"===typeof MutationObserver||!lt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())ae="undefined"!==typeof setImmediate&&lt(setImmediate)?function(){setImmediate(le)}:function(){setTimeout(le,0)};else{var fe=1,pe=new MutationObserver(le),de=document.createTextNode(String(fe));pe.observe(de,{characterData:!0}),ae=function(){fe=(fe+1)%2,de.data=String(fe)},se=!0}function me(t,e){var n;if(ue.push((function(){if(t)try{t.call(e)}catch(Ca){ne(Ca,e,"nextTick")}else n&&n(e)})),ce||(ce=!0,ae()),!t&&"undefined"!==typeof Promise)return new Promise((function(t){n=t}))}var ve=new ht;function ge(t){ye(t,ve),ve.clear()}function ye(t,e){var n,r,i=Array.isArray(t);if(!(!i&&!u(t)||Object.isFrozen(t)||t instanceof bt)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(i){n=t.length;while(n--)ye(t[n],e)}else{r=Object.keys(t),n=r.length;while(n--)ye(t[r[n]],e)}}}var be=w((function(t){var e="&"===t.charAt(0);t=e?t.slice(1):t;var n="~"===t.charAt(0);t=n?t.slice(1):t;var r="!"===t.charAt(0);return t=r?t.slice(1):t,{name:t,once:n,capture:r,passive:e}}));function xe(t,e){function n(){var t=arguments,r=n.fns;if(!Array.isArray(r))return re(r,null,arguments,e,"v-on handler");for(var i=r.slice(),o=0;o<i.length;o++)re(i[o],null,t,e,"v-on handler")}return n.fns=t,n}function we(t,e,n,i,a,s){var u,c,l,h;for(u in t)c=t[u],l=e[u],h=be(u),r(c)||(r(l)?(r(c.fns)&&(c=t[u]=xe(c,s)),o(h.once)&&(c=t[u]=a(h.name,c,h.capture)),n(h.name,c,h.capture,h.passive,h.params)):c!==l&&(l.fns=c,t[u]=l));for(u in e)r(t[u])&&(h=be(u),i(h.name,e[u],h.capture))}function Ee(t,e,n){var a;t instanceof bt&&(t=t.data.hook||(t.data.hook={}));var s=t[e];function u(){n.apply(this,arguments),y(a.fns,u)}r(s)?a=xe([u]):i(s.fns)&&o(s.merged)?(a=s,a.fns.push(u)):a=xe([s,u]),a.merged=!0,t[e]=a}function _e(t,e,n){var o=e.options.props;if(!r(o)){var a={},s=t.attrs,u=t.props;if(i(s)||i(u))for(var c in o){var l=A(c);Ce(a,u,c,l,!0)||Ce(a,s,c,l,!1)}return a}}function Ce(t,e,n,r,o){if(i(e)){if(x(e,n))return t[n]=e[n],o||delete e[n],!0;if(x(e,r))return t[n]=e[r],o||delete e[r],!0}return!1}function Se(t){for(var e=0;e<t.length;e++)if(Array.isArray(t[e]))return Array.prototype.concat.apply([],t);return t}function Ae(t){return s(t)?[Et(t)]:Array.isArray(t)?Te(t):void 0}function ke(t){return i(t)&&i(t.text)&&a(t.isComment)}function Te(t,e){var n,a,u,c,l=[];for(n=0;n<t.length;n++)a=t[n],r(a)||"boolean"===typeof a||(u=l.length-1,c=l[u],Array.isArray(a)?a.length>0&&(a=Te(a,(e||"")+"_"+n),ke(a[0])&&ke(c)&&(l[u]=Et(c.text+a[0].text),a.shift()),l.push.apply(l,a)):s(a)?ke(c)?l[u]=Et(c.text+a):""!==a&&l.push(Et(a)):ke(a)&&ke(c)?l[u]=Et(c.text+a.text):(o(t._isVList)&&i(a.tag)&&r(a.key)&&i(e)&&(a.key="__vlist"+e+"_"+n+"__"),l.push(a)));return l}function Ie(t){var e=t.$options.provide;e&&(t._provided="function"===typeof e?e.call(t):e)}function Pe(t){var e=De(t.$options.inject,t);e&&(It(!1),Object.keys(e).forEach((function(n){Ft(t,n,e[n])})),It(!0))}function De(t,e){if(t){for(var n=Object.create(null),r=ft?Reflect.ownKeys(t):Object.keys(t),i=0;i<r.length;i++){var o=r[i];if("__ob__"!==o){var a=t[o].from,s=e;while(s){if(s._provided&&x(s._provided,a)){n[o]=s._provided[a];break}s=s.$parent}if(!s)if("default"in t[o]){var u=t[o].default;n[o]="function"===typeof u?u.call(e):u}else 0}}return n}}function Re(t,e){if(!t||!t.length)return{};for(var n={},r=0,i=t.length;r<i;r++){var o=t[r],a=o.data;if(a&&a.attrs&&a.attrs.slot&&delete a.attrs.slot,o.context!==e&&o.fnContext!==e||!a||null==a.slot)(n.default||(n.default=[])).push(o);else{var s=a.slot,u=n[s]||(n[s]=[]);"template"===o.tag?u.push.apply(u,o.children||[]):u.push(o)}}for(var c in n)n[c].every(Me)&&delete n[c];return n}function Me(t){return t.isComment&&!t.asyncFactory||" "===t.text}function Fe(t){return t.isComment&&t.asyncFactory}function Oe(t,e,r){var i,o=Object.keys(e).length>0,a=t?!!t.$stable:!o,s=t&&t.$key;if(t){if(t._normalized)return t._normalized;if(a&&r&&r!==n&&s===r.$key&&!o&&!r.$hasNormal)return r;for(var u in i={},t)t[u]&&"$"!==u[0]&&(i[u]=Ne(e,u,t[u]))}else i={};for(var c in e)c in i||(i[c]=Le(e,c));return t&&Object.isExtensible(t)&&(t._normalized=i),U(i,"$stable",a),U(i,"$key",s),U(i,"$hasNormal",o),i}function Ne(t,e,n){var r=function(){var t=arguments.length?n.apply(null,arguments):n({});t=t&&"object"===typeof t&&!Array.isArray(t)?[t]:Ae(t);var e=t&&t[0];return t&&(!e||1===t.length&&e.isComment&&!Fe(e))?void 0:t};return n.proxy&&Object.defineProperty(t,e,{get:r,enumerable:!0,configurable:!0}),r}function Le(t,e){return function(){return t[e]}}function Be(t,e){var n,r,o,a,s;if(Array.isArray(t)||"string"===typeof t)for(n=new Array(t.length),r=0,o=t.length;r<o;r++)n[r]=e(t[r],r);else if("number"===typeof t)for(n=new Array(t),r=0;r<t;r++)n[r]=e(r+1,r);else if(u(t))if(ft&&t[Symbol.iterator]){n=[];var c=t[Symbol.iterator](),l=c.next();while(!l.done)n.push(e(l.value,n.length)),l=c.next()}else for(a=Object.keys(t),n=new Array(a.length),r=0,o=a.length;r<o;r++)s=a[r],n[r]=e(t[s],s,r);return i(n)||(n=[]),n._isVList=!0,n}function Ve(t,e,n,r){var i,o=this.$scopedSlots[t];o?(n=n||{},r&&(n=D(D({},r),n)),i=o(n)||("function"===typeof e?e():e)):i=this.$slots[t]||("function"===typeof e?e():e);var a=n&&n.slot;return a?this.$createElement("template",{slot:a},i):i}function ze(t){return Xt(this.$options,"filters",t,!0)||O}function je(t,e){return Array.isArray(t)?-1===t.indexOf(e):t!==e}function We(t,e,n,r,i){var o=W.keyCodes[e]||n;return i&&r&&!W.keyCodes[e]?je(i,r):o?je(o,t):r?A(r)!==e:void 0===t}function Ge(t,e,n,r,i){if(n)if(u(n)){var o;Array.isArray(n)&&(n=R(n));var a=function(a){if("class"===a||"style"===a||g(a))o=t;else{var s=t.attrs&&t.attrs.type;o=r||W.mustUseProp(e,s,a)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var u=_(a),c=A(a);if(!(u in o)&&!(c in o)&&(o[a]=n[a],i)){var l=t.on||(t.on={});l["update:"+a]=function(t){n[a]=t}}};for(var s in n)a(s)}else;return t}function He(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e||(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,null,this),qe(r,"__static__"+t,!1)),r}function Ue(t,e,n){return qe(t,"__once__"+e+(n?"_"+n:""),!0),t}function qe(t,e,n){if(Array.isArray(t))for(var r=0;r<t.length;r++)t[r]&&"string"!==typeof t[r]&&$e(t[r],e+"_"+r,n);else $e(t,e,n)}function $e(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function Ke(t,e){if(e)if(l(e)){var n=t.on=t.on?D({},t.on):{};for(var r in e){var i=n[r],o=e[r];n[r]=i?[].concat(i,o):o}}else;return t}function Xe(t,e,n,r){e=e||{$stable:!n};for(var i=0;i<t.length;i++){var o=t[i];Array.isArray(o)?Xe(o,e,n):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return r&&(e.$key=r),e}function Ye(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"===typeof r&&r&&(t[e[n]]=e[n+1])}return t}function Je(t,e){return"string"===typeof t?e+t:t}function Qe(t){t._o=Ue,t._n=m,t._s=d,t._l=Be,t._t=Ve,t._q=N,t._i=L,t._m=He,t._f=ze,t._k=We,t._b=Ge,t._v=Et,t._e=wt,t._u=Xe,t._g=Ke,t._d=Ye,t._p=Je}function Ze(t,e,r,i,a){var s,u=this,c=a.options;x(i,"_uid")?(s=Object.create(i),s._original=i):(s=i,i=i._original);var l=o(c._compiled),h=!l;this.data=t,this.props=e,this.children=r,this.parent=i,this.listeners=t.on||n,this.injections=De(c.inject,i),this.slots=function(){return u.$slots||Oe(t.scopedSlots,u.$slots=Re(r,i)),u.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Oe(t.scopedSlots,this.slots())}}),l&&(this.$options=c,this.$slots=this.slots(),this.$scopedSlots=Oe(t.scopedSlots,this.$slots)),c._scopeId?this._c=function(t,e,n,r){var o=pn(s,t,e,n,r,h);return o&&!Array.isArray(o)&&(o.fnScopeId=c._scopeId,o.fnContext=i),o}:this._c=function(t,e,n,r){return pn(s,t,e,n,r,h)}}function tn(t,e,r,o,a){var s=t.options,u={},c=s.props;if(i(c))for(var l in c)u[l]=Yt(l,c,e||n);else i(r.attrs)&&nn(u,r.attrs),i(r.props)&&nn(u,r.props);var h=new Ze(r,u,a,o,t),f=s.render.call(null,h._c,h);if(f instanceof bt)return en(f,r,h.parent,s,h);if(Array.isArray(f)){for(var p=Ae(f)||[],d=new Array(p.length),m=0;m<p.length;m++)d[m]=en(p[m],r,h.parent,s,h);return d}}function en(t,e,n,r,i){var o=_t(t);return o.fnContext=n,o.fnOptions=r,e.slot&&((o.data||(o.data={})).slot=e.slot),o}function nn(t,e){for(var n in e)t[_(n)]=e[n]}Qe(Ze.prototype);var rn={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;rn.prepatch(n,n)}else{var r=t.componentInstance=sn(t,Dn);r.$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var n=e.componentOptions,r=e.componentInstance=t.componentInstance;Nn(r,n.propsData,n.listeners,e,n.children)},insert:function(t){var e=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,zn(n,"mounted")),t.data.keepAlive&&(e._isMounted?Zn(n):Bn(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?Vn(e,!0):e.$destroy())}},on=Object.keys(rn);function an(t,e,n,a,s){if(!r(t)){var c=n.$options._base;if(u(t)&&(t=c.extend(t)),"function"===typeof t){var l;if(r(t.cid)&&(l=t,t=_n(l,c),void 0===t))return En(l,e,n,a,s);e=e||{},Er(t),i(e.model)&&ln(t.options,e);var h=_e(e,t,s);if(o(t.options.functional))return tn(t,h,e,n,a);var f=e.on;if(e.on=e.nativeOn,o(t.options.abstract)){var p=e.slot;e={},p&&(e.slot=p)}un(e);var d=t.options.name||s,m=new bt("vue-component-"+t.cid+(d?"-"+d:""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:h,listeners:f,tag:s,children:a},l);return m}}}function sn(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},r=t.data.inlineTemplate;return i(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new t.componentOptions.Ctor(n)}function un(t){for(var e=t.hook||(t.hook={}),n=0;n<on.length;n++){var r=on[n],i=e[r],o=rn[r];i===o||i&&i._merged||(e[r]=i?cn(o,i):o)}}function cn(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}function ln(t,e){var n=t.model&&t.model.prop||"value",r=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var o=e.on||(e.on={}),a=o[r],s=e.model.callback;i(a)?(Array.isArray(a)?-1===a.indexOf(s):a!==s)&&(o[r]=[s].concat(a)):o[r]=s}var hn=1,fn=2;function pn(t,e,n,r,i,a){return(Array.isArray(n)||s(n))&&(i=r,r=n,n=void 0),o(a)&&(i=fn),dn(t,e,n,r,i)}function dn(t,e,n,r,o){if(i(n)&&i(n.__ob__))return wt();if(i(n)&&i(n.is)&&(e=n.is),!e)return wt();var a,s,u;(Array.isArray(r)&&"function"===typeof r[0]&&(n=n||{},n.scopedSlots={default:r[0]},r.length=0),o===fn?r=Ae(r):o===hn&&(r=Se(r)),"string"===typeof e)?(s=t.$vnode&&t.$vnode.ns||W.getTagNamespace(e),a=W.isReservedTag(e)?new bt(W.parsePlatformTagName(e),n,r,void 0,void 0,t):n&&n.pre||!i(u=Xt(t.$options,"components",e))?new bt(e,n,r,void 0,void 0,t):an(u,n,t,r,e)):a=an(e,n,t,r);return Array.isArray(a)?a:i(a)?(i(s)&&mn(a,s),i(n)&&vn(n),a):wt()}function mn(t,e,n){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,n=!0),i(t.children))for(var a=0,s=t.children.length;a<s;a++){var u=t.children[a];i(u.tag)&&(r(u.ns)||o(n)&&"svg"!==u.tag)&&mn(u,e,n)}}function vn(t){u(t.style)&&ge(t.style),u(t.class)&&ge(t.class)}function gn(t){t._vnode=null,t._staticTrees=null;var e=t.$options,r=t.$vnode=e._parentVnode,i=r&&r.context;t.$slots=Re(e._renderChildren,i),t.$scopedSlots=n,t._c=function(e,n,r,i){return pn(t,e,n,r,i,!1)},t.$createElement=function(e,n,r,i){return pn(t,e,n,r,i,!0)};var o=r&&r.data;Ft(t,"$attrs",o&&o.attrs||n,null,!0),Ft(t,"$listeners",e._parentListeners||n,null,!0)}var yn,bn=null;function xn(t){Qe(t.prototype),t.prototype.$nextTick=function(t){return me(t,this)},t.prototype._render=function(){var t,e=this,n=e.$options,r=n.render,i=n._parentVnode;i&&(e.$scopedSlots=Oe(i.data.scopedSlots,e.$slots,e.$scopedSlots)),e.$vnode=i;try{bn=e,t=r.call(e._renderProxy,e.$createElement)}catch(Ca){ne(Ca,e,"render"),t=e._vnode}finally{bn=null}return Array.isArray(t)&&1===t.length&&(t=t[0]),t instanceof bt||(t=wt()),t.parent=i,t}}function wn(t,e){return(t.__esModule||ft&&"Module"===t[Symbol.toStringTag])&&(t=t.default),u(t)?e.extend(t):t}function En(t,e,n,r,i){var o=wt();return o.asyncFactory=t,o.asyncMeta={data:e,context:n,children:r,tag:i},o}function _n(t,e){if(o(t.error)&&i(t.errorComp))return t.errorComp;if(i(t.resolved))return t.resolved;var n=bn;if(n&&i(t.owners)&&-1===t.owners.indexOf(n)&&t.owners.push(n),o(t.loading)&&i(t.loadingComp))return t.loadingComp;if(n&&!i(t.owners)){var a=t.owners=[n],s=!0,c=null,l=null;n.$on("hook:destroyed",(function(){return y(a,n)}));var h=function(t){for(var e=0,n=a.length;e<n;e++)a[e].$forceUpdate();t&&(a.length=0,null!==c&&(clearTimeout(c),c=null),null!==l&&(clearTimeout(l),l=null))},f=B((function(n){t.resolved=wn(n,e),s?a.length=0:h(!0)})),d=B((function(e){i(t.errorComp)&&(t.error=!0,h(!0))})),m=t(f,d);return u(m)&&(p(m)?r(t.resolved)&&m.then(f,d):p(m.component)&&(m.component.then(f,d),i(m.error)&&(t.errorComp=wn(m.error,e)),i(m.loading)&&(t.loadingComp=wn(m.loading,e),0===m.delay?t.loading=!0:c=setTimeout((function(){c=null,r(t.resolved)&&r(t.error)&&(t.loading=!0,h(!1))}),m.delay||200)),i(m.timeout)&&(l=setTimeout((function(){l=null,r(t.resolved)&&d(null)}),m.timeout)))),s=!1,t.loading?t.loadingComp:t.resolved}}function Cn(t){if(Array.isArray(t))for(var e=0;e<t.length;e++){var n=t[e];if(i(n)&&(i(n.componentOptions)||Fe(n)))return n}}function Sn(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&In(t,e)}function An(t,e){yn.$on(t,e)}function kn(t,e){yn.$off(t,e)}function Tn(t,e){var n=yn;return function r(){var i=e.apply(null,arguments);null!==i&&n.$off(t,r)}}function In(t,e,n){yn=t,we(e,n||{},An,kn,Tn,t),yn=void 0}function Pn(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(Array.isArray(t))for(var i=0,o=t.length;i<o;i++)r.$on(t[i],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(t)){for(var r=0,i=t.length;r<i;r++)n.$off(t[r],e);return n}var o,a=n._events[t];if(!a)return n;if(!e)return n._events[t]=null,n;var s=a.length;while(s--)if(o=a[s],o===e||o.fn===e){a.splice(s,1);break}return n},t.prototype.$emit=function(t){var e=this,n=e._events[t];if(n){n=n.length>1?P(n):n;for(var r=P(arguments,1),i='event handler for "'+t+'"',o=0,a=n.length;o<a;o++)re(n[o],e,r,e,i)}return e}}var Dn=null;function Rn(t){var e=Dn;return Dn=t,function(){Dn=e}}function Mn(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function Fn(t){t.prototype._update=function(t,e){var n=this,r=n.$el,i=n._vnode,o=Rn(n);n._vnode=t,n.$el=i?n.__patch__(i,t):n.__patch__(n.$el,t,e,!1),o(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},t.prototype.$forceUpdate=function(){var t=this;t._watcher&&t._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){zn(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||y(e.$children,t),t._watcher&&t._watcher.teardown();var n=t._watchers.length;while(n--)t._watchers[n].teardown();t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),zn(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}function On(t,e,n){var r;return t.$el=e,t.$options.render||(t.$options.render=wt),zn(t,"beforeMount"),r=function(){t._update(t._render(),n)},new rr(t,r,M,{before:function(){t._isMounted&&!t._isDestroyed&&zn(t,"beforeUpdate")}},!0),n=!1,null==t.$vnode&&(t._isMounted=!0,zn(t,"mounted")),t}function Nn(t,e,r,i,o){var a=i.data.scopedSlots,s=t.$scopedSlots,u=!!(a&&!a.$stable||s!==n&&!s.$stable||a&&t.$scopedSlots.$key!==a.$key||!a&&t.$scopedSlots.$key),c=!!(o||t.$options._renderChildren||u);if(t.$options._parentVnode=i,t.$vnode=i,t._vnode&&(t._vnode.parent=i),t.$options._renderChildren=o,t.$attrs=i.data.attrs||n,t.$listeners=r||n,e&&t.$options.props){It(!1);for(var l=t._props,h=t.$options._propKeys||[],f=0;f<h.length;f++){var p=h[f],d=t.$options.props;l[p]=Yt(p,d,e,t)}It(!0),t.$options.propsData=e}r=r||n;var m=t.$options._parentListeners;t.$options._parentListeners=r,In(t,r,m),c&&(t.$slots=Re(o,i.context),t.$forceUpdate())}function Ln(t){while(t&&(t=t.$parent))if(t._inactive)return!0;return!1}function Bn(t,e){if(e){if(t._directInactive=!1,Ln(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)Bn(t.$children[n]);zn(t,"activated")}}function Vn(t,e){if((!e||(t._directInactive=!0,!Ln(t)))&&!t._inactive){t._inactive=!0;for(var n=0;n<t.$children.length;n++)Vn(t.$children[n]);zn(t,"deactivated")}}function zn(t,e){gt();var n=t.$options[e],r=e+" hook";if(n)for(var i=0,o=n.length;i<o;i++)re(n[i],t,null,t,r);t._hasHookEvent&&t.$emit("hook:"+e),yt()}var jn=[],Wn=[],Gn={},Hn=!1,Un=!1,qn=0;function $n(){qn=jn.length=Wn.length=0,Gn={},Hn=Un=!1}var Kn=0,Xn=Date.now;if(Y&&!tt){var Yn=window.performance;Yn&&"function"===typeof Yn.now&&Xn()>document.createEvent("Event").timeStamp&&(Xn=function(){return Yn.now()})}function Jn(){var t,e;for(Kn=Xn(),Un=!0,jn.sort((function(t,e){return t.id-e.id})),qn=0;qn<jn.length;qn++)t=jn[qn],t.before&&t.before(),e=t.id,Gn[e]=null,t.run();var n=Wn.slice(),r=jn.slice();$n(),tr(n),Qn(r),ct&&W.devtools&&ct.emit("flush")}function Qn(t){var e=t.length;while(e--){var n=t[e],r=n.vm;r._watcher===n&&r._isMounted&&!r._isDestroyed&&zn(r,"updated")}}function Zn(t){t._inactive=!1,Wn.push(t)}function tr(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Bn(t[e],!0)}function er(t){var e=t.id;if(null==Gn[e]){if(Gn[e]=!0,Un){var n=jn.length-1;while(n>qn&&jn[n].id>t.id)n--;jn.splice(n+1,0,t)}else jn.push(t);Hn||(Hn=!0,me(Jn))}}var nr=0,rr=function(t,e,n,r,i){this.vm=t,i&&(t._watcher=this),t._watchers.push(this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++nr,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ht,this.newDepIds=new ht,this.expression="","function"===typeof e?this.getter=e:(this.getter=$(e),this.getter||(this.getter=M)),this.value=this.lazy?void 0:this.get()};rr.prototype.get=function(){var t;gt(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(Ca){if(!this.user)throw Ca;ne(Ca,e,'getter for watcher "'+this.expression+'"')}finally{this.deep&&ge(t),yt(),this.cleanupDeps()}return t},rr.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},rr.prototype.cleanupDeps=function(){var t=this.deps.length;while(t--){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},rr.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():er(this)},rr.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||u(t)||this.deep){var e=this.value;if(this.value=t,this.user){var n='callback for watcher "'+this.expression+'"';re(this.cb,this.vm,[t,e],this.vm,n)}else this.cb.call(this.vm,t,e)}}},rr.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},rr.prototype.depend=function(){var t=this.deps.length;while(t--)this.deps[t].depend()},rr.prototype.teardown=function(){if(this.active){this.vm._isBeingDestroyed||y(this.vm._watchers,this);var t=this.deps.length;while(t--)this.deps[t].removeSub(this);this.active=!1}};var ir={enumerable:!0,configurable:!0,get:M,set:M};function or(t,e,n){ir.get=function(){return this[e][n]},ir.set=function(t){this[e][n]=t},Object.defineProperty(t,n,ir)}function ar(t){t._watchers=[];var e=t.$options;e.props&&sr(t,e.props),e.methods&&mr(t,e.methods),e.data?ur(t):Mt(t._data={},!0),e.computed&&hr(t,e.computed),e.watch&&e.watch!==ot&&vr(t,e.watch)}function sr(t,e){var n=t.$options.propsData||{},r=t._props={},i=t.$options._propKeys=[],o=!t.$parent;o||It(!1);var a=function(o){i.push(o);var a=Yt(o,e,n,t);Ft(r,o,a),o in t||or(t,"_props",o)};for(var s in e)a(s);It(!0)}function ur(t){var e=t.$options.data;e=t._data="function"===typeof e?cr(e,t):e||{},l(e)||(e={});var n=Object.keys(e),r=t.$options.props,i=(t.$options.methods,n.length);while(i--){var o=n[i];0,r&&x(r,o)||H(o)||or(t,"_data",o)}Mt(e,!0)}function cr(t,e){gt();try{return t.call(e,e)}catch(Ca){return ne(Ca,e,"data()"),{}}finally{yt()}}var lr={lazy:!0};function hr(t,e){var n=t._computedWatchers=Object.create(null),r=ut();for(var i in e){var o=e[i],a="function"===typeof o?o:o.get;0,r||(n[i]=new rr(t,a||M,M,lr)),i in t||fr(t,i,o)}}function fr(t,e,n){var r=!ut();"function"===typeof n?(ir.get=r?pr(e):dr(n),ir.set=M):(ir.get=n.get?r&&!1!==n.cache?pr(e):dr(n.get):M,ir.set=n.set||M),Object.defineProperty(t,e,ir)}function pr(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),mt.target&&e.depend(),e.value}}function dr(t){return function(){return t.call(this,this)}}function mr(t,e){t.$options.props;for(var n in e)t[n]="function"!==typeof e[n]?M:I(e[n],t)}function vr(t,e){for(var n in e){var r=e[n];if(Array.isArray(r))for(var i=0;i<r.length;i++)gr(t,n,r[i]);else gr(t,n,r)}}function gr(t,e,n,r){return l(n)&&(r=n,n=n.handler),"string"===typeof n&&(n=t[n]),t.$watch(e,n,r)}function yr(t){var e={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",n),t.prototype.$set=Ot,t.prototype.$delete=Nt,t.prototype.$watch=function(t,e,n){var r=this;if(l(e))return gr(r,t,e,n);n=n||{},n.user=!0;var i=new rr(r,t,e,n);if(n.immediate){var o='callback for immediate watcher "'+i.expression+'"';gt(),re(e,r,[i.value],r,o),yt()}return function(){i.teardown()}}}var br=0;function xr(t){t.prototype._init=function(t){var e=this;e._uid=br++,e._isVue=!0,t&&t._isComponent?wr(e,t):e.$options=Kt(Er(e.constructor),t||{},e),e._renderProxy=e,e._self=e,Mn(e),Sn(e),gn(e),zn(e,"beforeCreate"),Pe(e),ar(e),Ie(e),zn(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}function wr(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var i=r.componentOptions;n.propsData=i.propsData,n._parentListeners=i.listeners,n._renderChildren=i.children,n._componentTag=i.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function Er(t){var e=t.options;if(t.super){var n=Er(t.super),r=t.superOptions;if(n!==r){t.superOptions=n;var i=_r(t);i&&D(t.extendOptions,i),e=t.options=Kt(n,t.extendOptions),e.name&&(e.components[e.name]=t)}}return e}function _r(t){var e,n=t.options,r=t.sealedOptions;for(var i in n)n[i]!==r[i]&&(e||(e={}),e[i]=n[i]);return e}function Cr(t){this._init(t)}function Sr(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=P(arguments,1);return n.unshift(this),"function"===typeof t.install?t.install.apply(t,n):"function"===typeof t&&t.apply(null,n),e.push(t),this}}function Ar(t){t.mixin=function(t){return this.options=Kt(this.options,t),this}}function kr(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,i=t._Ctor||(t._Ctor={});if(i[r])return i[r];var o=t.name||n.options.name;var a=function(t){this._init(t)};return a.prototype=Object.create(n.prototype),a.prototype.constructor=a,a.cid=e++,a.options=Kt(n.options,t),a["super"]=n,a.options.props&&Tr(a),a.options.computed&&Ir(a),a.extend=n.extend,a.mixin=n.mixin,a.use=n.use,z.forEach((function(t){a[t]=n[t]})),o&&(a.options.components[o]=a),a.superOptions=n.options,a.extendOptions=t,a.sealedOptions=D({},a.options),i[r]=a,a}}function Tr(t){var e=t.options.props;for(var n in e)or(t.prototype,"_props",n)}function Ir(t){var e=t.options.computed;for(var n in e)fr(t.prototype,n,e[n])}function Pr(t){z.forEach((function(e){t[e]=function(t,n){return n?("component"===e&&l(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&"function"===typeof n&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}}))}function Dr(t){return t&&(t.Ctor.options.name||t.tag)}function Rr(t,e){return Array.isArray(t)?t.indexOf(e)>-1:"string"===typeof t?t.split(",").indexOf(e)>-1:!!h(t)&&t.test(e)}function Mr(t,e){var n=t.cache,r=t.keys,i=t._vnode;for(var o in n){var a=n[o];if(a){var s=a.name;s&&!e(s)&&Fr(n,o,r,i)}}}function Fr(t,e,n,r){var i=t[e];!i||r&&i.tag===r.tag||i.componentInstance.$destroy(),t[e]=null,y(n,e)}xr(Cr),yr(Cr),Pn(Cr),Fn(Cr),xn(Cr);var Or=[String,RegExp,Array],Nr={name:"keep-alive",abstract:!0,props:{include:Or,exclude:Or,max:[String,Number]},methods:{cacheVNode:function(){var t=this,e=t.cache,n=t.keys,r=t.vnodeToCache,i=t.keyToCache;if(r){var o=r.tag,a=r.componentInstance,s=r.componentOptions;e[i]={name:Dr(s),tag:o,componentInstance:a},n.push(i),this.max&&n.length>parseInt(this.max)&&Fr(e,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)Fr(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",(function(e){Mr(t,(function(t){return Rr(e,t)}))})),this.$watch("exclude",(function(e){Mr(t,(function(t){return!Rr(e,t)}))}))},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=Cn(t),n=e&&e.componentOptions;if(n){var r=Dr(n),i=this,o=i.include,a=i.exclude;if(o&&(!r||!Rr(o,r))||a&&r&&Rr(a,r))return e;var s=this,u=s.cache,c=s.keys,l=null==e.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):e.key;u[l]?(e.componentInstance=u[l].componentInstance,y(c,l),c.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||t&&t[0]}},Lr={KeepAlive:Nr};function Br(t){var e={get:function(){return W}};Object.defineProperty(t,"config",e),t.util={warn:pt,extend:D,mergeOptions:Kt,defineReactive:Ft},t.set=Ot,t.delete=Nt,t.nextTick=me,t.observable=function(t){return Mt(t),t},t.options=Object.create(null),z.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,D(t.options.components,Lr),Sr(t),Ar(t),kr(t),Pr(t)}Br(Cr),Object.defineProperty(Cr.prototype,"$isServer",{get:ut}),Object.defineProperty(Cr.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Cr,"FunctionalRenderContext",{value:Ze}),Cr.version="2.6.14";var Vr=v("style,class"),zr=v("input,textarea,option,select,progress"),jr=function(t,e,n){return"value"===n&&zr(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},Wr=v("contenteditable,draggable,spellcheck"),Gr=v("events,caret,typing,plaintext-only"),Hr=function(t,e){return Xr(e)||"false"===e?"false":"contenteditable"===t&&Gr(e)?e:"true"},Ur=v("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),qr="http://www.w3.org/1999/xlink",$r=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Kr=function(t){return $r(t)?t.slice(6,t.length):""},Xr=function(t){return null==t||!1===t};function Yr(t){var e=t.data,n=t,r=t;while(i(r.componentInstance))r=r.componentInstance._vnode,r&&r.data&&(e=Jr(r.data,e));while(i(n=n.parent))n&&n.data&&(e=Jr(e,n.data));return Qr(e.staticClass,e.class)}function Jr(t,e){return{staticClass:Zr(t.staticClass,e.staticClass),class:i(t.class)?[t.class,e.class]:e.class}}function Qr(t,e){return i(t)||i(e)?Zr(t,ti(e)):""}function Zr(t,e){return t?e?t+" "+e:t:e||""}function ti(t){return Array.isArray(t)?ei(t):u(t)?ni(t):"string"===typeof t?t:""}function ei(t){for(var e,n="",r=0,o=t.length;r<o;r++)i(e=ti(t[r]))&&""!==e&&(n&&(n+=" "),n+=e);return n}function ni(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}var ri={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},ii=v("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),oi=v("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),ai=function(t){return ii(t)||oi(t)};function si(t){return oi(t)?"svg":"math"===t?"math":void 0}var ui=Object.create(null);function ci(t){if(!Y)return!0;if(ai(t))return!1;if(t=t.toLowerCase(),null!=ui[t])return ui[t];var e=document.createElement(t);return t.indexOf("-")>-1?ui[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:ui[t]=/HTMLUnknownElement/.test(e.toString())}var li=v("text,number,password,search,email,tel,url");function hi(t){if("string"===typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}function fi(t,e){var n=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n}function pi(t,e){return document.createElementNS(ri[t],e)}function di(t){return document.createTextNode(t)}function mi(t){return document.createComment(t)}function vi(t,e,n){t.insertBefore(e,n)}function gi(t,e){t.removeChild(e)}function yi(t,e){t.appendChild(e)}function bi(t){return t.parentNode}function xi(t){return t.nextSibling}function wi(t){return t.tagName}function Ei(t,e){t.textContent=e}function _i(t,e){t.setAttribute(e,"")}var Ci=Object.freeze({createElement:fi,createElementNS:pi,createTextNode:di,createComment:mi,insertBefore:vi,removeChild:gi,appendChild:yi,parentNode:bi,nextSibling:xi,tagName:wi,setTextContent:Ei,setStyleScope:_i}),Si={create:function(t,e){Ai(e)},update:function(t,e){t.data.ref!==e.data.ref&&(Ai(t,!0),Ai(e))},destroy:function(t){Ai(t,!0)}};function Ai(t,e){var n=t.data.ref;if(i(n)){var r=t.context,o=t.componentInstance||t.elm,a=r.$refs;e?Array.isArray(a[n])?y(a[n],o):a[n]===o&&(a[n]=void 0):t.data.refInFor?Array.isArray(a[n])?a[n].indexOf(o)<0&&a[n].push(o):a[n]=[o]:a[n]=o}}var ki=new bt("",{},[]),Ti=["create","activate","update","remove","destroy"];function Ii(t,e){return t.key===e.key&&t.asyncFactory===e.asyncFactory&&(t.tag===e.tag&&t.isComment===e.isComment&&i(t.data)===i(e.data)&&Pi(t,e)||o(t.isAsyncPlaceholder)&&r(e.asyncFactory.error))}function Pi(t,e){if("input"!==t.tag)return!0;var n,r=i(n=t.data)&&i(n=n.attrs)&&n.type,o=i(n=e.data)&&i(n=n.attrs)&&n.type;return r===o||li(r)&&li(o)}function Di(t,e,n){var r,o,a={};for(r=e;r<=n;++r)o=t[r].key,i(o)&&(a[o]=r);return a}function Ri(t){var e,n,a={},u=t.modules,c=t.nodeOps;for(e=0;e<Ti.length;++e)for(a[Ti[e]]=[],n=0;n<u.length;++n)i(u[n][Ti[e]])&&a[Ti[e]].push(u[n][Ti[e]]);function l(t){return new bt(c.tagName(t).toLowerCase(),{},[],void 0,t)}function h(t,e){function n(){0===--n.listeners&&f(t)}return n.listeners=e,n}function f(t){var e=c.parentNode(t);i(e)&&c.removeChild(e,t)}function p(t,e,n,r,a,s,u){if(i(t.elm)&&i(s)&&(t=s[u]=_t(t)),t.isRootInsert=!a,!d(t,e,n,r)){var l=t.data,h=t.children,f=t.tag;i(f)?(t.elm=t.ns?c.createElementNS(t.ns,f):c.createElement(f,t),E(t),b(t,h,e),i(l)&&w(t,e),y(n,t.elm,r)):o(t.isComment)?(t.elm=c.createComment(t.text),y(n,t.elm,r)):(t.elm=c.createTextNode(t.text),y(n,t.elm,r))}}function d(t,e,n,r){var a=t.data;if(i(a)){var s=i(t.componentInstance)&&a.keepAlive;if(i(a=a.hook)&&i(a=a.init)&&a(t,!1),i(t.componentInstance))return m(t,e),y(n,t.elm,r),o(s)&&g(t,e,n,r),!0}}function m(t,e){i(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,x(t)?(w(t,e),E(t)):(Ai(t),e.push(t))}function g(t,e,n,r){var o,s=t;while(s.componentInstance)if(s=s.componentInstance._vnode,i(o=s.data)&&i(o=o.transition)){for(o=0;o<a.activate.length;++o)a.activate[o](ki,s);e.push(s);break}y(n,t.elm,r)}function y(t,e,n){i(t)&&(i(n)?c.parentNode(n)===t&&c.insertBefore(t,e,n):c.appendChild(t,e))}function b(t,e,n){if(Array.isArray(e)){0;for(var r=0;r<e.length;++r)p(e[r],n,t.elm,null,!0,e,r)}else s(t.text)&&c.appendChild(t.elm,c.createTextNode(String(t.text)))}function x(t){while(t.componentInstance)t=t.componentInstance._vnode;return i(t.tag)}function w(t,n){for(var r=0;r<a.create.length;++r)a.create[r](ki,t);e=t.data.hook,i(e)&&(i(e.create)&&e.create(ki,t),i(e.insert)&&n.push(t))}function E(t){var e;if(i(e=t.fnScopeId))c.setStyleScope(t.elm,e);else{var n=t;while(n)i(e=n.context)&&i(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e),n=n.parent}i(e=Dn)&&e!==t.context&&e!==t.fnContext&&i(e=e.$options._scopeId)&&c.setStyleScope(t.elm,e)}function _(t,e,n,r,i,o){for(;r<=i;++r)p(n[r],o,t,e,!1,n,r)}function C(t){var e,n,r=t.data;if(i(r))for(i(e=r.hook)&&i(e=e.destroy)&&e(t),e=0;e<a.destroy.length;++e)a.destroy[e](t);if(i(e=t.children))for(n=0;n<t.children.length;++n)C(t.children[n])}function S(t,e,n){for(;e<=n;++e){var r=t[e];i(r)&&(i(r.tag)?(A(r),C(r)):f(r.elm))}}function A(t,e){if(i(e)||i(t.data)){var n,r=a.remove.length+1;for(i(e)?e.listeners+=r:e=h(t.elm,r),i(n=t.componentInstance)&&i(n=n._vnode)&&i(n.data)&&A(n,e),n=0;n<a.remove.length;++n)a.remove[n](t,e);i(n=t.data.hook)&&i(n=n.remove)?n(t,e):e()}else f(t.elm)}function k(t,e,n,o,a){var s,u,l,h,f=0,d=0,m=e.length-1,v=e[0],g=e[m],y=n.length-1,b=n[0],x=n[y],w=!a;while(f<=m&&d<=y)r(v)?v=e[++f]:r(g)?g=e[--m]:Ii(v,b)?(I(v,b,o,n,d),v=e[++f],b=n[++d]):Ii(g,x)?(I(g,x,o,n,y),g=e[--m],x=n[--y]):Ii(v,x)?(I(v,x,o,n,y),w&&c.insertBefore(t,v.elm,c.nextSibling(g.elm)),v=e[++f],x=n[--y]):Ii(g,b)?(I(g,b,o,n,d),w&&c.insertBefore(t,g.elm,v.elm),g=e[--m],b=n[++d]):(r(s)&&(s=Di(e,f,m)),u=i(b.key)?s[b.key]:T(b,e,f,m),r(u)?p(b,o,t,v.elm,!1,n,d):(l=e[u],Ii(l,b)?(I(l,b,o,n,d),e[u]=void 0,w&&c.insertBefore(t,l.elm,v.elm)):p(b,o,t,v.elm,!1,n,d)),b=n[++d]);f>m?(h=r(n[y+1])?null:n[y+1].elm,_(t,h,n,d,y,o)):d>y&&S(e,f,m)}function T(t,e,n,r){for(var o=n;o<r;o++){var a=e[o];if(i(a)&&Ii(t,a))return o}}function I(t,e,n,s,u,l){if(t!==e){i(e.elm)&&i(s)&&(e=s[u]=_t(e));var h=e.elm=t.elm;if(o(t.isAsyncPlaceholder))i(e.asyncFactory.resolved)?R(t.elm,e,n):e.isAsyncPlaceholder=!0;else if(o(e.isStatic)&&o(t.isStatic)&&e.key===t.key&&(o(e.isCloned)||o(e.isOnce)))e.componentInstance=t.componentInstance;else{var f,p=e.data;i(p)&&i(f=p.hook)&&i(f=f.prepatch)&&f(t,e);var d=t.children,m=e.children;if(i(p)&&x(e)){for(f=0;f<a.update.length;++f)a.update[f](t,e);i(f=p.hook)&&i(f=f.update)&&f(t,e)}r(e.text)?i(d)&&i(m)?d!==m&&k(h,d,m,n,l):i(m)?(i(t.text)&&c.setTextContent(h,""),_(h,null,m,0,m.length-1,n)):i(d)?S(d,0,d.length-1):i(t.text)&&c.setTextContent(h,""):t.text!==e.text&&c.setTextContent(h,e.text),i(p)&&i(f=p.hook)&&i(f=f.postpatch)&&f(t,e)}}}function P(t,e,n){if(o(n)&&i(t.parent))t.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var D=v("attrs,class,staticClass,staticStyle,key");function R(t,e,n,r){var a,s=e.tag,u=e.data,c=e.children;if(r=r||u&&u.pre,e.elm=t,o(e.isComment)&&i(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(i(u)&&(i(a=u.hook)&&i(a=a.init)&&a(e,!0),i(a=e.componentInstance)))return m(e,n),!0;if(i(s)){if(i(c))if(t.hasChildNodes())if(i(a=u)&&i(a=a.domProps)&&i(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var l=!0,h=t.firstChild,f=0;f<c.length;f++){if(!h||!R(h,c[f],n,r)){l=!1;break}h=h.nextSibling}if(!l||h)return!1}else b(e,c,n);if(i(u)){var p=!1;for(var d in u)if(!D(d)){p=!0,w(e,n);break}!p&&u["class"]&&ge(u["class"])}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,n,s){if(!r(e)){var u=!1,h=[];if(r(t))u=!0,p(e,h);else{var f=i(t.nodeType);if(!f&&Ii(t,e))I(t,e,h,null,null,s);else{if(f){if(1===t.nodeType&&t.hasAttribute(V)&&(t.removeAttribute(V),n=!0),o(n)&&R(t,e,h))return P(e,h,!0),t;t=l(t)}var d=t.elm,m=c.parentNode(d);if(p(e,h,d._leaveCb?null:m,c.nextSibling(d)),i(e.parent)){var v=e.parent,g=x(e);while(v){for(var y=0;y<a.destroy.length;++y)a.destroy[y](v);if(v.elm=e.elm,g){for(var b=0;b<a.create.length;++b)a.create[b](ki,v);var w=v.data.hook.insert;if(w.merged)for(var E=1;E<w.fns.length;E++)w.fns[E]()}else Ai(v);v=v.parent}}i(m)?S([t],0,0):i(t.tag)&&C(t)}}return P(e,h,u),e.elm}i(t)&&C(t)}}var Mi={create:Fi,update:Fi,destroy:function(t){Fi(t,ki)}};function Fi(t,e){(t.data.directives||e.data.directives)&&Oi(t,e)}function Oi(t,e){var n,r,i,o=t===ki,a=e===ki,s=Li(t.data.directives,t.context),u=Li(e.data.directives,e.context),c=[],l=[];for(n in u)r=s[n],i=u[n],r?(i.oldValue=r.value,i.oldArg=r.arg,Vi(i,"update",e,t),i.def&&i.def.componentUpdated&&l.push(i)):(Vi(i,"bind",e,t),i.def&&i.def.inserted&&c.push(i));if(c.length){var h=function(){for(var n=0;n<c.length;n++)Vi(c[n],"inserted",e,t)};o?Ee(e,"insert",h):h()}if(l.length&&Ee(e,"postpatch",(function(){for(var n=0;n<l.length;n++)Vi(l[n],"componentUpdated",e,t)})),!o)for(n in s)u[n]||Vi(s[n],"unbind",t,t,a)}var Ni=Object.create(null);function Li(t,e){var n,r,i=Object.create(null);if(!t)return i;for(n=0;n<t.length;n++)r=t[n],r.modifiers||(r.modifiers=Ni),i[Bi(r)]=r,r.def=Xt(e.$options,"directives",r.name,!0);return i}function Bi(t){return t.rawName||t.name+"."+Object.keys(t.modifiers||{}).join(".")}function Vi(t,e,n,r,i){var o=t.def&&t.def[e];if(o)try{o(n.elm,t,n,r,i)}catch(Ca){ne(Ca,n.context,"directive "+t.name+" "+e+" hook")}}var zi=[Si,Mi];function ji(t,e){var n=e.componentOptions;if((!i(n)||!1!==n.Ctor.options.inheritAttrs)&&(!r(t.data.attrs)||!r(e.data.attrs))){var o,a,s,u=e.elm,c=t.data.attrs||{},l=e.data.attrs||{};for(o in i(l.__ob__)&&(l=e.data.attrs=D({},l)),l)a=l[o],s=c[o],s!==a&&Wi(u,o,a,e.data.pre);for(o in(tt||nt)&&l.value!==c.value&&Wi(u,"value",l.value),c)r(l[o])&&($r(o)?u.removeAttributeNS(qr,Kr(o)):Wr(o)||u.removeAttribute(o))}}function Wi(t,e,n,r){r||t.tagName.indexOf("-")>-1?Gi(t,e,n):Ur(e)?Xr(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):Wr(e)?t.setAttribute(e,Hr(e,n)):$r(e)?Xr(n)?t.removeAttributeNS(qr,Kr(e)):t.setAttributeNS(qr,e,n):Gi(t,e,n)}function Gi(t,e,n){if(Xr(n))t.removeAttribute(e);else{if(tt&&!et&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var Hi={create:ji,update:ji};function Ui(t,e){var n=e.elm,o=e.data,a=t.data;if(!(r(o.staticClass)&&r(o.class)&&(r(a)||r(a.staticClass)&&r(a.class)))){var s=Yr(e),u=n._transitionClasses;i(u)&&(s=Zr(s,ti(u))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var qi,$i={create:Ui,update:Ui},Ki="__r",Xi="__c";function Yi(t){if(i(t[Ki])){var e=tt?"change":"input";t[e]=[].concat(t[Ki],t[e]||[]),delete t[Ki]}i(t[Xi])&&(t.change=[].concat(t[Xi],t.change||[]),delete t[Xi])}function Ji(t,e,n){var r=qi;return function i(){var o=e.apply(null,arguments);null!==o&&to(t,i,n,r)}}var Qi=se&&!(it&&Number(it[1])<=53);function Zi(t,e,n,r){if(Qi){var i=Kn,o=e;e=o._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=i||t.timeStamp<=0||t.target.ownerDocument!==document)return o.apply(this,arguments)}}qi.addEventListener(t,e,at?{capture:n,passive:r}:n)}function to(t,e,n,r){(r||qi).removeEventListener(t,e._wrapper||e,n)}function eo(t,e){if(!r(t.data.on)||!r(e.data.on)){var n=e.data.on||{},i=t.data.on||{};qi=e.elm,Yi(n),we(n,i,Zi,to,Ji,e.context),qi=void 0}}var no,ro={create:eo,update:eo};function io(t,e){if(!r(t.data.domProps)||!r(e.data.domProps)){var n,o,a=e.elm,s=t.data.domProps||{},u=e.data.domProps||{};for(n in i(u.__ob__)&&(u=e.data.domProps=D({},u)),s)n in u||(a[n]="");for(n in u){if(o=u[n],"textContent"===n||"innerHTML"===n){if(e.children&&(e.children.length=0),o===s[n])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===n&&"PROGRESS"!==a.tagName){a._value=o;var c=r(o)?"":String(o);oo(a,c)&&(a.value=c)}else if("innerHTML"===n&&oi(a.tagName)&&r(a.innerHTML)){no=no||document.createElement("div"),no.innerHTML="<svg>"+o+"</svg>";var l=no.firstChild;while(a.firstChild)a.removeChild(a.firstChild);while(l.firstChild)a.appendChild(l.firstChild)}else if(o!==s[n])try{a[n]=o}catch(Ca){}}}}function oo(t,e){return!t.composing&&("OPTION"===t.tagName||ao(t,e)||so(t,e))}function ao(t,e){var n=!0;try{n=document.activeElement!==t}catch(Ca){}return n&&t.value!==e}function so(t,e){var n=t.value,r=t._vModifiers;if(i(r)){if(r.number)return m(n)!==m(e);if(r.trim)return n.trim()!==e.trim()}return n!==e}var uo={create:io,update:io},co=w((function(t){var e={},n=/;(?![^(]*\))/g,r=/:(.+)/;return t.split(n).forEach((function(t){if(t){var n=t.split(r);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function lo(t){var e=ho(t.style);return t.staticStyle?D(t.staticStyle,e):e}function ho(t){return Array.isArray(t)?R(t):"string"===typeof t?co(t):t}function fo(t,e){var n,r={};if(e){var i=t;while(i.componentInstance)i=i.componentInstance._vnode,i&&i.data&&(n=lo(i.data))&&D(r,n)}(n=lo(t.data))&&D(r,n);var o=t;while(o=o.parent)o.data&&(n=lo(o.data))&&D(r,n);return r}var po,mo=/^--/,vo=/\s*!important$/,go=function(t,e,n){if(mo.test(e))t.style.setProperty(e,n);else if(vo.test(n))t.style.setProperty(A(e),n.replace(vo,""),"important");else{var r=bo(e);if(Array.isArray(n))for(var i=0,o=n.length;i<o;i++)t.style[r]=n[i];else t.style[r]=n}},yo=["Webkit","Moz","ms"],bo=w((function(t){if(po=po||document.createElement("div").style,t=_(t),"filter"!==t&&t in po)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<yo.length;n++){var r=yo[n]+e;if(r in po)return r}}));function xo(t,e){var n=e.data,o=t.data;if(!(r(n.staticStyle)&&r(n.style)&&r(o.staticStyle)&&r(o.style))){var a,s,u=e.elm,c=o.staticStyle,l=o.normalizedStyle||o.style||{},h=c||l,f=ho(e.data.style)||{};e.data.normalizedStyle=i(f.__ob__)?D({},f):f;var p=fo(e,!0);for(s in h)r(p[s])&&go(u,s,"");for(s in p)a=p[s],a!==h[s]&&go(u,s,null==a?"":a)}}var wo={create:xo,update:xo},Eo=/\s+/;function _o(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Eo).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var n=" "+(t.getAttribute("class")||"")+" ";n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function Co(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(Eo).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{var n=" "+(t.getAttribute("class")||"")+" ",r=" "+e+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?t.setAttribute("class",n):t.removeAttribute("class")}}function So(t){if(t){if("object"===typeof t){var e={};return!1!==t.css&&D(e,Ao(t.name||"v")),D(e,t),e}return"string"===typeof t?Ao(t):void 0}}var Ao=w((function(t){return{enterClass:t+"-enter",enterToClass:t+"-enter-to",enterActiveClass:t+"-enter-active",leaveClass:t+"-leave",leaveToClass:t+"-leave-to",leaveActiveClass:t+"-leave-active"}})),ko=Y&&!et,To="transition",Io="animation",Po="transition",Do="transitionend",Ro="animation",Mo="animationend";ko&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Po="WebkitTransition",Do="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Ro="WebkitAnimation",Mo="webkitAnimationEnd"));var Fo=Y?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function Oo(t){Fo((function(){Fo(t)}))}function No(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),_o(t,e))}function Lo(t,e){t._transitionClasses&&y(t._transitionClasses,e),Co(t,e)}function Bo(t,e,n){var r=zo(t,e),i=r.type,o=r.timeout,a=r.propCount;if(!i)return n();var s=i===To?Do:Mo,u=0,c=function(){t.removeEventListener(s,l),n()},l=function(e){e.target===t&&++u>=a&&c()};setTimeout((function(){u<a&&c()}),o+1),t.addEventListener(s,l)}var Vo=/\b(transform|all)(,|$)/;function zo(t,e){var n,r=window.getComputedStyle(t),i=(r[Po+"Delay"]||"").split(", "),o=(r[Po+"Duration"]||"").split(", "),a=jo(i,o),s=(r[Ro+"Delay"]||"").split(", "),u=(r[Ro+"Duration"]||"").split(", "),c=jo(s,u),l=0,h=0;e===To?a>0&&(n=To,l=a,h=o.length):e===Io?c>0&&(n=Io,l=c,h=u.length):(l=Math.max(a,c),n=l>0?a>c?To:Io:null,h=n?n===To?o.length:u.length:0);var f=n===To&&Vo.test(r[Po+"Property"]);return{type:n,timeout:l,propCount:h,hasTransform:f}}function jo(t,e){while(t.length<e.length)t=t.concat(t);return Math.max.apply(null,e.map((function(e,n){return Wo(e)+Wo(t[n])})))}function Wo(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Go(t,e){var n=t.elm;i(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var o=So(t.data.transition);if(!r(o)&&!i(n._enterCb)&&1===n.nodeType){var a=o.css,s=o.type,c=o.enterClass,l=o.enterToClass,h=o.enterActiveClass,f=o.appearClass,p=o.appearToClass,d=o.appearActiveClass,v=o.beforeEnter,g=o.enter,y=o.afterEnter,b=o.enterCancelled,x=o.beforeAppear,w=o.appear,E=o.afterAppear,_=o.appearCancelled,C=o.duration,S=Dn,A=Dn.$vnode;while(A&&A.parent)S=A.context,A=A.parent;var k=!S._isMounted||!t.isRootInsert;if(!k||w||""===w){var T=k&&f?f:c,I=k&&d?d:h,P=k&&p?p:l,D=k&&x||v,R=k&&"function"===typeof w?w:g,M=k&&E||y,F=k&&_||b,O=m(u(C)?C.enter:C);0;var N=!1!==a&&!et,L=qo(R),V=n._enterCb=B((function(){N&&(Lo(n,P),Lo(n,I)),V.cancelled?(N&&Lo(n,T),F&&F(n)):M&&M(n),n._enterCb=null}));t.data.show||Ee(t,"insert",(function(){var e=n.parentNode,r=e&&e._pending&&e._pending[t.key];r&&r.tag===t.tag&&r.elm._leaveCb&&r.elm._leaveCb(),R&&R(n,V)})),D&&D(n),N&&(No(n,T),No(n,I),Oo((function(){Lo(n,T),V.cancelled||(No(n,P),L||(Uo(O)?setTimeout(V,O):Bo(n,s,V)))}))),t.data.show&&(e&&e(),R&&R(n,V)),N||L||V()}}}function Ho(t,e){var n=t.elm;i(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var o=So(t.data.transition);if(r(o)||1!==n.nodeType)return e();if(!i(n._leaveCb)){var a=o.css,s=o.type,c=o.leaveClass,l=o.leaveToClass,h=o.leaveActiveClass,f=o.beforeLeave,p=o.leave,d=o.afterLeave,v=o.leaveCancelled,g=o.delayLeave,y=o.duration,b=!1!==a&&!et,x=qo(p),w=m(u(y)?y.leave:y);0;var E=n._leaveCb=B((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[t.key]=null),b&&(Lo(n,l),Lo(n,h)),E.cancelled?(b&&Lo(n,c),v&&v(n)):(e(),d&&d(n)),n._leaveCb=null}));g?g(_):_()}function _(){E.cancelled||(!t.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[t.key]=t),f&&f(n),b&&(No(n,c),No(n,h),Oo((function(){Lo(n,c),E.cancelled||(No(n,l),x||(Uo(w)?setTimeout(E,w):Bo(n,s,E)))}))),p&&p(n,E),b||x||E())}}function Uo(t){return"number"===typeof t&&!isNaN(t)}function qo(t){if(r(t))return!1;var e=t.fns;return i(e)?qo(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function $o(t,e){!0!==e.data.show&&Go(e)}var Ko=Y?{create:$o,activate:$o,remove:function(t,e){!0!==t.data.show?Ho(t,e):e()}}:{},Xo=[Hi,$i,ro,uo,wo,Ko],Yo=Xo.concat(zi),Jo=Ri({nodeOps:Ci,modules:Yo});et&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&oa(t,"input")}));var Qo={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?Ee(n,"postpatch",(function(){Qo.componentUpdated(t,e,n)})):Zo(t,e,n.context),t._vOptions=[].map.call(t.options,na)):("textarea"===n.tag||li(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",ra),t.addEventListener("compositionend",ia),t.addEventListener("change",ia),et&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){Zo(t,e,n.context);var r=t._vOptions,i=t._vOptions=[].map.call(t.options,na);if(i.some((function(t,e){return!N(t,r[e])}))){var o=t.multiple?e.value.some((function(t){return ea(t,i)})):e.value!==e.oldValue&&ea(e.value,i);o&&oa(t,"change")}}}};function Zo(t,e,n){ta(t,e,n),(tt||nt)&&setTimeout((function(){ta(t,e,n)}),0)}function ta(t,e,n){var r=e.value,i=t.multiple;if(!i||Array.isArray(r)){for(var o,a,s=0,u=t.options.length;s<u;s++)if(a=t.options[s],i)o=L(r,na(a))>-1,a.selected!==o&&(a.selected=o);else if(N(na(a),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));i||(t.selectedIndex=-1)}}function ea(t,e){return e.every((function(e){return!N(e,t)}))}function na(t){return"_value"in t?t._value:t.value}function ra(t){t.target.composing=!0}function ia(t){t.target.composing&&(t.target.composing=!1,oa(t.target,"input"))}function oa(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function aa(t){return!t.componentInstance||t.data&&t.data.transition?t:aa(t.componentInstance._vnode)}var sa={bind:function(t,e,n){var r=e.value;n=aa(n);var i=n.data&&n.data.transition,o=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&i?(n.data.show=!0,Go(n,(function(){t.style.display=o}))):t.style.display=r?o:"none"},update:function(t,e,n){var r=e.value,i=e.oldValue;if(!r!==!i){n=aa(n);var o=n.data&&n.data.transition;o?(n.data.show=!0,r?Go(n,(function(){t.style.display=t.__vOriginalDisplay})):Ho(n,(function(){t.style.display="none"}))):t.style.display=r?t.__vOriginalDisplay:"none"}},unbind:function(t,e,n,r,i){i||(t.style.display=t.__vOriginalDisplay)}},ua={model:Qo,show:sa},ca={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function la(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?la(Cn(e.children)):t}function ha(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var i=n._parentListeners;for(var o in i)e[_(o)]=i[o];return e}function fa(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function pa(t){while(t=t.parent)if(t.data.transition)return!0}function da(t,e){return e.key===t.key&&e.tag===t.tag}var ma=function(t){return t.tag||Fe(t)},va=function(t){return"show"===t.name},ga={name:"transition",props:ca,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(ma),n.length)){0;var r=this.mode;0;var i=n[0];if(pa(this.$vnode))return i;var o=la(i);if(!o)return i;if(this._leaving)return fa(t,i);var a="__transition-"+this._uid+"-";o.key=null==o.key?o.isComment?a+"comment":a+o.tag:s(o.key)?0===String(o.key).indexOf(a)?o.key:a+o.key:o.key;var u=(o.data||(o.data={})).transition=ha(this),c=this._vnode,l=la(c);if(o.data.directives&&o.data.directives.some(va)&&(o.data.show=!0),l&&l.data&&!da(o,l)&&!Fe(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var h=l.data.transition=D({},u);if("out-in"===r)return this._leaving=!0,Ee(h,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),fa(t,i);if("in-out"===r){if(Fe(o))return c;var f,p=function(){f()};Ee(u,"afterEnter",p),Ee(u,"enterCancelled",p),Ee(h,"delayLeave",(function(t){f=t}))}}return i}}},ya=D({tag:String,moveClass:String},ca);delete ya.mode;var ba={props:ya,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var i=Rn(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,i(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,i=this.$slots.default||[],o=this.children=[],a=ha(this),s=0;s<i.length;s++){var u=i[s];if(u.tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))o.push(u),n[u.key]=u,(u.data||(u.data={})).transition=a;else;}if(r){for(var c=[],l=[],h=0;h<r.length;h++){var f=r[h];f.data.transition=a,f.data.pos=f.elm.getBoundingClientRect(),n[f.key]?c.push(f):l.push(f)}this.kept=t(e,null,c),this.removed=l}return t(e,null,o)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(xa),t.forEach(wa),t.forEach(Ea),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var n=t.elm,r=n.style;No(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(Do,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(Do,t),n._moveCb=null,Lo(n,e))})}})))},methods:{hasMove:function(t,e){if(!ko)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){Co(n,t)})),_o(n,e),n.style.display="none",this.$el.appendChild(n);var r=zo(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}};function xa(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function wa(t){t.data.newPos=t.elm.getBoundingClientRect()}function Ea(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,i=e.top-n.top;if(r||i){t.data.moved=!0;var o=t.elm.style;o.transform=o.WebkitTransform="translate("+r+"px,"+i+"px)",o.transitionDuration="0s"}}var _a={Transition:ga,TransitionGroup:ba};Cr.config.mustUseProp=jr,Cr.config.isReservedTag=ai,Cr.config.isReservedAttr=Vr,Cr.config.getTagNamespace=si,Cr.config.isUnknownElement=ci,D(Cr.options.directives,ua),D(Cr.options.components,_a),Cr.prototype.__patch__=Y?Jo:M,Cr.prototype.$mount=function(t,e){return t=t&&Y?hi(t):void 0,On(this,t,e)},Y&&setTimeout((function(){W.devtools&&ct&&ct.emit("init",Cr)}),0),e["a"]=Cr}).call(this,n("c8ba"))},"2caf":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));n("4ae1"),n("3410");function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}var o=n("7037"),a=n.n(o);function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){return!e||"object"!==a()(e)&&"function"!==typeof e?s(t):e}function c(t){var e=i();return function(){var n,i=r(t);if(e){var o=r(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return u(this,n)}}},"2cf4":function(t,e,n){var r,i,o,a=n("da84"),s=n("d039"),u=n("0366"),c=n("1be4"),l=n("cc12"),h=n("1cdc"),f=n("605d"),p=a.location,d=a.setImmediate,m=a.clearImmediate,v=a.process,g=a.MessageChannel,y=a.Dispatch,b=0,x={},w="onreadystatechange",E=function(t){if(x.hasOwnProperty(t)){var e=x[t];delete x[t],e()}},_=function(t){return function(){E(t)}},C=function(t){E(t.data)},S=function(t){a.postMessage(t+"",p.protocol+"//"+p.host)};d&&m||(d=function(t){var e=[],n=1;while(arguments.length>n)e.push(arguments[n++]);return x[++b]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},r(b),b},m=function(t){delete x[t]},f?r=function(t){v.nextTick(_(t))}:y&&y.now?r=function(t){y.now(_(t))}:g&&!h?(i=new g,o=i.port2,i.port1.onmessage=C,r=u(o.postMessage,o,1)):a.addEventListener&&"function"==typeof postMessage&&!a.importScripts&&p&&"file:"!==p.protocol&&!s(S)?(r=S,a.addEventListener("message",C,!1)):r=w in l("script")?function(t){c.appendChild(l("script"))[w]=function(){c.removeChild(this),E(t)}}:function(t){setTimeout(_(t),0)}),t.exports={set:d,clear:m}},"2d00":function(t,e,n){var r,i,o=n("da84"),a=n("342f"),s=o.process,u=s&&s.versions,c=u&&u.v8;c?(r=c.split("."),i=r[0]<4?1:r[0]+r[1]):a&&(r=a.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/),r&&(i=r[1]))),t.exports=i&&+i},"2d83":function(t,e,n){"use strict";var r=n("387f");t.exports=function(t,e,n,i,o){var a=new Error(t);return r(a,e,n,i,o)}},"2e67":function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},"30b5":function(t,e,n){"use strict";var r=n("c532");function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var a=[];r.forEach(e,(function(t,e){null!==t&&"undefined"!==typeof t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),a.push(i(e)+"="+i(t))})))})),o=a.join("&")}if(o){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},3410:function(t,e,n){var r=n("23e7"),i=n("d039"),o=n("7b0b"),a=n("e163"),s=n("e177"),u=i((function(){a(1)}));r({target:"Object",stat:!0,forced:u,sham:!s},{getPrototypeOf:function(t){return a(o(t))}})},"342f":function(t,e,n){var r=n("d066");t.exports=r("navigator","userAgent")||""},"35a1":function(t,e,n){var r=n("f5df"),i=n("3f8c"),o=n("b622"),a=o("iterator");t.exports=function(t){if(void 0!=t)return t[a]||t["@@iterator"]||i[r(t)]}},"37e8":function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("825a"),a=n("df75");t.exports=r?Object.defineProperties:function(t,e){o(t);var n,r=a(e),s=r.length,u=0;while(s>u)i.f(t,n=r[u++],e[n]);return t}},"387f":function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},3934:function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return function(){return!0}}()},"3bbe":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"3ca3":function(t,e,n){"use strict";var r=n("6547").charAt,i=n("69f3"),o=n("7dd0"),a="String Iterator",s=i.set,u=i.getterFor(a);o(String,"String",(function(t){s(this,{type:a,string:String(t),index:0})}),(function(){var t,e=u(this),n=e.string,i=e.index;return i>=n.length?{value:void 0,done:!0}:(t=r(n,i),e.index+=t.length,{value:t,done:!1})}))},"3e8f":function(t,e){},"3f8c":function(t,e){t.exports={}},"428f":function(t,e,n){var r=n("da84");t.exports=r},4362:function(t,e,n){e.nextTick=function(t){var e=Array.prototype.slice.call(arguments);e.shift(),setTimeout((function(){t.apply(null,e)}),0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=n("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},"44ad":function(t,e,n){var r=n("d039"),i=n("c6b6"),o="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?o.call(t,""):Object(t)}:Object},"44d2":function(t,e,n){var r=n("b622"),i=n("7c73"),o=n("9bf2"),a=r("unscopables"),s=Array.prototype;void 0==s[a]&&o.f(s,a,{configurable:!0,value:i(null)}),t.exports=function(t){s[a][t]=!0}},"44de":function(t,e,n){var r=n("da84");t.exports=function(t,e){var n=r.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}},"45ef":function(t,e,n){"use strict";(function(t,r,i){n.d(e,"a",(function(){return _t})),n.d(e,"b",(function(){return It})),n.d(e,"c",(function(){return Ru})),n.d(e,"d",(function(){return jc})),n.d(e,"e",(function(){return Eu})),n.d(e,"f",(function(){return Ff})),n.d(e,"g",(function(){return zs})),n.d(e,"h",(function(){return Mn})),n.d(e,"i",(function(){return xc})),n.d(e,"j",(function(){return Cc})),n.d(e,"k",(function(){return Nu})),n.d(e,"l",(function(){return Hs})),n.d(e,"m",(function(){return or})),n.d(e,"n",(function(){return Tn})),n.d(e,"o",(function(){return ch})),n.d(e,"p",(function(){return Df})),n.d(e,"q",(function(){return Pc})),n.d(e,"r",(function(){return nl})),n.d(e,"s",(function(){return zc})),n.d(e,"t",(function(){return qu})),n.d(e,"u",(function(){return Ys})),n.d(e,"v",(function(){return cr})),n.d(e,"w",(function(){return hl})),n.d(e,"x",(function(){return yr})),n.d(e,"y",(function(){return yn})),n.d(e,"z",(function(){return kc})),n.d(e,"A",(function(){return tu})),n.d(e,"B",(function(){return Uc})),n.d(e,"C",(function(){return Kc})),n.d(e,"D",(function(){return qr})),n.d(e,"E",(function(){return wr})),n.d(e,"F",(function(){return Ju})),n.d(e,"G",(function(){return vn})),n.d(e,"H",(function(){return bn})),n.d(e,"I",(function(){return xn})),n.d(e,"J",(function(){return wn})),n.d(e,"K",(function(){return En})),n.d(e,"L",(function(){return $e})),n.d(e,"M",(function(){return Er})),n.d(e,"N",(function(){return dl})),n.d(e,"O",(function(){return Cr})),n.d(e,"P",(function(){return kn}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function a(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n((function(e){e(t.value)})).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function u(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var c=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return l(n,e[0],e[1]),e.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0],i=n[1];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,i)}))}},t}();function l(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function h(){return f}var f=null,p=new Map,d=new Map;function m(t,e){var n=x(t,e);return p.get(n)}function v(t){return d.get(t)}function g(t){for(var e=p.entries(),n=[];;){var r=e.next(),i=r.done,o=r.value;if(i)break;var a=o[0],s=o[1];a.split("_")[0]===t&&n.push(s)}return n}function y(t){var e=t.kernelName,n=t.backendName,r=x(e,n);if(p.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");p.set(r,t)}function b(t){var e=t.kernelName;d.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),d.set(e,t)}function x(t,e){return e+"_"+t}function w(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function E(t,e,n){return Math.max(t,Math.min(e,n))}function _(t){return t%2==0?t:t+1}function C(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function S(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function A(t,e,n){void 0===n&&(n=""),S(P(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function k(t){S(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function T(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||H(t)&&!n)for(var r=0;r<t.length;++r)T(t[r],e,n);else e.push(t);return e}function I(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function P(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function D(t){return t%1==0}function R(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function M(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function F(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function O(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,i){var o=0,a=function(){if(t())r();else{o++;var s=e(o);null!=n&&o>=n?i():setTimeout(a,s)}};a()}))}function N(t,e){for(var n=1,r=-1,i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+i);r=i}else if(t[i]<0)throw Error("Shapes can not be < 0. Found "+t[i]+" at dim "+i);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var o=t.slice();return o[r]=e/n,o}function L(t,e){var n=e.length;return S((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),S(t.every((function(t){return D(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function B(t,e){for(var n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,o=null==e||i?null:L(e,t).sort(),a=0,s=0;s<t.length;++s){if(null!=o){if(o[a]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==o[a]||o[a]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),o[a]<=s&&a++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function V(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function z(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function j(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function W(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function G(t,e){return"complex64"!==e&&("float32"!==e||"complex64"===t)&&("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)}function H(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function U(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function q(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function $(t){return"string"==typeof t||t instanceof String}function K(t){return"boolean"==typeof t}function X(t){return"number"==typeof t}function Y(t){return Array.isArray(t)?Y(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":X(t)?"float32":$(t)?"string":K(t)?"bool":"float32"}function J(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Q(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function Z(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function tt(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=T(t)),n&&j(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),i=0;i<r.length;++i)0!==Math.round(t[i])&&(r[i]=1);return r}throw new Error("Unknown data type "+e)}function et(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var i=new Array;if(1===n.length)for(var o=n[0],a=0;a<o;a++)i[a]=r[e+a];else{o=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(a=0;a<o;a++)i[a]=t(e+a*u,s,r)}return i}(0,t,e)}function nt(t,e){for(var n=rt(t,e),r=0;r<n.length;r++)n[r]=1;return n}function rt(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function it(){return h().platform.now()}function ot(t){t.forEach((function(e){S(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function at(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",h().platform.encode(t,e)}function st(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",h().platform.decode(t,e)}function ut(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function ct(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}Object.freeze({shuffle:w,clamp:E,nearestLargerEven:_,sum:C,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var i=Number(t[r])-Number(e[r]);n+=i*i}return n},assert:S,assertShapesMatch:A,assertNonNull:k,flatten:T,sizeFromShape:I,isScalarShape:function(t){return 0===t.length},arraysEqual:P,isInt:D,tanh:R,sizeToSquarishShape:M,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return w(e),e},rightPad:F,repeatedTry:O,inferFromImplicitShape:N,parseAxisParam:L,squeezeShape:B,getTypedArrayFromDType:V,getArrayFromDType:z,checkConversionForErrors:j,isValidDtype:W,hasEncodingLoss:G,isTypedArray:H,bytesPerElement:U,bytesFromStringArray:q,isString:$,isBoolean:K,isNumber:X,inferDtype:Y,isFunction:J,nearestDivisor:Q,computeStrides:Z,toTypedArray:tt,toNestedArray:et,makeOnesTypedArray:nt,makeZerosTypedArray:rt,now:it,assertNonNegativeIntegerDimensions:ot,fetch:function(t,e){return h().platform.fetch(t,e)},encodeString:at,decodeString:st,locToIndex:ut,indexToLoc:ct});var lt=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new ht)}return t.prototype.profileKernel=function(t,e,n){var r,i=this,o=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var i=t[r];if(isNaN(i)||!isFinite(i))return console.warn("Found "+i+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),o.then((function(o){var a="";null!=o.getExtraProfileInfo&&(a=o.getExtraProfileInfo()),i.logger.logKernelProfile(t,n,r,o.kernelMs,e,a)}))}))})),r},t}(),ht=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,i,o){var a="number"==typeof r?F(r+"ms",9):r.error,s=F(t,25),u=e.rank,c=e.size,l=F(e.shape.toString(),14),h="";for(var f in i){var p=i[f].shape||e.shape,d=p.length;h+=f+": "+d+"D "+(d>0?p:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+h+"\t%c"+o,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),ft=20,pt=3,dt=7;function mt(t,e,n,r){var i=Z(e),o=function(t,e,n,r){var i=I(e),o=r[r.length-1],a=new Array(o).fill(0),s=e.length,u="complex64"===n?yt(t):t;if(s>1)for(var c=0;c<i/o;c++)for(var l=c*o,h=0;h<o;h++)a[h]=Math.max(a[h],vt(u[l+h],0,n).length);return a}(t,e,n,i),a=e.length,s=function t(e,n,r,i,o,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[vt(yt(e)[0],0,r)]:"bool"===r?[gt(e[0])]:[e[0].toString()];if(1===c){if(u>ft){var l=pt*s,h=Array.from(e.slice(0,l)),f=Array.from(e.slice((u-pt)*s,u*s));return"complex64"===r&&(h=yt(h),f=yt(f)),["["+h.map((function(t,e){return vt(t,o[e],r)})).join(", ")+", ..., "+f.map((function(t,e){return vt(t,o[u-pt+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?yt(e):Array.from(e)).map((function(t,e){return vt(t,o[e],r)})).join(", ")+"]"]}var p=n.slice(1),d=i.slice(1),m=i[0]*s,v=[];if(u>ft){for(var g=0;g<pt;g++){var y=(b=g*m)+m;v.push.apply(v,t(e.slice(b,y),p,r,d,o,!1))}for(v.push("..."),g=u-pt;g<u;g++)y=(b=g*m)+m,v.push.apply(v,t(e.slice(b,y),p,r,d,o,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*m)+m,v.push.apply(v,t(e.slice(b,y),p,r,d,o,g===u-1))}var x=2===c?",":"";for(v[0]="["+v[0]+x,g=1;g<v.length-1;g++)v[g]=" "+v[g]+x;var w=",\n";for(g=2;g<c;g++)w+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(a?"":w),v}(t,e,n,i,o),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function vt(t,e,n){return F(Array.isArray(t)?parseFloat(t[0].toFixed(dt))+" + "+parseFloat(t[1].toFixed(dt))+"j":$(t)?"'"+t+"'":"bool"===n?gt(t):parseFloat(t.toFixed(dt)).toString(),e)}function gt(t){return 0===t?"false":"true"}function yt(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var bt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=I(t),null!=n){var i=n.length;S(i===this.size,(function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||z(e,this.size),this.strides=Z(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),S(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var i=this.locToIndex(n);this.values[i]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o<0||o>=this.shape[n]){var a="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return xt().makeTensor(this.values,this.shape,this.dtype)},t}(),xt=null,wt=null,Et=null,_t=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=I(t),this.strides=Z(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),S(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),this.reshape([t,e,n,r,i])},t.prototype.asType=function(t){return this.throwIfDisposed(),wt.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,wt.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return wt.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,et(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return et(this.shape,this.dataSync())},t.prototype.data=function(){return s(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=xt().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return st(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=xt().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return st(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,xt().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(xt().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),wt.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),wt.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),wt.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),wt.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),wt.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),wt.clone(this)},t.prototype.oneHot=function(t,e,n){return this.throwIfDisposed(),wt.oneHot(this,t,e,n)},t.prototype.toString=function(t){return void 0===t&&(t=!1),mt(this.dataSync(),this.shape,this.dtype,t)},t.prototype.tile=function(t){return this.throwIfDisposed(),wt.tile(this,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),wt.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),wt.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),wt.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),wt.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),wt.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),wt.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),wt.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),wt.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),wt.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),wt.unstack(this,t)},t.prototype.pad=function(t,e){return void 0===e&&(e=0),wt.pad(this,t,e)},t.prototype.batchNormalization=function(t,e,n,r,i){return void 0===n&&(n=.001),Et("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,i,r,n)},t.prototype.batchNorm=function(t,e,n,r,i){return void 0===i&&(i=.001),this.throwIfDisposed(),wt.batchNorm(this,t,e,n,r,i)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),wt.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),wt.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),wt.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),wt.cast(this,t)},t.prototype.add=function(t){return this.throwIfDisposed(),wt.add(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),wt.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),wt.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),wt.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),wt.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),wt.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),wt.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),wt.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),wt.mulStrict(this,t)},t.prototype.div=function(t){return this.throwIfDisposed(),wt.div(this,t)},t.prototype.divNoNan=function(t){return this.throwIfDisposed(),wt.divNoNan(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),wt.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),wt.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),wt.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),wt.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),wt.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),wt.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),wt.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),wt.modStrict(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),wt.squaredDifferenceStrict(this,t)},t.prototype.transpose=function(t){return this.throwIfDisposed(),wt.transpose(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),wt.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),wt.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),wt.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),wt.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),wt.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),wt.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),wt.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),wt.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),wt.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),wt.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),wt.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),wt.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),wt.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),wt.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),wt.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),wt.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),wt.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),wt.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),wt.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),wt.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),wt.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),wt.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),wt.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),wt.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),wt.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),wt.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),wt.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),wt.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),wt.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),wt.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),wt.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),wt.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),wt.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),wt.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),wt.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),wt.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),wt.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),wt.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),wt.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),wt.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),wt.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),wt.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),wt.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),wt.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),wt.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),wt.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),wt.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),wt.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),wt.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),wt.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),wt.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),wt.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),wt.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),wt.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),wt.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),wt.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),wt.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),wt.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),wt.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),wt.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),wt.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),wt.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),wt.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),wt.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,i,o){return void 0===r&&(r="NWC"),void 0===i&&(i=1),this.throwIfDisposed(),wt.conv1d(this,t,e,n,r,i,o)},t.prototype.conv2d=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),wt.conv2d(this,t,e,n,r,i,o)},t.prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),wt.conv2dTranspose(this,t,e,n,r,i)},t.prototype.depthwiseConv2D=function(t,e,n,r,i,o){return void 0===r&&(r="NHWC"),void 0===i&&(i=[1,1]),this.throwIfDisposed(),wt.depthwiseConv2d(this,t,e,n,r,i,o)},t.prototype.separableConv2d=function(t,e,n,r,i,o){return void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC"),this.throwIfDisposed(),wt.separableConv2d(this,t,e,n,r,i,o)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),wt.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),wt.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),wt.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,i){return this.throwIfDisposed(),wt.pool(this,t,e,n,r,i)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),xt().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),wt.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),wt.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),wt.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),wt.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,i,o,a,s){return void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),wt.stridedSlice(this,t,e,n,r,i,o,a,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),wt.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),wt.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),wt.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),wt.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),wt.spectral.irfft(this)},t}();Object.defineProperty(_t,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var Ct,St,At,kt,Tt,It=function(t){function e(e,n,r,i){var o=t.call(this,e.shape,e.dtype,e.dataId,i)||this;return o.trainable=n,o.name=r,o}return a(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!P(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");xt().disposeTensor(this),this.dataId=t.dataId,xt().incRef(this,null)},e.prototype.dispose=function(){xt().disposeVariable(this),this.isDisposedInternal=!0},e}(_t);Object.defineProperty(It,Symbol.hasInstance,{value:function(t){return t instanceof _t&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Ct||(Ct={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(St||(St={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(At||(At={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(kt||(kt={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(Tt||(Tt={}));var Pt={float32:kt,int32:St,bool:At,complex64:Tt};function Dt(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return Pt[t][e]}function Rt(t){return Dt(t,"int32")}function Mt(t,e){if(t.dtype===e.dtype)return[t,e];var n=Dt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Ft(t,e){S(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function Ot(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof _t)n.push(e);else if(i=e,Array.isArray(i)||"object"==typeof i){var i,o=e;for(var a in o){var s=o[a];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}Object.freeze({makeTypesMatch:Mt,assertTypesMatch:Ft,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},getTensorsInContainer:Ot});var Nt,Lt=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),Bt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Lt}return t.prototype.ready=function(){return s(this,void 0,void 0,(function(){var t,e,n;return u(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){switch(i.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=i.sent(),[3,3];case 2:r=n,i.label=3;case 3:if(!r)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new lt(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;g(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;g(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var i=++this.pendingBackendInitId,o=r.then((function(n){return!(i<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return!(i<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),i=r.success,o=r.asyncInit;if(o||i)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,i,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,i=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun((function(){return r.startScope(i)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){return t.toFloat()}}}),[]),e},t.prototype.runKernel=function(t,e,n,r,i){return this.runKernelFunc(null,e,null,t,n,r,i)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),i=0;n.forEach((function(t){i+="complex64"===t.dtype?3:1}));var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-e-i-o;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+t+"'")},t.prototype.runKernelFunc=function(t,e,n,r,i,o,a){var s,u=this;void 0===o&&(o=[]),void 0===a&&(a=[]);var c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,f=function(t){l&&(c=t.map((function(t){return u.keep(u.clone(t))})))},p=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,g=m(r,this.backendName);return h=null!=g?function(){var t=u.backend.numDataIds();v=g.kernelFunc({inputs:e,attrs:i,backend:u.backend});var n=Array.isArray(v)?v:[v];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)})),c=s.filter((function(t,e){return a[e]}));return f((o||[]).slice().concat(c)),s}:function(){var e=u.backend.numDataIds();v=u.tidy((function(){return t(u.backend,f)}));var n=Array.isArray(v)?v:[v];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,e,(function(){return h()})):h()})),l&&this.addTapeNode(r,e,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(v)?s:s[0]},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var i=t;"string"===n&&$(t[0])&&(i=t.map((function(t){return at(t)})));var o=r.write(i,e,n),a=new _t(e,n,o,this.nextTensorId());if(this.incRef(a,r),"string"===n){var s=this.state.tensorInfo.get(o),u=q(i);this.state.numBytes+=u-s.bytes,s.bytes=u}return a},t.prototype.makeTensorFromDataId=function(t,e,n,r){var i=new _t(e,n=n||"float32",t,this.nextTensorId());return this.incRef(i,r),i},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var i=new It(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*U(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof It||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,i){var o=this,a={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},s=v(t);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],i=rt(r.size,r.dtype);return o.makeTensor(i,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],i)}),this.state.activeTape.push(a)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=Ot(t),r=new Set(n.map((function(t){return t.id}))),i=0;i<this.state.activeScope.track.length;i++){var o=this.state.activeScope.track[i];o.kept||r.has(o.id)||o.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==a.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var i=this;if(void 0===r&&(r=!1),S(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var o=this.scopedRun((function(){return i.startTape()}),(function(){return i.endTape()}),(function(){return i.tidy("forward",t)}));S(o instanceof _t,(function(){return"The result y returned by f() must be a tensor."}));var a=function(t,e,n){for(var r={},i={},o=0;o<e.length;o++)r[e[o].id]=!0;for(o=0;o<t.length;o++){var a=(d=t[o]).inputs;for(var s in a){for(var u=a[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){d.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,i[d.id]=!0;break}if(c)break}}var h={};h[n.id]=!0;var f={};for(o=t.length-1;o>=0;o--)for(a=(d=t[o]).inputs,l=0;l<d.outputs.length;l++)if(h[d.outputs[l].id]){for(var s in a)h[a[s].id]=!0,f[d.id]=!0;break}var p=[];for(o=0;o<t.length;o++){var d;if(i[(d=t[o]).id]&&f[d.id]){var m={};for(var s in d.inputs){var v=d.inputs[s];r[v.id]&&(m[s]=v)}var g=Object.assign({},d);g.inputs=m,g.outputs=d.outputs,p.push(g)}}return p}(this.state.activeTape,e,o);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[o.id]=null==n?(t=o.shape,r=nt(I(t),"float32"),Vt.makeTensor(r,t,"float32")):n,function(t,e,n){for(var r=function(r){var i=e[r],o=[];if(i.outputs.forEach((function(e){var n=t[e.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+i.kernelName+".");var a=i.gradient(o),s=function(e){if(!(e in a))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var o=i.inputs[e];if(!P(r.shape,o.shape))throw new Error("Error in gradient for op "+i.kernelName+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+o.shape+"'");if(null==t[o.id])t[o.id]=r;else{var s=t[o.id];t[o.id]=s.add(r),s.dispose()}};for(var u in i.inputs)s(u)},i=e.length-1;i>=0;i--)r(i)}(s,a,(function(t){return i.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===i.state.gradientDepth&&(i.state.activeTape.forEach((function(t){for(var e=0,n=t.saved;e<n.length;e++)n[e].dispose()})),i.state.activeTape=null),{value:o,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return S(J(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];S(r.every((function(t){return t instanceof _t})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(t,e){o[e]=t})),e.runKernelFunc((function(e,i){return S((n=t.apply(void 0,r.concat([i]))).value instanceof _t,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),S(J(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),o,(function(t,e){var i=n.gradFunc(t,e),o=Array.isArray(i)?i:[i];S(o.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),S(o.every((function(t){return t instanceof _t})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return o.forEach((function(t,e){a[e]=function(){return t}})),a}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return e=it(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=it()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Lt,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),Vt=function(){var e=function(){if(null==Nt){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof t)e=t;else if("undefined"!=typeof r)e=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Nt=e}return Nt}();if(null==e._tfengine){var n=new c(e);e._tfengine=new Bt(n)}return function(t){f=t}(e._tfengine.ENV),xt=function(){return e._tfengine},e._tfengine}();function zt(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var jt=h();jt.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),jt.registerFlag("IS_BROWSER",(function(){return zt()})),jt.registerFlag("IS_NODE",(function(){return"undefined"!=typeof r&&void 0!==r.versions&&void 0!==r.versions.node})),jt.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),jt.registerFlag("PROD",(function(){return!1})),jt.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return jt.getBool("DEBUG")})),jt.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),jt.registerFlag("IS_TEST",(function(){return!1}));var Wt,Gt,Ht,Ut={},qt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $t(t,e){Ut[t]=e}function Kt(t){t in Ut||(Ut[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Ut[t]}),!1),1===t?e.getContext("webgl",qt)||e.getContext("experimental-webgl",qt):e.getContext("webgl2",qt)}(t));var e=Ut[t];return e.isContextLost()?(delete Ut[t],Kt(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Ut[t])}function Xt(t,e){return[e,t]}function Yt(t){var e=I(t);return M(Math.ceil(e/4))}function Jt(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Qt(t,e){var n,r,i,o,a,s,u,c,l,f=t;return 2===h().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,i=f.RGBA16F,o=f.RGBA32F,a=f.RED,s=4,u=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=t.RGBA,r=t.RGBA,i=t.RGBA,o=f.RGBA,a=t.RGBA,s=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:a,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function Zt(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+re(t,e))}(t),r}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Wt||(Wt={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(Gt||(Gt={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Ht||(Ht={}));var te=5.96e-8,ee=65504;function ne(t){return!!(h().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||te<Math.abs(t)&&Math.abs(t)<ee)}function re(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function ie(t,e,n){return ke(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function oe(t,e,n){var r=ke(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Zt(t,e,(function(){return t.shaderSource(r,n)})),Zt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function ae(t,e,n){var r=ke(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Zt(t,e,(function(){return t.shaderSource(r,n)})),Zt(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=ce.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],i=t.split("\n"),o=i.length.toString().length+2,a=i.map((function(t,e){return F((e+1).toString(),o)+t})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var c=a.slice(0,r-1),l=a.slice(r-1,r),h=a.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+F(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var se,ue,ce=/ERROR: [0-9]+:([0-9]+):/g;function le(t,e){return ke(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function he(t,e,n){if(Zt(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function fe(t,e,n){if(Zt(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function pe(t,e,n){var r=ke(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),Zt(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function de(t,e,n){var r=ke(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return Zt(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),Zt(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function me(t,e){return ke(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function ve(t,e){var n=h().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function ge(t,e){return ke(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function ye(t,e,n,r,i,o,a,s){var u=t.getAttribLocation(n,r);return-1!==u&&(Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,i)})),Zt(t,e,(function(){return t.vertexAttribPointer(u,o,t.FLOAT,!1,a,s)})),Zt(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function be(t,e,n,r){Te(t,r),Zt(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function xe(t,e,n,r){return ke(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function we(t,e,n){return t.getUniformLocation(e,n)}function Ee(t,e,n,r,i,o){Zt(t,e,(function(){return be(t,e,r,o)})),Zt(t,e,(function(){return t.uniform1i(i,o)}))}function _e(t,e,n,r){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),Zt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function Ce(t,e,n){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),Zt(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function Se(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Ae(t,e))}function Ae(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function ke(t,e,n,r){var i=Zt(t,e,(function(){return n()}));if(null==i)throw new Error(r);return i}function Te(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function Ie(t,e){return void 0===e&&(e=2),I(t.slice(0,t.length-e))}function Pe(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function De(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[Ie(t)].concat(Pe(t))),e}function Re(t,e){var n;void 0===e&&(e=!1);var r=h().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?_(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var i=B(t);t=i.newShape}var o=I(t);if(t.length<=1&&o<=r)return[1,o];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var a=Ie(t),s=2,u=2;return t.length&&(s=(n=Pe(t))[0],u=n[1]),M(o=a*(s/2)*(u/2)).map((function(t){return 2*t}))}return M(o)}function Me(t){return t%2==0}function Fe(t,e){if(P(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Me(n)&&Me(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Me(t[0])&&Me(e[0])}function Oe(t){if(null==se){var e=Kt(t);se=e.getParameter(e.MAX_TEXTURE_SIZE)}return se}function Ne(t){if(null==ue){var e=Kt(t);ue=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,ue)}function Le(t){if(0===t)return 0;var e=Kt(t);return Be(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:Be(e,"EXT_disjoint_timer_query")?1:0}function Be(t,e){return null!=t.getExtension(e)}function Ve(t){try{if(null!=Kt(t))return!0}catch(t){return!1}return!1}function ze(t){if(0===t)return!1;var e=Kt(t);if(1===t){if(!Be(e,"OES_texture_float"))return!1}else if(!Be(e,"EXT_color_buffer_float"))return!1;return We(e)}function je(t){if(0===t)return!1;var e=Kt(t);if(1!==t){if(Be(e,"EXT_color_buffer_float"))return We(e);if(Be(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=Qt(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),o}(e,n)}return!1}return!!Be(e,"OES_texture_float")&&!!Be(e,"WEBGL_color_buffer_float")&&We(e)}function We(t){var e=Qt(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),i}function Ge(t){return 2===t&&null!=Kt(t).fenceSync}var He=Object.freeze({callAndCheck:Zt,canBeRepresented:ne,getWebGLErrorMessage:re,getExtensionOrThrow:ie,createVertexShader:oe,createFragmentShader:ae,createProgram:le,linkProgram:he,validateProgram:fe,createStaticVertexBuffer:pe,createStaticIndexBuffer:de,getNumChannels:function(){return 2===h().getNumber("WEBGL_VERSION")?1:4},createTexture:me,validateTextureSize:ve,createFramebuffer:ge,bindVertexBufferToProgramAttribute:ye,bindTextureUnit:be,unbindTextureUnit:function(t,e,n){Te(t,n),Zt(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:xe,getProgramUniformLocation:we,bindTextureToProgramUniformSampler:Ee,bindCanvasToFramebuffer:function(t,e){Zt(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Zt(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),Zt(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:_e,unbindColorTextureFromFramebuffer:Ce,validateFramebuffer:Se,getFramebufferErrorMessage:Ae,getBatchDim:Ie,getRowsCols:Pe,getShapeAs3D:De,getTextureShapeFromLogicalShape:Re,isReshapeFree:Fe,getWebGLMaxTextureSize:Oe,resetMaxTextureSize:function(){se=null},resetMaxTexturesInShader:function(){ue=null},getMaxTexturesInShader:Ne,getWebGLDisjointQueryTimerVersion:Le,hasExtension:Be,isWebGLVersionEnabled:Ve,isCapableOfRenderingToFloatTexture:ze,isDownloadFloatTextureEnabled:je,isWebGLFenceEnabled:Ge}),Ue=h();function qe(t){h().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function $e(t,e){return Vt.tidy(t,e)}function Ke(t){Ot(t).forEach((function(t){return t.dispose()}))}function Xe(t){return Vt.keep(t)}function Ye(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];h().getBool("IS_TEST")||console.warn.apply(console,t)}function Je(t,e){var n=t;if(H(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||H(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&h().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||H(e)){S(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),S(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var i=n.slice(1),o=0;o<e.length;++o)t(e[o],i,r.concat(o))}else S(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function Qe(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function Ze(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof _t)return Qe(r,t.dtype,e,n),t;var i=Y(t);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),Qe(r,i,e,n),null==t||!H(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var o=null==t?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+o+"'")}var a=Je(t,i);H(t)||Array.isArray(t)||(t=[t]);var s="string"!==i?tt(t,i,h().getBool("DEBUG")):T(t,[],!0);return Vt.makeTensor(s,a,i)}function tn(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return Ze(t,e+"["+r+"]",n)}),r)}function en(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function nn(t,e,n){for(var r=t.length+e.length,i=[],o=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?i.push(t[o++]):i.push(e[a++]);return i}function rn(t,e){for(var n=[],r=t.length,i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((function(e){return t[e]}))]}function on(t,e){return nn(t,e.map((function(t){return 1})),e)}function an(t,e,n){S(en(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function sn(t,e){if(en(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function un(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function cn(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function ln(t,e){var n=t[0].length;t.forEach((function(t,e){S(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),S(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,i){for(var o=0;o<n;o++)S(o===e||t[o]===r[o],(function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."}))}))}function hn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function fn(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var i=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Vt.startScope(n);try{var i=r.apply(void 0,t);return i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Vt.endScope(i),i}catch(t){throw Vt.endScope(null),t}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}Ue.registerFlag("HAS_WEBGL",(function(){return Ue.getNumber("WEBGL_VERSION")>0})),Ue.registerFlag("WEBGL_VERSION",(function(){return Ve(2)?2:Ve(1)?1:0})),Ue.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Ue.get("WEBGL_VERSION")})),Ue.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Ue.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Ue.registerFlag("WEBGL_PACK",(function(){return Ue.getBool("HAS_WEBGL")})),Ue.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_CLIP",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Ue.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_PACK_REDUCE",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_CONV_IM2COL",(function(){return Ue.getBool("WEBGL_PACK")})),Ue.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Oe(Ue.getNumber("WEBGL_VERSION"))})),Ue.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Ne(Ue.getNumber("WEBGL_VERSION"))})),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Ue.getNumber("WEBGL_VERSION");return 0===t?0:Le(t)})),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Ue.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Ue.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return ze(Ue.getNumber("WEBGL_VERSION"))})),Ue.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Ue.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ue.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Ue.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return je(Ue.getNumber("WEBGL_VERSION"))})),Ue.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return Ge(Ue.getNumber("WEBGL_VERSION"))})),Ue.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Ue.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Et=qe;var pn=fn({complex_:function(t,e){var n=Ze(t,"real","complex"),r=Ze(e,"imag","complex");return A(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Vt.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),dn=fn({real_:function(t){var e=Ze(t,"input","real");return Vt.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),mn=fn({imag_:function(t){var e=Ze(t,"input","imag");return Vt.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function vn(t,e,n){return gn(t,e,Je(t,n),n)}function gn(t,e,n,r){if(null==r&&(r=Y(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!H(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){ot(e);var i=I(e),o=I(n);S(i===o,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+i+" values but has "+o}));for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==I(e.slice(a));S(n[a]===e[a]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return H(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?tt(t,r,h().getBool("DEBUG")):T(t,[],!0),Vt.makeTensor(t,e,r)}function yn(t,e){if((H(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&H(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return gn(t,[],[],e)}function bn(t,e){k(t);var n=Je(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return gn(t,null,n,e)}function xn(t,e,n){if(k(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Je(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return gn(t,e,r,n)}function wn(t,e,n){if(k(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=Je(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return gn(t,e,r,n)}function En(t,e,n){if(k(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=Je(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return gn(t,e,r,n)}function _n(t,e,n){if(k(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=Je(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return gn(t,e,r,n)}function Cn(t,e,n){if(k(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=Je(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return gn(t,e=e||r,r,n)}function Sn(t,e,n,r){return void 0===e&&(e=!0),Vt.makeVariable(t,e,n,r)}function An(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=An(t,"float32"),r=kn(t,"float32");return pn(n,r)}var i=nt(I(t),e);return Vt.makeTensor(i,t,e)}function kn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=kn(t,"float32"),r=kn(t,"float32");return pn(n,r)}var i=rt(I(t),e);return Vt.makeTensor(i,t,e)}function Tn(t,e,n){return Vt.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function In(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Vt.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function Pn(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return kn([0],r);var i=rt(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return bn(i,r)}var Dn=fn({onesLike_:function(t){var e=Ze(t,"x","onesLike");if("complex64"===e.dtype){var n=Dn(dn(e)),r=Rn(mn(e));return pn(n,r)}return Vt.runKernelFunc((function(t){return t.onesLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Rn(t)}}}))}}),Rn=fn({zerosLike_:function(t){var e=Ze(t,"x","zerosLike");return Vt.runKernelFunc((function(t){return t.zerosLike(e)}),{$x:e},(function(t,e){return{$x:function(){return Rn(t)}}}))}}),Mn=fn({concat_:function(t,e){void 0===e&&(e=0),S(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=tn(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=L(e,n[0].shape)[0];var r=hn(n.map((function(t){return t.shape})),e);if(0===I(r))return vn([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var i=n.map((function(t){return t.shape}));ln(i,e);var o=n,a={axis:e};return Vt.runKernelFunc((function(t){return t.concat(n,e)}),o,(function(t){var n=i.map((function(t){return t[e]}));return Bn(t,n,e).map((function(t){return function(){return t}}))}),"Concat",a)}}),Fn=fn({concat1d_:function(t){return Mn(t,0)}}),On=fn({concat2d_:function(t,e){return Mn(t,e)}}),Nn=fn({concat3d_:function(t,e){return Mn(t,e)}}),Ln=fn({concat4d_:function(t,e){return Mn(t,e)}}),Bn=fn({split_:function(t,e,n){void 0===n&&(n=0);var r,i=Ze(t,"x","split");return n=L(n,i.shape)[0],"number"==typeof e?(S(i.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(i.shape[n]/e)):(S(i.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Vt.runKernelFunc((function(t){return t.split(i,r,n)}),{$x:i},(function(t){return{$x:function(){return Mn(t,n)}}}))}});function Vn(t,e){return t(e={exports:{}},e.exports),e.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t||"undefined"!=typeof self&&self;var zn=Vn((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function i(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function o(t,e){var n=new r(t),o=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.alea=o}(0,t,!1)})),jn=Vn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor128=o}(0,t,!1)})),Wn=Vn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function i(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorwow=o}(0,t,!1)})),Gn=Vn((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function i(t,e){return e.x=t.x.slice(),e.i=t.i,e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.x&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xorshift7=o}(0,t,!1)})),Hn=Vn((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,o=e.i;return e.w=r=r+1640531527|0,n=i[o+34&127],t=i[o=o+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[o]=n^t,e.i=o,n+(r^r>>>16)|0},function(t,e){var n,r,i,o,a,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(r^=e.charCodeAt((o+32)%e.length)),0===o&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(a=a+1640531527|0,i=0==(n=s[127&o]^=r+a)?i+1:0);for(i>=128&&(s[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;t.w=a,t.X=s,t.i=i}(e,t)}function i(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function o(t,e){null==t&&(t=+new Date);var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&(o.X&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.xor4096=o}(0,t,!1)})),Un=Vn((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function i(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function o(t,e){var n=new r(t),o=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},a.int32=n.next,a.quick=a,o&&("object"==typeof o&&i(o,n),a.state=function(){return i(n,{})}),a}e&&e.exports?e.exports=o:n&&n.amd?n((function(){return o})):this.tychei=o}(0,t,!1)})),qn=Vn((function(t){!function(e,r){var i,o=this,a=256,s=6,u="random",c=r.pow(a,s),l=r.pow(2,52),h=2*l,f=a-1;function p(t,n,f){var p=[],y=v(function t(e,n){var r,i=[],o=typeof e;if(n&&"object"==o)for(r in e)try{i.push(t(e[r],n-1))}catch(t){}return i.length?i:"string"==o?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,g(e)]:null==t?function(){try{var t;return i&&(t=i.randomBytes)?t=t(a):(t=new Uint8Array(a),(o.crypto||o.msCrypto).getRandomValues(t)),g(t)}catch(t){var n=o.navigator,r=n&&n.plugins;return[+new Date,o,r,o.screen,g(e)]}}():t,3),p),b=new d(p),x=function(){for(var t=b.g(s),e=c,n=0;t<l;)t=(t+n)*a,e*=a,n=b.g(1);for(;t>=h;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,v(g(b.S),e),(n.pass||f||function(t,e,n,i){return i&&(i.S&&m(i,b),t.state=function(){return m(b,{})}),n?(r[u]=t,e):t})(x,y,"global"in n?n.global:this==r,n.state)}function d(t){var e,n=t.length,r=this,i=0,o=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<a;)s[i]=i++;for(i=0;i<a;i++)s[i]=s[o=f&o+t[i%n]+(e=s[i])],s[o]=e;(r.g=function(t){for(var e,n=0,i=r.i,o=r.j,s=r.S;t--;)e=s[i=f&i+1],n=n*a+s[f&(s[i]=s[o=f&o+e])+(s[o]=e)];return r.i=i,r.j=o,n})(a)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){for(var n,r=t+"",i=0;i<r.length;)e[f&i]=f&(n^=19*e[f&i])+r.charCodeAt(i++);return g(e)}function g(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=p,v(r.random(),e),t.exports){t.exports=p;try{i=n(1)}catch(t){}}}([],Math)}));qn.alea=zn,qn.xor128=jn,qn.xorwow=Wn,qn.xorshift7=Gn,qn.xor4096=Hn,qn.tychei=Un;var $n=qn.alea,Kn=function(){function t(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=$n(o.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var i=void 0,o=void 0,a=void 0;do{a=(i=2*this.random()-1)*i+(o=2*this.random()-1)*o}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*s,n=this.mean+this.stdDev*o*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),Xn=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var i=r||Math.random();this.randu=$n(i.toString()),this.randn=new Kn(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,i,o;;){do{r=this.randn.nextValue(),o=1+this.c*r}while(o<=0);if(o*=o*o,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-o+Math.log(o)),(i=this.randu())<e||Math.log(i)<n)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),Yn=function(){function t(t,e,n,r){var i=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==i.dtype||"float32"===i.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=$n(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}();function Jn(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",ot(t),new bt(t,e,n)}function Qn(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var Zn=fn({batchToSpaceND_:function(t,e,n){var r=Ze(t,"x","batchToSpaceND"),i=e.reduce((function(t,e){return t*e}));return S(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),S(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),S(r.shape[0]%i==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+i})),Vt.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),tr=fn({broadcastTo_:function(t,e){var n=Ze(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var i=n.shape.slice();i.length<e.length;)i.unshift(1);n=n.reshape(i)}for(var o=Array.from(e),a=e.length-1;a>=0;a--)if(n.shape[a]===e[a])o[a]=1;else if(1!==n.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var s=o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));return 0===s.length?n.clone():Vt.runKernelFunc((function(t){return t.tile(n,o)}),{input:n},(function(t){return{input:function(){return t.sum(s,!0)}}}))}}),er=fn({cast_:function(t,e){var n=Ze(t,"x","cast");if(!W(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:e};return Vt.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",r)}}),nr=fn({clone_:function(t){var e=Ze(t,"x","clone",null);return Vt.runKernelFunc((function(){return Vt.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{$x:e},(function(t){return{$x:function(){return t.toFloat()}}}))}}),rr=fn({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var i=Ze(t,"x","cumsum"),o=sn([e|=0],i.rank),a=i;null!=o&&(a=i.transpose(o));var s=cn(1,i.rank)[0],u=Vt.runKernelFunc((function(t){return t.cumsum(a,s,n,r)}),{permutedX:a},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=o&&(u=u.transpose(o)),u}}),ir=fn({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=Ze(t,"x","depthToSpace"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return S(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),S(o*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),S(a%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+a+" for depthToSpace with input shape "+r.shape})),Vt.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),or=fn({expandDims_:function(t,e){void 0===e&&(e=0);var n=Ze(t,"x","expandDims",null);S(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(S(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),yr(n,r)}}),ar=fn({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var i=Jn([t,e],r),o=t<=e?t:e,a=0;a<o;++a)i.set(1,a,a);var s=i.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Er(or(s,0),[n[0],1,1]);if(2===n.length)return Er(or(or(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Er(or(or(or(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),sr=fn({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var i=Ze(t,"logits","multinomial"),o=i.size,a=i.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+o+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?i.as2D(1,-1):i,u=Vt.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===a?u.as1D():u}}),ur=fn({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var i=Ze(t,"indices","oneHot","int32"),o=i.shape.concat([e]);return i=i.flatten(),Vt.runKernelFunc((function(t){return t.oneHot(i,e,n,r)}),{$indices:i},(function(t){return{$indices:function(){return kn(i.shape,"float32")}}})).reshape(o)}}),cr=fn({pad_:function(t,e,n){void 0===n&&(n=0);var r=Ze(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var i={paddings:e,constantValue:n};return Vt.runKernelFunc((function(t){return t.pad(r,e,n)}),{x:r},(function(t){var n=e.map((function(t){return t[0]}));return{x:function(){return t.slice(n,r.shape)}}}),"PadV2",i)}}),lr=fn({pad1d_:function(t,e,n){return void 0===n&&(n=0),S(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),cr(t,[e],n)}}),hr=fn({pad2d_:function(t,e,n){return void 0===n&&(n=0),S(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(t,e,n)}}),fr=fn({pad3d_:function(t,e,n){return void 0===n&&(n=0),S(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(t,e,n)}}),pr=fn({pad4d_:function(t,e,n){return void 0===n&&(n=0),S(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),cr(t,e,n)}}),dr=fn({rand_:function(t,e,n){var r=I(t),i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);i=new Uint8Array(r)}for(var o=0;o<r;o++)i[o]=e();return Vt.makeTensor(i,t,n)}}),mr=fn({randomNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new Kn(e,n,r,!1,i),a=Jn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),vr=fn({randomGamma_:function(t,e,n,r,i){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var o=new Xn(e,n,r,i),a=Jn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),gr=fn({randomUniform_:function(t,e,n,r,i){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var o=Jn(t,r),a=new Yn(e,n,null,i),s=0;s<o.values.length;s++)o.values[s]=a.nextValue();return o.toTensor()}}),yr=fn({reshape_:function(t,e){var n=Ze(t,"x","reshape",null);e=N(e,n.size),S(n.size===I(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Vt.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",r)}}),br=fn({spaceToBatchND_:function(t,e,n){var r=Ze(t,"x","spaceToBatchND");return S(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),S(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),S(r.shape.reduce((function(t,r,i){return i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),Vt.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),xr=fn({squeeze_:function(t,e){var n=Ze(t,"x","squeeze");return yr(n,B(n.shape,e).newShape)}}),wr=fn({stack_:function(t,e){void 0===e&&(e=0);var n=tn(t,"tensors","stack");if(S(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].rank,i=n[0].shape,o=n[0].dtype;S(e<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){A(i,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){S(o===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(t){return t.expandDims(e)}));return Mn(a,e)}}),Er=fn({tile_:function(t,e){var n=Ze(t,"x","tile",null);S(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."}));var r=[n],i={reps:e};return Vt.runKernelFunc((function(t,r){var i=t.tile(n,e);return r([n]),i}),{x:n},(function(t,n){var r=n[0];return{x:function(){var n=Rn(r);if(1===r.rank)for(var i=0;i<e[0];++i)n=n.add(t.slice([i*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(i=0;i<e[0];++i)for(var o=0;o<e[1];++o)n=n.add(t.slice([i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(var a=0;a<e[2];++a)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(i=0;i<e[0];++i)for(o=0;o<e[1];++o)for(a=0;a<e[2];++a)for(var s=0;s<e[3];++s)n=n.add(t.slice([i*r.shape[0],o*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}),"Tile",i,r)}}),_r=fn({truncatedNormal_:function(t,e,n,r,i){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var o=new Kn(e,n,r,!0,i),a=Jn(t,r),s=0;s<a.values.length;s++)a.values[s]=o.nextValue();return a.toTensor()}}),Cr=fn({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=Ze(t,"x","unstack");S(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length);var r={axis:e};return Vt.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return wr(t,e)}}}),"Unpack",r)}}),Sr=function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,a,s,c,l,h,f;return u(this,(function(u){switch(u.label){case 0:return n=Ze(t,"x","setdiff1d"),r=Ze(e,"y","setdiff1d"),S(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),S(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),S(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return i=u.sent(),[4,r.data()];case 2:for(o=u.sent(),a=new Set(o),s=0,h=0;h<i.length;h++)a.has(i[h])||s++;for(c=new bt([s],n.dtype),l=new bt([s],"int32"),h=0,f=0;h<i.length;h++)a.has(i[h])||(c.values[f]=i[h],l.values[f]=h,f++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function Ar(t,e,n,r){void 0===r&&(r=!0);var i=[];if(r)(i=i.concat(e.slice(0))).push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);for(var o=e.length,a=0;a<o;++a)i=i.concat([t[a+1]/e[a],e[a]]);i=i.concat(t.slice(o+1))}return i}function kr(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{var o=[],a=[];for(i=1;i<t;++i)i>=2*e+1||i%2==1?a.push(i):o.push(i);r.push.apply(r,o),r.push(0),r.push.apply(r,a)}return r}function Tr(t,e,n,r){void 0===r&&(r=!0);var i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(var o=1;o<t.length;++o)o<=e.length?r?i.push(e[o-1]*t[o]):i.push(t[o]/e[o-1]):i.push(t[o]);return i}function Ir(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Pr(t,e,n){for(var r=t.slice(0,1),i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}function Dr(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],i=1,o=0;o<n.length-1;++o)i*=n[o];var a=t.shape,s=n.slice();s.pop();var u=1;for(o=r;o<t.rank;++o)u*=a[o],s.push(a[o]);var c=Z(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,i,u,c]}Object.freeze({prepareAndValidate:Dr});var Rr=30;function Mr(t){return t<=Rr?t:Q(t,Math.floor(Math.sqrt(t)))}function Fr(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+i+".";if(n.rank<i)throw new Error(o+" update.rank < "+i+". ");if(t.length<r+(n.rank-i))throw new Error(o+" Output shape length < "+(r+(n.rank-i)));if(n.rank!==i+t.length-r)throw new Error(o+" update.rank != "+(i+t.length-r));for(var a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(o+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+e.shape[a]+").");for(a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(o+" updates.shape["+(a+i)+"] ("+n.shape[a+i]+") != shape["+(a+i)+"] ("+t[a+i]+")")}function Or(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}Fr(n,e,t)}function Nr(t,e,n){for(var r=e.shape.length,i=r>1?e.shape[r-1]:1,o=n.length,a=1,s=i;s<o;++s)a*=n[s];var u=i<1?1:i;return{sliceRank:i,numUpdates:I(e.shape)/u,sliceSize:a,strides:Z(n.slice(0,i)).concat([1]),outputSize:I(n)}}Object.freeze({validateUpdateShape:Fr,validateInput:Or,calculateShapes:Nr});function Lr(t,e,n){S(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),S(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){S(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},i=0;i<t.rank;++i)r(i)}function Br(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Vr(t,e,n){for(var r=[],i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function zr(t,e,n,r,i){var o=e[i],a=n[i]||1;(t&1<<i||null==o)&&(o=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),E(0,o,s-1)}function jr(t,e,n,r,i){var o=e[i],a=n[i]||1;(t&1<<i||null==o)&&(o=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[i];return o<0&&(o+=s),a>0?E(0,o,s):E(-1,o,s-1)}function Wr(t,e,n){for(var r=n.length,i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function Gr(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}Object.freeze({assertParamsValid:Lr,maskToAxes:Br,computeOutShape:Vr,startForAxis:zr,stopForAxis:jr,isSliceContinous:Wr,computeFlatOffset:Gr});function Hr(t,e){S(J(t),(function(){return"The f passed in variableGrads(f) must be a function"})),S(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof It})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Vt.registeredVariables)e.push(Vt.registeredVariables[r]);var i=n?e.filter((function(t){return!t.trainable})):null,o=e.length;S((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+o+" variables is trainable."}));var a=Vt.gradients(t,e,null,!0),s=a.value,u=a.grads;S(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),S(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=i&&i.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}function Ur(t){return Vt.customGrad(t)}var qr=fn({softmax_:function(t,e){void 0===e&&(e=-1);var n=Ze(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return Vt.runKernelFunc((function(t,r){var i=t.softmax(n,e);return r([i]),i}),{logits:n},(function(t,n){var r=n[0],i=t.mul(r);return{logits:function(){return i.sub(i.sum([e],!0).mul(r))}}}),"Softmax",{dim:e},[],[!0])}}),$r=fn({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=Ze(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return Ur((function(t,n){var r=t.max(e,!0),i=t.sub(r),o=i.toFloat().sub(i.exp().sum(e,!0).log());return n([o]),{value:o,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),Kr=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),Xr=function(){function t(){}return t.prototype.time=function(t){return Yr("time")},t.prototype.read=function(t){return Yr("read")},t.prototype.readSync=function(t){return Yr("readSync")},t.prototype.numDataIds=function(){return Yr("numDataIds")},t.prototype.disposeData=function(t){return Yr("disposeData")},t.prototype.write=function(t,e,n){return Yr("write")},t.prototype.move=function(t,e,n,r){return Yr("move")},t.prototype.memory=function(){return Yr("memory")},t.prototype.floatPrecision=function(){return Yr("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return Yr("batchMatMul")},t.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,Yr("fusedBatchMatMul")},t.prototype.slice=function(t,e,n){return Yr("slice")},t.prototype.stridedSlice=function(t,e,n,r){return Yr("stridedSlice")},t.prototype.unstack=function(t,e){return Yr("unstack")},t.prototype.reverse=function(t,e){return Yr("reverse")},t.prototype.concat=function(t,e){return Yr("concat")},t.prototype.neg=function(t){return Yr("neg")},t.prototype.add=function(t,e){return Yr("add")},t.prototype.addN=function(t){return Yr("addN")},t.prototype.subtract=function(t,e){return Yr("subtract")},t.prototype.multiply=function(t,e){return Yr("multiply")},t.prototype.realDivide=function(t,e){return Yr("realDivide")},t.prototype.floorDiv=function(t,e){return Yr("floorDiv")},t.prototype.sum=function(t,e){return Yr("sum")},t.prototype.prod=function(t,e){return Yr("prod")},t.prototype.unsortedSegmentSum=function(t,e,n){return Yr("unsortedSegmentSum")},t.prototype.argMin=function(t,e){return Yr("argMin")},t.prototype.argMax=function(t,e){return Yr("argMax")},t.prototype.equal=function(t,e){return Yr("equal")},t.prototype.notEqual=function(t,e){return Yr("notEqual")},t.prototype.less=function(t,e){return Yr("less")},t.prototype.lessEqual=function(t,e){return Yr("lessEqual")},t.prototype.greater=function(t,e){return Yr("greater")},t.prototype.greaterEqual=function(t,e){return Yr("greaterEqual")},t.prototype.logicalNot=function(t){return Yr("logicalNot")},t.prototype.logicalAnd=function(t,e){return Yr("logicalAnd")},t.prototype.logicalOr=function(t,e){return Yr("logicalOr")},t.prototype.where=function(t){return Yr("where")},t.prototype.select=function(t,e,n){return Yr("select")},t.prototype.topk=function(t,e,n){return Yr("topk")},t.prototype.min=function(t,e){return Yr("min")},t.prototype.minimum=function(t,e){return Yr("minimum")},t.prototype.mod=function(t,e){return Yr("mod")},t.prototype.max=function(t,e){return Yr("max")},t.prototype.maximum=function(t,e){return Yr("maximum")},t.prototype.all=function(t,e){return Yr("all")},t.prototype.any=function(t,e){return Yr("any")},t.prototype.squaredDifference=function(t,e){return Yr("squaredDifference")},t.prototype.ceil=function(t){return Yr("ceil")},t.prototype.floor=function(t){return Yr("floor")},t.prototype.round=function(t){return Yr("round")},t.prototype.sign=function(t){return Yr("sign")},t.prototype.isNaN=function(t){return Yr("isNaN")},t.prototype.isInf=function(t){return Yr("isInf")},t.prototype.isFinite=function(t){return Yr("isFinite")},t.prototype.pow=function(t,e){return Yr("pow")},t.prototype.exp=function(t){return Yr("exp")},t.prototype.expm1=function(t){return Yr("expm1")},t.prototype.softmax=function(t,e){return Yr("softmax")},t.prototype.log=function(t){return Yr("log")},t.prototype.log1p=function(t){return Yr("log1p")},t.prototype.sqrt=function(t){return Yr("sqrt")},t.prototype.rsqrt=function(t){return Yr("rsqrt")},t.prototype.square=function(t){return Yr("square")},t.prototype.reciprocal=function(t){return Yr("reciprocal")},t.prototype.relu=function(t){return Yr("relu")},t.prototype.relu6=function(t){return Yr("relu6")},t.prototype.prelu=function(t,e){return Yr("prelu")},t.prototype.elu=function(t){return Yr("elu")},t.prototype.eluDer=function(t,e){return Yr("eluDer")},t.prototype.selu=function(t){return Yr("selu")},t.prototype.int=function(t){return Yr("int")},t.prototype.clip=function(t,e,n){return Yr("clip")},t.prototype.abs=function(t){return Yr("abs")},t.prototype.complexAbs=function(t){return Yr("complexAbs")},t.prototype.sigmoid=function(t){return Yr("sigmoid")},t.prototype.softplus=function(t){return Yr("softplus")},t.prototype.sin=function(t){return Yr("sin")},t.prototype.cos=function(t){return Yr("cos")},t.prototype.tan=function(t){return Yr("tan")},t.prototype.asin=function(t){return Yr("asin")},t.prototype.acos=function(t){return Yr("acos")},t.prototype.atan=function(t){return Yr("atan")},t.prototype.atan2=function(t,e){return Yr("atan2")},t.prototype.sinh=function(t){return Yr("sinh")},t.prototype.cosh=function(t){return Yr("cosh")},t.prototype.tanh=function(t){return Yr("tanh")},t.prototype.asinh=function(t){return Yr("asinh")},t.prototype.acosh=function(t){return Yr("acosh")},t.prototype.atanh=function(t){return Yr("atanh")},t.prototype.erf=function(t){return Yr("erf")},t.prototype.step=function(t,e){return Yr("step")},t.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Yr("fusedConv2d")},t.prototype.conv2d=function(t,e,n){return Yr("conv2d")},t.prototype.conv2dDerInput=function(t,e,n){return Yr("conv2dDerInput")},t.prototype.conv2dDerFilter=function(t,e,n){return Yr("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,Yr("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(t,e,n){return Yr("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return Yr("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return Yr("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(t,e,n){return Yr("conv3d")},t.prototype.conv3dDerInput=function(t,e,n){return Yr("conv3dDerInput")},t.prototype.conv3dDerFilter=function(t,e,n){return Yr("conv3dDerFilter")},t.prototype.maxPool=function(t,e){return Yr("maxPool")},t.prototype.maxPoolBackprop=function(t,e,n,r){return Yr("maxPoolBackprop")},t.prototype.avgPool=function(t,e){return Yr("avgPool")},t.prototype.avgPoolBackprop=function(t,e,n){return Yr("avgPoolBackprop")},t.prototype.avgPool3d=function(t,e){return Yr("avgPool3d")},t.prototype.avgPool3dBackprop=function(t,e,n){return Yr("avgPool3dBackprop")},t.prototype.maxPool3d=function(t,e){return Yr("maxPool3d")},t.prototype.maxPool3dBackprop=function(t,e,n,r){return Yr("maxPool3dBackprop")},t.prototype.reshape=function(t,e){return Yr("reshape")},t.prototype.cast=function(t,e){return Yr("cast")},t.prototype.tile=function(t,e){return Yr("tile")},t.prototype.pad=function(t,e,n){return Yr("pad")},t.prototype.transpose=function(t,e){return Yr("transpose")},t.prototype.gather=function(t,e,n){return Yr("gather")},t.prototype.gatherND=function(t,e){return Yr("gatherND")},t.prototype.scatterND=function(t,e,n){return Yr("scatterND")},t.prototype.batchToSpaceND=function(t,e,n){return Yr("batchToSpaceND")},t.prototype.spaceToBatchND=function(t,e,n){return Yr("spaceToBatchND")},t.prototype.resizeBilinear=function(t,e,n,r){return Yr("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(t,e,n){return Yr("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return Yr("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return Yr("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(t,e,n,r,i,o){return Yr("batchNormalization")},t.prototype.localResponseNormalization4D=function(t,e,n,r,i){return Yr("localResponseNormalization4D")},t.prototype.LRNGrad=function(t,e,n,r,i,o,a){return Yr("LRNGrad")},t.prototype.multinomial=function(t,e,n,r){return Yr("multinomial")},t.prototype.oneHot=function(t,e,n,r){return Yr("oneHot")},t.prototype.cumsum=function(t,e,n,r){return Yr("cumsum")},t.prototype.nonMaxSuppression=function(t,e,n,r,i){return Yr("nonMaxSuppression")},t.prototype.fft=function(t){return Yr("fft")},t.prototype.ifft=function(t){return Yr("ifft")},t.prototype.complex=function(t,e){return Yr("complex")},t.prototype.real=function(t){return Yr("real")},t.prototype.imag=function(t){return Yr("imag")},t.prototype.cropAndResize=function(t,e,n,r,i,o){return Yr("cropAndResize")},t.prototype.depthToSpace=function(t,e,n){return Yr("depthToSpace")},t.prototype.split=function(t,e,n){return Yr("split")},t.prototype.sparseToDense=function(t,e,n,r){return Yr("sparseToDense")},t.prototype.diag=function(t){return Yr("diag")},t.prototype.fill=function(t,e,n){return Yr("fill")},t.prototype.onesLike=function(t){return Yr("onesLike")},t.prototype.zerosLike=function(t){return Yr("zerosLike")},t.prototype.linspace=function(t,e,n){return Yr("linspace")},t.prototype.dispose=function(){return Yr("dispose")},t}();function Yr(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function Jr(t,e){for(var n=t.length,r=[],i=0;i<n;i++){var o=n-1-i,a=t[o]||1;(e[e.length-1-i]||1)>1&&1===a&&r.unshift(o)}return r}function Qr(t,e){for(var n=[],r=0;r<e.length;r++){var i=t[t.length-r-1],o=e.length-r-1,a=e[o];(null==i||1===i&&a>1)&&n.unshift(o)}return n}function Zr(t,e){for(var n=[],r=Math.max(t.length,e.length),i=0;i<r;i++){var o=t[t.length-i-1];null==o&&(o=1);var a=e[e.length-i-1];if(null==a&&(a=1),1===o)n.unshift(a);else if(1===a)n.unshift(o);else{if(o!==a)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(o)}}return n}function ti(t,e,n,r,i,o,a){void 0===a&&(a="channelsLast");var s,u=oi(e),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,t[1],t[1]]}return ni(t,s,n,r,i,o,!1,a)}function ei(t,e,n,r,i,o,a){void 0===a&&(a="NDHWC");var s,u,c=ai(e),l=c[0],h=c[1],f=c[2];if("NDHWC"===a)u="channelsLast",s=[l,h,f,t[4],t[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,h,f,t[1],t[1]]}return ri(t,s,n,r,i,!1,u,o)}function ni(t,e,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3];if("channelsLast"===s)c=t[0],l=t[1],h=t[2],f=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],f=t[1],l=t[2],h=t[3]}var p,d=e[0],m=e[1],v=e[3],g=oi(n),y=g[0],b=g[1],x=oi(r),w=x[0],E=x[1],_=si(d,w),C=si(m,E),A=function(t,e,n,r,i,o,a,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var h=function(t,e,n,r,i){null==r&&(r=ii(t,e,n));var o=t[0],a=t[1],s=ui((o-e+2*r)/n+1,i);S(D(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var u=ui((a-e+2*r)/n+1,i);return S(D(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[s,u]}([e,n],o,r,t,s);c=h[0],l=h[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/i);var f=Math.max(0,(c-1)*r+o-e),p=Math.max(0,(l-1)*i+a-n),d=Math.floor(f/2),m=f-d,v=Math.floor(p/2);u={top:d,bottom:m,left:v,right:p-v,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),l=Math.ceil((n-a+1)/i)}return{padInfo:u,outHeight:c,outWidth:l}}(i,l,h,y,b,_,C,o),k=A.padInfo,T=A.outHeight,I=A.outWidth,P=a?v*f:v;return"channelsFirst"===s?p=[c,P,T,I]:"channelsLast"===s&&(p=[c,T,I,P]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:h,inChannels:f,outHeight:T,outWidth:I,outChannels:P,padInfo:k,strideHeight:y,strideWidth:b,filterHeight:d,filterWidth:m,effectiveFilterHeight:_,effectiveFilterWidth:C,dilationHeight:w,dilationWidth:E,inShape:t,outShape:p,filterShape:e}}function ri(t,e,n,r,i,o,a,s){void 0===o&&(o=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],h=u[2],f=u[3],p=u[4];if("channelsLast"===a)c=t[0],l=t[1],h=t[2],f=t[3],p=t[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=t[0],p=t[1],l=t[2],h=t[3],f=t[4]}var d,m=e[0],v=e[1],g=e[2],y=e[4],b=ai(n),x=b[0],w=b[1],E=b[2],_=ai(r),C=_[0],A=_[1],k=_[2],T=si(m,C),I=si(v,A),P=si(g,k),R=function(t,e,n,r,i,o,a,s,u,c,l){var h,f,p,d;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,i,o){null==i&&(i=ii(t,e,r));var a=t[0],s=t[1],u=t[2],c=ui((a-e+2*i)/r+1,o);S(D(c),(function(){return"The output # of depths ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=ui((s-e+2*i)/r+1,o);S(D(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var h=ui((u-e+2*i)/r+1,o);return S(D(h),(function(){return"The output # of columns ("+h+") must be an integer. Change the stride and/or zero pad parameters"})),[c,l,h,n]}([e,n,r,1],s,1,i,t,l);f=m[0],p=m[1],d=m[2]}else if("same"===t){f=Math.ceil(e/i),p=Math.ceil(n/o),d=Math.ceil(r/a);var v=(f-1)*i+s-e,g=(p-1)*o+u-n,y=(d-1)*a+c-r,b=Math.floor(v/2),x=v-b,w=Math.floor(g/2),E=g-w,_=Math.floor(y/2);h={top:w,bottom:E,left:_,right:y-_,front:b,back:x,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((e-s+1)/i),p=Math.ceil((n-u+1)/o),d=Math.ceil((r-c+1)/a)}return{padInfo:h,outDepth:f,outHeight:p,outWidth:d}}(i,l,h,f,x,w,E,T,I,P,s),M=R.padInfo,F=R.outDepth,O=R.outHeight,N=R.outWidth,L=o?y*p:y;return"channelsFirst"===a?d=[c,L,F,O,N]:"channelsLast"===a&&(d=[c,F,O,N,L]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:h,inWidth:f,inChannels:p,outDepth:F,outHeight:O,outWidth:N,outChannels:L,padInfo:M,strideDepth:x,strideHeight:w,strideWidth:E,filterDepth:m,filterHeight:v,filterWidth:g,effectiveFilterDepth:T,effectiveFilterHeight:I,effectiveFilterWidth:P,dilationDepth:C,dilationHeight:A,dilationWidth:k,inShape:t,outShape:d,filterShape:e}}function ii(t,e,n,r){void 0===r&&(r=1);var i=si(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function oi(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ai(t){return"number"==typeof t?[t,t,t]:t}function si(t,e){return e<=1?t:t+(t-1)*(e-1)}function ui(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function ci(t){var e=oi(t),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function li(t,e){return ci(t)||ci(e)}function hi(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function fi(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=kn(t.shape),i=t.toFloat(),o=n.complex(i,r);return r.dispose(),i.dispose(),o}if(!G(t.dtype,e))return Vt.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var a=n.real(t);return o=a.cast(e),a.dispose(),o}if("int32"===e)return n.int(t);if("bool"===e){var s=yn(0,t.dtype);return o=n.notEqual(t,s),s.dispose(),o}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function pi(t,e){return Vt.makeTensorFromDataId(t.dataId,e,t.dtype)}function di(t,e,n){var r=(e-t)/(n-1),i=rt(n,"float32");i[0]=t;for(var o=1;o<i.length;o++)i[o]=i[o-1]+r;return bn(i,"float32")}Object.freeze({castTensor:fi,reshapeTensor:pi,linspaceImpl:di,upcastType:Dt,axesAreInnerMostDims:en,combineLocations:nn,computeOutAndReduceShapes:rn,expandShapeToKeepDim:on,assertAxesAreInnerMostDims:an,getAxesPermutation:sn,getUndoAxesPermutation:un,getInnerMostAxes:cn,getBroadcastDims:Jr,getReductionAxes:Qr,assertAndGetBroadcastShape:Zr,assertParamsConsistent:ln,computeOutShape:hn,computePool2DInfo:ti,computePool3DInfo:ei,computeConv2DInfo:ni,computeConv3DInfo:ri,computeDefaultPad:ii,tupleValuesAreOne:ci,eitherStridesOrDilationsAreOne:li,convertConv2DDataFormat:hi,PARALLELIZE_THRESHOLD:Rr,computeOptimalWindowSize:Mr});function mi(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function vi(t,e){return{real:t[2*e],imag:t[2*e+1]}}function gi(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function yi(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function bi(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,i=t.length,o=0,a=!1;r<i;){var s=n(e,t[o=r+(i-r>>>1)]);s>0?r=o+1:(i=o,a=!s)}return a?r:-r-1}(t,e,n||xi)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function xi(t,e){return t>e?1:t<e?-1:0}function wi(t,e,n,r,i){return _i(t,e,n,r,i,0).selectedIndices}function Ei(t,e,n,r,i,o){var a=_i(t,e,n,r,i,o,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function _i(t,e,n,r,i,o,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>i})).sort(Ai),c=o>0?-.5/o:0,l=[],h=[];l.length<n&&u.length>0;){var f=u.pop(),p=f.score,d=f.boxIndex,m=f.suppressBeginIndex;if(p<i)break;for(var v=!1,g=l.length-1;g>=m;--g){var y=Ci(t,d,l[g]);if(y>=r){v=!0;break}if(f.score=f.score*Si(r,c,y),f.score<=i)break}f.suppressBeginIndex=l.length,v||(f.score===p?(l.push(d),h.push(f.score)):f.score>i&&bi(u,f,Ai))}var b=l.length;return s&&(l.fill(0,b),h.fill(0,b)),{selectedIndices:bn(l,"int32"),selectedScores:bn(h,"float32"),numValidOutputs:yn(b,"int32")}}function Ci(t,e,n){var r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),h=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),p=(s-o)*(u-a),d=(h-c)*(f-l);if(p<=0||d<=0)return 0;var m=Math.max(o,c),v=Math.max(a,l),g=Math.min(s,h),y=Math.min(u,f),b=Math.max(g-m,0)*Math.max(y-v,0);return b/(p+d-b)}function Si(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Ai(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function ki(t,e,n){var r=new Array(t.rank).fill(0),i=t.shape.slice();return e.map((function(e){i[n]=e;var o=t.slice(r,i);return r[n]+=e,o}))}function Ti(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var i=Jn(n,t.dtype);for(r=0;r<i.values.length;++r){for(var o=i.indexToLoc(r),a=new Array(t.rank),s=0;s<a.length;s++)a[s]=o[s]%t.shape[s];var u=t.locToIndex(a);i.values[r]=t.values[u]}return i.toTensor()}function Ii(t,e,n,r,i){for(var o=e[e.length-1],a=[t.length/o,o],s=a[0],u=a[1],c=V(n,s*r),l=V("int32",s*r),h=0;h<s;h++){for(var f=h*u,p=t.subarray(f,f+u),d=[],m=0;m<p.length;m++)d.push({value:p[m],index:m});d.sort((function(t,e){return e.value-t.value}));var v=h*r,g=c.subarray(v,v+r),y=l.subarray(v,v+r);for(m=0;m<r;m++)g[m]=d[m].value,y[m]=d[m].index}var b=e.slice();return b[b.length-1]=r,[vn(c,b,n),vn(l,b,"int32")]}function Pi(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var i=Jn(t,"int32"),o=Jn([n.length,t.length],"int32");for(r=0;r<n.length;r++){var a=i.indexToLoc(n[r]),s=r*t.length;o.values.set(a,s)}return o.toTensor()}var Di=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Ri=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Mi=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,i=t.batchSize,o=t.inSize,a=Math.ceil(o/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,a];var s="max"===e?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Fi(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function Oi(t,e){return 1===e?[t]:Fi(t,e)}function Ni(){var t,e,n,r,i,o,a,s,u,c;return 2===h().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",i="texture",o="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Li(t,e,n){void 0===n&&(n="index");var r=Z(e);return r.map((function(e,i){return"int "+t[i]+" = "+n+" / "+e+"; "+(i===r.length-1?"int "+t[i+1]+" = "+n+" - "+t[i]+" * "+e:"index -= "+t[i]+" * "+e)+";"})).join("")}function Bi(t){var e=Z(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var Vi="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function zi(t,e,n,r){var i=[];t.forEach((function(t){var e=I(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?i.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(i.push("uniform sampler2D "+t.name+";"),i.push("uniform int offset"+t.name+";"))}));var o,a,s=i.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";r+=n?Wi(t):ji(t);var i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(r+=n?function(t,e){var n,r=t.name,i=r.charAt(0).toUpperCase()+r.slice(1),o="get"+i+"AtOutCoords",a=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=Jr(t.shapeInfo.logicalShape,e.logicalShape),c=Xi(s),l=s-a,h=["x","y","z","w","u","v"];n=0===a?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+h[t+l]+" = 0;"})).join("\n");var f="";f=s<2&&a>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+h[e+l]})).join(", ");var p="return outputValue;",d=1===I(t.shapeInfo.logicalShape),m=1===I(e.logicalShape);if(1!==a||d||m){if(d&&!m)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var v=a-2,g=a-1;u.indexOf(v)>-1&&u.indexOf(g)>-1?p="return vec4(outputValue.x);":u.indexOf(v)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+o+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+i+"("+f+");\n      "+p+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.texShape,a=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&P(a,o))return"\n      float "+i+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=Xi(u),h=Jr(t.shapeInfo.logicalShape,e.logicalShape),f=u-s,p=["x","y","z","w","u","v"];c=0===s?"":u<2&&h.length>=1?"coords = 0;":h.map((function(t){return"coords."+p[t+f]+" = 0;"})).join("\n");var d="";return d=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+p[e+f]})).join(", "),"\n    float "+i+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+d+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=Ni(),h=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),f=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+Gi+"\n    "+Hi+"\n    "+Ui+"\n  "}(l);return e.isPacked?(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(P(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=Math.ceil(n[2]/2),a=o*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+i[0]+", "+i[1]+"));\n      int index = resTexRC.x * "+i[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+o+");\n      int c = imod(index, "+o+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),i=r*Math.ceil(t[t.length-2]/2),o=i,a="",s="b, r, c",u=2;u<t.length-1;u++)o*=t[t.length-u-1],a="\n      int b"+u+" = index / "+o+";\n      index -= b"+u+" * "+o+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+i+";\n      index -= b * "+i+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,i,o,a}(e.logicalShape,c),a=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(o=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return P(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=Li(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=Li(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=Li(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=Li(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),a=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(f+=qi),[f,h,a,s,o,u,n].join("\n")}function ji(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===i&&1===o)return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var a=t.shapeInfo.texShape,s=a[0],u=a[1],c=$i(e);return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+s+", "+u+", "+c+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+Ki(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,i=r[0],o=r[1];if(1===o&&1===i)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var a=$i(e);return 1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+i+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+o+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+i+", "+o+", index + "+a+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape;if(null!=i&&P(e,i)){var o=i[0],a=i[1];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var s=B(e),u=s.newShape,c=s.keptDims,l=u;if(l.length<e.length){var h=Yi(t,l);return"\n      "+ji(h)+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+Ji(["row","col"],c)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+e[1]+", 1)));\n        "+Ki(t)+"\n      }\n    ";var f=i[0],p=i[1],d=$i(n);return 1===p?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===f?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+d+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+p+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+e[1]+" + col + "+d+";\n    vec2 uv = uvFromFlat("+f+", "+p+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[1]*e[2],o=e[2],a=B(e),s=a.newShape,u=a.keptDims,c=s;if(c.length<e.length){var l=Yi(t,c);return"\n        "+ji(l)+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+Ji(["row","col","depth"],u)+");\n        }\n      "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+i+", "+o+", 1)));\n        "+Ki(t)+"\n      }\n    ";var h=t.shapeInfo.texShape,f=h[0],p=h[1],d=t.shapeInfo.flatOffset;if(p===i&&null==d)return"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+o+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+p+".0, "+f+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ";if(p===o&&null==d)return"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+e[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+".0, "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ";var m=$i(n);return"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+i+" + col * "+o+" + depth + "+m+";\n        vec2 uv = uvFromFlat("+f+", "+p+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(t);case 4:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[3],o=e[2]*i,a=e[1]*o,s=B(e),u=s.newShape,c=s.keptDims;if(u.length<e.length){var l=Yi(t,u);return"\n      "+ji(l)+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+Ji(["row","col","depth","depth2"],c)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+o+", "+i+", 1)));\n        "+Ki(t)+"\n      }\n    ";var h=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],d=f[1];if(d===a&&null==h)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+o+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(d===i&&null==h)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+e[1]*e[2]+", "+e[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var m=$i(n);return"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+o+" +\n          depth * "+i+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+d+", index + "+m+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 5:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],o=e[3]*i,a=e[2]*o,s=e[1]*a,u=B(e),c=u.newShape,l=u.keptDims;if(c.length<e.length){var h=Yi(t,c);return"\n      "+ji(h)+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+Ji(["row","col","depth","depth2","depth3"],l)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+a+", "+o+", "+i+")) +\n          depth3;\n        "+Ki(t)+"\n      }\n    ";var f=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,d=p[0],m=p[1];if(m===s&&null==f)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+o+", "+i+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(m===i&&null==f)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]+",\n               "+e[2]*e[3]+", "+e[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var v=$i(n);return"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" + depth * "+o+" +\n          depth2 * "+i+" + depth3 + "+v+";\n      vec2 uv = uvFromFlat("+d+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 6:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=B(e),o=i.newShape,a=i.keptDims;if(o.length<e.length){var s=Yi(t,o);return"\n      "+ji(s)+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+Ji(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    "}var u=e[5],c=e[4]*u,l=e[3]*c,h=e[2]*l,f=e[1]*h;if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+h+", "+l+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+u+", 1)));\n        "+Ki(t)+"\n      }\n    ";var p=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,m=d[0],v=d[1];if(v===f&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+h+", "+l+", "+c+", "+u+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(v===u&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]*e[4]+",\n               "+e[2]*e[3]*e[4]+",\n               "+e[3]*e[4]+",\n               "+e[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var g=$i(n);return"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+h+" + depth * "+l+" +\n          depth2 * "+c+" + depth3 * "+u+" + depth4 + "+g+";\n      vec2 uv = uvFromFlat("+m+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function Wi(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Ni(),"\n    vec4 "+n+"() {\n      return "+r.texture2D+"("+e+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=Ni();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+i[0]+", "+i[1]+", index);\n      return "+o.texture2D+"("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=i[0],a=i[1],s=Ni();if(null!=i&&P(e,i))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+o+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(e[1]/2);return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+c+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===e[0]){var a=e.slice(1),s=Yi(t,a);return"\n        "+Wi(s)+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+Ji(["b","row","col"],[1,2])+");\n        }\n      "}var u=o[0],c=o[1],l=Math.ceil(e[2]/2),h=l*Math.ceil(e[1]/2),f=Ni();return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+h+", "+l+", b, row, col);\n      return "+f.texture2D+"("+n+", uv);\n    }\n  "}(t);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],s=a[0],u=a[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),h="int b, int row, int col",f="b * "+l+" + (row / 2) * "+c+" + (col / 2)",p=2;p<n-1;p++)h="int b"+p+", "+h,l*=e[n-p-1],f="b"+p+" * "+l+" + "+f;var d=Ni();return"\n    vec4 "+i+"("+h+") {\n      int index = "+f+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+d.texture2D+"("+r+", uv);\n    }\n  "}(t)}}var Gi="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Hi="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ui="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",qi="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function $i(t){return"offset"+t}function Ki(t){var e=t.name,n=I(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function Xi(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function Yi(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Ji(t,e){return e.map((function(e){return t[e]})).join(", ")}var Qi=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,S(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var i=t[t.length-1],o=Math.ceil(i/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=Xi(c),h=Oi("coords",c);if(1===o){var f=Xi(s=c+1);a="\n        "+f+" sourceLocR = "+f+"("+h.join()+", 0);\n        ++"+h[c-1]+";\n        "+f+" sourceLocG = "+f+"("+h.join()+", 0);\n        ++"+h[c-2]+";\n        "+f+" sourceLocA = "+f+"("+h.join()+", 0);\n        --"+h[c-1]+";\n        "+f+" sourceLocB = "+f+"("+h.join()+", 0);\n        --"+h[c-2]+";"}else s=c,a="\n        "+l+" sourceLocR = coords;\n        ++"+h[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+h[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+h[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+h[c-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),d="."+p[s-1],m=p.map((function(t){return"int "+t})),v=Oi("sourceLocR",s-1).concat("inIdx.r"),g=Oi("sourceLocG",s-1).concat("inIdx.g"),y=Oi("sourceLocB",s-1).concat("inIdx.b"),b=Oi("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+v.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",E="vec4(\n            getAChannel("+v.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",_=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+_+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+h[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+h[c-2]+" < "+(u[c-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+E+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+E+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Zi=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,h=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+h+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+o+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+a+") {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},to=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=l-1-t.padInfo.front,d=h-1-t.padInfo.top,m=f-1-t.padInfo.left,v=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3("+p+", "+d+", "+m+");\n      const float avgMultiplier = float("+v+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+i+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+h+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+o+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},eo=function(t,e,n,r,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Zr(t,e),Zr(t,n);var a="0.0";null!=r&&(Zr(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=i&&(Zr(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+o+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},no=function(t,e,n,r,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Zr(t,e),Zr(t,n);var a="vec4(0.0)";null!=r&&(Zr(t,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(Zr(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+o+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},ro="return areal * breal - aimag * bimag;",io="return areal * bimag + aimag * breal;",oo=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Zr(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},ao="return a + b;",so="return a - b;",uo="return a * b;",co="return (a < 0.) ? b * a : a;",lo=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Zr(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},ho="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",fo=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Zr(e,n);var i=this.outputShape.length,o="";if(r)if(0===i||1===I(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o="\n          "+Xi(i)+" coords = getOutputCoords();\n        ",1===i)o+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=Oi("coords",i);o+="\n            bool nextRowOutOfBounds =\n              ("+a[i-2]+" + 1) >= "+this.outputShape[i-2]+";\n            bool nextColOutOfBounds =\n              ("+a[i-1]+" + 1) >= "+this.outputShape[i-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+o+"\n\n        setOutput(result);\n      }\n    "},po=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),mo=function(){function t(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,i){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(i,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(i,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),vo=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},go=function(t){this.outputShape=[],this.outputShape=hn(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var i=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+i+"));")}var o=e.length,a=e[e.length-1];r.push("else setOutput(getT"+o+"(yR, yC-"+a+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},yo=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=hn(t,e);var n=this.outputShape,r=n.length,i=Xi(r),o=Oi("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=a[e],l=a.slice(-2),h=a.join(),f="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+h+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var p=s[u-1];f+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+bo(a,c,p)+"),\n            vec2("+bo(l,c,p)+"));\n        }"}var d=s.length,m=s[s.length-1];f+="\n        return getChannel(\n          getT"+d+"("+bo(a,c,m)+"),\n          vec2("+bo(l,c,m)+"));",this.userCode="\n      float getValue("+a.map((function(t){return"int "+t}))+") {\n        "+f+"\n      }\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+o+"), 0., 0., 0.);\n\n        "+o[r-1]+" = "+o[r-1]+" + 1;\n        if ("+o[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+o+");\n        }\n\n        "+o[r-2]+" = "+o[r-2]+" + 1;\n        if ("+o[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+o+");\n        }\n\n        "+o[r-1]+" = "+o[r-1]+" - 1;\n        if ("+o[r-2]+" < "+n[r-2]+" &&\n            "+o[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+o+");\n        }\n        setOutput(result);\n      }\n    "};function bo(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var xo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+o+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},wo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,a=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=o?1:2,c=o?2:3,l=o?3:1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+o+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Eo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,a=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+e+" - "+i+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+o+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+a+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},_o=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+i+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+o+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Co=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+o+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+i+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},So=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,i=t.strideWidth,o=e-1-t.padInfo.top,a=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+i+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ao=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,a=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,h=t.filterWidth,f=4*Math.floor(t.inChannels/4),p=t.inChannels%4,d="channelsLast"===t.dataFormat,m=d?1:2,v=d?2:3,g=d?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+v+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+h+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+f+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+d+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===p)+") {\n\n              if ("+d+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+f+") *\n                    getW(wR, wC, "+f+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+f+", xR, xC) *\n                    getW(wR, wC, "+f+", d2);\n              }\n\n            } else if ("+(2===p)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2)\n              );\n\n              if ("+d+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===p)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+f+", d2),\n                getW(wR, wC, "+f+" + 1, d2),\n                getW(wR, wC, "+f+" + 2, d2)\n              );\n\n              if ("+d+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+f+"),\n                  getX(batch, xR, xC, "+f+" + 1),\n                  getX(batch, xR, xC, "+f+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+f+", xR, xC),\n                  getX(batch, "+f+" + 1, xR, xC),\n                  getX(batch, "+f+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},ko=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,h=t.filterHeight,f=t.filterWidth,p=4*Math.floor(t.inChannels/4),d=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===d)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+p+") *\n                  getW(wF, wR, wC, "+p+", d2);\n              } else if ("+(2===d)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===d)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1),\n                  getX(batch, xF, xR, xC, "+p+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2),\n                  getW(wF, wR, wC, "+p+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},To=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,d=t.outChannels/t.inChannels,m="",v="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",v="result = activation(result);");var g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+d+";\n        int q = d2 - d1 * "+d+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+f+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+i+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+h+";\n\n            if (xC < 0 || xC >= "+o+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+v+"\n        setOutput(result);\n      }\n    "},Io=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var i=t.inHeight,o=t.inWidth,a=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,h=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,d=p,m="int xR; int xC; int xCOffset;",v=0;v<f;v++)for(var g=0;g<p;g++)m+="\n          vec4 xTexelR"+v+"C"+2*g+" = vec4(0.);\n          vec4 wR"+v+"C"+g+" = vec4(0.);\n          vec4 xR"+v+"C"+g+" = vec4(0.);";for(v=0;v<f;v++)for(var y=0;y<d;y++){if(m+="\n          xR = xRCorner + "+v*l+";\n          xC = xCCorner + "+(g=2*y)*h+";\n        ",1===c){if(g<p&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+o+") {\n                    xTexelR"+v+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+i+" && xCOffset >= 0 && xCOffset < "+o+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+o+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+v+"C"+g+" = vec4(previous.zw, xTexelR"+v+"C"+g+".xy);\n                } else {\n                  xR"+v+"C"+g+" = vec4(0, 0, xTexelR"+v+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+i+" && xC >= 0 && xC < "+o+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = xTexelR"+v+"C"+g+";\n              ",g+1<p)){var b=s%2==0?_(h):h;h%2==0&&s%2==1||h%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",h>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+i+" &&\n                      xCOffset >= 0 && xCOffset < "+o+") {\n                      xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+v+"C"+g+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+i+" &&\n                    xCOffset >= 0 && xCOffset < "+o+") {\n                    xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+v+"C"+(g+1)+" = xTexelR"+v+"C"+(g+2)+";\n                "}}else g<p&&(m+="\n              if(xR >= 0 && xR < "+i+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+o+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n              ",g+1<p&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+o+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+v+"C"+(g+1)+" = vec4(xTexelR"+v+"C"+(g+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+o+") {\n                  xTexelR"+v+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+v+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+o+") {\n                  xTexelR"+v+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+v+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+v+"C"+g+" = vec4(\n                  xTexelR"+v+"C"+g+".xy, xTexelR"+v+"C"+(g+2)+".xy);\n              ",g+1<p&&(m+="\n                  xR"+v+"C"+(g+1)+" = vec4(\n                    xTexelR"+v+"C"+g+".zw, xTexelR"+v+"C"+(g+2)+".zw);\n                ")),m+="}");g<p&&(m+="\n            vec4 wTexelR"+v+"C"+g+" = getW("+v+", "+g+", d1, q);\n            wR"+v+"C"+g+" = vec4(wTexelR"+v+"C"+g+".xz, wTexelR"+v+"C"+g+".xz);\n          ",g+1<p&&(m+="\n              vec4 wTexelR"+v+"C"+(g+1)+" = getW("+v+", "+(g+1)+", d1, q);\n              wR"+v+"C"+(g+1)+" =\n                vec4(wTexelR"+v+"C"+(g+1)+".xz, wTexelR"+v+"C"+(g+1)+".xz);"))}for(v=0;v<f;v++)for(g=0;g<p;g++)m+="dotProd += xR"+v+"C"+g+" * wR"+v+"C"+g+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var E=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+E+"\n        "+w+"\n        setOutput(result);\n      }\n    "},Po=function(t,e,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=t[0],a=t[1],s=t[2],u=t[3],c=e[0],l=n[0],h=n[1];this.outputShape=[c,l,h,u];var f="bilinear"===r?1:0,p=[a-1+".0",s-1+".0"],d=p[0],m=p[1],v=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+d+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+d],g=v[0],y=v[1],b=v[2],x=h>1?[""+(s-1)/(h-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=x[0],E=x[1],_=x[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+o+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+E+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+d+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n        float in_x = "+_+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+i+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+f+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Do=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,i=t[t.length-1],o=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+i+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+Xi(r)+" coords = getOutputCoords();\n        int end = "+Ro(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+i+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+o+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+Ro(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Ro(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var Mo=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Wt.DENSE;var e=Yt(t),n=Ni();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Li(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},Fo=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Wt.DENSE;var e=Yt(t),n=Ni();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Li(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},Oo=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),No=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Lo=function(t){this.variableNames=["A"],this.outTexUsage=Gt.DOWNLOAD;var e=Ni();this.outputShape=t,this.userCode="\n      "+Vi+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},Bo=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Gt.DOWNLOAD;var e=Ni();this.outputShape=t,this.userCode="\n      "+Vi+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},Vo=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Ni(),i=e[0],o=e[1];this.outputShape=t;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Bi(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+o+";\n        int c = imod(flatIndex, "+o+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},zo=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ni(),i=e[0],o=e[1];this.outputShape=t;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+o+";\n              c = imod(flatIndex, "+o+");\n              uv = (vec2(c, r) + halfCR) / vec2("+o+".0, "+i+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Bi(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},jo="return real * expR - imag * expI;",Wo="return real * expI + imag * expR;",Go=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var i=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,o=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+i+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+o+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},Ho=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),Uo=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var i=Xi(this.rank),o=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=0;o<t.length;o++)o===e?i.push("int(getIndices("+r[o]+"))"):i.push(""+r[o]);return i.join()}(t,n);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},qo=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=Xi(e.length),i=Xi(n.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+i+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+o+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function $o(t,e){var n=Ni();return oe(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function Ko(t,e){return pe(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function Xo(t,e){return de(t,e,new Uint16Array([0,1,2,2,1,3]))}function Yo(t,e,n,r,i,o,a){ve(n,r);var s=me(t,e),u=t.TEXTURE_2D;return Zt(t,e,(function(){return t.bindTexture(u,s)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),Zt(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),Zt(t,e,(function(){return t.texImage2D(u,0,i,n,r,0,o,a,null)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function Jo(t,e,n,r,i){var o=Xt(n,r);return Yo(t,e,o[0],o[1],i.internalFormatFloat,i.textureFormatFloat,t.FLOAT)}function Qo(t,e,n,r,i){var o=Xt(n,r);return Yo(t,e,o[0],o[1],i.internalFormatHalfFloat,i.textureFormatFloat,i.textureTypeHalfFloat)}function Zo(t,e,n,r,i){var o=Xt(n,r);return Yo(t,e,o[0],o[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function ta(t,e,n,r,i){var o=Jt(n,r);return Yo(t,e,o[0],o[1],i.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function ea(t,e,n,r,i){var o=Jt(n,r);return Yo(t,e,o[0],o[1],i.internalFormatPackedHalfFloat,t.RGBA,i.textureTypeHalfFloat)}function na(t,e,n,r){return Zt(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),ye(t,e,n,"clipSpacePos",r,3,20,0)&&ye(t,e,n,"uv",r,2,20,12)}function ra(t,e,n,r,i,o,a){var s,u,c;Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),o instanceof Uint8Array?(s=new Uint8Array(r*i*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*i*4),u=t.FLOAT,c=a.internalFormatPackedFloat),s.set(o),Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,i,0,t.RGBA,u,s)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function ia(t,e,n,r){Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):Zt(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),Zt(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function oa(t,e,n,r,i){var o=t.createBuffer();Zt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,o)}));var a=16*n*r;return Zt(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)})),Zt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),Zt(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),o}function aa(t,e,n){var r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function sa(t,e,n,r,i){var o=Xt(n,r),a=o[0],s=o[1],u=new Uint8Array(n*r*4);return Zt(t,e,(function(){return t.readPixels(0,0,a,s,i.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function ua(t,e,n,r,i,o,a,s){var u=t,c=new Float32Array(function(t,e){var n=Jt(t,e);return n[0]*n[1]*4}(o,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function ca(t,e,n,r){var i=new Float32Array(n*r*4);return Zt(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,i)})),i}var la=Object.freeze({createVertexShader:$o,createVertexBuffer:Ko,createIndexBuffer:Xo,createFloat32MatrixTexture:Jo,createFloat16MatrixTexture:Qo,createUnsignedBytesMatrixTexture:Zo,createPackedMatrixTexture:ta,createFloat16PackedMatrixTexture:ea,bindVertexProgramAttributeStreams:na,uploadDenseMatrixToTexture:ra,uploadPixelDataToTexture:ia,createBufferFromOutputTexture:oa,downloadFloat32MatrixFromBuffer:aa,downloadByteEncodedFloatMatrixFromOutputTexture:sa,downloadPackedMatrixFromBuffer:ua,downloadMatrixFromPackedOutputTexture:ca}),ha=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=h().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,$t(e,t)):this.gl=Kt(e);var n="WEBGL_color_buffer_float";if(1===h().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=ie(this.gl,this.debug,"OES_texture_float"),Be(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ie(this.gl,this.debug,"OES_texture_half_float");else if(h().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Be(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ie(this.gl,this.debug,"EXT_color_buffer_half_float");else if(h().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Be(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Be(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=Ko(this.gl,this.debug),this.indexBuffer=Xo(this.gl,this.debug),this.framebuffer=ge(this.gl,this.debug),this.textureConfig=Qt(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return h().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;Zt(e,this.debug,(function(){return e.finish()})),Zt(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),Zt(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),Zt(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),Zt(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),Zt(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),Jo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),Qo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),Zo(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),ia(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),ra(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ea(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),ta(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Ce(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Zt(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return sa(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,i,o){return ua(this.gl,t,0,0,0,i,o,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return aa(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=oa(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(h().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,o=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=i.clientWaitSync(o,0,0);return t===i.ALREADY_SIGNALED||t===i.CONDITION_SATISFIED},e=o}else h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return ca(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=ae(e,this.debug,t),r=$o(e,this.debug),i=le(e,this.debug);return Zt(e,this.debug,(function(){return e.attachShader(i,r)})),Zt(e,this.debug,(function(){return e.attachShader(i,n)})),he(e,this.debug,i),this.debug&&fe(e,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=na(e,this.debug,this.program,this.vertexBuffer)),i},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&Zt(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&fe(this.gl,this.debug,this.program),Zt(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?xe(this.gl,this.debug,t,e):we(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Ee(this.gl,this.debug,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=Jt(e,n),i=r[0],o=r[1];this.setOutputMatrixTextureDriver(t,i,o)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&fe(this.gl,this.debug,this.program),Se(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),Zt(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=ie(this.gl,this.debug,2===h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),i=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,i),i},t.prototype.endQuery=function(){if(2!==h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(n){switch(n.label){case 0:return[4,O((function(){return e.disposed||e.isQueryAvailable(t,h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),i=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length;++e)if(!t[e]())break;return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||O((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),_e(this.gl,this.debug,t,this.framebuffer),this.debug&&Se(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(_e(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Se(this.gl)):Ce(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;_e(r,this.debug,t,this.framebuffer),this.debug&&Se(r),this.outputTexture=t,Zt(r,this.debug,(function(){return r.viewport(0,0,e,n)})),Zt(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var i=this;this.throwIfDisposed(),Zt(this.gl,this.debug,(function(){return i.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function fa(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,i=e[n],o=i.shape;if(!P(r,o))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+o+" must match");if(!t.isUniform||!i.isUniform){var a=t.texShape,s=i.isUniform?null:i.texData.texShape;if(!P(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var pa=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,i=n.inChannels,o=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,h=n.dataFormat,f=s.left,p=s.top,d=i*r,m=Ni(),v="channelsLast"===h,g=v?0:1,y=v?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+p+";\n            d0 = offsetY + "+l+" * (pos / "+d+");\n\n            if(d0 < "+e[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+o+". - "+f+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+d+".) / "+i+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+i+".));\n\n                if ("+v+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+m.output+" = result;\n      }\n    "},da=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[];var o,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";o=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+o+";\n        setOutput(val);\n      }\n    "},ma=function(t,e,n,r,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+i+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+i+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},va=function(t,e,n,r,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,a=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";o=.5===i?"inversesqrt("+u+")":1===i?"1.0/("+u+")":"exp(log("+u+") * float(-"+i+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+o+";\n        setOutput(result);\n      }\n    "},ga=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,a=i-1-t.padInfo.top,s=o-1-t.padInfo.left,u=i*o-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+i+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+e+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+o+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+o+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ya=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,h=u-1-t.padInfo.top,f=c-1-t.padInfo.left,p=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+h+", "+f+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+i+") {\n          float dyD = float(dyDCorner + wD) / "+e+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+o+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+a+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+p+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ba=function(t,e,n,r,i,o,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",h=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",d="";o&&(p=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+o+"\n        }":"vec4 activation(vec4 x) {\n          "+o+"\n        }",d="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+h[0]+" * "+f[0]+");\n          result += ("+h[1]+" * "+f[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},xa=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),wa=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Ea=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Oi("rc",e),r=Xi(e),i=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",i=t-2;i<t;i++)r+=n[i]+" >= "+e[i],i<t-1&&(r+="||");return r}(e,t,n),o=function(t,e,n,r){if(1===t)return"";var i=r.slice(-2);return"\n    int r = "+i[0]+";\n    int c = "+i[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),a=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var i=0;i<=1;i++){for(var o=(0===r?"r":"rp1")+", "+(0===i?"c":"cp1"),a=2;a<t;a++)o=e[e.length-1-a]+","+o;n.push(o)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+i+") {\n            setOutput(vec4(0));\n          } else {\n            "+o+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},_a=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,i=Xi(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+i+" start = "+i+"("+o+");\n      "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+i+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+o+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Ca=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,i=Xi(r),o=e.map((function(t){return t[0]})).join(","),a=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Oi("rc",r),u=Oi("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",h=[i+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],f=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",d=0,m=1===r?2:4;d<m;d++)p+="\n        "+h[d]+"\n        if ("+f+") {\n          result["+d+"] = float("+n+");\n        } else {\n          "+i+" source = rc - start;\n          result["+d+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";p+=1===r?"} ":"}}",this.userCode="\n      const "+i+" start = "+i+"("+o+");\n      const "+i+" end = "+i+"("+a+");\n\n      void main() {\n        "+i+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+p+"\n        setOutput(result);\n      }\n    "},Sa=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideHeight,o=t.strideWidth,a=t.dilationHeight,s=t.dilationWidth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,p="0.0";if(f||(p="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+i+", "+o+");\n        const ivec2 pads = ivec2("+l+", "+h+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var d=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(d="avgValue / count");var m=4*Math.floor(r/4),v=r%4,g="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+i+", "+o+");\n      const ivec2 pads = ivec2("+l+", "+h+");\n      const float initializationValue = "+p+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+p+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+m+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+m+";\n          if ("+(1===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===v)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+d+");\n      }\n    "}},Aa=function(t,e,n){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var r=t.filterWidth,i=t.strideDepth,o=t.strideHeight,a=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=t.padInfo.front,d=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===e,g="0.0";if(v||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+i+", "+o+", "+a+");\n        const ivec3 pads = ivec3("+p+", "+d+", "+m+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+h+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+h+" * "+f+" +\n                      wR * "+f+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var b=4*Math.floor(r/4),x=r%4,w="\n      if ("+v+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+i+", "+o+", "+a+");\n      const ivec3 pads = ivec3("+p+", "+d+", "+m+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+h+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+w+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(2===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+w+"\n            } else if ("+(3===x)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+w+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},ka=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=Math.ceil(i/n);this.outputShape=[r,o];var a="0.0",s="";"prod"===e?a="1.0":"min"===e?(a="1.0 / 1e-20",s="min"):"max"===e&&(a="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,h="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",f="vec4";"all"===e?(a="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",f="bvec4"):"any"===e&&(a="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",f="bvec4");var p="";i%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+p+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+h+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(2===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+h+"\n        } else if ("+(3===l)+") {\n          "+f+" values = "+f+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+h+"\n        }\n        setOutput("+u+");\n      }\n    "},Ta=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var i="thisRC = rc;";r%2==1&&(i+="thisRC.z += 1;"),r>1&&(i+="thisRC.y += 1;"),n+="\n        "+i+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Li(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Bi(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Ia=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],p=1/h,d=1/f,m=2*Math.ceil(p)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(i-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(o-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Pa=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?o-1:o,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Da=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?o-1:o,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+o+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Ra=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,i=r[1],o=r[2],a=t.shape,s=a[1],u=a[2],c=[n&&s>1?i-1:i,n&&u>1?o-1:o],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],h=c[0]/l[0],f=c[1]/l[1],p=1/h,d=1/f,m=2*Math.ceil(p)+2,v=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+h+");\n        const float widthScale = float("+f+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+v+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Ma=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var i=t[0],o=t[1],a=t[2],s=t[3];this.outputShape=[i,e,n,s];var u=[r&&e>1?o-1:o,r&&n>1?a-1:a],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+o+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Fa=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),i=Xi(n);this.userCode="\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},Oa=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Oi("rc",n),i=r[n-1]+" + 1 < "+this.outputShape[n-1],o=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Xi(n);function s(n){var r=t.map((function(r,i){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(i,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+i+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+i+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+o+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+i+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},Na=function(t,e,n,r,i,o,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Xi(i.length),u=Xi(o.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",h="";1===r?h="i":2===r&&(h="i, coords[1]");var f="getUpdates("+h+")",p=e>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+i+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+p+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+f+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},La=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,i=t.inSize,o=t.numSegments,a=o*Math.ceil(i/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";i%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return initializationValue;\n        }\n      ");var h="";i%n>0&&(h="\n        if (inIdx < 0 || inIdx >= "+i+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+h+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+o+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+o+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},Ba=function(t,e,n){var r,i;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)i="resRC",r="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<e.length;u++)s.push(""+o[u]),u<t&&a.push(""+o[u]);r=a.join(),i=s.join()}var c=Xi(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+i+"));\n        } else {\n          setOutput(getB("+i+"));\n        }\n      }\n    "},Va=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=Xi(this.rank),r="uniform int start["+this.rank+"];",i=function(t){if(1===t)return"sourceLoc";if(t<=6)return za.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+za[e]+" = start["+e+"] + coords."+za[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+i+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),za=["x","y","z","w","u","v"],ja=function(){function t(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=Xi(this.rank),n=Oi("coords",this.rank),r=Oi("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",o="getChannel(getSource("+r.join()+"), "+i+")",a="\n      result.x = "+o+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+o+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+o+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+o+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),Wa=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,i=Xi(n.length),o=Xi(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+i+" begin = "+i+"("+t+");\n      "+i+" strides = "+i+"("+e+");\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},Ga=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,i=Ha(e,n),o=Ua(t,i,n);if(o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]),this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[o].shift();return this.usedTextures[o].push(a),a}return this.numUsedTextures++,this.log(),i===Ht.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Ht.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Ht.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Ht.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Ht.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[o].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var i=Ua(e,Ha(n,r),r);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var o=this.usedTextures[i],a=o.indexOf(t);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");o.splice(a,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function Ha(t,e){if(t===Gt.UPLOAD)return Ht.PACKED_2X2_FLOAT32;if(t===Gt.RENDER||null==t)return function(t){return h().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Ht.PACKED_2X2_FLOAT32:Ht.UNPACKED_FLOAT32:t?Ht.PACKED_2X2_FLOAT16:Ht.UNPACKED_FLOAT16}(e);if(t===Gt.DOWNLOAD||t===Gt.PIXELS)return Ht.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function Ua(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var qa=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var i=Xi(this.rank),o=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],i=0;i<t.length;i++)r.push("imod("+n[i]+", "+t[i]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+i+" resRC = getOutputCoords();\n        setOutput(getA("+o+"));\n      }\n    "},$a=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var i=Xi(this.rank),o=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}(e);this.userCode="\n    void main() {\n      "+i+" resRC = getOutputCoords();\n      setOutput(getA("+o+"));\n    }\n    "},Ka=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var i=Xi(this.rank),o=Fi("rc",this.rank),a=new Array(this.rank);for(r=0;r<e.length;r++)a[e[r]]=o[r];var s="vec2("+a.slice(-2).join()+")",u="++"+o[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+i+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+o[this.rank-1]+";\n      if(++"+o[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},Xa=1.7580993408473768,Ya=1.0507009873554805,Ja=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Qa="if (isnan(x)) return x;",Za="return x;",ts="return abs(x);",es=Qa+"\n  return (x < 0.0) ? 0.0 : x;\n",ns=Qa+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",rs="return (x >= 0.0) ? x : (exp(x) - 1.0);",is="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+Xa+";\n  float scale = "+Ya+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",os="return -x;",as="return ceil(x);",ss="return floor(x);",us="return exp(x);",cs="return exp(x) - 1.0;",ls=Qa+"\n  return sin(x);\n",hs=Qa+"\n  return cos(x);\n",fs=Qa+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",ps=Qa+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",ds=Qa+"\n  return atan(x);\n",ms=Qa+"return log(x + sqrt(x * x + 1.0));",vs=Qa+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",gs=Qa+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",ys="return x;",bs="return x;",xs="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ws="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Es="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",_s=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Cs=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=Oi("rc",e),r=Xi(e),i=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),o=n.slice(-2),a=e<=1?"rc":"vec2("+o.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+i+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},Ss={};function As(t,e){if(void 0===e&&(e=!1),"linear"===t)return e?bs:Za;if("relu"===t)return e?xs:es;if("elu"===t)return e?Es:rs;if("relu6"===t)return e?ws:ns;if("prelu"===t)return e?ho:co;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var ks=600,Ts=function(t){function e(e){var n,r=t.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!h().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=Kt(h().getNumber("WEBGL_VERSION"));r.binaryCache=((n=h().getNumber("WEBGL_VERSION"))in Ss||(Ss[n]={}),Ss[n]),r.gpgpu=new ha(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new Ga(r.gpgpu),r.numMBBeforeWarning=null==h().global.screen?1024:h().global.screen.height*h().global.screen.width*window.devicePixelRatio*ks/1024/1024,r.texData=new Kr(r,Vt),r}return a(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,e,n){if(h().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:Gt.UPLOAD}),r},e.prototype.move=function(t,e,n,r){if(h().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:Gt.UPLOAD})},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,i=e.complexTensors,o=e.slice,a=e.shape,s=e.isPacked;if(null!=o){var u=void 0;u=s?new _s(a,ys):new Ja(a,ys);var c=this.runWebGLProgram(u,[{dataId:t,shape:a,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var h,f,p=null!=this.activeTimers;return p&&(h=it()),f="complex64"===r?mi(i.real.dataSync(),i.imag.dataSync()):this.getValuesFromTexture(t),p&&(this.downloadWaitMs+=it()-h),this.convertAndCacheOnCPU(t,f)},e.prototype.read=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,c,l,f,p,d,m,v,g,y,b,x,w,E,_,C;return u(this,(function(u){switch(u.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,i=n.shape,o=n.slice,a=n.dtype,s=n.complexTensors,c=n.isPacked,null!=o)return l=void 0,l=c?new _s(i,ys):new Ja(i,ys),f=this.runWebGLProgram(l,[{dataId:t,shape:i,dtype:a}],a),p=this.read(f.dataId),this.disposeData(f.dataId),[2,p];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!h().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===h().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return d=null,"complex64"!==a&&h().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(t),v=this.texData.get(m.dataId),d=(C=this.gpgpu).createBufferFromTexture.apply(C,[v.texture].concat(Yt(i)))),this.pendingRead.set(t,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:u.sent(),u.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=u.sent(),b=y[0],x=y[1],g=mi(b,x),[3,5];case 4:null==d?g=this.getValuesFromTexture(t):(w=I(i),g=this.gpgpu.downloadFloat32MatrixFromBuffer(d,w)),u.label=5;case 5:return null!=m&&this.disposeData(m.dataId),E=this.convertAndCacheOnCPU(t,g),_=this.pendingRead.get(t),this.pendingRead.delete(t),_.forEach((function(t){return t(E)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,E]}}))}))},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!ne(n)){if(h().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.isPacked,a=I(r);if(h().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(t),u=this.texData.get(s.dataId),c=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[u.texture].concat(Yt(r))).subarray(0,a);return this.disposeData(s.dataId),c}var l=h().getBool("WEBGL_PACK")&&!0===o,f=l?De(r):r,p=l?new Bo(f):new Lo(f),d=this.runWebGLProgram(p,[{shape:f,dtype:i,dataId:t}],"float32"),m=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,a);return this.disposeData(d.dataId),v},e.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return u(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),i=T(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),o=T(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(i)]:[3,2];case 1:return s=u.sent(),a.kernelMs=C(s),a.getExtraProfileInfo=function(){return s.map((function(t,e){return{name:o[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},[3,3];case 2:a.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:it(),endMs:null}},e.prototype.endTimer=function(t){return h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=it(),t)},e.prototype.getQueryTime=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return h().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,i=e.texShape,o=e.usage,a=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,o,a)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return h().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Vt.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&t.size<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Vt.keep(t.clone()),imag:Vt.keep(e.clone())},n},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===I(n))return vn([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,i=Wr(t.shape,e,n);if(r||!i){var o=h().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ja(n):new Va(n),a=o.getCustomSetupFunc(e);return this.compileAndRun(o,[t],null,a)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},e.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),i=this.makeOutput(n,t.dtype),o=this.texData.get(i.dataId);Object.assign(o,r),o.shape=n,o.dtype=t.dtype;var a=Gr(e,t.strides);r.slice&&(a+=r.slice.flatOffset),o.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,s+1),i},e.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var i=Vr(e,n,r);if(i.some((function(t){return 0===t})))return vn([],i);var o=new Wa(e,r,i);return this.compileAndRun(o,[t])},e.prototype.reverse=function(t,e){var n=h().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Oa(t.shape,e):new Fa(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return dn(t)})),r=t.map((function(t){return mn(t)}));return pn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>h().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(t.length/2),o=this.concat(t.slice(0,i),e),a=this.concat(t.slice(i),e);return this.concat([o,a],e)}if(h().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new yo(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var u=hn(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,I(t.shape.slice(e)))})),l=new go(c.map((function(t){return t.shape})));return this.compileAndRun(l,c).reshape(u)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,os,t.dtype);var e=new Ja(t.shape,os);return this.compileAndRun(e,[t])},e.prototype.batchMatMul=function(t,e,n,r){var i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],a=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===i||1===o)&&a>1e3){n&&(t=t.transpose([0,2,1])),r&&(e=e.transpose([0,2,1]));var u=1===o?t:t.as3D(s,a,1),c=1===o?2:1,l=1===o?e.as3D(s,1,a):e;return this.multiply(u,l).sum(c,!0)}var h=Dt(t.dtype,e.dtype),f=new ba(t.shape,[s,i,o],n,r);return this.compileAndRun(f,[t,e],h)},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,o=t.bias,a=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=i?n.shape[1]:n.shape[2],l=e.shape[0],h=Dt(e.dtype,n.dtype),f=null!=o,p=null!=s,d=a?As(a,!0):null,m=new ba(e.shape,[l,u,c],r,i,f,d,p),v=[e,n];return o&&v.push(o),s&&v.push(s),this.compileAndRun(m,v,h)},e.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),i=new oo(ro,t.shape,e.shape),o=new oo(io,t.shape,e.shape),a=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(i,a),u=this.compileAndRun(o,a),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,uo,t.dtype);var l=new lo(uo,t.shape,e.shape);return this.compileAndRun(l,[t,e],t.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,o){var a=[t,e,n],s=null;null!=o&&(s=o.shape,a.push(o));var u=null;if(null!=i&&(u=i.shape,a.push(i)),h().getBool("WEBGL_PACK_NORMALIZATION")){var c=new no(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(c,a)}var l=new eo(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,a)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){var o=h().getBool("WEBGL_PACK_NORMALIZATION")?new va(t.shape,e,n,r,i):new da(t.shape,e,n,r,i);return this.compileAndRun(o,[t])},e.prototype.LRNGrad=function(t,e,n,r,i,o,a){var s=new ma(e.shape,r,i,o,a);return this.compileAndRun(s,[e,n,t])},e.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return st(t)}));return Ti(Jn(t.shape,t.dtype,n),e)}var r=new qa(t.shape,e);return this.compileAndRun(r,[t])},e.prototype.pad=function(t,e,n){var r=h().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ca(t.shape,e,n):new _a(t.shape,e,n);return this.compileAndRun(r,[t])},e.prototype.transpose=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.transpose(t,e);var n=h().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ka(t.shape,e):new $a(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new Uo(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},e.prototype.batchToSpaceND=function(t,e,n){S(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=Ar(t.shape,e,r),o=kr(i.length,e.length),a=Tr(t.shape,e,r),s=Ir(n,e.length),u=Pr(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){S(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=Ar(a.shape,e,r,!1),u=kr(s.length,e.length,!1),c=Tr(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},e.prototype.reduce=function(t,e,n){var r=t.shape[0],i=t.shape[1],o=Mr(i),a=new ka({windowSize:o,inSize:i,batchSize:r},e),s=this.compileAndRun(a,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},e.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],i=t.shape[1];null!=n&&(r=n.shape[0],i=n.shape[1]);var o=Mr(i),a=new Mi({windowSize:o,inSize:i,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(a,s,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)},e.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,i=Mr(r[r.length-1]),o=new Qi(r,i,e,null==n),a=null==n?[t]:[t,n],s=this.compileAndRun(o,a,"int32");return s.rank===t.rank?this.argReducePacked(t,e,s):s},e.prototype.sum=function(t,e){an("sum",e,t.rank);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i),a=Rt(t.dtype);return this.reduce(o,"sum",a).reshape(r)},e.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i),a=Rt(t.dtype);return this.reduce(o,"prod",a).reshape(r)},e.prototype.unsortedSegmentSum=function(t,e,n){var r=0,i=sn([r],t.rank),o=t;null!=i&&(o=t.transpose(i),r=cn(1,t.rank)[0]);var a=function(t,e,n){for(var r=[],i=t.length,o=0;o<i;o++)o!==e?r.push(t[o]):r.push(n);return r}(o.shape,r,n),s=I([o.shape[r]]),u=o.as2D(-1,s),c=Rt(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(a);return null!=i&&(l=l.transpose(un(i))),l},e.prototype.segOpCompute=function(t,e,n,r,i){var o=t.shape[0],a=t.shape[1],s=function(t,e){var n,r=!1;for(t<=Rr?(n=t,r=!0):n=Q(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=Q(t,n+1);return n}(a,i),u=new La({windowSize:s,inSize:a,batchSize:o,numSegments:i},e),c=this.compileAndRun(u,[t,n],r);return c.shape[1]===i?c:(n=Pn(0,i).tile([a/s]),this.segOpCompute(c,e,n,r,i))},e.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(an("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!h().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var i=rn(t.shape,r),o=i[0],a=I(i[1]),s=t.as2D(-1,a);return this.argReduce(s,n).reshape(o)}return this.argReducePacked(t,n)},e.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},e.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},e.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var i=new Do(t.shape,n,r);return this.compileAndRun(i,[t])},e.prototype.equal=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new lo("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.notEqual=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new lo("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new lo("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.lessEqual=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new lo("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new lo("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greaterEqual=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new lo("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalNot=function(t){var e=new Ja(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},e.prototype.logicalAnd=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new lo("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalOr=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new lo("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.select=function(t,e,n){var r=new Ba(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],Dt(e.dtype,n.dtype))},e.prototype.where=function(t){Ye("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return Pi(t.shape,e)},e.prototype.topk=function(t,e,n){return Ii(t.dataSync(),t.shape,t.dtype,e)},e.prototype.min=function(t,e){an("min",e,t.rank);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)},e.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new lo("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.mod=function(t,e){var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new lo("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);an("max",e,t.rank);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i);return this.reduce(o,"max",o.dtype).reshape(r)},e.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new lo("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.all=function(t,e){an("all",e,t.rank);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)},e.prototype.any=function(t,e){an("any",e,t.rank);var n=rn(t.shape,e),r=n[0],i=I(n[1]),o=t.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)},e.prototype.realDivide=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new lo("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",t.shape,e.shape);return this.compileAndRun(n,[t,e],"float32")},e.prototype.floorDiv=function(t,e){if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new lo("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")},e.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,ao);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Dt(t.dtype,e.dtype);if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,ao,n);var r=new lo(ao,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.packedUnaryOp=function(t,e,n){var r=new _s(t.shape,e);return this.compileAndRun(r,[t],n)},e.prototype.packedBinaryOp=function(t,e,n,r,i){void 0===i&&(i=!1);var o=new fo(n,t.shape,e.shape,i);return this.compileAndRun(o,[t,e],r)},e.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,i=this.texData.get(t.dataId),o=this.texData.get(e.dataId),a=[[i.complexTensors.real,o.complexTensors.real],[i.complexTensors.imag,o.complexTensors.imag]].map((function(i){var o=i[0],a=i[1],s=r.makeComplexComponentTensorInfo(t,o),u=r.makeComplexComponentTensorInfo(e,a),c=new lo(n,t.shape,e.shape);return r.compileAndRun(c,[s,u],Dt(o.dtype,a.dtype))})),s=a[0],u=a[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},e.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},e.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>h().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var i=t.map((function(t){return t.dtype})).reduce((function(t,e){return Dt(t,e)})),o=t.map((function(t){return t.shape})),a=h().getBool("WEBGL_PACK")?new Ri(t[0].shape,o):new Di(t[0].shape,o);return this.compileAndRun(a,t,i)},e.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,so);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Dt(t.dtype,e.dtype);if(h().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,so,t.dtype);var r=new lo(so,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.pow=function(t,e){var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new lo("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=Dt(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,as,t.dtype);var e=new Ja(t.shape,as);return this.compileAndRun(e,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ss,t.dtype);var e=new Ja(t.shape,ss);return this.compileAndRun(e,[t])},e.prototype.sign=function(t){var e=new Ja(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},e.prototype.isNaN=function(t){var e=new Ja(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isInf=function(t){var e=new Ja(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isFinite=function(t){var e=new Ja(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.round=function(t){var e=new Ja(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,us,t.dtype);var e=new Ja(t.shape,us);return this.compileAndRun(e,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,cs,t.dtype);var e=new Ja(t.shape,cs);return this.compileAndRun(e,[t])},e.prototype.softmax=function(t,e){var n=L([e],t.shape),r=this.max(t,n),i=on(r.shape,n),o=this.subtract(t,r.reshape(i)),a=this.exp(o),s=this.sum(a,n).reshape(i);return this.realDivide(a,s)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new Ja(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},e.prototype.log1p=function(t){var e=new Ja(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},e.prototype.sqrt=function(t){var e=new Ja(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new Ja(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},e.prototype.reciprocal=function(t){var e=new Ja(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},e.prototype.relu=function(t){var e;return e=h().getBool("WEBGL_PACK")?new _s(t.shape,xs):new Ja(t.shape,es),this.compileAndRun(e,[t])},e.prototype.relu6=function(t){var e;return e=h().getBool("WEBGL_PACK")?new _s(t.shape,ws):new Ja(t.shape,ns),this.compileAndRun(e,[t])},e.prototype.prelu=function(t,e){var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo(ho,t.shape,e.shape):new lo(co,t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.elu=function(t){if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Es,t.dtype);var e=new Ja(t.shape,rs);return this.compileAndRun(e,[t])},e.prototype.eluDer=function(t,e){var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new lo("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.selu=function(t){var e=new Ja(t.shape,is);return this.compileAndRun(e,[t])},e.prototype.int=function(t){var e=new Ja(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")},e.prototype.clip=function(t,e,n){var r,i=(r=h().getBool("WEBGL_PACK_CLIP")?new mo(t.shape):new po(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,i)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(h().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ts,t.dtype);var e=new Ja(t.shape,ts);return this.compileAndRun(e,[t])},e.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new vo(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(t){var e=new Ja(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},e.prototype.softplus=function(t){var e=new Ja(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},e.prototype.sin=function(t){var e=new Ja(t.shape,ls);return this.compileAndRun(e,[t])},e.prototype.cos=function(t){var e=new Ja(t.shape,hs);return this.compileAndRun(e,[t])},e.prototype.tan=function(t){var e=new Ja(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},e.prototype.asin=function(t){var e=new Ja(t.shape,fs);return this.compileAndRun(e,[t])},e.prototype.acos=function(t){var e=new Ja(t.shape,ps);return this.compileAndRun(e,[t])},e.prototype.atan=function(t){var e=new Ja(t.shape,ds);return this.compileAndRun(e,[t])},e.prototype.atan2=function(t,e){var n=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new lo("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.sinh=function(t){var e=new Ja(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.cosh=function(t){var e=new Ja(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.tanh=function(t){var e=new Ja(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},e.prototype.asinh=function(t){var e=new Ja(t.shape,ms);return this.compileAndRun(e,[t])},e.prototype.acosh=function(t){var e=new Ja(t.shape,vs);return this.compileAndRun(e,[t])},e.prototype.atanh=function(t){var e=new Ja(t.shape,gs);return this.compileAndRun(e,[t])},e.prototype.erf=function(t){var e=new Ja(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},e.prototype.step=function(t,e){var n=new Ja(t.shape,function(t){return void 0===t&&(t=0),Qa+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},e.prototype.conv2dByMatMul=function(t,e,n,r,i,o){var a=t.shape,s=this.texData.get(t.dataId),u=n.inChannels,c=a[0]*a[1]*a[2],l=n.outChannels,f="channelsLast"===n.dataFormat,p=(1===c||1===l)&&u>1e3,d=a[2]%2!=0&&!!s.isPacked;if(p||!h().getBool("WEBGL_LAZILY_UNPACK")||!h().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var m=f?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],v=this.reshape(t,[1,m,n.inChannels]),g=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:g,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),n.outShape)}var y=f?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),b={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},x=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,S(Fe(s.shape,b.shape),(function(){return"packed reshape "+s.shape+" to "+b.shape+" isn't free"}));var w=this.reshape(e,[1,n.inChannels,n.outChannels]),E=this.fusedBatchMatMul({a:b,b:w,transposeA:!1,transposeB:!1,bias:r,activation:i,preluActivationWeights:o}),_=this.texData.get(E.dataId);return S(_.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=x,_.shape=n.outShape,Vt.makeTensorFromDataId(E.dataId,n.outShape,E.dtype)},e.prototype.conv2dWithIm2Row=function(t,e,n,r,i,o){var a=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,h="channelsLast"===n.dataFormat,f=a*s*u,p=l*c,d=[f,p],m=t.squeeze([0]),v=e.reshape([1,f,-1]),g=new pa(d,m.shape,n),y=this.compileAndRun(g,[m]).reshape([1,d[0],d[1]]),b=null!=r,x=null!=o,w=i?As(i,!0):null,E=new ba(y.shape,[1,p,n.outChannels],!0,!1,b,w,x),_=[y,v];r&&_.push(r),x&&_.push(o);var C=this.compileAndRun(E,_);return h?C.reshape([1,l,c,n.outChannels]):C.reshape([1,n.outChannels,l,c])},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,o=t.activation,a=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,i,o,a);if(h().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,i,o,a);var s=null!=i,u=null!=a,c=o?As(o,!1):null,l=new Ao(r,s,c,u),f=[e,n];return i&&f.push(i),a&&f.push(a),this.compileAndRun(l,f)},e.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(h().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new Ao(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerInput=function(t,e,n){var r=new wo(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerFilter=function(t,e,n){var r=new xo(n);return this.compileAndRun(r,[t,e])},e.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,i=t.convInfo,o=t.bias,a=t.activation,s=t.preluActivationWeights,u=h().getBool("WEBGL_PACK_DEPTHWISECONV")&&i.strideWidth<=2&&i.outChannels/i.inChannels==1,c=a?As(a,u):null,l=[n,r],f=null!=o,p=null!=s;return f&&l.push(o),p&&l.push(s),u?(e=new Io(i,f,c,p),this.compileAndRun(e,l)):(e=new To(i,f,c,p),this.compileAndRun(e,l))},e.prototype.depthwiseConv2D=function(t,e,n){var r;return h().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Io(n),this.compileAndRun(r,[t,e])):(r=new To(n),this.compileAndRun(r,[t,e]))},e.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new So(n);return this.compileAndRun(r,[t,e])},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Co(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3d=function(t,e,n){var r=new ko(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerInput=function(t,e,n){var r=new _o(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerFilter=function(t,e,n){var r=new Eo(n);return this.compileAndRun(r,[t,e])},e.prototype.maxPool=function(t,e){var n=new Sa(e,"max",!1);return this.compileAndRun(n,[t])},e.prototype.avgPool=function(t,e){var n=new Sa(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPoolBackprop=function(t,e,n,r){var i=new Sa(r,"max",!0),o=this.compileAndRun(i,[e]),a=new ga(r),s=this.compileAndRun(a,[t,o],e.dtype);return o.dispose(),s},e.prototype.avgPoolBackprop=function(t,e,n){var r=new Zi(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.cast=function(t,e){return fi(t,e,this)},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},e.prototype.avgPool3d=function(t,e){var n=new Aa(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,e,n){var r=new to(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.maxPool3d=function(t,e){var n=new Aa(e,"max",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,e,n,r){var i=new Aa(r,"max",!0),o=this.compileAndRun(i,[e]),a=new ya(r),s=this.compileAndRun(a,[t,o],e.dtype);return o.dispose(),s},e.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!Fe(t.shape,e)&&(null===n.texture||!Fe(n.shape,e))){var r=this.packedReshape(t,e);return Vt.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return pi(t,e)},e.prototype.resizeBilinear=function(t,e,n,r){var i=h().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Da(t.shape,e,n,r):new Pa(t.shape,e,n,r);return this.compileAndRun(i,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,e,n){var r=new Ia(t,e,n);return this.compileAndRun(r,[t])},e.prototype.resizeNearestNeighbor=function(t,e,n,r){var i=new Ma(t.shape,e,n,r);return this.compileAndRun(i,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new Ra(t,e,n);return this.compileAndRun(r,[t])},e.prototype.multinomial=function(t,e,n,r){var i=e?t:qr(t),o=i.shape[0],a=i.shape[1],s=new xa(o,a,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[i],"int32",u)},e.prototype.oneHot=function(t,e,n,r){var i=new wa(t.size,e,n,r);return this.compileAndRun(i,[t])},e.prototype.diag=function(t){var e=new No(t.size);return this.compileAndRun(e,[t])},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return Ye("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),wi(t.dataSync(),e.dataSync(),n,r,i)},e.prototype.cropAndResize=function(t,e,n,r,i,o){var a=new Po(t.shape,e.shape,r,i,o);return this.compileAndRun(a,[t,e,n],"float32")},e.prototype.depthToSpace=function(t,e,n){S(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],i="NHWC"===n?t.shape[1]:t.shape[2],o="NHWC"===n?t.shape[2]:t.shape[3],a="NHWC"===n?t.shape[3]:t.shape[1],s=i*e,u=o*e,c=a/(e*e),l=new Oo("NHWC"===n?[r,s,u,c]:[r,c,s,u],e,n);return this.compileAndRun(l,[t])},e.prototype.split=function(t,e,n){return ki(t,e,n)},e.prototype.scatterND=function(t,e,n){var r=Nr(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/a,a],l=t.reshape([o,i]),h=e.reshape([o,a]);if(0===u)return pi(vn([]),n);var f=yn(0),p=new Na(o,i,l.rank,h.rank,s,c);return this.compileAndRun(p,[h,l,f]).reshape(n)},e.prototype.sparseToDense=function(t,e,n,r){var i=Nr(0,t,n),o=i.sliceRank,a=i.numUpdates,s=i.strides,u=i.outputSize,c=new Na(a,o,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(c,[e,t,r]).reshape(n)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new Go(jo,t.shape,e),i=new Go(Wo,t.shape,e),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],a=this.compileAndRun(r,o),s=this.compileAndRun(i,o),u=this.complex(a,s).as2D(t.shape[0],t.shape[1]);return a.dispose(),s.dispose(),u},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Dr(t,e),o=i[0],a=i[1],s=i[2],u=i[3],c=e.reshape([a,r]),l=t.reshape([t.size/s,s]),h=new qo(r,u,[a,s]);return this.compileAndRun(h,[l,c]).reshape(o)},e.prototype.fill=function(t,e,n){if("string"===(n=n||Y(e))){var r=z(n,I(t));return r.fill(e),Vt.makeTensor(r,t,n,this)}var i=new Ho(t,e),o=i.getCustomSetupFunc(e);return this.compileAndRun(i,[],n,o)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},e.prototype.linspace=function(t,e,n){return di(t,e,n)},e.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Vt.makeTensorFromDataId(n,t,e,this)},e.prototype.unpackTensor=function(t){var e=new Cs(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new Ea(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=[Ie(t.shape)].concat(Pe(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},i=[Ie(e)].concat(Pe(e)),o=new Ta(i,n),a=this.runWebGLProgram(o,[r],t.dtype,null,!0);return{dataId:a.dataId,shape:e,dtype:a.dtype}},e.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,i=n.shape,o=n.dtype,a=De(i);return e=r?new Fo(a):new Mo(a),{dtype:o,shape:i,dataId:this.runWebGLProgram(e,[{shape:a,dtype:o,dataId:t}],o,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,e,n,r,i){var o=this;void 0===i&&(i=!1);var a=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(a.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===Wt.DENSE){var u=Yt(t.outputShape);s.texShape=u.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===I(a.shape))return s.values=V(a.dtype,0),a;var c=[],l=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=o.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&I(e.shape)<=h().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?o.unpackTensor(e):o.packTensor(e),c.push(e),n=o.texData.get(e.dataId);else if(n.isPacked&&!Fe(n.shape,e.shape)){var r=e,i=e.shape;e.shape=n.shape,e=o.packedReshape(e,i),c.push(e),n=o.texData.get(e.dataId),r.shape=i}return o.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);var f,p={shape:a.shape,texData:s,isUniform:!1},d=function(t,e,n){var r="";e.concat(n).forEach((function(t){var e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;r+=t.shape+"_"+n+"_"+e}));var i=t.userCode,o=t.constructor.name;return o+"_"+r+"_"+i}(t,l,p),m=this.getAndSaveBinary(d,(function(){return function(t,e,n,r){var i=e.userCode,o=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),a=o.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=zi(o,s,i,e.packedInputs),c=t.createProgram(u),l=null,f=t.getUniformLocation(c,"NAN",!1);1===h().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var p={},d=0;d<e.variableNames.length;d++){var m=e.variableNames[d];p[m]=t.getUniformLocation(c,m,!1),p["offset"+m]=t.getUniformLocation(c,"offset"+m,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:p,inShapeInfos:a,outShapeInfo:s,infLoc:l,nanLoc:f}}(o.gpgpu,t,l,p)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(t,e,n,r,i){fa(e.inShapeInfos,n),fa([e.outShapeInfo],[r]);var o=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o,a[0],a[1]):t.setOutputMatrixTexture(o,a[0],a[1]),t.setProgram(e.webGLProgram),1===h().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var i=e.program.variableNames[r],o=e.uniformLocations[i],a=e.uniformLocations["offset"+i];if(null!=o)if(n.isUniform)if(I(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(o,s)}else null!=n.texData.slice&&null!=a&&t.gl.uniform1i(a,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,o,r)})),null!=i&&i(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,m,l,p,r),c.forEach((function(t){return o.disposeData(t.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(f)})),!h().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var g=this.unpackTensor(a);return this.disposeData(a.dataId),g}return a},e.prototype.compileAndRun=function(t,e,n,r,i){void 0===i&&(i=!1),n=n||e[0].dtype;var o=this.runWebGLProgram(t,e,n,r,i);return Vt.makeTensorFromDataId(o.dataId,o.shape,o.dtype)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(h().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=$e((function(){if(!h().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=h().getBool("DEBUG");h().set("DEBUG",!1);var n=t.abs(yn(1e-8)).dataSync()[0];if(h().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,i=n.dtype,o=n.values,a=n.texture,s=n.usage,u=n.isPacked;if(null==a){var c,l=null!=this.activeTimers;l&&(c=it());var h=n.texShape;if(null==h&&(h=Re(r,u),n.texShape=h),null!=o){var f=De(r),p=void 0,d=h[1],m=h[0],v=o instanceof Uint8Array;u?(d=(e=Jt(h[0],h[1]))[0],m=e[1],p=new zo(f,[m,d],v)):p=new Vo(f,[m,d],v);var g=this.makeTensorInfo([m,d],i);this.texData.get(g.dataId).usage=v?Gt.PIXELS:Gt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,m,o);var y=this.runWebGLProgram(p,[g],i,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=it()-c)}else{var x=this.acquireTexture(h,s,i,u);n.texture=x}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+i+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*U(e)},e}(Xr);zt()&&Vt.registerBackend("webgl",(function(){return new Ts}),2);var Is=fn({square_:function(t){var e=Ze(t,"x","square"),n=[e];return Vt.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,"Square",{},n,[])}}),Ps="SquaredDifference",Ds=fn({squaredDifference_:function(t,e){var n,r=Ze(t,"a","squaredDifference"),i=Ze(e,"b","squaredDifference");n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape);var o={a:r,b:i},a=[r,i];return Vt.runKernelFunc((function(t,e){var n=t.squaredDifference(r,i);return e([r,i]),n}),o,(function(t,e){var n=e[0],r=e[1],i=yn(2);return{a:function(){return t.mul(n.sub(r).mul(i))},b:function(){return t.mul(r.sub(n).mul(i))}}}),Ps,{},a,[])}}),Rs=fn({abs_:function(t){var e=Ze(t,"x","abs");return"complex64"===e.dtype?Vt.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Vt.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),Ms=fn({acos_:function(t){var e=Ze(t,"x","acos");return Vt.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(yn(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Fs=fn({acosh_:function(t){var e=Ze(t,"x","acosh");return Vt.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Os=fn({asin_:function(t){var e=Ze(t,"x","asin");return Vt.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(yn(1).sub(n.toFloat().square()).sqrt())}}}))}}),Ns=fn({asinh_:function(t){var e=Ze(t,"x","asinh");return Vt.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(yn(1).add(n.toFloat().square()).sqrt())}}}))}}),Ls=fn({atan_:function(t){var e=Ze(t,"x","atan");return Vt.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),Bs=fn({atanh_:function(t){var e=Ze(t,"x","atanh");return Vt.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(yn(1).sub(n.toFloat().square()))}}}))}}),Vs=fn({ceil_:function(t){var e=Ze(t,"x","ceil");return Vt.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),zs=fn({clipByValue_:function(t,e,n){var r=Ze(t,"x","clipByValue");S(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."}));var i=[r],o={min:e,max:n};return Vt.runKernelFunc((function(t,i){var o=t.clip(r,e,n);return i([r]),o}),{x:r},(function(t,r){var i=r[0];return{x:function(){return t.where(i.greaterEqual(e).logicalAnd(i.lessEqual(n)),Rn(t))}}}),"ClipByValue",o,i)}}),js=fn({cos_:function(t){var e=Ze(t,"x","cos"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),"Cos",{},n)}}),Ws=fn({cosh_:function(t){var e=Ze(t,"x","cosh");return Vt.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),Gs=fn({erf_:function(t){var e=Ze(t,"x","erf");return S("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Vt.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Hs=fn({exp_:function(t){var e=Ze(t,"x","exp");return Vt.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mulStrict(e[0])}}}),"Exp",{},[],[!0])}}),Us=fn({expm1_:function(t){var e=Ze(t,"x","expm1");return Vt.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),qs=fn({floor_:function(t){var e=Ze(t,"x","floor");return Vt.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),$s=fn({log_:function(t){var e=Ze(t,"x","log"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.toFloat())}}}),"Log",{},n)}}),Ks=fn({log1p_:function(t){var e=Ze(t,"x","log1p");return Vt.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),Xs=fn({logSigmoid_:function(t){var e=Ze(t,"x","logSigmoid");return Vt.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),Ys=fn({neg_:function(t){var e=Ze(t,"x","neg"),n=[e];return Vt.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),"Neg",{},n)}}),Js=fn({reciprocal_:function(t){var e=Ze(t,"x","reciprocal");return Vt.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),Qs=fn({round_:function(t){var e=Ze(t,"x","round");return Vt.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),Zs=fn({rsqrt_:function(t){var e=Ze(t,"x","rsqrt"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),tu=fn({sigmoid_:function(t){var e=Ze(t,"x","sigmoid");return Vt.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(yn(1).sub(n)))}}}),"Sigmoid")}}),eu=fn({sign_:function(t){var e=Ze(t,"x","sign");return Vt.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),nu=fn({isNaN_:function(t){var e=Ze(t,"x","isNaN");return Vt.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),ru=fn({isInf_:function(t){var e=Ze(t,"x","isInf");return Vt.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),iu=fn({isFinite_:function(t){var e=Ze(t,"x","isFinite");return Vt.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Rn(t)}}}))}}),ou=fn({sin_:function(t){var e=Ze(t,"x","sin"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),"Sin",{},n)}}),au=fn({sinh_:function(t){var e=Ze(t,"x","sinh");return Vt.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),su=fn({softplus_:function(t){var e=Ze(t,"x","softplus");return Vt.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),uu=fn({sqrt_:function(t){var e=Ze(t,"x","sqrt");return Vt.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),cu=fn({step_:function(t,e){void 0===e&&(e=0);var n=Ze(t,"x","step");return Vt.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Rn(t)}}}))}}),lu=fn({tan_:function(t){var e=Ze(t,"x","tan");return Vt.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),hu=fn({tanh_:function(t){var e=Ze(t,"x","tanh");return Vt.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return yn(1).sub(n.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}});function fu(t,e,n,r,i,o){var a,s,u=Ze(t,"x","batchNorm"),c=Ze(e,"mean","batchNorm"),l=Ze(n,"variance","batchNorm");return null!=i&&(a=Ze(i,"scale","batchNorm")),null!=r&&(s=Ze(r,"offset","batchNorm")),S(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),S(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),S(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=a&&S(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&S(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),mu(u,c,l,s,a,o)}function pu(t,e,n,r,i,o){var a,s,u=Ze(t,"x","batchNorm"),c=Ze(e,"mean","batchNorm"),l=Ze(n,"variance","batchNorm");return null!=i&&(a=Ze(i,"scale","batchNorm")),null!=r&&(s=Ze(r,"offset","batchNorm")),S(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),S(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),S(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=a&&S(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&S(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),mu(u,c,l,s,a,o)}function du(t,e,n,r,i,o){var a,s,u=Ze(t,"x","batchNorm"),c=Ze(e,"mean","batchNorm"),l=Ze(n,"variance","batchNorm");return null!=i&&(a=Ze(i,"scale","batchNorm")),null!=r&&(s=Ze(r,"offset","batchNorm")),S(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),S(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),S(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=a&&S(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&S(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),mu(u,c,l,s,a,o)}function mu(t,e,n,r,i,o){null==o&&(o=.001);var a,s,u,c=Ze(t,"x","batchNorm"),l=Ze(e,"mean","batchNorm"),h=Ze(n,"variance","batchNorm");null!=i&&(a=Ze(i,"scale","batchNorm")),null!=r&&(s=Ze(r,"offset","batchNorm")),S(l.rank===h.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),S(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),S(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var f=[c,l,h,a];return Vt.runKernelFunc((function(t,e){var n=t.batchNormalization(u,vu(l),vu(h),o,vu(a),vu(s));return e([c,l,h,a]),n}),{x:c,mean:l,variance:h,scale:a,offset:s},(function(t,e){var n=e,r=n[0],i=n[1],a=n[2],s=n[3],c=null==s?yn(1):s,l=Qr(i.shape,u.shape),h=[];if(1===i.rank){for(var f=0;f<u.shape.length-1;++f)h.push(u.shape[f]);h.push(1)}var p=r.sub(i),d=t.mul(c),m=Zs(a.add(yn(o))),v=m.mul(m).mul(m).mul(yn(-.5));return{x:function(){return 1===i.rank?t.mul(Er(m.as4D(1,1,1,i.shape[0]),h)).mul(c).reshape(r.shape):t.mul(m).mul(c).reshape(r.shape)},mean:function(){var t=m.mul(yn(-1)).mul(d);return 1===i.rank&&(t=t.sum(l)),t.reshape(i.shape)},variance:function(){var t=v.mul(p).mul(d);return 1===i.rank&&(t=t.sum(l)),t.reshape(i.shape)},scale:function(){var e=p.mul(m),n=t.mul(e);return 1===i.rank&&(n=n.sum(l)),n.reshape(i.shape)},offset:function(){var e=t;return 1===i.rank&&(e=e.sum(l)),e.reshape(i.shape)}}}),"BatchNormalization",{varianceEpsilon:o},f).reshape(c.shape)}function vu(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function gu(){qe("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var yu=fn({batchNormalization2d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),gu(),fu(t,e,n,o,i,r)}}),bu=fn({batchNormalization3d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),gu(),pu(t,e,n,o,i,r)}}),xu=fn({batchNormalization4d_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),gu(),du(t,e,n,o,i,r)}}),wu=fn({batchNormalization_:function(t,e,n,r,i,o){return void 0===r&&(r=.001),gu(),mu(t,e,n,o,i,r)}}),Eu=fn({batchNorm_:mu}),_u=fn({batchNorm2d_:fu}),Cu=fn({batchNorm3d_:pu}),Su=fn({batchNorm4d_:du}),Au=fn({logicalAnd_:function(t,e){var n=Ze(t,"a","logicalAnd","bool"),r=Ze(e,"b","logicalAnd","bool");return Zr(n.shape,r.shape),Vt.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),ku=fn({logicalNot_:function(t){var e=Ze(t,"x","logicalNot","bool");return Vt.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),Tu=fn({logicalOr_:function(t,e){var n=Ze(t,"a","logicalOr","bool"),r=Ze(e,"b","logicalOr","bool");return Zr(n.shape,r.shape),Vt.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),Iu=fn({logicalXor_:function(t,e){var n=Ze(t,"a","logicalXor","bool"),r=Ze(e,"b","logicalXor","bool");return Zr(n.shape,r.shape),Tu(t,e).logicalAnd(Au(t,e).logicalNot())}}),Pu=fn({where_:function(t,e,n){var r=Ze(e,"a","where"),i=Ze(n,"b","where"),o=Ze(t,"condition","where","bool");return A(r.shape,i.shape,"Error in where: "),1===o.rank?S(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):A(o.shape,i.shape,"Error in where: "),Vt.runKernelFunc((function(t,e){var n=t.select(o,r,i);return e([o]),n}),{$condition:o,$a:r,$b:i},(function(t,e){var n=e[0];return{$condition:function(){return Rn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),Du=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){switch(i.label){case 0:return[4,(e=Ze(t,"condition","whereAsync","bool")).data()];case 1:return n=i.sent(),r=Pi(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},Ru=fn({add_:function(t,e){var n,r=Ze(t,"a","add"),i=Ze(e,"b","add");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t){return t.add(r,i)}),{a:r,b:i},(function(t){return{a:function(){var e=t,n=Qr(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=Qr(i.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(i.shape)}}}),"Add")}}),Mu=fn({addN_:function(t){S(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),S(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return Ze(t,"tensors"+e,"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!P(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Vt.runKernelFunc((function(t){return t.addN(e)}),r,(function(t){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}),"AddN")}}),Fu=fn({addStrict_:function(t,e){var n=Ze(t,"a","addStrict"),r=Ze(e,"b","addStrict");return A(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Ou=fn({atan2_:function(t,e){var n,r=Ze(t,"a","atan2"),i=Ze(e,"b","atan2");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t,e){var n=t.atan2(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Ru(n.square(),r.square()),i=t.mul(r.div(e)),a=Qr(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},$b:function(){var e=Ru(n.square(),r.square()),i=Ys(t.mul(n.div(e))),a=Qr(r.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(r.shape)}}}))}}),Nu=fn({div_:function(t,e){var n,r=Ze(t,"a","div"),i=Ze(e,"b","div");if(n=Mt(r,i),r=n[0],i=n[1],"int32"===r.dtype&&"int32"===i.dtype)return Vu(r,i);var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t,e){var n=t.realDivide(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),i=Qr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=Qr(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}),"Div")}}),Lu=fn({divNoNan_:function(t,e){var n,r=Ze(t,"a","div"),i=Ze(e,"b","div");r=(n=Mt(r,i))[0],i=n[1];var o=Nu(r,i),a=Rn(o),s=i.equal(a);return Pu(s,a,o)}}),Bu=fn({divStrict_:function(t,e){var n=Ze(t,"a","div"),r=Ze(e,"b","div");return A(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Vu=fn({floorDiv_:function(t,e){var n,r=Ze(t,"a","floorDiv"),i=Ze(e,"b","floorDiv");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t,e){var n=t.floorDiv(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),i=Qr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=Qr(r.shape,o);i.length>0&&(e=e.sum(i).reshape(r.shape));var a=r.square();return e.div(a.toFloat()).neg()}}}),"FloorDiv")}}),zu=fn({maximum_:function(t,e){var n,r=Ze(t,"a","maximum"),i=Ze(e,"b","maximum");return n=Mt(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),Zr(r.shape,i.shape),Vt.runKernelFunc((function(t,e){var n=t.maximum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.greaterEqual(r).toFloat())},b:function(){return t.mul(n.less(r).toFloat())}}}),"Maximum")}}),ju=fn({maximumStrict_:function(t,e){var n=Ze(t,"a","maximumStrict"),r=Ze(e,"b","maximumStrict");return A(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Wu=fn({minimum_:function(t,e){var n,r=Ze(t,"a","minimum"),i=Ze(e,"b","minimum");return n=Mt(r,i),r=n[0],i=n[1],"bool"===r.dtype&&(r=r.toInt(),i=i.toInt()),Zr(r.shape,i.shape),Vt.runKernelFunc((function(t,e){var n=t.minimum(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.lessEqual(r).toFloat())},b:function(){return t.mul(n.greater(r).toFloat())}}}),"Minimum")}}),Gu=fn({minimumStrict_:function(t,e){var n=Ze(t,"a","minimumStrict"),r=Ze(e,"b","minimumStrict");return A(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Hu=fn({mod_:function(t,e){var n,r=Ze(t,"a","mod"),i=Ze(e,"b","mod");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t,e){var n=t.mod(r,i);return e([r,i]),n}),{$a:r,$b:i},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Qr(n.shape,o);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),i=Qr(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}))}}),Uu=fn({modStrict_:function(t,e){var n=Ze(t,"a","modStrict"),r=Ze(e,"b","modStrict");return A(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),qu=fn({mul_:function(t,e){var n,r=Ze(t,"a","mul"),i=Ze(e,"b","mul");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t,e){var n=t.multiply(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),i=Qr(n.shape,o);return i.length>0?e.sum(i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=Qr(r.shape,o);return i.length>0?e.sum(i).reshape(r.shape):e}}}),"Mul")}}),$u=fn({mulStrict_:function(t,e){var n=Ze(t,"a","mul"),r=Ze(e,"b","mul");return A(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Ku=fn({pow_:function(t,e){var n,r=Ze(t,"base","pow"),i=Ze(e,"exp","pow");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape),a=[r,i];return Vt.runKernelFunc((function(t,e){var n=t.pow(r,i);return e([r,i,n]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1],i=e[2];return{a:function(){var e=r.toFloat(),i=t.mul(e.mul(n.pow(e.sub(yn(1))))),a=Qr(n.shape,o);return a.length>0&&(i=i.sum(a)),i.reshape(n.shape)},b:function(){var e=n.greater(0),a=n.log().where(e,Rn(n)),s=t.mul(i.mul(a)),u=Qr(r.shape,o);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},a,[!0])}}),Xu=fn({powStrict_:function(t,e){return A(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Yu=fn({squaredDifferenceStrict_:function(t,e){var n=Ze(t,"a","squaredDifferenceStrict"),r=Ze(e,"b","squaredDifferenceStrict");return A(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),Ju=fn({sub_:function(t,e){var n,r=Ze(t,"a","sub"),i=Ze(e,"b","sub");n=Mt(r,i),r=n[0],i=n[1];var o=Zr(r.shape,i.shape);return Vt.runKernelFunc((function(t){return t.subtract(r,i)}),{a:r,b:i},(function(t){return{a:function(){var e=t,n=Qr(r.shape,o);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=Qr(i.shape,o);return n.length>0&&(e=e.sum(n)),e.neg().reshape(i.shape)}}}),"Sub")}}),Qu=fn({subStrict_:function(t,e){var n=Ze(t,"a","subStrict"),r=Ze(e,"b","subStrict");return A(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Zu=fn({equal_:function(t,e){var n,r=Ze(t,"a","equal"),i=Ze(e,"b","equal");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t){return t.equal(r,i)}),{$a:r,$b:i})}}),tc=fn({equalStrict_:function(t,e){var n=Ze(t,"a","equalStrict"),r=Ze(e,"b","equalStrict");return A(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),ec=fn({greater_:function(t,e){var n,r=Ze(t,"a","greater"),i=Ze(e,"b","greater");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t){return t.greater(r,i)}),{a:r,b:i},null,"Greater")}}),nc=fn({greaterEqual_:function(t,e){var n,r=Ze(t,"a","greaterEqual"),i=Ze(e,"b","greaterEqual");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t,e){var n=t.greaterEqual(r,i);return e([r,i]),n}),{a:r,b:i},(function(t,e){var n=e[0],r=e[1];return{a:function(){return Rn(n)},b:function(){return Rn(r)}}}),"GreaterEqual")}}),rc=fn({greaterEqualStrict_:function(t,e){var n=Ze(t,"a","greaterEqualStrict"),r=Ze(e,"b","greaterEqualStrict");return A(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),ic=fn({greaterStrict_:function(t,e){var n=Ze(t,"a","greaterStrict"),r=Ze(e,"b","greaterStrict");return A(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),oc=fn({less_:function(t,e){var n,r=Ze(t,"a","less"),i=Ze(e,"b","less");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t){return t.less(r,i)}),{a:r,b:i},null,"Less")}}),ac=fn({lessEqual_:function(t,e){var n,r=Ze(t,"a","lessEqual"),i=Ze(e,"b","lessEqual");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t,e){var n=t.lessEqual(r,i);return e([r,i]),n}),{a:r,b:i},null,"LessEqual")}}),sc=fn({lessEqualStrict_:function(t,e){var n=Ze(t,"a","lessEqualStrict"),r=Ze(e,"b","lessEqualStrict");return A(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),uc=fn({lessStrict_:function(t,e){var n=Ze(t,"a","lessStrict"),r=Ze(e,"b","lessStrict");return A(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),cc=fn({notEqual_:function(t,e){var n,r=Ze(t,"a","notEqual"),i=Ze(e,"b","notEqual");return n=Mt(r,i),r=n[0],i=n[1],Zr(r.shape,i.shape),Vt.runKernelFunc((function(t){return t.notEqual(r,i)}),{a:r,b:i},null,"NotEqual")}}),lc=fn({notEqualStrict_:function(t,e){var n=Ze(t,"a","notEqualStrict"),r=Ze(e,"b","notEqualStrict");return A(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function hc(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function fc(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var pc=fn({gather_:function(t,e,n){void 0===n&&(n=0);var r=Ze(t,"x","gather"),i=Ze(e,"indices","gather","int32");n=L(n,r.shape)[0];var o=function(t,e,n){for(var r=t.shape[n],i=[],o=1,a=1,s=0;s<n;s++)i.push(t.shape[s]),o*=t.shape[s];for(s=0;s<e.rank;s++)i.push(e.shape[s]);for(s=n+1;s<t.rank;s++)i.push(t.shape[s]),a*=t.shape[s];return{batchSize:o,sliceSize:a,dimSize:r,outputShape:i}}(r,i,n);return Vt.runKernelFunc((function(t,e){var o=t.gather(r,i.flatten(),n);return e([i]),o}),{x:r,indices:i},(function(t,e){var i=e[0];return{x:function(){var e=r.shape,o=i.size,a=e.slice(0,n),s=a.length,u=e.slice(n,e.length).slice(1),c=u.length,l=hc(0,s),h=hc(s+1,s+1+c),f=fc([a,[o],u]),p=t.reshape(f),d=i.reshape([o]),m=fc([[s],l,h]),v=p.transpose(m),g=dc(v,d,r.shape[n]),y=un(m);return g.transpose(y)},indices:function(){return i}}}),"Gather",{axis:n}).reshape(o.outputShape)}}),dc=fn({unsortedSegmentSum_:function(t,e,n){var r=Ze(t,"x","unsortedSegmentSum"),i=Ze(e,"segmentIds","unsortedSegmentSum","int32");return S(D(n),(function(){return"numSegments must be of dtype int"})),Vt.runKernelFunc((function(t,e){var o=t.unsortedSegmentSum(r,i,n);return e([i]),o}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=zu(e,Rn(e)),r=pc(t,n),i=nc(e,yn(0,"int32")),o=r.rank-i.rank,a=0;a<o;++a)i=or(i,a+1);i=Au(i,An(r.shape,"bool"));var s=Rn(r);return Pu(i,r,s)}(t,n)}}}))}}),mc=function(t,e,n){return s(this,void 0,void 0,(function(){var r,i,o,a,s,c,l,h,f,p,d,m,v;return u(this,(function(u){switch(u.label){case 0:for(r=Ze(t,"tensor","boolMask"),i=Ze(e,"mask","boolMask","bool"),o=null==n?0:n,a=i.rank,s=r.shape,S(a>0,(function(){return"mask cannot be scalar"})),A(s.slice(o,o+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+a;l++)c*=s[l];return h=s.slice(0,o).concat([c],s.slice(o+a)),f=r.reshape(h),p=i.reshape([-1]),[4,Du(p)];case 1:return d=u.sent(),m=d.squeeze([1]),v=pc(f,m,o),t!==r&&r.dispose(),e!==i&&i.dispose(),m.dispose(),f.dispose(),p.dispose(),d.dispose(),[2,v]}}))}))};function vc(t,e,n,r,i,o,a){void 0===o&&(o="NHWC"),S(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),S(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),S(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),S(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===o?s[3]:s[1],h="NHWC"===o?u.shape[3]:u.shape[1];S(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),S(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+h+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&S(D(i),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var f=hi(o),p=ni(s,n.shape,r,1,i,a,!1,f),d=Vt.runKernelFunc((function(t,e){var r=t.conv2dDerInput(u,n,p);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return xc(t,n,r,i,o,1,a)},filter:function(){return Ec(t,s,n.shape,r,i,o,a)}}}));return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function gc(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t),n=e[0],r=e[1],i=e[2];return 1===n&&1===r&&1===i}function yc(t,e,n,r,i){S(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var o=t,a=e,s=!1;4===e.rank&&(s=!0,a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),o=[1,t[0],t[1],t[2],t[3]]);var u=o[4],c=a.shape[4];S(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+o.length+"."})),S(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),S(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),S(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),S(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=ri(o,n.shape,r,1,i),h=Vt.runKernelFunc((function(t){return t.conv3dDerInput(a,n,l)}),{dy5D:a});return s?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}var bc=fn({conv1d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NWC"),void 0===o&&(o=1);var s=Ze(t,"x","conv1d"),u=Ze(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),S(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),S(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&S(D(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),S(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),S(li(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+o+"'"})),S("NWC"===i,(function(){return"Error in conv1d: got dataFormat of "+i+" but only NWC is currently supported."}));var h=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),f=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),p=xc(f,h,[1,n],r,"NHWC",[1,o],a);return l?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),xc=fn({conv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=Ze(t,"x","conv2d"),u=Ze(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),S(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),S(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&S(D(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h="NHWC"===i?c.shape[3]:c.shape[1];S(h===u.shape[2],(function(){return"Error in conv2d: depth of input ("+h+") must match input depth for filter "+u.shape[2]+"."})),S(li(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"}));var f=hi(i),p=ni(c.shape,u.shape,n,o,r,a,!1,f),d=[u,c],m=Vt.runKernelFunc((function(t,e){var n=t.conv2d(c,u,p);return e([u,c]),n}),{x:c,filter:u},(function(t,e){var a=e,s=a[0],u=a[1];return S(ci(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"})),{x:function(){return _c(u.shape,t,s,n,r,i)},filter:function(){return Ec(u,t,s.shape,n,r,i)}}}),"Conv2D",p,d);return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),wc=fn({conv3d_:function(t,e,n,r,i,o){void 0===i&&(i="NDHWC"),void 0===o&&(o=[1,1,1]);var a=Ze(t,"x","conv3d"),s=Ze(e,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),S(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),S(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),S(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),S(function(t,e){return gc(t)||gc(e)}(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),S("NDHWC"===i,(function(){return"Error in conv3d: got dataFormat of "+i+" but only NDHWC is currently supported."}));var l=ri(u.shape,s.shape,n,o,r),h=Vt.runKernelFunc((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){S(gc(o),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+o+"'"}));var i=e[0],a=e[1];return{x:function(){return yc(i.shape,t,a,n,r)},$filter:function(){return function(t,e,n,r,i){var o=t;4===t.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var a=e;4===a.rank&&(a=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),S(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+o.shape+"."})),S(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),S(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),S(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+o.shape[4]+") must match input depth in filter ("+n[3]+"."})),S(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=ri(o.shape,n,r,1,i);return Vt.runKernelFunc((function(t){return t.conv3dDerFilter(o,a,s)}),{x5D:o,dy5D:a})}(i,t,a.shape,n,r)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Ec=fn({conv2dDerFilter_:function(t,e,n,r,i,o,a){void 0===o&&(o="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),S(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),S(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),S(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===o?s.shape[3]:s.shape[1],l="NHWC"===o?u.shape[3]:u.shape[1];S(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),S(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=a&&S(D(i),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var h=hi(o),f=ni(s.shape,n,r,1,i,a,!1,h);return Vt.runKernelFunc((function(t){return t.conv2dDerFilter(s,u,f)}),{x4D:s,dy4D:u})}}),_c=fn({conv2dDerInput_:vc}),Cc=fn({depthwiseConv2d_:function(t,e,n,r,i,o,a){void 0===i&&(i="NHWC"),void 0===o&&(o=[1,1]);var s=Ze(t,"x","depthwiseConv2d"),u=Ze(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),S(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),S(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),S(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==o&&(o=[1,1]),S(li(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&S(D(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var h=ni(c.shape,u.shape,n,o,r,a,!0),f=[c,u],p=Vt.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(c,u,h);return e([c,u]),n}),{x:c,filter:u},(function(t,e){S(ci(o),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+o+"'"}));var n=e[0],r=e[1];return{x:function(){return Sc(n.shape,t,r,h)},filter:function(){return Ac(n,t,r.shape,h)}}}),"DepthwiseConv2dNative",h,f);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Sc=fn({depthwiseConv2dDerInput_:function(t,e,n,r){var i=e,o=!1;3===e.rank&&(o=!0,i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var a=Vt.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(i,n,r)}),{dy4D:i});return o?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),Ac=fn({depthwiseConv2dDerFilter_:function(t,e,n,r){var i=t;3===t.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=e;return 3===o.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Vt.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(i,o,r)}),{x4D:i,dy4D:o})}}),kc=fn({separableConv2d_:function(t,e,n,r,i,o,a){void 0===o&&(o=[1,1]),void 0===a&&(a="NHWC");var s=Ze(t,"x","separableConv2d"),u=Ze(e,"depthwiseFilter","separableConv2d"),c=Ze(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");S(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),S(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),S(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),S(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),S(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var f=u.shape[2],p=u.shape[3];S(c.shape[2]===f*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+f*p+", but got "+c.shape[2]+"."}));var d=Cc(l,u,r,i,a,o),m=xc(d,c,1,"valid",a);return h?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Tc=fn({conv2dTranspose_:function(t,e,n,r,i,o){return vc(n,Ze(t,"x","conv2dTranspose"),Ze(e,"filter","conv2dTranspose"),r,i,"NHWC",o)}}),Ic=fn({conv3dTranspose_:function(t,e,n,r,i){return yc(n,Ze(t,"x","conv3dTranspose"),Ze(e,"filter","conv3dTranspose"),r,i)}}),Pc=fn({matMul_:function(t,e,n,r){var i;void 0===n&&(n=!1),void 0===r&&(r=!1);var o=Ze(t,"a","matMul"),a=Ze(e,"b","matMul");i=Mt(o,a),o=i[0],a=i[1];var s=n?o.shape[o.rank-2]:o.shape[o.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?o.shape[o.rank-1]:o.shape[o.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],h=o.shape.slice(0,-2),f=a.shape.slice(0,-2),p=I(h),d=I(f);S(o.rank>=2&&a.rank>=2&&o.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+o.rank+" and "+a.rank+"."})),S(P(h,f),(function(){return"Error in matMul: outer dimensions ("+h+") and ("+f+") of Tensors with shapes "+o.shape+" and "+a.shape+" must match."})),S(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+o.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=o.shape.slice(0,-2).concat([c,l]),v=n?o.as3D(p,s,c):o.as3D(p,c,s),g=r?a.as3D(d,l,u):a.as3D(d,u,l),y={transposeA:n,transposeB:r};return Vt.runKernelFunc((function(t,e){var i=t.batchMatMul(v,g,n,r);return e([v,g]),i}),{a:v,b:g},(function(t,e){var i=e,o=i[0],a=i[1];return n||r?!n&&r?{a:function(){return t.matMul(a,!1,!1)},b:function(){return t.matMul(o,!0,!1)}}:n&&!r?{a:function(){return a.matMul(t,!1,!0)},b:function(){return o.matMul(t,!1,!1)}}:{a:function(){return a.matMul(t,!0,!0)},b:function(){return t.matMul(o,!0,!0)}}:{a:function(){return t.matMul(a,!1,!0)},b:function(){return o.matMul(t,!0,!1)}}}),"BatchMatMul",y).reshape(m)}}),Dc=fn({dot_:function(t,e){var n=Ze(t,"t1","dot"),r=Ze(e,"t2","dot");S(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var i=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];return S(i===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+i+" and "+o+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Rc=fn({outerProduct_:function(t,e){var n=Ze(t,"v1","outerProduct"),r=Ze(e,"v2","outerProduct");return S(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Mc=fn({reverse_:function(t,e){var n=Ze(t,"x","reverse");if(0===n.rank)return n.clone();var r=L(e,n.shape);return Vt.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),Fc=fn({reverse1d_:function(t){var e=Ze(t,"x","reverse");return S(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Mc(e,0)}}),Oc=fn({reverse2d_:function(t,e){var n=Ze(t,"x","reverse");return S(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Mc(n,e)}}),Nc=fn({reverse3d_:function(t,e){var n=Ze(t,"x","reverse");return S(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Mc(n,e)}}),Lc=fn({reverse4d_:function(t,e){var n=Ze(t,"x","reverse");return S(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Mc(n,e)}});function Bc(t,e,n,r,i,o){var a=Ze(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),S(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),S(li(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=o&&S(D(i),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=ti(s.shape,e,n,r,i,o);if(1===c.filterWidth&&1===c.filterHeight&&P(c.inShape,c.outShape))return a.clone();var l=[s],h=Vt.runKernelFunc((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,o){var a=o[0],s=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=Ze(t,"dy","maxPoolBackprop"),c=Ze(e,"input","maxPoolBackprop"),l=Ze(n,"output","maxPoolBackprop");S(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==o&&(o=[1,1]),S(li(i,o),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),S(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),S(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."})),null!=s&&S(D(a),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var h=ti(c.shape,r,i,o,a,s);return Vt.runKernelFunc((function(t){return t.maxPoolBackprop(u,c,l,h)}),{$dy:u,$input:c})}(t,a,s,e,n,r,i)}}}),"MaxPool",c,l);return u?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}function Vc(t,e,n,r,i,o){var a=Ze(t,"x","avgPool","float32");null==r&&(r=[1,1]),S(li(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),S(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=o&&S(D(i),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var c=ti(s.shape,e,n,r,i,o);if(1===c.filterWidth&&1===c.filterHeight&&P(c.inShape,c.outShape))return a.clone();var l=Vt.runKernelFunc((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,i,o){var a=Ze(t,"dy","avgPoolBackprop"),s=Ze(e,"input","avgPoolBackprop");S(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==i&&(i=[1,1]),S(li(r,i),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"}));var u=s,c=a,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),S(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),S(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var h=ti(u.shape,n,r,i,o),f=Vt.runKernelFunc((function(t){return t.avgPoolBackprop(c,u,h)}),{dy4D:c,input4D:u});return l?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}(t,s,e,n,r,i)}}}),"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var zc=fn({maxPool_:function(t,e,n,r,i){return Bc(t,e,n,1,r,i)}}),jc=fn({avgPool_:function(t,e,n,r,i){return Vc(t,e,n,1,r,i)}}),Wc=fn({pool_:function(t,e,n,r,i,o){null==i&&(i=[1,1]),null==o&&(o=1),0===r&&(r="valid");var a=Ze(t,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),S(li(o,i),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"}));var c,l=ti(s.shape,e,o,i,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),i=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],i[e]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],p=function(t,e,n){var r=n.map((function(t){return t[0]})),i=n.map((function(t){return t[1]})),o=t.concat(r,i),a=e.map((function(t,e){return(t-o[e]%t)%t})),s=i.map((function(t,e){return t+a[e]})),u=e.map((function(t,e){return[r[e],s[e]]})),c=e.map((function(t,e){return[0,a[e]]}));return[u,c]}([l.inHeight,l.inWidth],h,c),d=p[0],m=p[1],v=f?r:"valid",g=f?s:br(s,h,d),y=("avg"===n?function(){return Vc(g,e,o,1,v)}:function(){return Bc(g,e,o,1,v)})(),b=f?y:Zn(y,h,m);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),Gc=fn({maxPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=Ze(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),S(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),S("NDHWC"===o,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),S(li(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&S(D(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=ei(u.shape,e,n,a,r,i,o),h=Vt.runKernelFunc((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,o){var s=o[0],u=o[1];return{x:function(){return function(t,e,n,r,i,o,a,s){var u=Ze(t,"dy","maxPool3dBackprop"),c=Ze(e,"input","maxPool3dBackprop"),l=Ze(n,"output","maxPool3dBackprop"),h=u,f=c,p=l,d=!1;4===c.rank&&(d=!0,h=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),f=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),p=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),S(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+h.rank+"."})),S(5===f.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+f.rank+"."})),S(5===p.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+p.rank+"."})),null==o&&(o=[1,1,1]),S(li(i,o),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"})),null!=s&&S(D(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var m=ei(f.shape,r,i,o,a,s),v=Vt.runKernelFunc((function(t){return t.maxPool3dBackprop(h,f,p,m)}),{dy5D:h,input5D:f});return d?v.as4D(v.shape[1],v.shape[2],v.shape[3],v.shape[4]):v}(t,s,u,e,n,a,r,i)}}}));return c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Hc=fn({avgPool3d_:function(t,e,n,r,i,o,a){void 0===o&&(o="NDHWC");var s=Ze(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),S(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),S("NDHWC"===o,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+o})),S(li(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=i&&S(D(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+r+"."}));var l=ei(u.shape,e,n,a,r,i,o),h=Vt.runKernelFunc((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,i,o,a){var s=Ze(t,"dy","avgPool3dBackprop"),u=Ze(e,"input","avgPool3dBackprop"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),S(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),S(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==i&&(i=[1,1,1]),S(li(r,i),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+i+"'"})),null!=a&&S(D(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var f=ei(l.shape,n,r,i,o,a),p=Vt.runKernelFunc((function(t){return t.avgPool3dBackprop(c,l,f)}),{dy5D:c,input5D:l});return h?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(t,u,e,n,a,r,i)}}}));return h=h.cast(u.dtype),c?h.as4D(h.shape[1],h.shape[2],h.shape[3],h.shape[4]):h}}),Uc=fn({slice_:function(t,e,n){var r,i,o=Ze(t,"x","slice");if(0===o.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(o.rank-1).fill(0)):e.length<o.rank?e.concat(new Array(o.rank-e.length).fill(0)):e.slice()).forEach((function(t){S(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),i=(i=null==n?new Array(o.rank).fill(-1):"number"==typeof n?[n].concat(new Array(o.rank-1).fill(-1)):n.length<o.rank?n.concat(new Array(o.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(S(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),o.shape[e]-r[e])})),Lr(o,r,i);var a=o.shape,s={begin:r,size:i};return Vt.runKernelFunc((function(t){return t.slice(o,r,i)}),{x:o},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],a[n]-r[n]-i[n]]);return{x:function(){return t.pad(e)}}}),"Slice",s)}}),qc=fn({slice1d_:function(t,e,n){var r=Ze(t,"x","slice1d");return S(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Uc(r,[e],[n])}}),$c=fn({slice2d_:function(t,e,n){var r=Ze(t,"x","slice2d");return S(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Uc(r,e,n)}}),Kc=fn({slice3d_:function(t,e,n){var r=Ze(t,"x","slice3d");return S(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Uc(r,e,n)}}),Xc=fn({slice4d_:function(t,e,n){var r=Ze(t,"x","slice4d");return S(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Uc(r,e,n)}});function Yc(t,e,n,r,i){return e.rank<n.rank&&(e=e.reshape(on(e.shape,r))),t.rank<n.rank&&(t=t.reshape(on(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==i?r:r.transpose(i)}}}var Jc=fn({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","all","bool"),i=L(e,r.shape),o=i,a=sn(o,r.rank);null!=a&&(r=r.transpose(a),o=cn(o.length,r.rank));var s=Vt.runKernelFunc((function(t){return t.all(r,o)}),{$x:r});if(n){var u=on(s.shape,i);return s.reshape(u)}return s}}),Qc=fn({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","any","bool"),i=L(e,r.shape),o=i,a=sn(o,r.rank);null!=a&&(r=r.transpose(a),o=cn(o.length,r.rank));var s=Vt.runKernelFunc((function(t){return t.any(r,o)}),{$x:r});if(n){var u=on(s.shape,i);return s.reshape(u)}return s}}),Zc=fn({argMax_:function(t,e){void 0===e&&(e=0);var n=Ze(t,"x","argMax");null==e&&(e=0);var r=L(e,n.shape),i=sn(r,n.rank);null!=i&&(n=n.transpose(i),r=cn(r.length,n.rank));var o={axis:r[0]},a=[n];return Vt.runKernelFunc((function(t,e){var i=t.argMax(n,r[0]);return e([n]),i}),{x:n},(function(t,e){var n=e[0];return{x:function(){return Rn(n)}}}),"ArgMax",o,a)}}),tl=fn({argMin_:function(t,e){void 0===e&&(e=0);var n=Ze(t,"x","argMin");null==e&&(e=0);var r=L(e,n.shape),i=sn(r,n.rank);return null!=i&&(n=n.transpose(i),r=cn(r.length,n.rank)),Vt.runKernelFunc((function(t,e){var i=t.argMin(n,r[0]);return e([n]),i}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Rn(n)}}}))}}),el=fn({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","logSumExp"),i=L(e,r.shape),o=r.max(i,!0),a=r.sub(o).exp().sum(i).log(),s=o.reshape(a.shape).add(a);if(n){var u=on(s.shape,i);return s.reshape(u)}return s}}),nl=fn({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","max"),i=r,o=L(e,r.shape),a=o,s=sn(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=[r],c=Vt.runKernelFunc((function(t,e){var n=t.max(r,a);return e([i,n]),n}),{x:r},(function(t,e){return Yc(t,e[1],e[0],o,s)}),"Max",{axes:a},u,[!0]);if(n){var l=on(c.shape,o);c=c.reshape(l)}return c}}),rl=fn({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","mean"),i=L(e,r.shape),o=I(rn(r.shape,i)[1]);return Ur((function(t){var r=yn(o);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(An(t.shape,"float32")).div(o)}}}))(r)}}),il=fn({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","min"),i=r,o=L(e,r.shape),a=o,s=sn(a,r.rank);null!=s&&(r=r.transpose(s),a=cn(a.length,r.rank));var u=[r],c=Vt.runKernelFunc((function(t,e){var n=t.min(r,a);return e([i,n]),n}),{x:r},(function(t,e){return Yc(t,e[1],e[0],o,s)}),"Min",{axes:a},u,[!0]);if(n){var l=on(c.shape,o);c=c.reshape(l)}return c}}),ol=fn({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=L(e,(t=Ze(t,"x","moments")).shape),i=t.mean(r,n),o=i.shape;n||(o=on(i.shape,r));var a=t.toFloat().sub(i.reshape(o)).square();return{mean:i,variance:a.mean(r,n)}}}),al=fn({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var i=L(e,r.shape);return Ur((function(t){var e=sn(i,t.rank),r=i,o=t;null!=e&&(o=t.transpose(e),r=cn(r.length,t.rank));var a=function(e){var n=t.shape.slice();return i.forEach((function(t){n[t]=1})),e.reshape(n).mul(An(t.shape,"float32"))},s={axes:r},u=Vt.runKernelFunc((function(t){return t.sum(o,r)}),{x:o},(function(t){return{x:function(){return a(t)}}}),"Sum",s);if(n){var c=on(u.shape,i);u=u.reshape(c)}return{value:u,gradFunc:a}}))(r)}}),sl=fn({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=Ze(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var i=L(e,r.shape),o=sn(i,r.rank),a=i,s=r;null!=o&&(s=r.transpose(o),a=cn(a.length,r.rank));var u=Vt.runKernelFunc((function(t){return t.prod(s,a)}),{permutedX:s});if(n){var c=on(u.shape,i);u=u.reshape(c)}return u}}),ul=fn({elu_:function(t){var e=Ze(t,"x","elu");return Vt.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Vt.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),cl=fn({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=Ze(t,"x","leakyRelu");return zu(yn(e).mul(n),n)}}),ll=fn({prelu_:function(t,e){var n=Ze(t,"x","prelu"),r=Ze(e,"alpha","prelu");return Vt.runKernelFunc((function(t,e){var i=t.prelu(n,r);return e([n,r]),i}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],i=n.greater(0);return{x:function(){return Pu(i,t,t.mul(r))},alpha:function(){var e=Pu(i,Rn(t),t.mul(n)),o=Qr(r.shape,t.shape);return o.length>0&&(e=e.sum(o)),e.reshape(r.shape)}}}),"Prelu")}}),hl=fn({relu_:function(t){var e=Ze(t,"x","relu");return"bool"===e.dtype?e.toInt():Vt.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mulStrict(n.step().toFloat())}}}),"Relu")}}),fl=fn({relu6_:function(t){var e=Ze(t,"x","relu6");return"bool"===e.dtype?e.toInt():Vt.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return t.mulStrict(r.toFloat())}}}),"Relu6")}}),pl=fn({selu_:function(t){var e=Ze(t,"x","selu");return Vt.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(yn(0)),r=yn(Xa),i=yn(Ya),o=t.mul(i),a=t.mul(r).mul(n.toFloat().exp());return Pu(e,o,a)}}}))}}),dl=fn({transpose_:function(t,e){var n=Ze(t,"x","transpose");if(null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),S(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){S(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1)return n.clone();var r={perm:e};return Vt.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},(function(t){var n=un(e);return{x:function(){return t.transpose(n)}}}),"Transpose",r)}}),ml=fn({localResponseNormalization_:function(t,e,n,r,i){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=.5);var o=Ze(t,"x","localResponseNormalization");S(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+o.rank+"."})),S(D(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var a=o,s=!1;3===o.rank&&(s=!0,a=o.as4D(1,o.shape[0],o.shape[1],o.shape[2]));var u=Vt.runKernelFunc((function(t,o){var s=t.localResponseNormalization4D(a,e,n,r,i);return o([a,s]),s}),{x4D:a},(function(t,o){var a=o[0],s=o[1];return{x4D:function(){return Vt.runKernelFunc((function(o){return o.LRNGrad(t,a,s,e,n,r,i)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),vl=fn({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var i=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(yn(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=Ze(t,"x","norm"),e,n),o=i.shape;if(r){var a=L(n,t.shape);o=on(i.shape,a)}return i.reshape(o)}}),gl=fn({basicLSTMCell_:function(t,e,n,r,i,o){var a=Ze(t,"forgetBias","basicLSTMCell"),s=Ze(e,"lstmKernel","basicLSTMCell"),u=Ze(n,"lstmBias","basicLSTMCell"),c=Ze(r,"data","basicLSTMCell"),l=Ze(i,"c","basicLSTMCell"),h=Ze(o,"h","basicLSTMCell"),f=c.concat(h,1).matMul(s).add(u),p=f.shape[0],d=f.shape[1]/4,m=[p,d],v=f.slice([0,0],m),g=f.slice([0,d],m),y=f.slice([0,2*d],m),b=f.slice([0,3*d],m),x=v.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),yl=fn({multiRNNCell_:function(t,e,n,r){for(var i=Ze(e,"data","multiRNNCell"),o=tn(n,"c","multiRNNCell"),a=tn(r,"h","multiRNNCell"),s=i,u=[],c=0;c<t.length;c++){var l=t[c](s,o[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var h=[],f=[];for(c=0;c<u.length;c+=2)h.push(u[c]),f.push(u[c+1]);return[h,f]}}),bl=fn({movingAverage_:function(t,e,n,r,i){void 0===i&&(i=!0);var o=Ze(t,"v","movingAverage"),a=Ze(e,"x","movingAverage"),s=Ze(n,"decay","movingAverage");Ft(o,a),S(P(o.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=yn(1),c=u.sub(s),l=a.sub(o).mul(c);if(i){S(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=Ze(r,"step","movingAverage");l=l.div(u.sub(Ku(s,h)))}return o.add(l)}}),xl=fn({stridedSlice_:function(t,e,n,r,i,o,a,s,u){if(void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=Ze(t,"x","stridedSlice"),l=Br(s),h=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,h.splice(t,0,1)})),c=c.reshape(h);for(var f=0;f<c.rank;f++)e[f]=zr(i,e,r,c.shape,f),n[f]=jr(o,n,r,c.shape,f),r[f]=r[f]||1;var p=Br(u);p.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var d=Vr(e,n,r),m=d.filter((function(t,e){return-1===p.indexOf(e)}));return r.every((function(t){return 1===t}))?Uc(c,e,d).reshape(m):Vt.runKernelFunc((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(m)}}),wl=fn({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=Ze(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var i=r.shape[r.shape.length-1];if(e>i)throw new Error("'k' passed to topk() must be <= the last dimension ("+i+") but got "+e);var o=Vt.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:o[0],indices:o[1]}}}),El=fn({scatterND_:function(t,e,n){var r=Ze(t,"indices","scatterND","int32"),i=Ze(e,"updates","scatterND");return Or(i,r,n),Vt.runKernelFunc((function(t){return t.scatterND(r,i,n)}),{indices:r,updates:i},null,"ScatterNd",{shape:n})}}),_l=fn({fft_:function(t){S("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Vt.runKernelFunc((function(t){return t.fft(r)}),{input:t}).reshape(t.shape)}}),Cl=fn({ifft_:function(t){S("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Vt.runKernelFunc((function(t){return t.ifft(r)}),{input:t}).reshape(t.shape)}}),Sl=fn({rfft_:function(t,e){S("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],i=t.size/r;if(null!=e&&e<r){var o=t.shape.map((function(t){return 0})),a=t.shape.map((function(t){return t}));a[t.shape.length-1]=e,n=t.slice(o,a),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(kn(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=pn(n,u).as2D(i,r),l=_l(c),h=Math.floor(r/2)+1,f=dn(l),p=mn(l),d=f.split([h,r-h],f.shape.length-1),m=p.split([h,r-h],p.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=h,pn(d[0],m[0]).reshape(v)}}),Al=fn({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),i=Cl(r);return dn(i)}var o=[n,2*(e-1)],a=dn(t).as2D(n,e),s=mn(t).as2D(n,e),u=a.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(yn(-1)),l=a.concat(u,1),h=s.concat(c,1);return r=pn(l,h).as2D(o[0],o[1]),i=Cl(r),dn(i)}}),kl=Object.freeze({fft:_l,ifft:Cl,rfft:Sl,irfft:Al}),Tl=fn({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var i=Ze(t,"sparseIndices","sparseToDense","int32"),o=Ze(e,"sparseValues","sparseToDense"),a=Ze(r,"defaultValue","sparseToDense",o.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var i=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+o+".");var a=e.size;if(0!==e.rank&&(1!==e.rank||a!==i))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+i+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,a),Vt.runKernelFunc((function(t){return t.sparseToDense(i,o,n,a)}),{$sparseIndices:i,$sparseValues:o,$defaultValue:a})}}),Il=fn({gatherND_:function(t,e){var n=Ze(e,"indices","gatherND","int32"),r=Ze(t,"x","gatherND");return Vt.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Pl=fn({diag_:function(t){var e=Ze(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return Vt.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),Dl=fn({dropout_:function(t,e,n,r){var i=Ze(t,"x","dropout");if(S("float32"===i.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+i.dtype+" tensor instead."})),S(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof _t?i.clone():i;var o=function(t,e){if(null==e)return t.shape.slice();if(P(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),a=1-e,s=gr(o,0,1,"float32",r).add(a).floor().div(a);return i.mul(s)}});function Rl(t,e,n){for(var r=1-t%2,i=new Float32Array(t),o=0;o<t;++o){var a=2*Math.PI*o/(t+r-1);i[o]=e-n*Math.cos(a)}return bn(i,"float32")}var Ml,Fl=fn({hannWindow_:function(t){return Rl(t,.5,.5)}}),Ol=fn({hammingWindow_:function(t){return Rl(t,.54,.46)}}),Nl=fn({frame_:function(t,e,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=0);for(var o=0,a=[];o+e<=t.size;)a.push(Uc(t,o,e)),o+=n;if(r)for(;o<t.size;){var s=o+e-t.size,u=Mn([Uc(t,o,e-s),Tn([s],i)]);a.push(u),o+=n}return 0===a.length?xn([],[0,e]):Mn(a).as2D(a.length,e)}}),Ll=fn({stft_:function(t,e,n,r,i){var o;void 0===i&&(i=Fl),null==r&&(o=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));for(var a=Nl(t,e,n),s=qu(a,i(e)),u=[],c=0;c<a.shape[0];c++)u.push(Sl(s.slice([c,0],[1,e]),r));return Mn(u)}}),Bl=Object.freeze({hannWindow:Fl,hammingWindow:Ol,frame:Nl,stft:Ll}),Vl=function(t,e,n){return void 0===n&&(n=1),s(this,void 0,void 0,(function(){var r,i,o,a,s,c,l,h,f,p,d,m,v,g;return u(this,(function(u){switch(u.label){case 0:return r=Ze(t,"predictions","inTopK"),i=Ze(e,"targets","inTopK"),S(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),S(r.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+i.rank})),A(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=r.shape[r.shape.length-1],S(n>0&&n<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+o+"), but got "+n})),[4,r.data()];case 1:return a=u.sent(),[4,i.data()];case 2:for(s=u.sent(),c=[a.length/o,o],h=c[1],f=V("bool",l=c[0]),p=0;p<l;p++){for(d=p*h,m=a.subarray(d,d+h),v=[],g=0;g<m.length;g++)v.push({value:m[g],index:g});for(v.sort((function(t,e){return e.value-t.value})),f[p]=0,g=0;g<n;g++)if(v[g].index===s[p]){f[p]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),[2,vn(f,i.shape,"bool")]}}))}))};!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ml||(Ml={}));var zl=fn({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=Ml.SUM_BY_NONZERO_WEIGHTS);var i=Ze(t,"labels","absoluteDifference"),o=Ze(e,"predictions","absoluteDifference"),a=null;null!=n&&(a=Ze(n,"weights","absoluteDifference")),A(i.shape,o.shape,"Error in absoluteDifference: ");var s=i.sub(o).abs();return jl(s,a,r)}}),jl=fn({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=Ml.SUM_BY_NONZERO_WEIGHTS);var r=Ze(t,"losses","computeWeightedLoss"),i=null;null!=e&&(i=Ze(e,"weights","computeWeightedLoss"));var o=null==i?r:r.mul(i);if(n===Ml.NONE)return o;if(n===Ml.SUM)return o.sum();if(n===Ml.MEAN){if(null==i)return o.mean();var a=r.size/i.size,s=o.sum().div(i.sum());return a>1?s.div(yn(a)):s}if(n===Ml.SUM_BY_NONZERO_WEIGHTS){if(null==i)return o.sum().div(yn(r.size));var u=i.mul(An(r.shape)).notEqual(yn(0)).sum().toFloat();return o.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Wl=fn({cosineDistance_:function(t,e,n,r,i){void 0===i&&(i=Ml.SUM_BY_NONZERO_WEIGHTS);var o=Ze(t,"labels","cosineDistance"),a=Ze(e,"predictions","cosineDistance"),s=null;null!=r&&(s=Ze(r,"weights","cosineDistance")),A(o.shape,a.shape,"Error in cosineDistance: ");var u=yn(1).sub(o.mul(a).sum(n,!0));return jl(u,s,i)}}),Gl=fn({hingeLoss_:function(t,e,n,r){void 0===r&&(r=Ml.SUM_BY_NONZERO_WEIGHTS);var i=Ze(t,"labels","hingeLoss"),o=Ze(e,"predictions","hingeLoss"),a=null;null!=n&&(a=Ze(n,"weights","hingeLoss")),A(i.shape,o.shape,"Error in hingeLoss: ");var s=yn(1);i=yn(2).mul(i).sub(s);var u=s.sub(i.mul(o)).relu();return jl(u,a,r)}}),Hl=fn({huberLoss_:function(t,e,n,r,i){void 0===r&&(r=1),void 0===i&&(i=Ml.SUM_BY_NONZERO_WEIGHTS);var o=Ze(t,"labels","huberLoss"),a=Ze(e,"predictions","huberLoss"),s=null;null!=n&&(s=Ze(n,"weights","huberLoss")),A(o.shape,a.shape,"Error in huberLoss: ");var u=yn(r),c=a.sub(o).abs(),l=Wu(c,u),h=c.sub(l),f=yn(.5).mul(l.square()).add(u.mul(h));return jl(f,s,i)}}),Ul=fn({logLoss_:function(t,e,n,r,i){void 0===r&&(r=1e-7),void 0===i&&(i=Ml.SUM_BY_NONZERO_WEIGHTS);var o=Ze(t,"labels","logLoss"),a=Ze(e,"predictions","logLoss"),s=null;null!=n&&(s=Ze(n,"weights","logLoss")),A(o.shape,a.shape,"Error in logLoss: ");var u=yn(1),c=yn(r),l=o.mul(a.add(c).log()).neg().sub(u.sub(o).mul(u.sub(a).add(c).log()));return jl(l,s,i)}}),ql=fn({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=Ml.SUM_BY_NONZERO_WEIGHTS);var i=Ze(t,"labels","meanSquaredError"),o=Ze(e,"predictions","meanSquaredError"),a=null;null!=n&&(a=Ze(n,"weights","meanSquaredError")),A(i.shape,o.shape,"Error in meanSquaredError: ");var s=i.squaredDifference(o);return jl(s,a,r)}}),$l=fn({sigmoidCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Ml.SUM_BY_NONZERO_WEIGHTS);var o=Ze(t,"multiClassLabels","sigmoidCrossEntropy"),a=Ze(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=Ze(n,"weights","sigmoidCrossEntropy")),A(o.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=yn(r),c=yn(1),l=yn(.5);o=o.mul(c.sub(u)).add(l.mul(u))}var h=function(t,e){var n=Ze(t,"labels","sigmoidCrossEntropyWithLogits"),r=Ze(e,"logits","sigmoidCrossEntropyWithLogits");A(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=r.relu(),o=r.mul(n),a=r.abs().neg().exp().log1p();return i.sub(o).add(a)}(o,a);return jl(h,s,i)}}),Kl=fn({softmaxCrossEntropy_:function(t,e,n,r,i){void 0===r&&(r=0),void 0===i&&(i=Ml.SUM_BY_NONZERO_WEIGHTS);var o=Ze(t,"onehotLabels","softmaxCrossEntropy"),a=Ze(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=Ze(n,"weights","softmaxCrossEntropy")),A(o.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=yn(r),c=yn(1),l=yn(o.shape[1]);o=o.mul(c.sub(u)).add(u.div(l))}var h=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return Ur((function(t,e,r){var i=e.logSumExp([n],!0),o=e.toFloat().sub(i);return r([t,o]),{value:o.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],i=e[1],o=on(t.shape,[n]);return[t.reshape(o).mul(r.toFloat().sub(i.exp())),t.reshape(o).mul(i.exp().sub(r.toFloat()))]}}}))(t,e)}(o,a);return jl(h,s,i)}}),Xl=Object.freeze({get Reduction(){return Ml},absoluteDifference:zl,computeWeightedLoss:jl,cosineDistance:Wl,hingeLoss:Gl,huberLoss:Hl,logLoss:Ul,meanSquaredError:ql,sigmoidCrossEntropy:$l,softmaxCrossEntropy:Kl});function Yl(t,e){return void 0===e&&(e=!1),Vt.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],i=ar(n),o=t.clone(),a=xn([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(t){var e,u=o,c=s,l=i;e=Vt.tidy((function(){var e=o.slice([t,t],[n-t,1]),u=e.norm(),c=o.slice([t,t],[1,1]),l=xn([[-1]]).where(c.greater(0),xn([[1]])),h=c.sub(l.mul(u)),f=e.div(h);s=1===f.shape[0]?a.clone():a.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var p=l.matMul(h).div(u).neg(),d=o.slice([t,0],[n-t,r]),m=p.mul(s);if(0===t)o=d.sub(m.matMul(s.transpose().matMul(d)));else{var v=d.sub(m.matMul(s.transpose().matMul(d)));o=o.slice([0,0],[t,r]).concat(v,0)}var g=i.slice([0,t],[n,i.shape[1]-t]);if(0===t)i=g.sub(g.matMul(s).matMul(m.transpose()));else{var y=g.sub(g.matMul(s).matMul(m.transpose()));i=i.slice([0,0],[n,t]).concat(y,1)}return[s,o,i]})),s=e[0],o=e[1],i=e[2],Ke([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(i=i.slice([0,0],[n,r]),o=o.slice([0,0],[r,r])),[i,o]}))}var Jl=fn({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=Ze(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var i=r.shape,o=r.shape.slice(-2),a=o[0],s=o[1];if(!(e<=a))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=a),n<0&&(n=s);var u=Pn(0,a,1,"int32").reshape([-1,1]),c=Pn(0,s,1,"int32"),l=Ju(u,c),h=Au(l.lessEqual(yn(+e,"int32")),l.greaterEqual(yn(-n,"int32"))),f=kn([a,s],r.dtype);return wr(Cr(r.reshape([-1,a,s])).map((function(t){return Pu(h,t,f)}))).reshape(i)}}),Ql=fn({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,S(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){S(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},i=1;i<t.length;++i)r(i)}else e=!0,t=Bn(t,t.shape[0],0).map((function(t){return xr(t,[0])}));S(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var o=[],a=t,s=function(t){o.push(Vt.tidy((function(){var e=a[t];if(t>0)for(var n=0;n<t;++n){var r=al(o[n].mulStrict(e)).mul(o[n]);e=e.sub(r)}return e.div(vl(e,"euclidean"))})))};for(i=0;i<t.length;++i)s(i);return e?wr(o,0):o}}),Zl=fn({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return Yl(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=Cr(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],o=[];return r.forEach((function(t){var n=Yl(t,e),r=n[0],a=n[1];i.push(r),o.push(a)})),[wr(i,0).reshape(t.shape),wr(o,0).reshape(t.shape)]}}),th=Object.freeze({bandPart:Jl,gramSchmidt:Ql,qr:Zl});function eh(t,e,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);var a=t.shape[0];return n=Math.min(n,a),S(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),S(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),S(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),S(1===e.rank,(function(){return"scores must be a 1D tensor"})),S(e.shape[0]===a,(function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+e.shape[0]})),S(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+o+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}var nh=fn({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=Ze(t,"images","resizeBilinear");S(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),S(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=Vt.runKernelFunc((function(t,e){return e([i]),t.resizeBilinear(i,a,s,n)}),{x:i},(function(t,e){return{x:function(){return Vt.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),rh=fn({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=Ze(t,"images","resizeNearestNeighbor");S(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),S(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),S("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var i=r,o=!1;3===r.rank&&(o=!0,i=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=e[0],s=e[1],u=Vt.runKernelFunc((function(t,e){return e([i]),t.resizeNearestNeighbor(i,a,s,n)}),{batchImages:i},(function(t,e){return{batchImages:function(){return Vt.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return o?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),ih=fn({nonMaxSuppression_:function(t,e,n,r,i){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY);var o=Ze(t,"boxes","nonMaxSuppression"),a=Ze(e,"scores","nonMaxSuppression"),s=eh(o,a,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return Vt.runKernelFunc((function(t){return t.nonMaxSuppression(o,a,n,r,i)}),{boxes:o,scores:a},null,"NonMaxSuppressionV3",u)}}),oh=function(t,e,n,r,i){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),s(this,void 0,void 0,(function(){var o,a,s,c,l,h,f;return u(this,(function(u){switch(u.label){case 0:return o=Ze(t,"boxes","nonMaxSuppressionAsync"),a=Ze(e,"scores","nonMaxSuppressionAsync"),s=eh(o,a,n,r,i),n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold,[4,Promise.all([o.data(),a.data()])];case 1:return c=u.sent(),l=c[0],h=c[1],f=wi(l,h,n,r,i),o!==t&&o.dispose(),a!==e&&a.dispose(),[2,f]}}))}))},ah=fn({nonMaxSuppressionWithScore_:function(t,e,n,r,i,o){void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===o&&(o=0);var a=Ze(t,"boxes","nonMaxSuppression"),s=Ze(e,"scores","nonMaxSuppression"),u=eh(a,s,n,r,i,o),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:i=u.scoreThreshold,softNmsSigma:o=u.softNmsSigma},l=Vt.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),sh=function(t,e,n,r,i,o){return void 0===r&&(r=.5),void 0===i&&(i=Number.NEGATIVE_INFINITY),void 0===o&&(o=0),s(this,void 0,void 0,(function(){var a,s,c,l,h,f,p;return u(this,(function(u){switch(u.label){case 0:return a=Ze(t,"boxes","nonMaxSuppressionAsync"),s=Ze(e,"scores","nonMaxSuppressionAsync"),c=eh(a,s,n,r,i,o),n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=u.sent(),h=l[0],f=l[1],p=Ei(h,f,n,r,i,o),a!==t&&a.dispose(),s!==e&&s.dispose(),[2,p]}}))}))},uh=fn({cropAndResize_:function(t,e,n,r,i,o){var a=Ze(t,"image","cropAndResize"),s=Ze(e,"boxes","cropAndResize","float32"),u=Ze(n,"boxInd","cropAndResize","int32");i=i||"bilinear",o=o||0;var c=s.shape[0];return S(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),S(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),S(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),S(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),S(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),S("bilinear"===i||"nearest"===i,(function(){return"method must be bilinear or nearest, but was "+i})),Vt.runKernelFunc((function(t,e){return t.cropAndResize(a,s,u,r,i,o)}),{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:i,extrapolationValue:o,cropSize:r})}}),ch=Object.freeze({resizeBilinear:nh,resizeNearestNeighbor:rh,nonMaxSuppression:ih,nonMaxSuppressionAsync:oh,nonMaxSuppressionWithScore:ah,nonMaxSuppressionWithScoreAsync:sh,cropAndResize:uh}),lh=function(t,e){return!(t>0)||"linear"===e},hh=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},fh=function(t,e){var n=e,r=Qr(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},ph=function(t,e,n){if("linear"===e)return t;if("relu"===e)return hl(t);if("elu"===e)return ul(t);if("relu6"===e)return fl(t);if("prelu"===e)return ll(t,n);throw new Error("Unknown fused activation "+e+".")},dh=fn({fusedMatMul_:function(t){var e,n=t.a,r=t.b,i=t.transposeA,o=void 0!==i&&i,a=t.transposeB,s=void 0!==a&&a,u=t.bias,c=t.activation,l=void 0===c?"linear":c,h=t.preluActivationWeights;if(!1===lh(Vt.state.gradientDepth,l)){var f=Pc(n,r,o,s);return null!=u&&(f=Ru(f,u)),ph(f,l,h)}var p=Ze(n,"a","fused matMul"),d=Ze(r,"b","fused matMul");e=Mt(p,d),p=e[0],d=e[1];var m=o?p.shape[p.rank-2]:p.shape[p.rank-1],v=s?d.shape[d.rank-1]:d.shape[d.rank-2],g=o?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?d.shape[d.rank-2]:d.shape[d.rank-1],b=p.shape.slice(0,-2),x=d.shape.slice(0,-2),w=I(b),E=I(x);S(p.rank>=2&&d.rank>=2&&p.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+d.rank+"."})),S(P(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+d.shape+" must match."})),S(m===v,(function(){return"Error in fused matMul: inner shapes ("+m+") and ("+v+") of Tensors with shapes "+p.shape+" and "+d.shape+" and transposeA="+o+" and transposeB="+s+" must match."}));var _,C,A=p.shape.slice(0,-2).concat([g,y]),k=o?p.as3D(w,m,g):p.as3D(w,g,m),T=s?d.as3D(E,y,v):d.as3D(E,v,y);null!=u&&Zr(A,(_=Mt(_=Ze(u,"bias","fused matMul"),p)[0]).shape),null!=h&&(C=Ze(h,"prelu weights","fused matMul"));var D={a:k,b:T};null!=u&&(D.bias=_),null!=h&&(D.preluActivationWeights=C);var R=[k,T];return Vt.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:k,b:T,transposeA:o,transposeB:s,bias:_,activation:l,preluActivationWeights:C});return e([k,T,n]),n}),D,(function(t,e){var n=e[0],r=e[1],i=e[2],a=hh(t,i,l),c={};return null!=u&&(c={bias:function(){return fh(_,a)}}),o||s?!o&&s?Object.assign({a:function(){return a.matMul(r,!1,!1)},b:function(){return a.matMul(n,!0,!1)}},c):o&&!s?Object.assign({a:function(){return r.matMul(a,!1,!0)},b:function(){return n.matMul(a,!1,!1)}},c):Object.assign({a:function(){return r.matMul(a,!0,!0)},b:function(){return a.matMul(n,!0,!0)}},c):Object.assign({a:function(){return a.matMul(r,!1,!0)},b:function(){return n.matMul(a,!0,!1)}},c)}),"_FusedMatMul",{transposeA:o,transposeB:s,activation:l},R,[!0]).reshape(A)}}),mh=fn({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,o=t.dataFormat,a=void 0===o?"NHWC":o,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,f=void 0===h?"linear":h,p=t.preluActivationWeights;if(f=f||"linear",!1===lh(Vt.state.gradientDepth,f)){var d=xc(e,n,r,i,a,u,c);return null!=l&&(d=Ru(d,l)),ph(d,f,p)}var m=Ze(e,"x","conv2d"),v=Ze(n,"filter","conv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),S(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),S(4===v.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+v.rank+"."})),null!=c&&S(D(i),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+i+"."})),S(g.shape[3]===v.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+v.shape[2]+"."})),S(li(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),S("NHWC"===a,(function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."}));var b,x,w=ni(g.shape,v.shape,r,u,i,c);null!=l&&(b=Mt(b=Ze(l,"bias","fused conv2d"),m)[0],Zr(w.outShape,b.shape)),null!=p&&(x=Ze(p,"prelu weights","fused conv2d"));var E={x:g,filter:v};null!=l&&(E.bias=b),null!=p&&(E.preluActivationWeights=x);var _=[v,g],C=Vt.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:g,filter:v,convInfo:w,bias:b,activation:f,preluActivationWeights:x});return e([v,g,n]),n}),E,(function(t,e){var n=e,o=n[0],a=n[1],s=n[2],c=hh(t,s,f);S(ci(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var h={};return null!=l&&(h={bias:function(){return fh(b,c)}}),Object.assign({x:function(){return _c(a.shape,c,o,r,i)},filter:function(){return Ec(a,c,o.shape,r,i)}},h)}),"FusedConv2D",{convInfo:w,activation:f},_,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),vh=fn({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,i=t.pad,o=t.dataFormat,a=void 0===o?"NHWC":o,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,h=t.activation,f=void 0===h?"linear":h,p=t.preluActivationWeights;if(!1===lh(Vt.state.gradientDepth,f)){var d=Cc(e,n,r,i,a,u,c);return null!=l&&(d=Ru(d,l)),ph(d,f,p)}var m=Ze(e,"x","depthwiseConv2d"),v=Ze(n,"filter","depthwiseConv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),S(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),S(4===v.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+v.rank+"."})),S(g.shape[3]===v.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+v.shape[2]+"."})),null==u&&(u=[1,1]),S(li(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&S(D(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+i+"."}));var b,x,w=ni(g.shape,v.shape,r,u,i,c,!0);null!=l&&(b=Mt(b=Ze(l,"bias","fused conv2d"),m)[0],Zr(w.outShape,b.shape)),null!=p&&(x=Ze(p,"prelu weights","fused depthwiseConv2d"));var E={x:g,filter:v};null!=l&&(E.bias=b),null!=p&&(E.preluActivationWeights=x);var _=[v,g],C=Vt.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:g,filter:v,convInfo:w,bias:b,activation:f,preluActivationWeights:x});return e([v,g,n]),n}),E,(function(t,e){S(ci(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=e[0],r=e[1],i=e[2],o=hh(t,i,f),a={};return null!=l&&(a={bias:function(){return fh(b,o)}}),Object.assign({x:function(){return Sc(r.shape,o,n,w)},filter:function(){return Ac(r,o,n.shape,w)}},a)}),"FusedDepthwiseConv2D",{convInfo:w,activation:f},_,[!0]);return y?C.as3D(C.shape[1],C.shape[2],C.shape[3]):C}}),gh=Object.freeze({matMul:dh,conv2d:mh,depthwiseConv2d:vh}),yh=Object.freeze({image:ch,linalg:th,losses:Xl,spectral:kl,fused:gh,signal:Bl,square:Is,squaredDifference:Ds,conv1d:bc,conv2d:xc,conv3d:wc,depthwiseConv2d:Cc,separableConv2d:kc,conv2dTranspose:Tc,conv3dTranspose:Ic,op:fn,batchNormalization2d:yu,batchNormalization3d:bu,batchNormalization4d:xu,batchNormalization:wu,batchNorm:Eu,batchNorm2d:_u,batchNorm3d:Cu,batchNorm4d:Su,booleanMaskAsync:mc,complex:pn,real:dn,imag:mn,concat:Mn,concat1d:Fn,concat2d:On,concat3d:Nn,concat4d:Ln,split:Bn,matMul:Pc,dot:Dc,outerProduct:Rc,reverse:Mc,reverse1d:Fc,reverse2d:Oc,reverse3d:Nc,reverse4d:Lc,maxPool:zc,avgPool:jc,pool:Wc,maxPool3d:Gc,avgPool3d:Hc,slice:Uc,slice1d:qc,slice2d:$c,slice3d:Kc,slice4d:Xc,abs:Rs,acos:Ms,acosh:Fs,asin:Os,asinh:Ns,atan:Ls,atanh:Bs,ceil:Vs,clipByValue:zs,cos:js,cosh:Ws,erf:Gs,exp:Hs,expm1:Us,floor:qs,log:$s,log1p:Ks,logSigmoid:Xs,neg:Ys,reciprocal:Js,round:Qs,rsqrt:Zs,sigmoid:tu,sign:eu,isNaN:nu,isInf:ru,isFinite:iu,sin:ou,sinh:au,softplus:su,sqrt:uu,step:cu,tan:lu,tanh:hu,all:Jc,any:Qc,argMax:Zc,argMin:tl,logSumExp:el,max:nl,mean:rl,min:il,moments:ol,sum:al,prod:sl,equal:Zu,equalStrict:tc,greater:ec,greaterEqual:nc,greaterEqualStrict:rc,greaterStrict:ic,less:oc,lessEqual:ac,lessEqualStrict:sc,lessStrict:uc,notEqual:cc,notEqualStrict:lc,add:Ru,addN:Mu,addStrict:Fu,atan2:Ou,div:Nu,divNoNan:Lu,divStrict:Bu,floorDiv:Vu,maximum:zu,maximumStrict:ju,minimum:Wu,minimumStrict:Gu,mod:Hu,modStrict:Uu,mul:qu,mulStrict:$u,pow:Ku,powStrict:Xu,squaredDifferenceStrict:Yu,sub:Ju,subStrict:Qu,elu:ul,leakyRelu:cl,prelu:ll,relu:hl,relu6:fl,selu:pl,logicalAnd:Au,logicalNot:ku,logicalOr:Tu,logicalXor:Iu,where:Pu,whereAsync:Du,buffer:Jn,print:Qn,batchToSpaceND:Zn,broadcastTo:tr,cast:er,clone:nr,cumsum:rr,depthToSpace:ir,expandDims:or,eye:ar,multinomial:sr,oneHot:ur,pad:cr,pad1d:lr,pad2d:hr,pad3d:fr,pad4d:pr,rand:dr,randomNormal:mr,randomGamma:vr,randomUniform:gr,reshape:yr,spaceToBatchND:br,squeeze:xr,stack:wr,tile:Er,truncatedNormal:_r,unstack:Cr,setdiff1dAsync:Sr,fill:Tn,linspace:In,ones:An,range:Pn,scalar:yn,tensor:vn,tensor1d:bn,tensor2d:xn,tensor3d:wn,tensor4d:En,tensor5d:_n,tensor6d:Cn,variable:Sn,zeros:kn,onesLike:Dn,zerosLike:Rn,transpose:dl,softmax:qr,logSoftmax:$r,localResponseNormalization:ml,norm:vl,gather:pc,unsortedSegmentSum:dc,basicLSTMCell:gl,multiRNNCell:yl,movingAverage:bl,stridedSlice:xl,topk:wl,scatterND:El,fft:_l,ifft:Cl,rfft:Sl,irfft:Al,sparseToDense:Tl,gatherND:Il,diag:Pl,dropout:Dl,hannWindow:Fl,hammingWindow:Ol,frame:Nl,stft:Ll,inTopKAsync:Vl});function bh(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&S("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))}function xh(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var wh=function(t){function e(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new Kr(e,Vt),e}return a(e,t),e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,h().get("IS_NODE")&&Ye("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:t,dtype:n}),r},e.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;return"complex64"===n?mi(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return st(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return Jn(t.shape,t.dtype,n)},e.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Vt.makeTensorFromDataId(r,e,n,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return e=it(),t(),[2,{kernelMs:it()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Vt.keep(t.clone()),imag:Vt.keep(e.clone())},n},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(bh(t,"slice"),Wr(t.shape,e,n)){var r=Gr(e,t.strides),i=I(n);return vn(this.readSync(t.dataId).subarray(r,r+i),n,t.dtype)}for(var o=Jn(n,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s).map((function(t,n){return t+e[n]}));o.values[s]=a.get.apply(a,u)}return o.toTensor()},e.prototype.stridedSlice=function(t,e,n,r){bh(t,"stridedSlice");var i=Vr(e,n,r);if(i.some((function(t){return 0===t})))return vn([],i);for(var o=Jn(i,t.dtype),a=this.bufferSync(t),s=0;s<o.size;s++){for(var u=o.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];o.set.apply(o,[a.get.apply(a,c)].concat(u))}return o.toTensor()},e.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=Jn([t.size,t.size],t.dtype),r=n.values,i=0;i<e.length;i++)r[i*t.size+i]=e[i];return n.toTensor()},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),i=0,o=0;o<t.rank;o++)o!==e&&(r[i++]=t.shape[o]);var a=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(o=0;o<u.length;o++)a[e]=o,u[o]=this.slice(t,a,s).reshape(r);return u},e.prototype.reverse=function(t,e){bh(t,"reverse");for(var n=Jn(t.shape,t.dtype),r=this.bufferSync(t),i=function(i){var o=n.indexToLoc(i),a=o.slice();e.forEach((function(e){return a[e]=t.shape[e]-1-a[e]})),n.set.apply(n,[r.get.apply(r,a)].concat(o))},o=0;o<n.size;o++)i(o);return n.toTensor()},e.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return dn(t)})),i=t.map((function(t){return mn(t)}));return pn(this.concat(r,e),this.concat(i,e))}var o=t.map((function(t){var n=I(t.shape.slice(e));return t.as2D(-1,n)})),a=hn(o.map((function(t){return t.shape})),1),s=Jn(a,t[0].dtype).values;if(1===o[0].shape[0]){var u=0;o.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;o.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,i=0;i<t.shape[0];++i)for(var o=i*a[1]+c,u=0;u<t.shape[1];++u)s[o+u]=e[r++];c+=t.shape[1]}))}var l=hn(t.map((function(t){return t.shape})),e);return vn(s,l,t[0].dtype)},e.prototype.neg=function(t){return bh(t,"neg"),this.multiply(yn(-1),t)},e.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t+e}))},e.prototype.addN=function(t){var e=this;bh(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=Jn(t[0].shape,t[0].dtype),i=r.values,o=0;o<t.length;o++)for(var a=n[o],s=0;s<i.length;s++)i[s]+=a[s];return r.toTensor()},e.prototype.softmax=function(t,e){var n=L([e],t.shape),r=this.max(t,n),i=on(r.shape,n),o=this.subtract(t,r.reshape(i)),a=this.exp(o),s=this.sum(a,n).reshape(i);return this.realDivide(a,s)},e.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t-e}))},e.prototype.pow=function(t,e){return bh([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},e.prototype.batchMatMul=function(t,e,n,r){bh([t,e],"matMul");for(var i=n?t.shape[1]:t.shape[2],o=n?t.shape[2]:t.shape[1],a=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],h=l[0],f=l[1],p=l[2],d=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=d[0],v=d[1],g=d[2],y=o*a,b=Jn([s,o,a],t.dtype),x=b.values,w=this.blockSize,E=0;E<s;E++)for(var _=0;_<o;_+=w)for(var C=0;C<a;C+=w)for(var S=0;S<i;S+=w)for(var A=Math.min(_+w,o),k=Math.min(C+w,a),T=Math.min(S+w,i),I=_;I<A;I++)for(var P=C;P<k;P++){for(var D=0,R=S;R<T;R++)D+=u[E*h+I*f+R*p]*c[R*m+P*v+E*g];x[E*y+(I*a+P)]+=D}return b.toTensor()},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,i=t.transposeB,o=t.bias,a=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,i);return o&&(u=this.add(u,o)),a&&(u=xh(this,u,a,s)),u},e.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t*e}))},e.prototype.realDivide=function(t,e){return bh([t,e],"realDivide"),this.broadcastedBinaryOp(t,e,"float32",(function(t,e){return t/e}))},e.prototype.floorDiv=function(t,e){return bh([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},e.prototype.sum=function(t,e){bh(t,"sum"),an("sum",e,t.rank);for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,Dt(t.dtype,"int32")),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=0,f=0;f<a;++f)h+=u[l+f];s[c]=h}return o},e.prototype.prod=function(t,e){bh(t,"sum");for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,Dt(t.dtype,"int32")),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=1,f=0;f<a;++f)h*=u[l+f];s[c]=h}return o},e.prototype.unsortedSegmentSum=function(t,e,n){bh(t,"unsortedSegmentSum");for(var r=[],i=t.rank-e.rank,o=0;o<i;++o)e=e.expandDims(o+1);for(o=0;o<n;++o){var a=yn(o,"int32"),s=Zu(a,e).asType("float32").mul(t).sum(0);r.push(s)}return wr(r)},e.prototype.argMin=function(t,e){bh(t,"argMin");var n=[e];an("argMin",n,t.rank);for(var r=rn(t.shape,n),i=r[0],o=r[1],a=kn(i,"int32"),s=I(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],p=0,d=0;d<s;++d){var m=c[h+d];m<f&&(f=m,p=d)}u[l]=p}return a},e.prototype.argMax=function(t,e){bh(t,"argMax");var n=[e];an("argMax",n,t.rank);for(var r=rn(t.shape,n),i=r[0],o=r[1],a=kn(i,"int32"),s=I(o),u=this.readSync(a.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],p=0,d=0;d<s;++d){var m=c[h+d];m>f&&(f=m,p=d)}u[l]=p}return a},e.prototype.cumsum=function(t,e,n,r){if(bh(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var i=Dt(t.dtype,"int32"),o=kn(t.shape,i),a=this.readSync(o.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var f=c(l,h);if(0===h)a[f]=n?0:s[f];else{var p=c(l,h-1);a[f]=n?s[p]+a[p]:s[f]+a[p]}}return o},e.prototype.equal=function(t,e){return bh([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},e.prototype.notEqual=function(t,e){return bh([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},e.prototype.less=function(t,e){return bh([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},e.prototype.lessEqual=function(t,e){return bh([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},e.prototype.greater=function(t,e){return bh([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},e.prototype.greaterEqual=function(t,e){return bh([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},e.prototype.logicalNot=function(t){bh(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")},e.prototype.logicalAnd=function(t,e){return bh([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},e.prototype.logicalOr=function(t,e){return bh([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},e.prototype.select=function(t,e,n){bh([t,e,n],"select");for(var r=this.readSync(t.dataId),i=this.readSync(e.dataId),o=this.readSync(n.dataId),a=kn(e.shape,Dt(e.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:I(e.shape.slice(1)),l=0;l<r.length;l++)for(var h=0;h<c;h++)1===r[l]?s[u++]=i[l]:s[u++]=o[l];return a},e.prototype.where=function(t){bh([t],"where");var e=this.readSync(t.dataId);return Pi(t.shape,e)},e.prototype.topk=function(t,e,n){return bh(t,"topk"),Ii(this.readSync(t.dataId),t.shape,t.dtype,e)},e.prototype.min=function(t,e){bh(t,"min"),an("min",e,t.rank);for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,t.dtype),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0;f<a;++f){var p=u[l+f];p<h&&(h=p)}s[c]=h}return o},e.prototype.minimum=function(t,e){return bh([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},e.prototype.mod=function(t,e){return bh([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},e.prototype.max=function(t,e){bh(t,"max"),an("max",e,t.rank);for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,t.dtype),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0;f<a;++f){var p=u[l+f];p>h&&(h=p)}s[c]=h}return o},e.prototype.maximum=function(t,e){return bh([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},e.prototype.all=function(t,e){bh(t,"all"),an("all",e,t.rank);for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,t.dtype),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0;f<a;++f){var p=u[l+f];h=h&&p}s[c]=h}return o},e.prototype.any=function(t,e){bh(t,"any"),an("any",e,t.rank);for(var n=rn(t.shape,e),r=n[0],i=n[1],o=kn(r,t.dtype),a=I(i),s=this.readSync(o.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*a,h=u[l],f=0;f<a;++f){var p=u[l+f];h=h||p}s[c]=h}return o},e.prototype.squaredDifference=function(t,e){return bh([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},e.prototype.ceil=function(t){bh(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.floor=function(t){bh(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sign=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)e[r]<0?n[r]=-1:e[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,t.shape,"float32")},e.prototype.isNaN=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isInf=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isFinite=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.round=function(t){bh(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=Math.floor(e[r]);e[r]-i<.5?n[r]=Math.floor(e[r]):e[r]-i>.5?n[r]=Math.ceil(e[r]):n[r]=i%2==0?i:i+1}return this.makeOutput(n,t.shape,"float32")},e.prototype.exp=function(t){bh(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.expm1=function(t){bh(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log=function(t){bh(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.log(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.log1p=function(t){bh(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.log1p(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.sqrt=function(t){bh(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=Math.sqrt(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.rsqrt=function(t){bh(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var i=e[r];n[r]=1/Math.sqrt(i)}return this.makeOutput(n,t.shape,"float32")},e.prototype.reciprocal=function(t){bh(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){bh(t,"relu");for(var e=kn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.max(0,r[i]);return e},e.prototype.relu6=function(t){bh(t,"relu");for(var e=kn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),i=0;i<r.length;++i)n[i]=Math.min(Math.max(0,r[i]),6);return e},e.prototype.prelu=function(t,e){return bh([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},e.prototype.elu=function(t){bh(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=n[r];e[r]=i>=0?i:Math.exp(i)-1}return this.makeOutput(e,t.shape,"float32")},e.prototype.eluDer=function(t,e){bh([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),i=this.readSync(t.dataId),o=0;o<r.length;++o){var a=r[o];n[o]=a>=1?i[o]:i[o]*(a+1)}return this.makeOutput(n,e.shape,"float32")},e.prototype.selu=function(t){bh(t,"selu");for(var e=Xa,n=Ya,r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>=0?n*a:e*(Math.exp(a)-1)}return this.makeOutput(r,t.shape,"float32")},e.prototype.clip=function(t,e,n){bh(t,"clip");for(var r=new Float32Array(t.size),i=this.readSync(t.dataId),o=0;o<i.length;++o){var a=i[o];r[o]=a>n?n:a<e?e:a}return this.makeOutput(r,t.shape,"float32")},e.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r){var i=n[2*r],o=n[2*r+1];e[r]=Math.hypot(i,o)}return this.makeOutput(e,t.shape,"float32")},e.prototype.int=function(t){bh(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")},e.prototype.sigmoid=function(t){bh(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")},e.prototype.softplus=function(t){bh(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i]>-e,a=r[i]<e,s=Math.exp(r[i]),u=void 0;u=a?s:o?r[i]:Math.log(1+s),n[i]=u}return this.makeOutput(n,t.shape,"float32")},e.prototype.sin=function(t){bh(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cos=function(t){bh(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tan=function(t){bh(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asin=function(t){bh(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acos=function(t){bh(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan=function(t){bh(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan2=function(t,e){return bh([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},e.prototype.sinh=function(t){bh(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cosh=function(t){bh(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tanh=function(t){bh(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=R(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asinh=function(t){bh(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acosh=function(t){bh(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atanh=function(t){bh(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.erf=function(t){bh(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var i=Math.sign(n[r]),o=Math.abs(n[r]),a=1/(1+.3275911*o);e[r]=i*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-o*o))}return this.makeOutput(e,t.shape,"float32")},e.prototype.step=function(t,e){void 0===e&&(e=0),bh(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];isNaN(o)?n[i]=NaN:n[i]=o>0?1:e}return this.makeOutput(n,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,o=t.activation,a=t.preluActivationWeights,s=this.conv2d(e,n,r);return i&&(s=this.add(s,i)),o&&(s=xh(this,s,o,a)),s},e.prototype.conv2d=function(t,e,n){bh([t,e],"conv2d");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=Jn(n.outShape,t.dtype),h=t.strides[0],f=c?t.strides[1]:t.strides[2],p=c?t.strides[2]:1,d=c?1:t.strides[1],m=l.strides[0],v=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(t.dataId),x=this.readSync(e.dataId),w=l.values,E=0;E<n.batchSize;++E)for(var _=E*h,C=E*m,S=0;S<n.outHeight;++S)for(var A=C+S*v,k=S*n.strideHeight-u,T=0;T<r;T++){var I=k+T*o;if(!(I<0||I>=n.inHeight))for(var P=T*e.strides[0],D=_+I*f,R=0;R<n.outWidth;++R)for(var M=A+R*g,F=R*n.strideWidth-s,O=0;O<i;O++){var N=F+O*a;if(!(N<0||N>=n.inWidth))for(var L=D+N*p,B=P+O*e.strides[1],V=0;V<n.inChannels;++V){for(var z=b[L+V*d],j=0;j<n.outChannels;++j)w[M+j*y]+=z*x[B+j];B+=n.outChannels}}}return l.toTensor()},e.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,i=n.filterHeight,o=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,f=Jn(n.outShape,t.dtype),p=this.readSync(t.dataId),d=this.readSync(e.dataId),m=f.values,v=0;v<n.batchSize;++v)for(var g=v*t.strides[0],y=v*f.strides[0],b=0;b<n.outDepth;++b)for(var x=y+b*f.strides[1],w=b*n.strideDepth-c,E=0;E<r;E++){var _=w+E*a;if(!(_<0||_>=n.inDepth))for(var C=E*e.strides[0],S=g+_*t.strides[1],A=0;A<n.outHeight;++A)for(var k=x+A*f.strides[2],T=A*n.strideHeight-h,I=0;I<i;I++){var P=T+I*s;if(!(P<0||P>=n.inHeight))for(var D=C+I*e.strides[1],R=S+P*t.strides[2],M=0;M<n.outWidth;++M)for(var F=k+M*n.outChannels,O=M*n.strideWidth-l,N=0;N<o;N++){var L=O+N*u;if(!(L<0||L>=n.inWidth))for(var B=D+N*e.strides[2],V=R+L*n.inChannels,z=B,j=0;j<n.inChannels;++j){for(var W=p[V+j],G=0;G<n.outChannels;++G)m[F+G]+=W*d[z+G];z+=n.outChannels}}}}return f.toTensor()},e.prototype.conv2dDerInput=function(t,e,n){bh([t,e],"conv2dDerInput");for(var r=Jn(n.inShape,"float32"),i=r.values,o=this.readSync(t.dataId),a=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],h=n.batchSize,f=n.filterHeight,p=n.filterWidth,d=n.inChannels,m=n.inHeight,v=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,E=n.dataFormat,_=f-1-n.padInfo.top,C=p-1-n.padInfo.left,S="channelsLast"===E,A=r.strides[0],k=S?r.strides[1]:r.strides[2],T=S?r.strides[2]:1,I=S?1:r.strides[1],P=t.strides[0],D=S?t.strides[1]:t.strides[2],R=S?t.strides[2]:1,M=S?1:t.strides[1],F=0;F<h;++F)for(var O=0;O<d;++O)for(var N=0;N<m;++N)for(var L=N-_,B=Math.max(0,Math.ceil(L/x)),V=Math.min(y,(f+L)/x),z=0;z<v;++z){for(var j=z-C,W=Math.max(0,Math.ceil(j/w)),G=Math.min(b,(p+j)/w),H=0,U=B;U<V;++U)for(var q=U*x-L,$=W;$<G;++$)for(var K=P*F+D*U+R*$,X=u*(f-1-q)+c*(p-1-($*w-j))+l*O,Y=0;Y<g;++Y)H+=o[K+M*Y]*a[X+Y];i[A*F+k*N+T*z+I*O]=H}return r.toTensor()},e.prototype.conv3dDerInput=function(t,e,n){for(var r=Jn(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=o[3],l=this.readSync(t.dataId),h=t.strides,f=h[0],p=h[1],d=h[2],m=h[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],x=g[2],w=g[3],E=n.batchSize,_=n.filterDepth,C=n.filterHeight,S=n.filterWidth,A=n.inChannels,k=n.inDepth,T=n.inHeight,I=n.inWidth,P=n.outChannels,D=n.outDepth,R=n.outHeight,M=n.outWidth,F=n.strideDepth,O=n.strideHeight,N=n.strideWidth,L=_-1-n.padInfo.front,B=C-1-n.padInfo.top,V=S-1-n.padInfo.left,z=0;z<E;++z)for(var j=0;j<A;++j)for(var W=0;W<k;++W)for(var G=W-L,H=Math.max(0,Math.ceil(G/F)),U=Math.min(D,(_+G)/F),q=0;q<T;++q)for(var $=q-B,K=Math.max(0,Math.ceil($/O)),X=Math.min(R,(C+$)/O),Y=0;Y<I;++Y){for(var J=Y-V,Q=Math.max(0,Math.ceil(J/N)),Z=Math.min(M,(S+J)/N),tt=0,et=H;et<U;++et)for(var nt=et*F-G,rt=K;rt<X;++rt)for(var it=rt*O-$,ot=Q;ot<Z;++ot)for(var at=f*z+p*et+d*rt+m*ot,st=y*(_-1-nt)+b*(C-1-it)+x*(S-1-(ot*N-J))+w*j,ut=0;ut<P;++ut)tt+=l[at+ut]*v[st+ut];i[a*z+s*W+u*q+c*Y+j]=tt}return r.toTensor()},e.prototype.conv2dDerFilter=function(t,e,n){bh([t,e],"conv2dDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=Jn(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(t),f=this.bufferSync(e),p=0;p<o;++p)for(var d=Math.max(0,Math.ceil((l-p)/r)),m=Math.min(n.outHeight,(n.inHeight+l-p)/r),v=0;v<a;++v)for(var g=Math.max(0,Math.ceil((c-v)/i)),y=Math.min(n.outWidth,(n.inWidth+c-v)/i),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,E=0;E<n.batchSize;++E)for(var _=d;_<m;++_)for(var C=p+_*r-l,S=g;S<y;++S){var A=v+S*i-c;w+=s?h.get(E,C,A,b)*f.get(E,_,S,x):h.get(E,b,C,A)*f.get(E,x,_,S)}u.set(w,p,v,b,x)}return u.toTensor()},e.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=Jn(n.filterShape,"float32"),l=c.values,h=c.strides,f=h[0],p=h[1],d=h[2],m=h[3],v=this.readSync(e.dataId),g=e.strides,y=g[0],b=g[1],x=g[2],w=g[3],E=this.readSync(t.dataId),_=t.strides,C=_[0],S=_[1],A=_[2],k=_[3],T=n.padInfo.front,I=n.padInfo.left,P=n.padInfo.top,D=0;D<a;++D)for(var R=Math.max(0,Math.ceil((T-D)/r)),M=Math.min(n.outDepth,(n.inDepth+T-D)/r),F=D*f,O=0;O<s;++O)for(var N=Math.max(0,Math.ceil((P-O)/i)),L=Math.min(n.outHeight,(n.inHeight+P-O)/i),B=O*p+F,V=0;V<u;++V)for(var z=Math.max(0,Math.ceil((I-V)/o)),j=Math.min(n.outWidth,(n.inWidth+I-V)/o),W=V*d+B,G=0;G<n.inChannels;++G)for(var H=G*m+W,U=0;U<n.outChannels;++U){for(var q=0,$=0;$<n.batchSize;++$)for(var K=$*C,X=$*y,Y=R;Y<M;++Y)for(var J=(D+Y*r-T)*S+K,Q=Y*b+X,Z=N;Z<L;++Z)for(var tt=(O+Z*i-P)*A+J,et=Z*x+Q,nt=z;nt<j;++nt){var rt=nt*w+et;q+=E[(V+nt*o-I)*k+tt+G]*v[rt+U]}l[H+U]=q}return c.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var e=t.input,n=t.filter,r=t.convInfo,i=t.bias,o=t.activation,a=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return i&&(s=this.add(s,i)),o&&(s=xh(this,s,o,a)),s},e.prototype.depthwiseConv2D=function(t,e,n){bh([t,e],"depthwiseConv2D");for(var r=n.filterHeight,i=n.filterWidth,o=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=Jn(n.outShape,t.dtype),h=this.readSync(t.dataId),f=this.readSync(e.dataId),p=l.values,d=0;d<n.batchSize;++d)for(var m=d*t.strides[0],v=d*l.strides[0],g=0;g<n.outHeight;++g)for(var y=v+g*l.strides[1],b=g*n.strideHeight-s,x=0;x<r;++x){var w=b+x*o;if(!(w<0||w>=n.inHeight))for(var E=x*e.strides[0],_=m+w*t.strides[1],C=0;C<n.outWidth;++C)for(var S=y+C*l.strides[2],A=C*n.strideWidth-u,k=0;k<i;++k){var T=A+k*a;if(!(T<0||T>=n.inWidth))for(var I=E+k*e.strides[1],P=_+T*n.inChannels,D=S,R=I,M=0;M<n.inChannels;++M){for(var F=h[P+M],O=0;O<c;++O)p[D+O]+=F*f[R+O];D+=c,R+=c}}}return l.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,e,n){bh([t,e],"depthwiseConv2DDerInput");for(var r=Jn(n.inShape,"float32"),i=r.values,o=r.strides,a=o[0],s=o[1],u=o[2],c=this.readSync(t.dataId),l=t.strides,h=l[0],f=l[1],p=l[2],d=this.readSync(e.dataId),m=e.strides,v=m[0],g=m[1],y=m[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,E=n.inChannels,_=n.inHeight,C=n.inWidth,S=n.outChannels,A=n.outHeight,k=n.outWidth,T=n.strideHeight,I=n.strideWidth,P=x-1-n.padInfo.top,D=w-1-n.padInfo.left,R=S/E,M=0;M<b;++M)for(var F=0;F<E;++F)for(var O=0;O<_;++O)for(var N=O-P,L=Math.max(0,Math.ceil(N/T)),B=Math.min(A,(x+N)/T),V=0;V<C;++V){for(var z=V-D,j=Math.max(0,Math.ceil(z/I)),W=Math.min(k,(w+z)/I),G=0,H=L;H<B;++H)for(var U=H*T-N,q=j;q<W;++q)for(var $=h*M+f*H+p*q,K=v*(x-1-U)+g*(w-1-(q*I-z))+y*F,X=0;X<R;++X)G+=c[$+(F*R+X)]*d[K+X];i[a*M+s*O+u*V+F]=G}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){bh([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=Jn(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(t),f=this.bufferSync(e),p=0;p<o;++p)for(var d=Math.max(0,Math.ceil((c-p)/r)),m=Math.min(n.outHeight,(n.inHeight+c-p)/r),v=0;v<a;++v)for(var g=Math.max(0,Math.ceil((u-v)/i)),y=Math.min(n.outWidth,(n.inWidth+u-v)/i),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/l),w=b%l,E=0,_=0;_<n.batchSize;++_)for(var C=d;C<m;++C)for(var S=p+C*r-c,A=g;A<y;++A){var k=v+A*i-u;E+=h.get(_,S,k,x)*f.get(_,C,A,b)}s.set(E,p,v,x,w)}return s.toTensor()},e.prototype.tile=function(t,e){return bh(t,"tile"),Ti(this.bufferSync(t),e)},e.prototype.pad=function(t,e,n){bh(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),i=e.map((function(t){return t[0]})),o=this.bufferSync(t),a=Jn(r,t.dtype);0!==n&&a.values.fill(n);for(var s=0;s<t.size;s++){var u=o.indexToLoc(s),c=u.map((function(t,e){return t+i[e]}));a.set.apply(a,[o.get.apply(o,u)].concat(c))}return a.toTensor()},e.prototype.transpose=function(t,e){bh(t,"transpose");for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[e[r]];var i=this.readSync(t.dataId),o=Jn(n,t.dtype),a=this.bufferSync(t);for(r=0;r<t.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[e[c]];var l=o.locToIndex(u);o.values[l]=i[r]}return o.toTensor()},e.prototype.gather=function(t,e,n){bh([t,e],"gather");var r=t.shape.slice(),i=this.readSync(e.dataId);r[n]=i.length;for(var o=Jn(r,t.dtype),a=this.bufferSync(t),s=0;s<o.size;++s){var u=o.indexToLoc(s),c=u.slice();c[n]=i[u[n]];var l=a.locToIndex(c);o.values[s]=a.values[l]}return o.toTensor()},e.prototype.batchToSpaceND=function(t,e,n){bh([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),i=Ar(t.shape,e,r),o=kr(i.length,e.length),a=Tr(t.shape,e,r),s=Ir(n,e.length),u=Pr(a,n,e.length);return t.reshape(i).transpose(o).reshape(a).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){bh([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),i=[[0,0]];i.push.apply(i,n);for(var o=1+e.length;o<t.shape.length;++o)i.push([0,0]);var a=t.pad(i),s=Ar(a.shape,e,r,!1),u=kr(s.length,e.length,!1),c=Tr(a.shape,e,r,!1);return a.reshape(s).transpose(u).reshape(c)},e.prototype.pool=function(t,e,n){bh(t,"pool");for(var r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,f=this.readSync(t.dataId),p=Jn(e.outShape,t.dtype),d=p.values,m=e.outShape[1]*e.outShape[2]*e.outShape[3],v=e.outShape[2]*e.outShape[3],g=e.outShape[3],y=0;y<e.batchSize;++y)for(var b=y*m,x=y*t.strides[0],w=0;w<e.inChannels;++w)for(var E=0;E<e.outHeight;++E)for(var _=E*r-c,C=Math.max(0,_),S=Math.min(e.inHeight,s+_),A=b+E*v,k=0;k<e.outWidth;++k){for(var T=k*i-l,I=Math.max(0,T),P=Math.min(e.inWidth,u+T),D=h,R=0,M=0,F=C;F<S;F+=o){for(var O=x+F*t.strides[1],N=I;N<P;N+=a){var L=f[O+N*t.strides[2]+w];"max"===n&&L>D?D=L:"avg"===n&&(R+=L,M++)}if(isNaN(D))break}d[A+k*g+w]="avg"===n?R/M:D}return p.toTensor()},e.prototype.maxPool=function(t,e){return this.pool(t,e,"max")},e.prototype.maxPoolPositions=function(t,e){for(var n=Jn(e.outShape,"int32"),r=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=e.padInfo.top,l=e.padInfo.left,h=this.bufferSync(t),f=0;f<e.batchSize;++f)for(var p=0;p<e.inChannels;++p)for(var d=0;d<e.outHeight;++d){for(var m=d*r-c,v=m;v<0;)v+=o;for(var g=Math.min(e.inHeight,s+m),y=0;y<e.outWidth;++y){for(var b=y*i-l,x=b;x<0;)x+=a;for(var w=Math.min(e.inWidth,u+b),E=Number.NEGATIVE_INFINITY,_=-1,C=v;C<g;C+=o)for(var S=C-m,A=x;A<w;A+=a){var k=A-b,T=h.get(f,C,A,p);T>E&&(E=T,_=S*u+k)}n.set(_,f,d,y,p)}}return n.toTensor()},e.prototype.maxPoolBackprop=function(t,e,n,r){bh([e,n],"maxPoolBackprop");for(var i=this.maxPoolPositions(e,r),o=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,h=l-1-r.padInfo.left,f=c-1-r.padInfo.top,p=Jn(e.shape,"float32"),d=this.bufferSync(i),m=this.bufferSync(t),v=0;v<r.batchSize;++v)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var x=y-f,w=b-h,E=0,_=0;_<c;_+=s){var C=(x+_)/o;if(!(C<0||C>=r.outHeight||Math.floor(C)!==C))for(var S=0;S<l;S+=u){var A=(w+S)/a;if(!(A<0||A>=r.outWidth||Math.floor(A)!==A)){var k=c*l-1-d.get(v,C,A,g)===_*l+S?1:0;0!==k&&(E+=m.get(v,C,A,g)*k)}}}p.set(E,v,y,b,g)}return p.toTensor()},e.prototype.avgPoolBackprop=function(t,e,n){bh([t,e],"avgPoolBackprop");for(var r=n.strideHeight,i=n.strideWidth,o=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,f=c-1-n.padInfo.top,p=Jn(e.shape,"float32"),d=1/(o*a),m=this.bufferSync(t),v=0;v<n.batchSize;++v)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var x=y-f,w=b-h,E=0,_=0;_<c;_+=s){var C=(x+_)/r;if(!(C<0||C>=n.outHeight||Math.floor(C)!==C))for(var S=0;S<l;S+=u){var A=(w+S)/i;A<0||A>=n.outWidth||Math.floor(A)!==A||(E+=m.get(v,C,A,g))}}p.set(E*d,v,y,b,g)}return p.toTensor()},e.prototype.pool3d=function(t,e,n){bh(t,"pool3d");for(var r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,d=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=this.readSync(t.dataId),g=Jn(e.outShape,t.dtype),y=g.values,b=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[3]*e.outShape[4],E=e.outShape[4],_=0;_<e.batchSize;++_)for(var C=_*b,S=_*t.strides[0],A=0;A<e.inChannels;++A)for(var k=0;k<e.outDepth;++k){for(var T=k*r-f,I=T;I<0;)I+=a;for(var P=Math.min(e.inDepth,c+T),D=C+k*x,R=0;R<e.outHeight;++R){for(var M=R*i-p,F=M;F<0;)F+=s;for(var O=Math.min(e.inHeight,l+M),N=D+R*w,L=0;L<e.outWidth;++L){for(var B=L*o-d,V=B;V<0;)V+=u;for(var z=Math.min(e.inWidth,h+B),j=N+L*E,W=m,G=0,H=0,U=I;U<P;U+=a){for(var q=S+U*t.strides[1],$=F;$<O;$+=s){for(var K=q+$*t.strides[2],X=V;X<z;X+=u){var Y=v[K+X*t.strides[3]+A];if("max"===n&&Y>W?W=Y:"avg"===n&&(G+=Y,H++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}y[j+A]="avg"===n?G/H:W}}}return g.toTensor()},e.prototype.avgPool3d=function(t,e){return bh(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,e,n){bh([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,i=n.strideHeight,o=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,f=n.effectiveFilterDepth,p=n.effectiveFilterHeight,d=n.effectiveFilterWidth,m=f-1-n.padInfo.front,v=d-1-n.padInfo.left,g=p-1-n.padInfo.top,y=Jn(e.shape,"float32"),b=1/(a*s*u),x=this.bufferSync(t),w=0;w<n.batchSize;++w)for(var E=0;E<n.inChannels;++E)for(var _=0;_<n.inDepth;++_)for(var C=0;C<n.inHeight;++C)for(var S=0;S<n.inWidth;++S){for(var A=_-m,k=C-g,T=S-v,I=0,P=0;P<f;P+=c){var D=(A+P)/r;if(!(D<0||D>=n.outDepth||Math.floor(D)!==D))for(var R=0;R<p;R+=l){var M=(k+R)/i;if(!(M<0||M>=n.outHeight||Math.floor(M)!==M))for(var F=0;F<d;F+=h){var O=(T+F)/o;O<0||O>=n.outWidth||Math.floor(O)!==O||(I+=x.get(w,D,M,O,E))}}}y.set(I*b,w,_,C,S,E)}return y.toTensor()},e.prototype.maxPool3d=function(t,e){return bh(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,e){for(var n=Jn(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,o=e.strideWidth,a=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,d=e.padInfo.left,m=this.bufferSync(t),v=0;v<e.batchSize;++v)for(var g=0;g<e.inChannels;++g)for(var y=0;y<e.outDepth;++y){for(var b=y*r-f,x=b;x<0;)x+=a;for(var w=Math.min(e.inDepth,c+b),E=0;E<e.outHeight;++E){for(var _=E*i-p,C=_;C<0;)C+=s;for(var S=Math.min(e.inHeight,l+_),A=0;A<e.outWidth;++A){for(var k=A*o-d,T=k;T<0;)T+=u;for(var I=Math.min(e.inWidth,h+k),P=Number.NEGATIVE_INFINITY,D=-1,R=x;R<w;R+=a)for(var M=R-b,F=C;F<S;F+=s)for(var O=F-_,N=T;N<I;N+=u){var L=N-k,B=m.get(v,R,F,N,g);B>=P&&(P=B,D=M*l*h+O*l+L)}n.set(D,v,y,E,A,g)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(t,e,n,r){bh([e,n],"maxPool3dBackprop");for(var i=this.maxPool3dPositions(e,r),o=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,d=h-1-r.padInfo.front,m=p-1-r.padInfo.left,v=f-1-r.padInfo.top,g=Jn(e.shape,"float32"),y=this.bufferSync(i),b=this.bufferSync(t),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var E=0;E<r.inDepth;++E)for(var _=0;_<r.inHeight;++_)for(var C=0;C<r.inWidth;++C){for(var S=E-d,A=_-v,k=C-m,T=0,I=0;I<h;I+=u){var P=(S+I)/o;if(!(P<0||P>=r.outDepth||Math.floor(P)!==P))for(var D=0;D<f;D+=c){var R=(A+D)/a;if(!(R<0||R>=r.outHeight||Math.floor(R)!==R))for(var M=0;M<p;M+=l){var F=(k+M)/s;if(!(F<0||F>=r.outWidth||Math.floor(F)!==F)){var O=h*f*p-1-y.get(x,P,R,F,w)===I*f*p+D*p+M?1:0;0!==O&&(T+=b.get(x,P,R,F,w)*O)}}}}g.set(T,x,E,_,C,w)}return g.toTensor()},e.prototype.cast=function(t,e){return fi(t,e,this)},e.prototype.reshape=function(t,e){return pi(t,e)},e.prototype.avgPool=function(t,e){return bh(t,"avgPool"),this.pool(t,e,"avg").toFloat()},e.prototype.resizeBilinear=function(t,e,n,r){bh(t,"resizeBilinear");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(I([o,e,n,u])),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],p=0,d=h[0]/f[0],m=h[1]/f[1],v=0;v<o;v++)for(var g=0;g<e;g++)for(var y=d*g,b=Math.floor(y),x=y-b,w=Math.min(a-1,Math.ceil(y)),E=v*t.strides[0]+b*t.strides[1],_=v*t.strides[0]+w*t.strides[1],C=0;C<n;C++)for(var S=m*C,A=Math.floor(S),k=S-A,T=Math.min(s-1,Math.ceil(S)),P=E+A*t.strides[2],D=_+A*t.strides[2],R=E+T*t.strides[2],M=_+T*t.strides[2],F=0;F<u;F++){var O=c[P+F],N=c[D+F],L=O+(c[R+F]-O)*k,B=L+(N+(c[M+F]-N)*k-L)*x;l[p++]=B}return vn(l,[o,e,n,u])},e.prototype.resizeBilinearBackprop=function(t,e,n){bh([t,e],"resizeBilinearBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=[n&&c>1?o-1:o,n&&l>1?a-1:a],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],d=f[0]/p[0],m=f[1]/p[1],v=this.readSync(t.dataId),g=0,y=0;y<i;y++)for(var b=y*e.strides[0],x=0;x<c;x++)for(var w=x*d,E=Math.floor(w),_=Math.min(Math.ceil(w),o-1),C=b+E*e.strides[1],S=b+_*e.strides[1],A=w-E,k=1-A,T=0;T<l;T++)for(var I=T*m,P=Math.floor(I),D=Math.min(Math.ceil(I),a-1),R=I-P,M=1-R,F=C+P*e.strides[2],O=C+D*e.strides[2],N=S+P*e.strides[2],L=S+D*e.strides[2],B=k*M,V=k*R,z=A*M,j=A*R,W=0;W<s;W++){var G=v[g++];h[F+W]+=G*B,h[O+W]+=G*V,h[N+W]+=G*z,h[L+W]+=G*j}return En(h,[i,a,o,s],e.dtype)},e.prototype.resizeNearestNeighbor=function(t,e,n,r){bh(t,"resizeNearestNeighbor");for(var i=t.shape,o=i[0],a=i[1],s=i[2],u=i[3],c=this.readSync(t.dataId),l=new Float32Array(o*e*n*u),h=[r&&e>1?a-1:a,r&&n>1?s-1:s],f=[r&&e>1?e-1:e,r&&n>1?n-1:n],p=h[0]/f[0],d=h[1]/f[1],m=0,v=0;v<o;v++)for(var g=v*t.strides[0],y=0;y<e;y++)for(var b=p*y,x=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*t.strides[1],w=0;w<n;w++)for(var E=d*w,_=x+Math.min(s-1,r?Math.round(E):Math.floor(E))*t.strides[2],C=0;C<u;C++){var S=c[_+C];l[m++]=S}return vn(l,[o,e,n,u],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){bh([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,i=r[0],o=r[1],a=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],h=new Float32Array(i*o*a*s),f=this.readSync(t.dataId),p=[n&&c>1?o-1:o,n&&l>1?a-1:a],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=p[0]/d[0],v=p[1]/d[1],g=1/m,y=1/v,b=2*Math.ceil(g)+2,x=2*Math.ceil(y)+2,w=0;w<i;w++)for(var E=w*e.strides[0],_=0;_<o;_++)for(var C=E+_*e.strides[1],S=Math.floor(_*g),A=Math.floor(S-b/2),k=0;k<a;k++)for(var T=C+k*e.strides[2],I=Math.floor(k*y),P=Math.floor(I-x/2),D=0;D<s;D++){for(var R=0,M=0;M<b;M++){var F=M+A;if(!(F<0||F>=c)){var O=E+F*t.strides[1],N=F*m;if(_===Math.min(o-1,n?Math.round(N):Math.floor(N)))for(var L=0;L<x;L++){var B=L+P;if(!(B<0||B>=l)){var V=O+B*t.strides[2],z=B*v;k===Math.min(a-1,n?Math.round(z):Math.floor(z))&&(R+=f[V+D])}}}}h[T+D]=R}return En(h,e.shape,e.dtype)},e.prototype.batchNormalization=function(t,e,n,r,i,o){bh([t,e,n,i,o],"batchNorm");for(var a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=i?this.readSync(i.dataId):new Float32Array([1]),l=o?this.readSync(o.dataId):new Float32Array([0]),h=new Float32Array(a.length),f=l.length,p=c.length,d=u.length,m=s.length,v=0,g=0,y=0,b=0,x=0;x<a.length;++x)h[x]=l[v++]+(a[x]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),v>=f&&(v=0),g>=m&&(g=0),y>=p&&(y=0),b>=d&&(b=0);return En(h,t.shape)},e.prototype.localResponseNormalization4D=function(t,e,n,r,i){bh(t,"localResponseNormalization4D");var o=t.shape[3],a=o-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%o,r=t-n+Math.max(0,n-e),i=t-n+Math.min(n+e,a),u=0;r<=i;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var f=l(h),p=s[h]*Math.pow(n+r*f,-i);c[h]=p}return En(c,t.shape)},e.prototype.LRNGrad=function(t,e,n,r,i,o,a){bh(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),h=new Float32Array(t.size),f=t.size,p=0;p<f;p++){for(var d=p%s,m=p-d+Math.max(0,d-r),v=p-d+Math.min(s,d+r+1),g=0,y=m;y<v;y++)g+=Math.pow(c[y],2);for(g=o*g+i,y=m;y<v;y++){var b=-2*o*a*c[y]*l[p]/g;p===y&&(b+=Math.pow(g,-a)),b*=u[p],h[y]+=b}}return En(h,t.shape)},e.prototype.multinomial=function(t,e,n,r){bh(t,"multinomial");for(var i=e?t:qr(t),o=i.shape[0],a=i.shape[1],s=kn([o,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(i.dataId),l=0;l<o;++l){var h=l*a,f=new Float32Array(a-1);f[0]=c[h];for(var p=1;p<f.length;++p)f[p]=f[p-1]+c[h+p];for(var d=$n(r.toString()),m=l*n,v=0;v<n;++v){var g=d();u[m+v]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[m+v]=y;break}}}return s},e.prototype.oneHot=function(t,e,n,r){bh(t,"oneHot");var i=new Float32Array(t.size*e);i.fill(r);for(var o=this.readSync(t.dataId),a=0;a<t.size;++a)o[a]>=0&&o[a]<e&&(i[a*e+o[a]]=n);return xn(i,[t.size,e],"int32")},e.prototype.nonMaxSuppression=function(t,e,n,r,i){return bh(t,"nonMaxSuppression"),wi(this.readSync(t.dataId),this.readSync(e.dataId),n,r,i)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],i=Jn(t.shape,"float32"),o=Jn(t.shape,"float32"),a=dn(t).as2D(n,r),s=mn(t).as2D(n,r),u=0;u<n;u++)for(var c=a.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=pn(c,l),f=this.readSync(this.fftImpl(h,e).dataId),p=0;p<r;p++){var d=vi(f,p);i.values[u*r+p]=d.real,o.values[u*r+p]=d.imag}return pn(i.toTensor(),o.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var i=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(i=pn(dn(i).div(yn(r)),mn(i).div(yn(r)))),i}var o=this.readSync(t.dataId),a=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(o,r,e));return pn(a.real,a.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return 0==(t&t-1)},e.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),i=e/2,o=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),a=pn(o.real,o.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}(r),u=pn(s.real,s.imag).as1D();a=this.fftRadix2(a,i,n),u=this.fftRadix2(u,i,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),i=0;i<Math.ceil(t/2);i++){var o=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}}(e,n),l=pn(c.real,c.imag).mul(u),h=a.add(l),f=a.sub(l),p=dn(h).concat(dn(f)),d=mn(h).concat(mn(f));return pn(p,d).as1D()},e.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),i=0;i<e;i++){for(var o=0,a=0,s=0;s<e;s++){var u=yi(i*s,e,n),c=vi(t,s);o+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(o/=e,a/=e),gi(r,o,a,i)}return r},e.prototype.depthToSpace=function(t,e,n){S("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),S(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],i=t.shape[1],o=t.shape[2],a=t.shape[3],s=i*e,u=o*e,c=a/(e*e),l=this.readSync(t.dataId),h=new Float32Array(r*s*u*c),f=0,p=0;p<r;++p)for(var d=0;d<s;++d)for(var m=Math.floor(d/e),v=d%e,g=0;g<u;++g)for(var y=Math.floor(g/e),b=(v*e+g%e)*c,x=0;x<c;++x){var w=x+b+a*(y+o*(m+i*p));h[f++]=l[w]}return En(h,[r,s,u,c])},e.prototype.broadcastedBinaryOp=function(t,e,n,r){var i=Zr(t.shape,e.shape),o=Jn(i,n),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Jr(t.shape,i),c=Jr(e.shape,i),l=o.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(a[h%a.length],s[h%s.length]);else{var f=this.bufferSync(t),p=this.bufferSync(e),d=function(n){var i=o.indexToLoc(n),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var d=f.locToIndex(h),m=i.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var v=p.locToIndex(m);l[n]=r(a[d],s[v])};for(h=0;h<l.length;++h)d(h)}return o.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=Zr(t.shape,e.shape),i=Jn(r,"float32"),o=Jn(r,"float32"),a=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Jr(t.shape,r),c=Jr(e.shape,r),l=i.values,h=o.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var p=f%a.length,d=f%s.length,m=n(a[2*p],a[2*p+1],s[2*d],s[2*d+1]);l[f]=m.real,h[f]=m.imag}else{var v=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var o=i.indexToLoc(r),f=o.slice(-t.rank);u.forEach((function(t){return f[t]=0}));var p=v.locToIndex(f),d=o.slice(-e.rank);c.forEach((function(t){return d[t]=0}));var m=g.locToIndex(d),y=n(a[2*p],a[2*p+1],s[2*m],s[2*m+1]);l[r]=y.real,h[r]=y.imag};for(f=0;f<l.length;f++)y(f)}return this.complex(i.toTensor(),o.toTensor())},e.prototype.split=function(t,e,n){return ki(t,e,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,e,n,r,i,o){for(var a=t.shape,s=a[0],u=a[1],c=a[2],l=a[3],h=e.shape[0],f=r[0],p=r[1],d=Jn([h,f,p,l],"float32"),m=this.readSync(e.dataId),v=this.readSync(n.dataId),g=this.readSync(t.dataId),y=t.strides,b=d.strides,x=0;x<h;x++){var w=4*x,E=m[w],_=m[w+1],C=m[w+2],S=m[w+3],A=v[x];if(!(A>=s))for(var k=f>1?(C-E)*(u-1)/(f-1):0,T=p>1?(S-_)*(c-1)/(p-1):0,I=0;I<f;I++){var P=f>1?E*(u-1)+I*k:.5*(E+C)*(u-1);if(P<0||P>u-1)for(var D=0;D<p;D++)for(var R=0;R<l;R++){var M=R+D*b[2]+I*b[1]+x*b[0];d.values[M]=o}else if("bilinear"===i){var F=Math.floor(P),O=Math.ceil(P),N=P-F;for(D=0;D<p;D++)if((U=p>1?_*(c-1)+D*T:.5*(_+S)*(c-1))<0||U>c-1)for(R=0;R<l;R++)M=R+D*b[2]+I*b[1]+x*b[0],d.values[M]=o;else{var L=Math.floor(U),B=Math.ceil(U),V=U-L;for(R=0;R<l;R++){var z=g[M=R+L*y[2]+F*y[1]+A*y[0]],j=g[M=R+B*y[2]+F*y[1]+A*y[0]],W=g[M=R+L*y[2]+O*y[1]+A*y[0]],G=z+(j-z)*V,H=W+(g[M=R+B*y[2]+O*y[1]+A*y[0]]-W)*V;M=R+D*b[2]+I*b[1]+x*b[0],d.values[M]=G+(H-G)*N}}}else for(D=0;D<p;++D){var U;if((U=p>1?_*(c-1)+D*T:.5*(_+S)*(c-1))<0||U>c-1)for(R=0;R<l;R++)M=R+D*b[2]+I*b[1]+x*b[0],d.values[M]=o;else{var q=Math.round(U),$=Math.round(P);for(R=0;R<l;R++){var K=R+q*y[2]+$*y[1]+A*y[0],X=R+D*b[2]+I*b[1]+x*b[0];d.values[X]=g[K]}}}}}return d.toTensor()},e.prototype.sparseToDense=function(t,e,n,r){var i=Nr(0,t,n),o=i.sliceRank,a=i.numUpdates,s=i.sliceSize,u=i.strides,c=i.outputSize;return this.scatter(t,e,n,c,s,a,o,u,r,!1)},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],i=Dr(t,e),o=i[0],a=i[1],s=i[2],u=i[3];if(0===a)return vn([],o,t.dtype);for(var c=new bt([a,s],t.dtype),l=this.readSync(e.dataId),h=this.readSync(t.dataId),f=0;f<a;f++){for(var p=[],d=0,m=0;m<r;m++){var v=l[f*r+m];d+=v*u[m],p.push(v)}if(d<0||d>=t.size/s)throw new Error("Invalid indices: "+p+" does not index into "+t.shape);for(var g=0;g<s;g++)c.values[f*s+g]=h[d*s+g]}return c.toTensor().reshape(o)},e.prototype.scatterND=function(t,e,n){var r=Nr(0,t,n),i=r.sliceRank,o=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=yn(0);return this.scatter(t,e,n,u,a,o,i,s,c,!0)},e.prototype.fill=function(t,e,n){var r=z(n=n||Y(e),I(t));return r.fill(e),Vt.makeTensor(r,t,n,this)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var e=z(t.dtype,I(t.shape));return this.makeOutput(e,t.shape,t.dtype)},e.prototype.linspace=function(t,e,n){return di(t,e,n)},e.prototype.scatter=function(t,e,n,r,i,o,a,s,u,c){var l=[r/i,i],h=this.readSync(t.dataId),f=this.readSync(e.dataId);if(0===r)return vn([],n,e.dtype);var p=new bt(l,e.dtype);p.values.fill(this.readSync(u.dataId)[0]);for(var d=0;d<o;d++){for(var m=[],v=0,g=0;g<a;g++){var y=h[d*a+g];m.push(y),v+=y*s[g]}if(v<0||v>=r/i)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var b=0;b<i;b++)c?p.values[v*i+b]+=f[d*i+b]:p.values[v*i+b]=0===e.rank?f[0]:f[d*i+b]}return p.toTensor().reshape(n)},e}(Xr);Vt.registerBackend("cpu",(function(){return new wh}),1);for(var Eh=0,_h=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,f=n;bh(o,"NonMaxSuppressionWithScore");var p=Ei(f.data.get(o.dataId).values,f.data.get(a.dataId).values,u,c,l,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n;bh(r,"square");for(var o=i.data.get(r.dataId).values,a=new Float32Array(o.length),s=0;s<o.length;++s){var u=o[s];a[s]=u*u}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Ps,backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,i=r.a,o=r.b,a=n;bh([i,o],Ps);var s=a.data.get(i.dataId).values,u=a.data.get(o.dataId).values,c=function(t,e,n,r,i,o){var a=Zr(t,e),s=a.length,u=Z(a),c=V(i,I(a)),l=t.length,h=e.length,f=Z(t),p=Z(e),d=Jr(t,a),m=Jr(e,a);if(d.length+m.length===0)for(var v=0;v<c.length;++v)c[v]=o(n[v%n.length],r[v%r.length]);else{var g=function(t){var e=ct(t,s,u),i=e.slice(-l);d.forEach((function(t){return i[t]=0}));var a=ut(i,l,f),v=e.slice(-h);m.forEach((function(t){return v[t]=0}));var g=ut(v,h,p);c[t]=o(n[a],r[g])};for(v=0;v<c.length;++v)g(v)}return[c,a]}(i.shape,o.shape,s,u,i.dtype,(function(t,e){var n=t-e;return n*n})),l=c[0],h=c[1];return{dataId:a.write(l,h,i.dtype),shape:h,dtype:i.dtype}}}];Eh<_h.length;Eh++)y(_h[Eh]);for(var Ch,Sh=function(t){this.variableNames=["A"];var e=Ni(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Ah=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Ni(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},kh=0,Th=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,i=e.pixels,o=r.numChannels,a="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,u=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],c=u[0],l=u[1],f=[l,c],p=[l,c,o];(s||a)&&(null==Ch&&(Ch=document.createElement("canvas").getContext("2d")),Ch.canvas.width=c,Ch.canvas.height=l,Ch.drawImage(i,0,0,c,l),i=Ch.canvas);var d=n.makeTensorInfo(f,"int32");n.texData.get(d.dataId).usage=Gt.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),i);var m=h().getBool("WEBGL_PACK")?new Ah(p):new Sh(p),v=n.runWebGLProgram(m,[d],"int32");return n.disposeData(d.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;Ye("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var i=e,o=i.boxes,a=i.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,h=s.softNmsSigma,f=n,p=Ei(f.readSync(o.dataId),f.readSync(a.dataId),u,c,l,h);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,i=n,o=new Ja(r.shape,"return x * x;");return i.runWebGLProgram(o,[r],r.dtype)}},{kernelName:Ps,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,i=r.a,o=r.b,a=n,s=h().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fo("return (a - b) * (a - b);",i.shape,o.shape):new lo("return (a - b) * (a - b);",i.shape,o.shape);return a.compileAndRun(s,[i,o])}}];kh<Th.length;kh++)y(Th[kh]);for(var Ih=0,Ph=[{kernelName:"Square",gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Ps,gradFunc:function(t,e){var n=e[0],r=e[1],i=yn(2);return{a:function(){return qu(t,qu(i,Ju(n,r)))},b:function(){return qu(t,qu(i,Ju(r,n)))}}}}];Ih<Ph.length;Ih++)b(Ph[Ih]);var Dh=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();h().get("IS_BROWSER")&&h().setPlatform("browser",new Dh);var Rh,Mh=function(){return n(2)},Fh=function(){function t(){this.util=n(3),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=h().global.fetch?h().global.fetch(t,e):(null==Rh&&(Rh=Mh()),Rh(t,e))},t.prototype.now=function(){var t=r.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();h().get("IS_NODE")&&h().setPlatform("node",new Fh);var Oh={float32:4,int32:4,uint16:2,uint8:1,bool:1},Nh=4;function Lh(t,e){for(var n={},r=0,i=function(e){var i=e.name,o=e.dtype,a=e.shape,s=I(a),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=Oh[c.dtype],h=t.slice(r,r+s*l),f="uint8"===c.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===o)u=Float32Array.from(f,(function(t){return t*c.scale+c.min}));else{if("int32"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=Int32Array.from(f,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===o){var p=I(e.shape);u=[];for(var d=0;d<p;d++){var m=new Uint32Array(t.slice(r,r+Nh))[0];r+=Nh;var v=new Uint8Array(t.slice(r,r+m));u.push(v),r+=m}}else{var g=Oh[o];if(h=t.slice(r,r+s*g),"float32"===o)u=new Float32Array(h);else if("int32"===o)u=new Int32Array(h);else{if("bool"!==o)throw new Error("Unsupported dtype in weight '"+i+"': "+o);u=new Uint8Array(h)}r+=s*g}n[i]=vn(u,a,o)},o=0,a=e;o<a.length;o++)i(a[o]);return n}function Bh(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),i=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}var Vh="undefined"!=typeof i&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function zh(t){return Vh?i.byteLength(t):new Blob([t]).size}function jh(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function Wh(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function Gh(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:zh(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:zh(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var Hh=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var i=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&i.push(n)})),i},t}(),Uh="://",qh=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){S(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(Uh)&&(e=e.slice(0,e.indexOf(Uh))),S(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();S(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function $h(t){if(-1===t.indexOf(Uh))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+qh.getSchemes().join(","));return{scheme:t.split(Uh)[0],path:t.split(Uh)[1]}}function Kh(t,e,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var r,i,o,a,s,c,l,h,f;return u(this,(function(u){switch(u.label){case 0:return S(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),S((r=Hh.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),S(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),i=r[0],S((o=Hh.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),S(o.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),a=o[0],s=$h(t).scheme,c=$h(t).path,l=s===$h(t).scheme,[4,i.load()];case 1:return h=u.sent(),n&&l?[4,qh.getManager(s).removeModel(c)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[4,a.save(h)];case 4:return f=u.sent(),!n||l?[3,6]:[4,qh.getManager(s).removeModel(c)];case 5:u.sent(),u.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var Xh="models_store",Yh="model_info_store";function Jh(){if(!h().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Qh(t){var e=t.result;e.createObjectStore(Xh,{keyPath:"modelPath"}),e.createObjectStore(Yh,{keyPath:"modelPath"})}var Zh=function(){function t(t){if(this.indexedDB=Jh(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var i=n.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Qh(i)},i.onsuccess=function(){var o=i.result;if(null==e){var a=o.transaction(Xh,"readonly"),s=a.objectStore(Xh).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return o.close(),r(s.error)},a.oncomplete=function(){return o.close()}}else{var u,c=Gh(e),l=o.transaction(Yh,"readwrite"),h=l.objectStore(Yh),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var i=(u=o.transaction(Xh,"readwrite")).objectStore(Xh).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});i.onsuccess=function(){return t({modelArtifactsInfo:c})},i.onerror=function(t){var e=(h=l.objectStore(Yh)).delete(n.modelPath);e.onsuccess=function(){return o.close(),r(i.error)},e.onerror=function(t){return o.close(),r(i.error)}}},f.onerror=function(t){return o.close(),r(f.error)},l.oncomplete=function(){null==u?o.close():u.oncomplete=function(){return o.close()}}}},i.onerror=function(t){return r(i.error)}}))},t.URL_SCHEME="indexeddb://",t}(),tf=function(t){return h().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Zh.URL_SCHEME)?(e=t.slice(Zh.URL_SCHEME.length),new Zh(e)):null;var e};Hh.registerSaveRouter(tf),Hh.registerLoadRouter(tf);var ef=function(){function t(){this.indexedDB=Jh()}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return Qh(r)},r.onsuccess=function(){var t=r.result,i=t.transaction(Yh,"readonly"),o=i.objectStore(Yh).getAll();o.onsuccess=function(){for(var t={},n=0,r=o.result;n<r.length;n++){var i=r[n];t[i.modelPath]=i.modelArtifactsInfo}e(t)},o.onerror=function(e){return t.close(),n(o.error)},i.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(n){var r;return t=(r=t).startsWith(Zh.URL_SCHEME)?r.slice(Zh.URL_SCHEME.length):r,[2,new Promise((function(n,r){var i=e.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return Qh(i)},i.onsuccess=function(){var e,o=i.result,a=o.transaction(Yh,"readwrite"),s=a.objectStore(Yh),u=s.get(t);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var i=s.delete(t),a=function(){var i=(e=o.transaction(Xh,"readwrite")).objectStore(Xh).delete(t);i.onsuccess=function(){return n(u.result.modelArtifactsInfo)},i.onerror=function(t){return r(u.error)}};i.onsuccess=a,i.onerror=function(t){return a(),o.close(),r(u.error)}},u.onerror=function(t){return o.close(),r(u.error)},a.oncomplete=function(){null==e?o.close():e.oncomplete=function(){return o.close()}}},i.onerror=function(t){return r(i.error)}}))]}))}))},t}();if(h().getBool("IS_BROWSER"))try{qh.registerManager(Zh.URL_SCHEME,new ef)}catch(o){}var nf="/",rf="tensorflowjs_models",of="info",af="model_topology",sf="weight_specs",uf="weight_data",cf="model_metadata";function lf(t){return{info:[rf,t,of].join(nf),topology:[rf,t,af].join(nf),weightSpecs:[rf,t,sf].join(nf),weightData:[rf,t,uf].join(nf),modelMetadata:[rf,t,cf].join(nf)}}function hf(t){var e=t.split(nf);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(nf)}var ff=function(){function t(t){if(!h().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=lf(this.modelPath)}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(o){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=Gh(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(Vh)return i.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,o=e.length;r<o;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,o,a,s;return u(this,(function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(a=JSON.parse(o),e.format=a.format,e.generatedBy=a.generatedBy,e.convertedBy=a.convertedBy,e.userDefinedMetadata=a.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(Vh){var e=i.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),pf=function(t){return h().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ff.URL_SCHEME)?(e=t.slice(ff.URL_SCHEME.length),new ff(e)):null;var e};Hh.registerSaveRouter(pf),Hh.registerLoadRouter(pf);var df=function(){function t(){S(h().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),S("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,o;return u(this,(function(a){for(t={},e=rf+nf,n=nf+of,r=0;r<this.LS.length;++r)(i=this.LS.key(r)).startsWith(e)&&i.endsWith(n)&&(o=hf(i),t[o]=JSON.parse(this.LS.getItem(i)));return[2,t]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){var i;if(t=(i=t).startsWith(ff.URL_SCHEME)?i.slice(ff.URL_SCHEME.length):i,e=lf(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(h().getBool("IS_BROWSER"))try{qh.registerManager(ff.URL_SCHEME,new df)}catch(o){}var mf="model",vf=".json",gf=".weights.bin";function yf(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var bf=function(){function t(e){if(!h().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e=mf),this.modelTopologyFileName=e+vf,this.weightDataFileName=e+gf}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o,a;return u(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},i=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,[4,yf((function(){return o.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==t.weightData?[3,4]:((a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=e,[4,yf((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:Gh(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),xf=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n=this;return u(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,i){var o=new FileReader;o.onload=function(o){var a=JSON.parse(o.target.result),s=a.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void i(t)}var l=[],h=[],f=[];u.forEach((function(t){t.paths.forEach((function(t){h.push(t),f.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,i=h.indexOf(t);f[i]=n,-1===f.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:jh(f),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},e.onerror=function(e){return i("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else i(new Error("weightManifest field is missing from file "+t.name))}else i(new Error("modelTopology field is missing from file "+t.name))},o.onerror=function(e){return i("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},o.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return Wh(t.name)})),i={},o=0,a=t;o<a.length;o++)a[o].paths.forEach((function(t){var o=Wh(t);if(-1!==n.indexOf(o))throw new Error("Duplicate file basename found in weights manifest: '"+o+"'");if(n.push(o),-1===r.indexOf(o))throw new Error("Weight file with basename '"+o+"' is not provided.");i[t]=e[r.indexOf(o)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return i},t}();function wf(t,e,n,r){!function(t){S(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){S(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),S(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),S(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var i=0;return Promise.all(t.map((function(o){return o.then((function(o){var a=n+ ++i/t.length*(r-n);return e(a),o})),o})))}function Ef(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,a,s,c,l,f;return u(this,(function(u){switch(u.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?h().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),i=0,o=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=u.sent(),[3,4];case 2:return[4,wf(r,e.onProgress,i,o)];case 3:a=u.sent(),u.label=4;case 4:return s=a.map((function(t){return t.arrayBuffer()})),c=.5,l=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return f=u.sent(),[3,8];case 6:return[4,wf(s,e.onProgress,c,l)];case 7:f=u.sent(),u.label=8;case 8:return[2,f]}}))}))}function _f(t){var e=this;return function(n,r,i){return void 0===r&&(r=""),s(e,void 0,void 0,(function(){var e,o,a,s,c,l,h,f,p,d;return u(this,(function(u){switch(u.label){case 0:if(e=n.map((function(){return!1})),o={},a=null!=i?i.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u="quantization"in t?t.quantization.dtype:t.dtype,c=Oh[u]*I(t.shape),l=function(){e[n]=!0,null==o[n]&&(o[n]=[]),o[n].push({manifestEntry:t,groupOffset:r,sizeBytes:c})};null!=i?i.forEach((function(e,n){e===t.name&&(l(),a[n]=!0)})):l(),s.push(t.name),r+=c}))})),!a.every((function(t){return t})))throw c=i.filter((function(t,e){return!a[e]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),h=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;h.push(e)}))})),[4,t(h)];case 1:return f=u.sent(),p={},d=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,i=0;i<e;i++)r+=f[d+i].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,c=0;c<e;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}o[t].forEach((function(t){var e=Lh(a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)p[n]=e[n]})),d+=e})),[2,p]}}))}))}}Hh.registerSaveRouter((function(t){return h().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bf.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new bf(t)}(t.slice(bf.URL_SCHEME.length)):null}));var Cf=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(S("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=h().platform.fetch,S(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&S(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i;return u(this,(function(o){switch(o.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((i=o.sent()).ok)return[2,{modelArtifactsInfo:Gh(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,c,l,h,f;return u(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,i=e.weightsManifest,o=e.generatedBy,a=e.convertedBy,s=e.format,c=e.userDefinedMetadata,null==r&&null==i)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==i?[3,7]:[4,this.loadWeights(i)];case 6:f=u.sent(),l=f[0],h=f[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:h,userDefinedMetadata:c,generatedBy:o,convertedBy:a,format:s}]}}))}))},t.prototype.loadWeights=function(t){return s(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,c,l,h,f;return u(this,(function(u){switch(u.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}(e),r=n[0],i=n[1],o=this.weightPathPrefix||r,a=[],s=0,c=t;s<c.length;s++)l=c[s],a.push.apply(a,l.weights);return h=[],t.forEach((function(t){t.paths.forEach((function(t){h.push(o+t+i)}))})),[4,Ef(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=u.sent(),[2,[a,jh(f)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Sf(t){return null!=t.match(Cf.URL_SCHEME_REGEX)}var Af=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return Sf(t)})):Sf(t))?kf(t,{onProgress:e}):null};function kf(t,e){return new Cf(t,e)}Hh.registerSaveRouter(Af),Hh.registerLoadRouter(Af);var Tf,If=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),Pf=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),Df=Object.freeze({browserFiles:function(t){return new xf(t)},browserHTTPRequest:function(t,e){return kf(t,e)},concatenateArrayBuffers:jh,decodeWeights:Lh,encodeWeights:function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,a,c=this;return u(this,(function(l){switch(l.label){case 0:for(n=[],r=[],i=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),o=function(o){var a=i[o],l=Array.isArray(t)?t[o].tensor:t[a];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+l.dtype);var h={name:a,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var f=new Promise((function(t){return s(c,void 0,void 0,(function(){var e,n,r,i,o,a,s;return u(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(e=u.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+Nh*e.length,r=new Uint8Array(n),i=0,o=0;o<e.length;o++)a=e[o],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,i),i+=Nh,r.set(a,i),i+=a.length;return t(r),[2]}}))}))}));r.push(f)}else r.push(l.data());null!=e&&(h.group=e),n.push(h)},a=0;a<i.length;++a)o(a);return[4,Promise.all(r)];case 1:return[2,{data:Bh(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new If(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new If({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return Hh.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:Gh,getSaveHandlers:function(t){return Hh.getSaveHandlers(t)},http:kf,isHTTPScheme:Sf,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),s(this,void 0,void 0,(function(){return u(this,(function(i){return[2,_f((function(t){return Ef(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return Hh.registerLoadRouter(t)},registerSaveRouter:function(t){return Hh.registerSaveRouter(t)},weightsLoaderFactory:_f,withSaveHandler:function(t){return new Pf(t)},copyModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Kh(t,e,!1)]}))}))},listModels:function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,o,a;return u(this,(function(s){switch(s.label){case 0:t=qh.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(i=r[n],[4,qh.getManager(i).listModels()]):[3,4];case 2:for(a in o=s.sent())e[i+Uh+a]=o[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,Kh(t,e,!0)]}))}))},removeModel:function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return e=$h(t),[2,qh.getManager(e.scheme).removeModel(e.path)]}))}))}}),Rf=fn({confusionMatrix_:function(t,e,n){var r=Ze(t,"labels","confusionMatrix"),i=Ze(e,"predictions","confusionMatrix");S(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),S(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),S(1===i.rank,(function(){return"Expected the rank of predictions to be 1, but got "+i.rank})),S(r.shape[0]===i.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+i.shape[0]+". Labels and predictions should have the same number of elements."})),S(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var o=ur(r.asType("int32"),n),a=ur(i.asType("int32"),n);return o.transpose().matMul(a).asType("int32")}}),Mf=(Object.freeze({confusionMatrix:Rf}),fn({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,i=!1,o=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)o=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);a=!0}if(i&&i&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=m("FromPixels",Vt.backendName))return Vt.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,c=i?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=c[0],h=c[1];if(a?s=t.getContext("2d").getImageData(0,0,l,h).data:r||n?s=t.data:(o||i)&&(null==Tf&&(Tf=document.createElement("canvas").getContext("2d")),Tf.canvas.width=l,Tf.canvas.height=h,Tf.drawImage(t,0,0,l,h),s=Tf.getImageData(0,0,l,h).data),4===e)u=new Int32Array(s);else{var f=l*h;u=new Int32Array(f*e);for(var p=0;p<f;p++)for(var d=0;d<e;++d)u[p*e+d]=s[4*p+d]}return wn(u,[h,l,e],"int32")}})),Ff=Object.freeze({toPixels:function(t,e){return s(this,void 0,void 0,(function(){var n,r,i,o,a,s,c,l,h,f,p,d,m,v,g,y,b,x,w,E,_,C,S;return u(this,(function(u){switch(u.label){case 0:if(n=Ze(t,"img","toPixels"),t instanceof _t||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),i=r[0],o=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=u.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(h=u.sent(),f=h[0],p=h[1],d=f[0],m=p[0],c.dispose(),l.dispose(),"float32"===n.dtype){if(d<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+m+"].")}for(v="float32"===n.dtype?255:1,g=new Uint8ClampedArray(o*i*4),y=0;y<i*o;++y)b=void 0,x=void 0,w=void 0,E=void 0,1===a?(b=s[y]*v,x=s[y]*v,w=s[y]*v,E=255):3===a?(b=s[3*y]*v,x=s[3*y+1]*v,w=s[3*y+2]*v,E=255):4===a&&(b=s[4*y]*v,x=s[4*y+1]*v,w=s[4*y+2]*v,E=s[4*y+3]*v),g[0+(_=4*y)]=Math.round(b),g[_+1]=Math.round(x),g[_+2]=Math.round(w),g[_+3]=Math.round(E);return null!=e&&(e.width=o,e.height=i,C=e.getContext("2d"),S=new ImageData(g,o,i),C.putImageData(S,0,0)),n!==t&&n.dispose(),[2,g]}}))}))},fromPixels:Mf}),Of=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),Nf=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Lf(t){S(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),S("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),S(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Nf.register(t)}Object.freeze({Serializable:Of,SerializationMap:Nf,registerClass:Lf});var Bf=.001,Vf=.1;function zf(){return 32===Vt.backend.floatPrecision()?Bf:Vf}function jf(t,e,n){var r=!0;if((H(t)||H(e))&&(r=!1),H(t)&&H(e)&&(r=!0),r){var i=t.constructor.name,o=e.constructor.name;if(i!==o)throw new Error("Arrays are of different type. Actual: "+i+". Expected: "+o)}if(Array.isArray(t)&&Array.isArray(e)){var a=Je(t),s=Je(e);if(!P(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=H(t)?t:T(t),c=H(e)?e:T(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var h=u[l],f=c[l];if(!n(h,f))throw new Error("Arrays differ: actual["+l+"] = "+h+", expected["+l+"] = "+f+".\nActual:   "+u+".\nExpected: "+c+".")}}function Wf(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}Object.freeze({TEST_EPSILON_FLOAT16:Vf,expectArraysClose:function(t,e,n){return null==n&&(n=zf()),jf(t,e,(function(t,e){return Wf(t,e,n)}))},testEpsilon:zf,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return $(t)||$(t[0])||$(e)||$(e[0])?jf(t,n,(function(t,e){return t==e})):jf(t,e,(function(t,e){return Wf(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=zf()),!Wf(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Object.freeze({gpgpu_util:la,webgl_util:He,forceHalfFloat:function(){h().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Ts,setWebGLContext:$t,GPGPUContext:ha});var Gf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),i=r.value,o=r.grads;if(null!=n){var a=n.map((function(t){return{name:t.name,tensor:o[t.name]}}));this.applyGradients(a)}else this.applyGradients(o);return Ke(o),e?i:(i.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return Hr(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&Ke(this.iterations_)},e.prototype.saveIterations=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:yn(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(Of);Object.defineProperty(Gf,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Hf=function(t){function e(e,n,r){void 0===r&&(r=null);var i=t.call(this)||this;return i.learningRate=e,i.rho=n,i.epsilon=r,i.accumulatedGrads=[],i.accumulatedUpdates=[],null==r&&(i.epsilon=Vt.backend.epsilon()),i}return a(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Vt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:$e((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:$e((function(){return Rn(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;$e((function(){var t=a.mul(e.rho).add(o.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(a.add(e.epsilon).sqrt()).mul(o),r=s.mul(e.rho).add(n.square().mul(1-e.rho));a.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(i);i.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(Ke(this.accumulatedGrads.map((function(t){return t.variable}))),Ke(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(Gf);Lf(Hf);var Uf=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return a(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Vt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:$e((function(){return Tn(i.shape,e.initialAccumulatorValue).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedGrads[r].variable;$e((function(){var t=a.add(o.square());a.assign(t);var n=o.div(t.add(Vt.backend.epsilon()).sqrt()).mul(-e.learningRate).add(i);i.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&Ke(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(Gf);Lf(Uf);var qf=function(t){function e(e,n,r,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=i,o.accumulatedFirstMoment=[],o.accumulatedSecondMoment=[],$e((function(){o.accBeta1=yn(n).variable(),o.accBeta2=yn(r).variable()})),null==i&&(o.epsilon=Vt.backend.epsilon()),o}return a(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);$e((function(){var r=Ju(1,e.accBeta1),i=Ju(1,e.accBeta2);n.forEach((function(n,o){var a=Vt.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:$e((function(){return Rn(a).variable(!1)}))}),null==e.accumulatedSecondMoment[o]&&(e.accumulatedSecondMoment[o]={originalName:n+"/v",variable:$e((function(){return Rn(a).variable(!1)}))});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedSecondMoment[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),f=l.div(r),p=h.div(i);u.assign(l),c.assign(h);var d=f.div(p.sqrt().add(e.epsilon)).mul(-e.learningRate).add(a);a.assign(d)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Ke(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&Ke(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),$e((function(){n.accBeta1.assign(Ku(n.beta1,n.iterations_+1)),n.accBeta2.assign(Ku(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(Gf);Lf(qf);var $f=function(t){function e(e,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=0);var a=t.call(this)||this;return a.learningRate=e,a.beta1=n,a.beta2=r,a.epsilon=i,a.decay=o,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],$e((function(){a.iteration=yn(0).variable(),a.accBeta1=yn(n).variable()})),null==i&&(a.epsilon=Vt.backend.epsilon()),a}return a(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);$e((function(){var r=Ju(1,e.accBeta1),i=Nu(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,o){var a=Vt.registeredVariables[n];null==e.accumulatedFirstMoment[o]&&(e.accumulatedFirstMoment[o]={originalName:n+"/m",variable:Rn(a).variable(!1)}),null==e.accumulatedWeightedInfNorm[o]&&(e.accumulatedWeightedInfNorm[o]={originalName:n+"/v",variable:Rn(a).variable(!1)});var s=Array.isArray(t)?t[o].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[o].variable,c=e.accumulatedWeightedInfNorm[o].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),h=c.mul(e.beta2),f=s.abs(),p=h.maximum(f);u.assign(l),c.assign(p);var d=i.div(r).mul(l.div(p.add(e.epsilon))).add(a);a.assign(d)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Ke(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&Ke(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(Gf);Lf($f);var Kf=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return a(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=Vt.registeredVariables[n];$e((function(){var t=e.c.mul(i).add(o);o.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Xe(yn(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(Gf);Lf(Kf);var Xf=function(t){function e(e,n,r){void 0===r&&(r=!1);var i=t.call(this,e)||this;return i.learningRate=e,i.momentum=n,i.useNesterov=r,i.accumulations=[],i.m=yn(i.momentum),i}return a(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Vt.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:$e((function(){return Rn(i).variable(!1)}))});var o=e.accumulations[r].variable,a=Array.isArray(t)?t[r].tensor:t[n];null!=a&&$e((function(){var t,n=e.m.mul(o).add(a);t=e.useNesterov?e.c.mul(a.add(n.mul(e.m))).add(i):e.c.mul(n).add(i),o.assign(n),i.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&Ke(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(Kf);Lf(Xf);var Yf=function(t){function e(e,n,r,i,o){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=null),void 0===o&&(o=!1);var a=t.call(this)||this;if(a.learningRate=e,a.decay=n,a.momentum=r,a.epsilon=i,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=o,null==i&&(a.epsilon=Vt.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return a(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var i=Vt.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:$e((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:$e((function(){return Rn(i).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:$e((function(){return Rn(i).variable(!1)}))});var o=Array.isArray(t)?t[r].tensor:t[n];if(null!=o){var a=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;$e((function(){var t=a.mul(e.decay).add(o.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(o.mul(1-e.decay)),c=s.mul(e.momentum).add(o.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));a.assign(t),n.assign(u),s.assign(c);var l=i.sub(c);i.assign(l)}else{var h=a.mul(e.decay).add(o.square().mul(1-e.decay));c=s.mul(e.momentum).add(o.mul(e.learningRate).div(h.add(e.epsilon).sqrt())),a.assign(h),s.assign(c),l=i.sub(c),i.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&Ke(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&Ke(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&Ke(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(Gf);Lf(Yf);var Jf=function(){function t(){}return t.sgd=function(t){return new Kf(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new Xf(t,e,n)},t.rmsprop=function(t,e,n,r,i){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===i&&(i=!1),new Yf(t,e,n,r,i)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new qf(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new Hf(t,e,n)},t.adamax=function(t,e,n,r,i){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===i&&(i=0),new $f(t,e,n,r,i)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new Uf(t,e)},t}();Jf.sgd,Jf.momentum,Jf.adadelta,Jf.adagrad,Jf.rmsprop,Jf.adamax,Jf.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;_t.prototype.squaredDifference=function(t){return Ds(this,t)},wt=yh}).call(this,n("c8ba"),n("4362"),n("b639").Buffer)},"467f":function(t,e,n){"use strict";var r=n("2d83");t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},4840:function(t,e,n){var r=n("825a"),i=n("1c0b"),o=n("b622"),a=o("species");t.exports=function(t,e){var n,o=r(t).constructor;return void 0===o||void 0==(n=r(o)[a])?e:i(n)}},4930:function(t,e,n){var r=n("2d00"),i=n("d039");t.exports=!!Object.getOwnPropertySymbols&&!i((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},"498a":function(t,e,n){"use strict";var r=n("23e7"),i=n("58a8").trim,o=n("c8d2");r({target:"String",proto:!0,forced:o("trim")},{trim:function(){return i(this)}})},"4a7b":function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){e=e||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],s=["validateStatus"];function u(t,e){return r.isPlainObject(t)&&r.isPlainObject(e)?r.merge(t,e):r.isPlainObject(e)?r.merge({},e):r.isArray(e)?e.slice():e}function c(i){r.isUndefined(e[i])?r.isUndefined(t[i])||(n[i]=u(void 0,t[i])):n[i]=u(t[i],e[i])}r.forEach(i,(function(t){r.isUndefined(e[t])||(n[t]=u(void 0,e[t]))})),r.forEach(o,c),r.forEach(a,(function(i){r.isUndefined(e[i])?r.isUndefined(t[i])||(n[i]=u(void 0,t[i])):n[i]=u(void 0,e[i])})),r.forEach(s,(function(r){r in e?n[r]=u(t[r],e[r]):r in t&&(n[r]=u(void 0,t[r]))}));var l=i.concat(o).concat(a).concat(s),h=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===l.indexOf(t)}));return r.forEach(h,c),n}},"4ae1":function(t,e,n){var r=n("23e7"),i=n("d066"),o=n("1c0b"),a=n("825a"),s=n("861d"),u=n("7c73"),c=n("0538"),l=n("d039"),h=i("Reflect","construct"),f=l((function(){function t(){}return!(h((function(){}),[],t)instanceof t)})),p=!l((function(){h((function(){}))})),d=f||p;r({target:"Reflect",stat:!0,forced:d,sham:d},{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(p&&!f)return h(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var i=n.prototype,l=u(s(i)?i:Object.prototype),d=Function.apply.call(t,l,e);return s(d)?d:l}})},"4d64":function(t,e,n){var r=n("fc6a"),i=n("50c4"),o=n("23cb"),a=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){while(c>l)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},"4ec9":function(t,e,n){"use strict";var r=n("6d61"),i=n("6566");t.exports=r("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},"50c4":function(t,e,n){var r=n("a691"),i=Math.min;t.exports=function(t){return t>0?i(r(t),9007199254740991):0}},5135:function(t,e,n){var r=n("7b0b"),i={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return i.call(r(t),e)}},5270:function(t,e,n){"use strict";var r=n("c532"),i=n("c401"),o=n("2e67"),a=n("2444");function s(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){s(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]}));var e=t.adapter||a.adapter;return e(t).then((function(e){return s(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(s(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},5319:function(t,e,n){"use strict";var r=n("d784"),i=n("d039"),o=n("825a"),a=n("50c4"),s=n("a691"),u=n("1d80"),c=n("8aa5"),l=n("0cb2"),h=n("14c3"),f=n("b622"),p=f("replace"),d=Math.max,m=Math.min,v=function(t){return void 0===t?t:String(t)},g=function(){return"$0"==="a".replace(/./,"$0")}(),y=function(){return!!/./[p]&&""===/./[p]("a","$0")}(),b=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}));r("replace",(function(t,e,n){var r=y?"$":"$0";return[function(t,n){var r=u(this),i=void 0==t?void 0:t[p];return void 0!==i?i.call(t,r,n):e.call(String(r),t,n)},function(t,i){if("string"===typeof i&&-1===i.indexOf(r)&&-1===i.indexOf("$<")){var u=n(e,this,t,i);if(u.done)return u.value}var f=o(this),p=String(t),g="function"===typeof i;g||(i=String(i));var y=f.global;if(y){var b=f.unicode;f.lastIndex=0}var x=[];while(1){var w=h(f,p);if(null===w)break;if(x.push(w),!y)break;var E=String(w[0]);""===E&&(f.lastIndex=c(p,a(f.lastIndex),b))}for(var _="",C=0,S=0;S<x.length;S++){w=x[S];for(var A=String(w[0]),k=d(m(s(w.index),p.length),0),T=[],I=1;I<w.length;I++)T.push(v(w[I]));var P=w.groups;if(g){var D=[A].concat(T,k,p);void 0!==P&&D.push(P);var R=String(i.apply(void 0,D))}else R=l(A,p,k,T,P,i);k>=C&&(_+=p.slice(C,k)+R,C=k+A.length)}return _+p.slice(C)}]}),!b||!g||y)},5692:function(t,e,n){var r=n("c430"),i=n("c6cd");(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.15.1",mode:r?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,n){var r=n("d066"),i=n("241c"),o=n("7418"),a=n("825a");t.exports=r("Reflect","ownKeys")||function(t){var e=i.f(a(t)),n=o.f;return n?e.concat(n(t)):e}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),i=n("5899"),o="["+i+"]",a=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),u=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(a,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:u(1),end:u(2),trim:u(3)}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"5f02":function(t,e,n){"use strict";t.exports=function(t){return"object"===typeof t&&!0===t.isAxiosError}},"602d":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=n("9ab4"),i=n("eea0");function o(){var e=t["Canvas"]||t["HTMLCanvasElement"],n=t["Image"]||t["HTMLImageElement"],o=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},a=function(){if(n)return new n;throw new Error("createImageElement - missing Image implementation for nodejs environment")},s=t["fetch"]||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},u=Object(i["a"])();return Object(r["a"])({Canvas:e||function(){function t(){}return t}(),CanvasRenderingContext2D:t["CanvasRenderingContext2D"]||function(){function t(){}return t}(),Image:n||function(){function t(){}return t}(),ImageData:t["ImageData"]||function(){function t(){}return t}(),Video:t["HTMLVideoElement"]||function(){function t(){}return t}(),createCanvasElement:o,createImageElement:a,fetch:s},u)}}).call(this,n("c8ba"))},"605d":function(t,e,n){var r=n("c6b6"),i=n("da84");t.exports="process"==r(i.process)},6069:function(t,e){t.exports="object"==typeof window},"60da":function(t,e,n){"use strict";var r=n("83ab"),i=n("d039"),o=n("df75"),a=n("7418"),s=n("d1e7"),u=n("7b0b"),c=n("44ad"),l=Object.assign,h=Object.defineProperty;t.exports=!l||i((function(){if(r&&1!==l({b:1},l(h({},"a",{enumerable:!0,get:function(){h(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach((function(t){e[t]=t})),7!=l({},t)[n]||o(l({},e)).join("")!=i}))?function(t,e){var n=u(t),i=arguments.length,l=1,h=a.f,f=s.f;while(i>l){var p,d=c(arguments[l++]),m=h?o(d).concat(h(d)):o(d),v=m.length,g=0;while(v>g)p=m[g++],r&&!f.call(d,p)||(n[p]=d[p])}return n}:l},6547:function(t,e,n){var r=n("a691"),i=n("1d80"),o=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(o=s.charCodeAt(u),o<55296||o>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536)}};t.exports={codeAt:o(!1),charAt:o(!0)}},6566:function(t,e,n){"use strict";var r=n("9bf2").f,i=n("7c73"),o=n("e2cc"),a=n("0366"),s=n("19aa"),u=n("2266"),c=n("7dd0"),l=n("2626"),h=n("83ab"),f=n("f183").fastKey,p=n("69f3"),d=p.set,m=p.getterFor;t.exports={getConstructor:function(t,e,n,c){var l=t((function(t,r){s(t,l,e),d(t,{type:e,index:i(null),first:void 0,last:void 0,size:0}),h||(t.size=0),void 0!=r&&u(r,t[c],{that:t,AS_ENTRIES:n})})),p=m(e),v=function(t,e,n){var r,i,o=p(t),a=g(t,e);return a?a.value=n:(o.last=a={index:i=f(e,!0),key:e,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=a),r&&(r.next=a),h?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},g=function(t,e){var n,r=p(t),i=f(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==e)return n};return o(l.prototype,{clear:function(){var t=this,e=p(t),n=e.index,r=e.first;while(r)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete n[r.index],r=r.next;e.first=e.last=void 0,h?e.size=0:t.size=0},delete:function(t){var e=this,n=p(e),r=g(e,t);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),h?n.size--:e.size--}return!!r},forEach:function(t){var e,n=p(this),r=a(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:n.first){r(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!g(this,t)}}),o(l.prototype,n?{get:function(t){var e=g(this,t);return e&&e.value},set:function(t,e){return v(this,0===t?0:t,e)}}:{add:function(t){return v(this,t=0===t?0:t,t)}}),h&&r(l.prototype,"size",{get:function(){return p(this).size}}),l},setStrong:function(t,e,n){var r=e+" Iterator",i=m(e),o=m(r);c(t,e,(function(t,e){d(this,{type:r,target:t,state:i(t),kind:e,last:void 0})}),(function(){var t=o(this),e=t.kind,n=t.last;while(n&&n.removed)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),l(e)}}},"65f0":function(t,e,n){var r=n("861d"),i=n("e8b5"),o=n("b622"),a=o("species");t.exports=function(t,e){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)?r(n)&&(n=n[a],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"69f3":function(t,e,n){var r,i,o,a=n("7f9a"),s=n("da84"),u=n("861d"),c=n("9112"),l=n("5135"),h=n("c6cd"),f=n("f772"),p=n("d012"),d="Object already initialized",m=s.WeakMap,v=function(t){return o(t)?i(t):r(t,{})},g=function(t){return function(e){var n;if(!u(e)||(n=i(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}};if(a||h.state){var y=h.state||(h.state=new m),b=y.get,x=y.has,w=y.set;r=function(t,e){if(x.call(y,t))throw new TypeError(d);return e.facade=t,w.call(y,t,e),e},i=function(t){return b.call(y,t)||{}},o=function(t){return x.call(y,t)}}else{var E=f("state");p[E]=!0,r=function(t,e){if(l(t,E))throw new TypeError(d);return e.facade=t,c(t,E,e),e},i=function(t){return l(t,E)?t[E]:{}},o=function(t){return l(t,E)}}t.exports={set:r,get:i,has:o,enforce:v,getterFor:g}},"6d61":function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("94ca"),a=n("6eeb"),s=n("f183"),u=n("2266"),c=n("19aa"),l=n("861d"),h=n("d039"),f=n("1c7e"),p=n("d44e"),d=n("7156");t.exports=function(t,e,n){var m=-1!==t.indexOf("Map"),v=-1!==t.indexOf("Weak"),g=m?"set":"add",y=i[t],b=y&&y.prototype,x=y,w={},E=function(t){var e=b[t];a(b,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(v&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return v&&!l(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(v&&!l(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})},_=o(t,"function"!=typeof y||!(v||b.forEach&&!h((function(){(new y).entries().next()}))));if(_)x=n.getConstructor(e,t,m,g),s.REQUIRED=!0;else if(o(t,!0)){var C=new x,S=C[g](v?{}:-0,1)!=C,A=h((function(){C.has(1)})),k=f((function(t){new y(t)})),T=!v&&h((function(){var t=new y,e=5;while(e--)t[g](e,e);return!t.has(-0)}));k||(x=e((function(e,n){c(e,x,t);var r=d(new y,e,x);return void 0!=n&&u(n,r[g],{that:r,AS_ENTRIES:m}),r})),x.prototype=b,b.constructor=x),(A||T)&&(E("delete"),E("has"),m&&E("get")),(T||S)&&E(g),v&&b.clear&&delete b.clear}return w[t]=x,r({global:!0,forced:x!=y},w),p(x,t),v||n.setStrong(x,t,m),x}},"6eeb":function(t,e,n){var r=n("da84"),i=n("9112"),o=n("5135"),a=n("ce4e"),s=n("8925"),u=n("69f3"),c=u.get,l=u.enforce,h=String(String).split("String");(t.exports=function(t,e,n,s){var u,c=!!s&&!!s.unsafe,f=!!s&&!!s.enumerable,p=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||o(n,"name")||i(n,"name",e),u=l(n),u.source||(u.source=h.join("string"==typeof e?e:""))),t!==r?(c?!p&&t[e]&&(f=!0):delete t[e],f?t[e]=n:i(t,e,n)):f?t[e]=n:a(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},7037:function(t,e,n){function r(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(t.exports=r=function(t){return typeof t},t.exports["default"]=t.exports,t.exports.__esModule=!0):(t.exports=r=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports["default"]=t.exports,t.exports.__esModule=!0),r(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),t.exports=r,t.exports["default"]=t.exports,t.exports.__esModule=!0},7156:function(t,e,n){var r=n("861d"),i=n("d2bb");t.exports=function(t,e,n){var o,a;return i&&"function"==typeof(o=e.constructor)&&o!==n&&r(a=o.prototype)&&a!==n.prototype&&i(t,a),t}},7418:function(t,e){e.f=Object.getOwnPropertySymbols},"746f":function(t,e,n){var r=n("428f"),i=n("5135"),o=n("e538"),a=n("9bf2").f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});i(e,t)||a(e,t,{value:o.f(t)})}},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7a77":function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},"7aac":function(t,e,n){"use strict";var r=n("c532");t.exports=r.isStandardBrowserEnv()?function(){return{write:function(t,e,n,i,o,a){var s=[];s.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},"7b0b":function(t,e,n){var r=n("1d80");t.exports=function(t){return Object(r(t))}},"7c73":function(t,e,n){var r,i=n("825a"),o=n("37e8"),a=n("7839"),s=n("d012"),u=n("1be4"),c=n("cc12"),l=n("f772"),h=">",f="<",p="prototype",d="script",m=l("IE_PROTO"),v=function(){},g=function(t){return f+d+h+t+f+"/"+d+h},y=function(t){t.write(g("")),t.close();var e=t.parentWindow.Object;return t=null,e},b=function(){var t,e=c("iframe"),n="java"+d+":";return e.style.display="none",u.appendChild(e),e.src=String(n),t=e.contentWindow.document,t.open(),t.write(g("document.F=Object")),t.close(),t.F},x=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(e){}x=r?y(r):b();var t=a.length;while(t--)delete x[p][a[t]];return x()};s[m]=!0,t.exports=Object.create||function(t,e){var n;return null!==t?(v[p]=i(t),n=new v,v[p]=null,n[m]=t):n=x(),void 0===e?n:o(n,e)}},"7dd0":function(t,e,n){"use strict";var r=n("23e7"),i=n("9ed3"),o=n("e163"),a=n("d2bb"),s=n("d44e"),u=n("9112"),c=n("6eeb"),l=n("b622"),h=n("c430"),f=n("3f8c"),p=n("ae93"),d=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,v=l("iterator"),g="keys",y="values",b="entries",x=function(){return this};t.exports=function(t,e,n,l,p,w,E){i(n,e,l);var _,C,S,A=function(t){if(t===p&&D)return D;if(!m&&t in I)return I[t];switch(t){case g:return function(){return new n(this,t)};case y:return function(){return new n(this,t)};case b:return function(){return new n(this,t)}}return function(){return new n(this)}},k=e+" Iterator",T=!1,I=t.prototype,P=I[v]||I["@@iterator"]||p&&I[p],D=!m&&P||A(p),R="Array"==e&&I.entries||P;if(R&&(_=o(R.call(new t)),d!==Object.prototype&&_.next&&(h||o(_)===d||(a?a(_,d):"function"!=typeof _[v]&&u(_,v,x)),s(_,k,!0,!0),h&&(f[k]=x))),p==y&&P&&P.name!==y&&(T=!0,D=function(){return P.call(this)}),h&&!E||I[v]===D||u(I,v,D),f[e]=D,p)if(C={values:A(y),keys:w?D:A(g),entries:A(b)},E)for(S in C)(m||T||!(S in I))&&c(I,S,C[S]);else r({target:e,proto:!0,forced:m||T},C);return C}},"7f9a":function(t,e,n){var r=n("da84"),i=n("8925"),o=r.WeakMap;t.exports="function"===typeof o&&/native code/.test(i(o))},"825a":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,n){var r=n("d039");t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"83b9":function(t,e,n){"use strict";var r=n("d925"),i=n("e683");t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},8418:function(t,e,n){"use strict";var r=n("c04e"),i=n("9bf2"),o=n("5c6c");t.exports=function(t,e,n){var a=r(e);a in t?i.f(t,a,o(0,n)):t[a]=n}},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8925:function(t,e,n){var r=n("c6cd"),i=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return i.call(t)}),t.exports=r.inspectSource},"8aa5":function(t,e,n){"use strict";var r=n("6547").charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"8c2c":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"lavContainer",style:t.style})},i=[],o=(n("a9e3"),n("94f1")),a=n.n(o),s={props:{options:{type:Object,required:!0},height:Number,width:Number},data:function(){return{style:{width:this.width?"".concat(this.width,"px"):"100%",height:this.height?"".concat(this.height,"px"):"100%",overflow:"hidden",margin:"0 auto"}}},mounted:function(){this.anim=a.a.loadAnimation({container:this.$refs.lavContainer,renderer:"svg",loop:!1!==this.options.loop,autoplay:!1!==this.options.autoplay,animationData:this.options.animationData,rendererSettings:this.options.rendererSettings}),this.$emit("animCreated",this.anim)}},u=s,c=n("2877"),l=Object(c["a"])(u,r,i,!1,null,null,null);e["a"]=l.exports},"8df4":function(t,e,n){"use strict";var r=n("7a77");function i(t){if("function"!==typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t,e=new i((function(e){t=e}));return{token:e,cancel:t}},t.exports=i},"90e3":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},9112:function(t,e,n){var r=n("83ab"),i=n("9bf2"),o=n("5c6c");t.exports=r?function(t,e,n){return i.f(t,e,o(1,n))}:function(t,e,n){return t[e]=n,t}},9152:function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,p=t[e+h];for(h+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+t[e+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+t[e+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),e+=a+h>=1?f/u:f*Math.pow(2,1-h),e*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(e*u-1)*Math.pow(2,i),a+=h):(s=e*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*m}},9263:function(t,e,n){"use strict";var r=n("ad6d"),i=n("9f7f"),o=n("5692"),a=n("7c73"),s=n("69f3").get,u=n("fce3"),c=n("107c"),l=RegExp.prototype.exec,h=o("native-string-replace",String.prototype.replace),f=l,p=function(){var t=/a/,e=/b*/g;return l.call(t,"a"),l.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),d=i.UNSUPPORTED_Y||i.BROKEN_CARET,m=void 0!==/()??/.exec("")[1],v=p||m||d||u||c;v&&(f=function(t){var e,n,i,o,u,c,v,g=this,y=s(g),b=y.raw;if(b)return b.lastIndex=g.lastIndex,e=f.call(b,t),g.lastIndex=b.lastIndex,e;var x=y.groups,w=d&&g.sticky,E=r.call(g),_=g.source,C=0,S=t;if(w&&(E=E.replace("y",""),-1===E.indexOf("g")&&(E+="g"),S=String(t).slice(g.lastIndex),g.lastIndex>0&&(!g.multiline||g.multiline&&"\n"!==t[g.lastIndex-1])&&(_="(?: "+_+")",S=" "+S,C++),n=new RegExp("^(?:"+_+")",E)),m&&(n=new RegExp("^"+_+"$(?!\\s)",E)),p&&(i=g.lastIndex),o=l.call(w?n:g,S),w?o?(o.input=o.input.slice(C),o[0]=o[0].slice(C),o.index=g.lastIndex,g.lastIndex+=o[0].length):g.lastIndex=0:p&&o&&(g.lastIndex=g.global?o.index+o[0].length:i),m&&o&&o.length>1&&h.call(o[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(o[u]=void 0)})),o&&x)for(o.groups=c=a(null),u=0;u<x.length;u++)v=x[u],c[v[0]]=o[v[1]];return o}),t.exports=f},"94ca":function(t,e,n){var r=n("d039"),i=/#|\.prototype\./,o=function(t,e){var n=s[a(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},a=o.normalize=function(t){return String(t).replace(i,".").toLowerCase()},s=o.data={},u=o.NATIVE="N",c=o.POLYFILL="P";t.exports=o},"94f1":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;"undefined"!==typeof navigator&&function(t,e){__WEBPACK_AMD_DEFINE_RESULT__=function(){return e(t)}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(window||{},(function(window){"use strict";var svgNS="http://www.w3.org/2000/svg",locationHref="",initialDefaultFrame=-999999,subframeEnabled=!0,idPrefix="",expressionsPlugin,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),cachedColors={},bmRnd,bmPow=Math.pow,bmSqrt=Math.sqrt,bmFloor=Math.floor,bmMax=Math.max,bmMin=Math.min,BMMath={};function ProjectInterface(){return{}}(function(){var t,e=["abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","cbrt","expm1","clz32","cos","cosh","exp","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc","E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],n=e.length;for(t=0;t<n;t+=1)BMMath[e[t]]=Math[e[t]]})(),BMMath.random=Math.random,BMMath.abs=function(t){var e=typeof t;if("object"===e&&t.length){var n,r=createSizedArray(t.length),i=t.length;for(n=0;n<i;n+=1)r[n]=Math.abs(t[n]);return r}return Math.abs(t)};var defaultCurveSegments=150,degToRads=Math.PI/180,roundCorner=.5519;function roundValues(t){bmRnd=t?Math.round:function(t){return t}}function styleDiv(t){t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.display="block",t.style.transformOrigin="0 0",t.style.webkitTransformOrigin="0 0",t.style.backfaceVisibility="visible",t.style.webkitBackfaceVisibility="visible",t.style.transformStyle="preserve-3d",t.style.webkitTransformStyle="preserve-3d",t.style.mozTransformStyle="preserve-3d"}function BMEnterFrameEvent(t,e,n,r){this.type=t,this.currentTime=e,this.totalTime=n,this.direction=r<0?-1:1}function BMCompleteEvent(t,e){this.type=t,this.direction=e<0?-1:1}function BMCompleteLoopEvent(t,e,n,r){this.type=t,this.currentLoop=n,this.totalLoops=e,this.direction=r<0?-1:1}function BMSegmentStartEvent(t,e,n){this.type=t,this.firstFrame=e,this.totalFrames=n}function BMDestroyEvent(t,e){this.type=t,this.target=e}function BMRenderFrameErrorEvent(t,e){this.type="renderFrameError",this.nativeError=t,this.currentTime=e}function BMConfigErrorEvent(t){this.type="configError",this.nativeError=t}function BMAnimationConfigErrorEvent(t,e){this.type=t,this.nativeError=e}roundValues(!1);var createElementID=function(){var t=0;return function(){return t+=1,idPrefix+"__lottie_element_"+t}}();function HSVtoRGB(t,e,n){var r,i,o,a,s,u,c,l;switch(a=Math.floor(6*t),s=6*t-a,u=n*(1-e),c=n*(1-s*e),l=n*(1-(1-s)*e),a%6){case 0:r=n,i=l,o=u;break;case 1:r=c,i=n,o=u;break;case 2:r=u,i=n,o=l;break;case 3:r=u,i=c,o=n;break;case 4:r=l,i=u,o=n;break;case 5:r=n,i=u,o=c;break;default:break}return[r,i,o]}function RGBtoHSV(t,e,n){var r,i=Math.max(t,e,n),o=Math.min(t,e,n),a=i-o,s=0===i?0:a/i,u=i/255;switch(i){case o:r=0;break;case t:r=e-n+a*(e<n?6:0),r/=6*a;break;case e:r=n-t+2*a,r/=6*a;break;case n:r=t-e+4*a,r/=6*a;break;default:break}return[r,s,u]}function addSaturationToRGB(t,e){var n=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return n[1]+=e,n[1]>1?n[1]=1:n[1]<=0&&(n[1]=0),HSVtoRGB(n[0],n[1],n[2])}function addBrightnessToRGB(t,e){var n=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return n[2]+=e,n[2]>1?n[2]=1:n[2]<0&&(n[2]=0),HSVtoRGB(n[0],n[1],n[2])}function addHueToRGB(t,e){var n=RGBtoHSV(255*t[0],255*t[1],255*t[2]);return n[0]+=e/360,n[0]>1?n[0]-=1:n[0]<0&&(n[0]+=1),HSVtoRGB(n[0],n[1],n[2])}var rgbToHex=function(){var t,e,n=[];for(t=0;t<256;t+=1)e=t.toString(16),n[t]=1===e.length?"0"+e:e;return function(t,e,r){return t<0&&(t=0),e<0&&(e=0),r<0&&(r=0),"#"+n[t]+n[e]+n[r]}}();function BaseEvent(){}BaseEvent.prototype={triggerEvent:function(t,e){if(this._cbs[t])for(var n=this._cbs[t].length,r=0;r<n;r+=1)this._cbs[t][r](e)},addEventListener:function(t,e){return this._cbs[t]||(this._cbs[t]=[]),this._cbs[t].push(e),function(){this.removeEventListener(t,e)}.bind(this)},removeEventListener:function(t,e){if(e){if(this._cbs[t]){var n=0,r=this._cbs[t].length;while(n<r)this._cbs[t][n]===e&&(this._cbs[t].splice(n,1),n-=1,r-=1),n+=1;this._cbs[t].length||(this._cbs[t]=null)}}else this._cbs[t]=null}};var createTypedArray=function(){function t(t,e){var n,r=0,i=[];switch(t){case"int16":case"uint8c":n=1;break;default:n=1.1;break}for(r=0;r<e;r+=1)i.push(n);return i}function e(e,n){return"float32"===e?new Float32Array(n):"int16"===e?new Int16Array(n):"uint8c"===e?new Uint8ClampedArray(n):t(e,n)}return"function"===typeof Uint8ClampedArray&&"function"===typeof Float32Array?e:t}();function createSizedArray(t){return Array.apply(null,{length:t})}function createNS(t){return document.createElementNS(svgNS,t)}function createTag(t){return document.createElement(t)}function DynamicPropertyContainer(){}DynamicPropertyContainer.prototype={addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&(this.dynamicProperties.push(t),this.container.addDynamicProperty(this),this._isAnimated=!0)},iterateDynamicProperties:function(){var t;this._mdf=!1;var e=this.dynamicProperties.length;for(t=0;t<e;t+=1)this.dynamicProperties[t].getValue(),this.dynamicProperties[t]._mdf&&(this._mdf=!0)},initDynamicPropertyContainer:function(t){this.container=t,this.dynamicProperties=[],this._mdf=!1,this._isAnimated=!1}};var getBlendMode=function(){var t={0:"source-over",1:"multiply",2:"screen",3:"overlay",4:"darken",5:"lighten",6:"color-dodge",7:"color-burn",8:"hard-light",9:"soft-light",10:"difference",11:"exclusion",12:"hue",13:"saturation",14:"color",15:"luminosity"};return function(e){return t[e]||""}}(),Matrix=function(){var t=Math.cos,e=Math.sin,n=Math.tan,r=Math.round;function i(){return this.props[0]=1,this.props[1]=0,this.props[2]=0,this.props[3]=0,this.props[4]=0,this.props[5]=1,this.props[6]=0,this.props[7]=0,this.props[8]=0,this.props[9]=0,this.props[10]=1,this.props[11]=0,this.props[12]=0,this.props[13]=0,this.props[14]=0,this.props[15]=1,this}function o(n){if(0===n)return this;var r=t(n),i=e(n);return this._t(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1)}function a(n){if(0===n)return this;var r=t(n),i=e(n);return this._t(1,0,0,0,0,r,-i,0,0,i,r,0,0,0,0,1)}function s(n){if(0===n)return this;var r=t(n),i=e(n);return this._t(r,0,i,0,0,1,0,0,-i,0,r,0,0,0,0,1)}function u(n){if(0===n)return this;var r=t(n),i=e(n);return this._t(r,-i,0,0,i,r,0,0,0,0,1,0,0,0,0,1)}function c(t,e){return this._t(1,e,t,1,0,0)}function l(t,e){return this.shear(n(t),n(e))}function h(r,i){var o=t(i),a=e(i);return this._t(o,a,0,0,-a,o,0,0,0,0,1,0,0,0,0,1)._t(1,0,0,0,n(r),1,0,0,0,0,1,0,0,0,0,1)._t(o,-a,0,0,a,o,0,0,0,0,1,0,0,0,0,1)}function f(t,e,n){return n||0===n||(n=1),1===t&&1===e&&1===n?this:this._t(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1)}function p(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m){return this.props[0]=t,this.props[1]=e,this.props[2]=n,this.props[3]=r,this.props[4]=i,this.props[5]=o,this.props[6]=a,this.props[7]=s,this.props[8]=u,this.props[9]=c,this.props[10]=l,this.props[11]=h,this.props[12]=f,this.props[13]=p,this.props[14]=d,this.props[15]=m,this}function d(t,e,n){return n=n||0,0!==t||0!==e||0!==n?this._t(1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1):this}function m(t,e,n,r,i,o,a,s,u,c,l,h,f,p,d,m){var v=this.props;if(1===t&&0===e&&0===n&&0===r&&0===i&&1===o&&0===a&&0===s&&0===u&&0===c&&1===l&&0===h)return v[12]=v[12]*t+v[15]*f,v[13]=v[13]*o+v[15]*p,v[14]=v[14]*l+v[15]*d,v[15]*=m,this._identityCalculated=!1,this;var g=v[0],y=v[1],b=v[2],x=v[3],w=v[4],E=v[5],_=v[6],C=v[7],S=v[8],A=v[9],k=v[10],T=v[11],I=v[12],P=v[13],D=v[14],R=v[15];return v[0]=g*t+y*i+b*u+x*f,v[1]=g*e+y*o+b*c+x*p,v[2]=g*n+y*a+b*l+x*d,v[3]=g*r+y*s+b*h+x*m,v[4]=w*t+E*i+_*u+C*f,v[5]=w*e+E*o+_*c+C*p,v[6]=w*n+E*a+_*l+C*d,v[7]=w*r+E*s+_*h+C*m,v[8]=S*t+A*i+k*u+T*f,v[9]=S*e+A*o+k*c+T*p,v[10]=S*n+A*a+k*l+T*d,v[11]=S*r+A*s+k*h+T*m,v[12]=I*t+P*i+D*u+R*f,v[13]=I*e+P*o+D*c+R*p,v[14]=I*n+P*a+D*l+R*d,v[15]=I*r+P*s+D*h+R*m,this._identityCalculated=!1,this}function v(){return this._identityCalculated||(this._identity=!(1!==this.props[0]||0!==this.props[1]||0!==this.props[2]||0!==this.props[3]||0!==this.props[4]||1!==this.props[5]||0!==this.props[6]||0!==this.props[7]||0!==this.props[8]||0!==this.props[9]||1!==this.props[10]||0!==this.props[11]||0!==this.props[12]||0!==this.props[13]||0!==this.props[14]||1!==this.props[15]),this._identityCalculated=!0),this._identity}function g(t){var e=0;while(e<16){if(t.props[e]!==this.props[e])return!1;e+=1}return!0}function y(t){var e;for(e=0;e<16;e+=1)t.props[e]=this.props[e];return t}function b(t){var e;for(e=0;e<16;e+=1)this.props[e]=t[e]}function x(t,e,n){return{x:t*this.props[0]+e*this.props[4]+n*this.props[8]+this.props[12],y:t*this.props[1]+e*this.props[5]+n*this.props[9]+this.props[13],z:t*this.props[2]+e*this.props[6]+n*this.props[10]+this.props[14]}}function w(t,e,n){return t*this.props[0]+e*this.props[4]+n*this.props[8]+this.props[12]}function E(t,e,n){return t*this.props[1]+e*this.props[5]+n*this.props[9]+this.props[13]}function _(t,e,n){return t*this.props[2]+e*this.props[6]+n*this.props[10]+this.props[14]}function C(){var t=this.props[0]*this.props[5]-this.props[1]*this.props[4],e=this.props[5]/t,n=-this.props[1]/t,r=-this.props[4]/t,i=this.props[0]/t,o=(this.props[4]*this.props[13]-this.props[5]*this.props[12])/t,a=-(this.props[0]*this.props[13]-this.props[1]*this.props[12])/t,s=new Matrix;return s.props[0]=e,s.props[1]=n,s.props[4]=r,s.props[5]=i,s.props[12]=o,s.props[13]=a,s}function S(t){var e=this.getInverseMatrix();return e.applyToPointArray(t[0],t[1],t[2]||0)}function A(t){var e,n=t.length,r=[];for(e=0;e<n;e+=1)r[e]=S(t[e]);return r}function k(t,e,n){var r=createTypedArray("float32",6);if(this.isIdentity())r[0]=t[0],r[1]=t[1],r[2]=e[0],r[3]=e[1],r[4]=n[0],r[5]=n[1];else{var i=this.props[0],o=this.props[1],a=this.props[4],s=this.props[5],u=this.props[12],c=this.props[13];r[0]=t[0]*i+t[1]*a+u,r[1]=t[0]*o+t[1]*s+c,r[2]=e[0]*i+e[1]*a+u,r[3]=e[0]*o+e[1]*s+c,r[4]=n[0]*i+n[1]*a+u,r[5]=n[0]*o+n[1]*s+c}return r}function T(t,e,n){var r;return r=this.isIdentity()?[t,e,n]:[t*this.props[0]+e*this.props[4]+n*this.props[8]+this.props[12],t*this.props[1]+e*this.props[5]+n*this.props[9]+this.props[13],t*this.props[2]+e*this.props[6]+n*this.props[10]+this.props[14]],r}function I(t,e){if(this.isIdentity())return t+","+e;var n=this.props;return Math.round(100*(t*n[0]+e*n[4]+n[12]))/100+","+Math.round(100*(t*n[1]+e*n[5]+n[13]))/100}function P(){var t=0,e=this.props,n="matrix3d(",i=1e4;while(t<16)n+=r(e[t]*i)/i,n+=15===t?")":",",t+=1;return n}function D(t){var e=1e4;return t<1e-6&&t>0||t>-1e-6&&t<0?r(t*e)/e:t}function R(){var t=this.props,e=D(t[0]),n=D(t[1]),r=D(t[4]),i=D(t[5]),o=D(t[12]),a=D(t[13]);return"matrix("+e+","+n+","+r+","+i+","+o+","+a+")"}return function(){this.reset=i,this.rotate=o,this.rotateX=a,this.rotateY=s,this.rotateZ=u,this.skew=l,this.skewFromAxis=h,this.shear=c,this.scale=f,this.setTransform=p,this.translate=d,this.transform=m,this.applyToPoint=x,this.applyToX=w,this.applyToY=E,this.applyToZ=_,this.applyToPointArray=T,this.applyToTriplePoints=k,this.applyToPointStringified=I,this.toCSS=P,this.to2dCSS=R,this.clone=y,this.cloneFromProps=b,this.equals=g,this.inversePoints=A,this.inversePoint=S,this.getInverseMatrix=C,this._t=this.transform,this.isIdentity=v,this._identity=!0,this._identityCalculated=!1,this.props=createTypedArray("float32",16),this.reset()}}();
/*!
 Transformation Matrix v2.0
 (c) Epistemex 2014-2015
 www.epistemex.com
 By Ken Fyrstenberg
 Contributions by leeoniya.
 License: MIT, header required.
 */(function(t,e){var n,r=this,i=256,o=6,a=52,s="random",u=e.pow(i,o),c=e.pow(2,a),l=2*c,h=i-1;function f(n,r,a){var h=[];r=!0===r?{entropy:!0}:r||{};var f=v(m(r.entropy?[n,y(t)]:null===n?g():n,3),h),b=new p(h),x=function(){var t=b.g(o),e=u,n=0;while(t<c)t=(t+n)*i,e*=i,n=b.g(1);while(t>=l)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,v(y(b.S),t),(r.pass||a||function(t,n,r,i){return i&&(i.S&&d(i,b),t.state=function(){return d(b,{})}),r?(e[s]=t,n):t})(x,f,"global"in r?r.global:this==e,r.state)}function p(t){var e,n=t.length,r=this,o=0,a=r.i=r.j=0,s=r.S=[];n||(t=[n++]);while(o<i)s[o]=o++;for(o=0;o<i;o++)s[o]=s[a=h&a+t[o%n]+(e=s[o])],s[a]=e;r.g=function(t){var e,n=0,o=r.i,a=r.j,s=r.S;while(t--)e=s[o=h&o+1],n=n*i+s[h&(s[o]=s[a=h&a+e])+(s[a]=e)];return r.i=o,r.j=a,n}}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function m(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(m(t[n],e-1))}catch(o){}return r.length?r:"string"==i?t:t+"\0"}function v(t,e){var n,r=t+"",i=0;while(i<r.length)e[h&i]=h&(n^=19*e[h&i])+r.charCodeAt(i++);return y(e)}function g(){try{if(n)return y(n.randomBytes(i));var e=new Uint8Array(i);return(r.crypto||r.msCrypto).getRandomValues(e),y(e)}catch(s){var o=r.navigator,a=o&&o.plugins;return[+new Date,r,a,r.screen,y(t)]}}function y(t){return String.fromCharCode.apply(0,t)}e["seed"+s]=f,v(e.random(),t)})([],BMMath);var BezierFactory=function(){var t={};t.getBezierEasing=n;var e={};function n(t,n,r,i,o){var a=o||("bez_"+t+"_"+n+"_"+r+"_"+i).replace(/\./g,"p");if(e[a])return e[a];var s=new g([t,n,r,i]);return e[a]=s,s}var r=4,i=.001,o=1e-7,a=10,s=11,u=1/(s-1),c="function"===typeof Float32Array;function l(t,e){return 1-3*e+3*t}function h(t,e){return 3*e-6*t}function f(t){return 3*t}function p(t,e,n){return((l(e,n)*t+h(e,n))*t+f(e))*t}function d(t,e,n){return 3*l(e,n)*t*t+2*h(e,n)*t+f(e)}function m(t,e,n,r,i){var s,u,c=0;do{u=e+(n-e)/2,s=p(u,r,i)-t,s>0?n=u:e=u}while(Math.abs(s)>o&&++c<a);return u}function v(t,e,n,i){for(var o=0;o<r;++o){var a=d(e,n,i);if(0===a)return e;var s=p(e,n,i)-t;e-=s/a}return e}function g(t){this._p=t,this._mSampleValues=c?new Float32Array(s):new Array(s),this._precomputed=!1,this.get=this.get.bind(this)}return g.prototype={get:function(t){var e=this._p[0],n=this._p[1],r=this._p[2],i=this._p[3];return this._precomputed||this._precompute(),e===n&&r===i?t:0===t?0:1===t?1:p(this._getTForX(t),n,i)},_precompute:function(){var t=this._p[0],e=this._p[1],n=this._p[2],r=this._p[3];this._precomputed=!0,t===e&&n===r||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],n=0;n<s;++n)this._mSampleValues[n]=p(n*u,t,e)},_getTForX:function(t){for(var e=this._p[0],n=this._p[2],r=this._mSampleValues,o=0,a=1,c=s-1;a!==c&&r[a]<=t;++a)o+=u;--a;var l=(t-r[a])/(r[a+1]-r[a]),h=o+l*u,f=d(h,e,n);return f>=i?v(t,h,e,n):0===f?h:m(t,o,o+u,e,n)}},t}();function extendPrototype(t,e){var n,r,i=t.length;for(n=0;n<i;n+=1)for(var o in r=t[n].prototype,r)Object.prototype.hasOwnProperty.call(r,o)&&(e.prototype[o]=r[o])}function getDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)}function createProxyFunction(t){function e(){}return e.prototype=t,e}function bezFunction(){var t=Math;function e(t,e,n,r,i,o){var a=t*r+e*i+n*o-i*r-o*t-n*e;return a>-.001&&a<.001}function n(n,r,i,o,a,s,u,c,l){if(0===i&&0===s&&0===l)return e(n,r,o,a,u,c);var h,f=t.sqrt(t.pow(o-n,2)+t.pow(a-r,2)+t.pow(s-i,2)),p=t.sqrt(t.pow(u-n,2)+t.pow(c-r,2)+t.pow(l-i,2)),d=t.sqrt(t.pow(u-o,2)+t.pow(c-a,2)+t.pow(l-s,2));return h=f>p?f>d?f-p-d:d-p-f:d>p?d-p-f:p-f-d,h>-1e-4&&h<1e-4}var r=function(){return function(t,e,n,r){var i,o,a,s,u,c,l=defaultCurveSegments,h=0,f=[],p=[],d=bezierLengthPool.newElement();for(a=n.length,i=0;i<l;i+=1){for(u=i/(l-1),c=0,o=0;o<a;o+=1)s=bmPow(1-u,3)*t[o]+3*bmPow(1-u,2)*u*n[o]+3*(1-u)*bmPow(u,2)*r[o]+bmPow(u,3)*e[o],f[o]=s,null!==p[o]&&(c+=bmPow(f[o]-p[o],2)),p[o]=f[o];c&&(c=bmSqrt(c),h+=c),d.percents[i]=u,d.lengths[i]=h}return d.addedLength=h,d}}();function i(t){var e,n=segmentsLengthPool.newElement(),i=t.c,o=t.v,a=t.o,s=t.i,u=t._length,c=n.lengths,l=0;for(e=0;e<u-1;e+=1)c[e]=r(o[e],o[e+1],a[e],s[e+1]),l+=c[e].addedLength;return i&&u&&(c[e]=r(o[e],o[0],a[e],s[0]),l+=c[e].addedLength),n.totalLength=l,n}function o(t){this.segmentLength=0,this.points=new Array(t)}function a(t,e){this.partialLength=t,this.point=e}var s=function(){var t={};return function(n,r,i,s){var u=(n[0]+"_"+n[1]+"_"+r[0]+"_"+r[1]+"_"+i[0]+"_"+i[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!t[u]){var c,l,h,f,p,d,m,v=defaultCurveSegments,g=0,y=null;2===n.length&&(n[0]!==r[0]||n[1]!==r[1])&&e(n[0],n[1],r[0],r[1],n[0]+i[0],n[1]+i[1])&&e(n[0],n[1],r[0],r[1],r[0]+s[0],r[1]+s[1])&&(v=2);var b=new o(v);for(h=i.length,c=0;c<v;c+=1){for(m=createSizedArray(h),p=c/(v-1),d=0,l=0;l<h;l+=1)f=bmPow(1-p,3)*n[l]+3*bmPow(1-p,2)*p*(n[l]+i[l])+3*(1-p)*bmPow(p,2)*(r[l]+s[l])+bmPow(p,3)*r[l],m[l]=f,null!==y&&(d+=bmPow(m[l]-y[l],2));d=bmSqrt(d),g+=d,b.points[c]=new a(d,m),y=m}b.segmentLength=g,t[u]=b}return t[u]}}();function u(t,e){var n=e.percents,r=e.lengths,i=n.length,o=bmFloor((i-1)*t),a=t*e.addedLength,s=0;if(o===i-1||0===o||a===r[o])return n[o];var u=r[o]>a?-1:1,c=!0;while(c)if(r[o]<=a&&r[o+1]>a?(s=(a-r[o])/(r[o+1]-r[o]),c=!1):o+=u,o<0||o>=i-1){if(o===i-1)return n[o];c=!1}return n[o]+(n[o+1]-n[o])*s}function c(e,n,r,i,o,a){var s=u(o,a),c=1-s,l=t.round(1e3*(c*c*c*e[0]+(s*c*c+c*s*c+c*c*s)*r[0]+(s*s*c+c*s*s+s*c*s)*i[0]+s*s*s*n[0]))/1e3,h=t.round(1e3*(c*c*c*e[1]+(s*c*c+c*s*c+c*c*s)*r[1]+(s*s*c+c*s*s+s*c*s)*i[1]+s*s*s*n[1]))/1e3;return[l,h]}var l=createTypedArray("float32",8);function h(e,n,r,i,o,a,s){o<0?o=0:o>1&&(o=1);var c=u(o,s);a=a>1?1:a;var h,f=u(a,s),p=e.length,d=1-c,m=1-f,v=d*d*d,g=c*d*d*3,y=c*c*d*3,b=c*c*c,x=d*d*m,w=c*d*m+d*c*m+d*d*f,E=c*c*m+d*c*f+c*d*f,_=c*c*f,C=d*m*m,S=c*m*m+d*f*m+d*m*f,A=c*f*m+d*f*f+c*m*f,k=c*f*f,T=m*m*m,I=f*m*m+m*f*m+m*m*f,P=f*f*m+m*f*f+f*m*f,D=f*f*f;for(h=0;h<p;h+=1)l[4*h]=t.round(1e3*(v*e[h]+g*r[h]+y*i[h]+b*n[h]))/1e3,l[4*h+1]=t.round(1e3*(x*e[h]+w*r[h]+E*i[h]+_*n[h]))/1e3,l[4*h+2]=t.round(1e3*(C*e[h]+S*r[h]+A*i[h]+k*n[h]))/1e3,l[4*h+3]=t.round(1e3*(T*e[h]+I*r[h]+P*i[h]+D*n[h]))/1e3;return l}return{getSegmentsLength:i,getNewSegment:h,getPointInSegment:c,buildBezierData:s,pointOnLine2D:e,pointOnLine3D:n}}(function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),r=Math.max(0,16-(n-t)),i=setTimeout((function(){e(n+r)}),r);return t=n+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})})();var bez=bezFunction();function dataFunctionManager(){function t(i,o,a){var s,u,c,h,f,p,d=i.length;for(u=0;u<d;u+=1)if(s=i[u],"ks"in s&&!s.completed){if(s.completed=!0,s.tt&&(i[u-1].td=s.tt),s.hasMask){var m=s.masksProperties;for(h=m.length,c=0;c<h;c+=1)if(m[c].pt.k.i)r(m[c].pt.k);else for(p=m[c].pt.k.length,f=0;f<p;f+=1)m[c].pt.k[f].s&&r(m[c].pt.k[f].s[0]),m[c].pt.k[f].e&&r(m[c].pt.k[f].e[0])}0===s.ty?(s.layers=e(s.refId,o),t(s.layers,o,a)):4===s.ty?n(s.shapes):5===s.ty&&l(s,a)}}function e(t,e){var n=0,r=e.length;while(n<r){if(e[n].id===t)return e[n].layers.__used?JSON.parse(JSON.stringify(e[n].layers)):(e[n].layers.__used=!0,e[n].layers);n+=1}return null}function n(t){var e,i,o,a=t.length;for(e=a-1;e>=0;e-=1)if("sh"===t[e].ty)if(t[e].ks.k.i)r(t[e].ks.k);else for(o=t[e].ks.k.length,i=0;i<o;i+=1)t[e].ks.k[i].s&&r(t[e].ks.k[i].s[0]),t[e].ks.k[i].e&&r(t[e].ks.k[i].e[0]);else"gr"===t[e].ty&&n(t[e].it)}function r(t){var e,n=t.i.length;for(e=0;e<n;e+=1)t.i[e][0]+=t.v[e][0],t.i[e][1]+=t.v[e][1],t.o[e][0]+=t.v[e][0],t.o[e][1]+=t.v[e][1]}function i(t,e){var n=e?e.split("."):[100,100,100];return t[0]>n[0]||!(n[0]>t[0])&&(t[1]>n[1]||!(n[1]>t[1])&&(t[2]>n[2]||!(n[2]>t[2])&&null))}var o=function(){var t=[4,4,14];function e(t){var e=t.t.d;t.t.d={k:[{s:e,t:0}]}}function n(t){var n,r=t.length;for(n=0;n<r;n+=1)5===t[n].ty&&e(t[n])}return function(e){if(i(t,e.v)&&(n(e.layers),e.assets)){var r,o=e.assets.length;for(r=0;r<o;r+=1)e.assets[r].layers&&n(e.assets[r].layers)}}}(),a=function(){var t=[4,7,99];return function(e){if(e.chars&&!i(t,e.v)){var n,o,a,s,u,c=e.chars.length;for(n=0;n<c;n+=1)if(e.chars[n].data&&e.chars[n].data.shapes)for(u=e.chars[n].data.shapes[0].it,a=u.length,o=0;o<a;o+=1)s=u[o].ks.k,s.__converted||(r(u[o].ks.k),s.__converted=!0)}}}(),s=function(){var t=[4,1,9];function e(t){var n,r,i,o=t.length;for(n=0;n<o;n+=1)if("gr"===t[n].ty)e(t[n].it);else if("fl"===t[n].ty||"st"===t[n].ty)if(t[n].c.k&&t[n].c.k[0].i)for(i=t[n].c.k.length,r=0;r<i;r+=1)t[n].c.k[r].s&&(t[n].c.k[r].s[0]/=255,t[n].c.k[r].s[1]/=255,t[n].c.k[r].s[2]/=255,t[n].c.k[r].s[3]/=255),t[n].c.k[r].e&&(t[n].c.k[r].e[0]/=255,t[n].c.k[r].e[1]/=255,t[n].c.k[r].e[2]/=255,t[n].c.k[r].e[3]/=255);else t[n].c.k[0]/=255,t[n].c.k[1]/=255,t[n].c.k[2]/=255,t[n].c.k[3]/=255}function n(t){var n,r=t.length;for(n=0;n<r;n+=1)4===t[n].ty&&e(t[n].shapes)}return function(e){if(i(t,e.v)&&(n(e.layers),e.assets)){var r,o=e.assets.length;for(r=0;r<o;r+=1)e.assets[r].layers&&n(e.assets[r].layers)}}}(),u=function(){var t=[4,4,18];function e(t){var n,r,i,o=t.length;for(n=o-1;n>=0;n-=1)if("sh"===t[n].ty)if(t[n].ks.k.i)t[n].ks.k.c=t[n].closed;else for(i=t[n].ks.k.length,r=0;r<i;r+=1)t[n].ks.k[r].s&&(t[n].ks.k[r].s[0].c=t[n].closed),t[n].ks.k[r].e&&(t[n].ks.k[r].e[0].c=t[n].closed);else"gr"===t[n].ty&&e(t[n].it)}function n(t){var n,r,i,o,a,s,u=t.length;for(r=0;r<u;r+=1){if(n=t[r],n.hasMask){var c=n.masksProperties;for(o=c.length,i=0;i<o;i+=1)if(c[i].pt.k.i)c[i].pt.k.c=c[i].cl;else for(s=c[i].pt.k.length,a=0;a<s;a+=1)c[i].pt.k[a].s&&(c[i].pt.k[a].s[0].c=c[i].cl),c[i].pt.k[a].e&&(c[i].pt.k[a].e[0].c=c[i].cl)}4===n.ty&&e(n.shapes)}}return function(e){if(i(t,e.v)&&(n(e.layers),e.assets)){var r,o=e.assets.length;for(r=0;r<o;r+=1)e.assets[r].layers&&n(e.assets[r].layers)}}}();function c(e,n){e.__complete||(s(e),o(e),a(e),u(e),t(e.layers,e.assets,n),e.__complete=!0)}function l(t){0!==t.t.a.length||"m"in t.t.p||(t.singleShape=!0)}var h={};return h.completeData=c,h.checkColors=s,h.checkChars=a,h.checkShapes=u,h.completeLayers=t,h}var dataManager=dataFunctionManager();function getFontProperties(t){for(var e,n=t.fStyle?t.fStyle.split(" "):[],r="normal",i="normal",o=n.length,a=0;a<o;a+=1)switch(e=n[a].toLowerCase(),e){case"italic":i="italic";break;case"bold":r="700";break;case"black":r="900";break;case"medium":r="500";break;case"regular":case"normal":r="400";break;case"light":case"thin":r="200";break;default:break}return{style:i,weight:t.fWeight||r}}var FontManager=function(){var t=5e3,e={w:0,size:0,shapes:[]},n=[];function r(t){var e,n=t.split(","),r=n.length,i=[];for(e=0;e<r;e+=1)"sans-serif"!==n[e]&&"monospace"!==n[e]&&i.push(n[e]);return i.join(",")}function i(t,e){var n=createTag("span");n.setAttribute("aria-hidden",!0),n.style.fontFamily=e;var i=createTag("span");i.innerText="giItT1WQy@!-/#",n.style.position="absolute",n.style.left="-10000px",n.style.top="-10000px",n.style.fontSize="300px",n.style.fontVariant="normal",n.style.fontStyle="normal",n.style.fontWeight="normal",n.style.letterSpacing="0",n.appendChild(i),document.body.appendChild(n);var o=i.offsetWidth;return i.style.fontFamily=r(t)+", "+e,{node:i,w:o,parent:n}}function o(){var e,n,r,i=this.fonts.length,o=i;for(e=0;e<i;e+=1)this.fonts[e].loaded?o-=1:"n"===this.fonts[e].fOrigin||0===this.fonts[e].origin?this.fonts[e].loaded=!0:(n=this.fonts[e].monoCase.node,r=this.fonts[e].monoCase.w,n.offsetWidth!==r?(o-=1,this.fonts[e].loaded=!0):(n=this.fonts[e].sansCase.node,r=this.fonts[e].sansCase.w,n.offsetWidth!==r&&(o-=1,this.fonts[e].loaded=!0)),this.fonts[e].loaded&&(this.fonts[e].sansCase.parent.parentNode.removeChild(this.fonts[e].sansCase.parent),this.fonts[e].monoCase.parent.parentNode.removeChild(this.fonts[e].monoCase.parent)));0!==o&&Date.now()-this.initTime<t?setTimeout(this.checkLoadedFontsBinded,20):setTimeout(this.setIsLoadedBinded,10)}function a(t,e){var n=createNS("text");n.style.fontSize="100px";var r=getFontProperties(e);n.setAttribute("font-family",e.fFamily),n.setAttribute("font-style",r.style),n.setAttribute("font-weight",r.weight),n.textContent="1",e.fClass?(n.style.fontFamily="inherit",n.setAttribute("class",e.fClass)):n.style.fontFamily=e.fFamily,t.appendChild(n);var i=createTag("canvas").getContext("2d");return i.font=e.fWeight+" "+e.fStyle+" 100px "+e.fFamily,n}function s(t,e){if(t){if(this.chars)return this.isLoaded=!0,void(this.fonts=t.list);var n,r=t.list,o=r.length,s=o;for(n=0;n<o;n+=1){var u,c,l=!0;if(r[n].loaded=!1,r[n].monoCase=i(r[n].fFamily,"monospace"),r[n].sansCase=i(r[n].fFamily,"sans-serif"),r[n].fPath){if("p"===r[n].fOrigin||3===r[n].origin){if(u=document.querySelectorAll('style[f-forigin="p"][f-family="'+r[n].fFamily+'"], style[f-origin="3"][f-family="'+r[n].fFamily+'"]'),u.length>0&&(l=!1),l){var h=createTag("style");h.setAttribute("f-forigin",r[n].fOrigin),h.setAttribute("f-origin",r[n].origin),h.setAttribute("f-family",r[n].fFamily),h.type="text/css",h.innerText="@font-face {font-family: "+r[n].fFamily+"; font-style: normal; src: url('"+r[n].fPath+"');}",e.appendChild(h)}}else if("g"===r[n].fOrigin||1===r[n].origin){for(u=document.querySelectorAll('link[f-forigin="g"], link[f-origin="1"]'),c=0;c<u.length;c+=1)-1!==u[c].href.indexOf(r[n].fPath)&&(l=!1);if(l){var f=createTag("link");f.setAttribute("f-forigin",r[n].fOrigin),f.setAttribute("f-origin",r[n].origin),f.type="text/css",f.rel="stylesheet",f.href=r[n].fPath,document.body.appendChild(f)}}else if("t"===r[n].fOrigin||2===r[n].origin){for(u=document.querySelectorAll('script[f-forigin="t"], script[f-origin="2"]'),c=0;c<u.length;c+=1)r[n].fPath===u[c].src&&(l=!1);if(l){var p=createTag("link");p.setAttribute("f-forigin",r[n].fOrigin),p.setAttribute("f-origin",r[n].origin),p.setAttribute("rel","stylesheet"),p.setAttribute("href",r[n].fPath),e.appendChild(p)}}}else r[n].loaded=!0,s-=1;r[n].helper=a(e,r[n]),r[n].cache={},this.fonts.push(r[n])}0===s?this.isLoaded=!0:setTimeout(this.checkLoadedFonts.bind(this),100)}else this.isLoaded=!0}function u(t){if(t){var e;this.chars||(this.chars=[]);var n,r,i=t.length,o=this.chars.length;for(e=0;e<i;e+=1){n=0,r=!1;while(n<o)this.chars[n].style===t[e].style&&this.chars[n].fFamily===t[e].fFamily&&this.chars[n].ch===t[e].ch&&(r=!0),n+=1;r||(this.chars.push(t[e]),o+=1)}}}function c(t,n,r){var i=0,o=this.chars.length;while(i<o){if(this.chars[i].ch===t&&this.chars[i].style===n&&this.chars[i].fFamily===r)return this.chars[i];i+=1}return("string"===typeof t&&13!==t.charCodeAt(0)||!t)&&console&&console.warn&&!this._warned&&(this._warned=!0,console.warn("Missing character from exported characters list: ",t,n,r)),e}function l(t,e,n){var r=this.getFontByName(e),i=t.charCodeAt(0);if(!r.cache[i+1]){var o=r.helper;if(" "===t){o.textContent="|"+t+"|";var a=o.getComputedTextLength();o.textContent="||";var s=o.getComputedTextLength();r.cache[i+1]=(a-s)/100}else o.textContent=t,r.cache[i+1]=o.getComputedTextLength()/100}return r.cache[i+1]*n}function h(t){var e=0,n=this.fonts.length;while(e<n){if(this.fonts[e].fName===t)return this.fonts[e];e+=1}return this.fonts[0]}function f(){return n}function p(){this.isLoaded=!0}n=n.concat([2304,2305,2306,2307,2362,2363,2364,2364,2366,2367,2368,2369,2370,2371,2372,2373,2374,2375,2376,2377,2378,2379,2380,2381,2382,2383,2387,2388,2389,2390,2391,2402,2403]);var d=function(){this.fonts=[],this.chars=null,this.typekitLoaded=0,this.isLoaded=!1,this._warned=!1,this.initTime=Date.now(),this.setIsLoadedBinded=this.setIsLoaded.bind(this),this.checkLoadedFontsBinded=this.checkLoadedFonts.bind(this)};d.getCombinedCharacterCodes=f;var m={addChars:u,addFonts:s,getCharData:c,getFontByName:h,measureText:l,checkLoadedFonts:o,setIsLoaded:p};return d.prototype=m,d}(),PropertyFactory=function(){var t=initialDefaultFrame,e=Math.abs;function n(t,e){var n,a=this.offsetTime;"multidimensional"===this.propType&&(n=createTypedArray("float32",this.pv.length));var s,u,c,l,h,f,p,d,m=e.lastIndex,v=m,g=this.keyframes.length-1,y=!0;while(y){if(s=this.keyframes[v],u=this.keyframes[v+1],v===g-1&&t>=u.t-a){s.h&&(s=u),m=0;break}if(u.t-a>t){m=v;break}v<g-1?v+=1:(m=0,y=!1)}var b,x=u.t-a,w=s.t-a;if(s.to){s.bezierData||(s.bezierData=bez.buildBezierData(s.s,u.s||s.e,s.to,s.ti));var E=s.bezierData;if(t>=x||t<w){var _=t>=x?E.points.length-1:0;for(l=E.points[_].point.length,c=0;c<l;c+=1)n[c]=E.points[_].point[c]}else{s.__fnct?d=s.__fnct:(d=BezierFactory.getBezierEasing(s.o.x,s.o.y,s.i.x,s.i.y,s.n).get,s.__fnct=d),h=d((t-w)/(x-w));var C,S=E.segmentLength*h,A=e.lastFrame<t&&e._lastKeyframeIndex===v?e._lastAddedLength:0;p=e.lastFrame<t&&e._lastKeyframeIndex===v?e._lastPoint:0,y=!0,f=E.points.length;while(y){if(A+=E.points[p].partialLength,0===S||0===h||p===E.points.length-1){for(l=E.points[p].point.length,c=0;c<l;c+=1)n[c]=E.points[p].point[c];break}if(S>=A&&S<A+E.points[p+1].partialLength){for(C=(S-A)/E.points[p+1].partialLength,l=E.points[p].point.length,c=0;c<l;c+=1)n[c]=E.points[p].point[c]+(E.points[p+1].point[c]-E.points[p].point[c])*C;break}p<f-1?p+=1:y=!1}e._lastPoint=p,e._lastAddedLength=A-E.points[p].partialLength,e._lastKeyframeIndex=v}}else{var k,T,I,P,D;if(g=s.s.length,b=u.s||s.e,this.sh&&1!==s.h)if(t>=x)n[0]=b[0],n[1]=b[1],n[2]=b[2];else if(t<=w)n[0]=s.s[0],n[1]=s.s[1],n[2]=s.s[2];else{var R=o(s.s),M=o(b),F=(t-w)/(x-w);i(n,r(R,M,F))}else for(v=0;v<g;v+=1)1!==s.h&&(t>=x?h=1:t<w?h=0:(s.o.x.constructor===Array?(s.__fnct||(s.__fnct=[]),s.__fnct[v]?d=s.__fnct[v]:(k="undefined"===typeof s.o.x[v]?s.o.x[0]:s.o.x[v],T="undefined"===typeof s.o.y[v]?s.o.y[0]:s.o.y[v],I="undefined"===typeof s.i.x[v]?s.i.x[0]:s.i.x[v],P="undefined"===typeof s.i.y[v]?s.i.y[0]:s.i.y[v],d=BezierFactory.getBezierEasing(k,T,I,P).get,s.__fnct[v]=d)):s.__fnct?d=s.__fnct:(k=s.o.x,T=s.o.y,I=s.i.x,P=s.i.y,d=BezierFactory.getBezierEasing(k,T,I,P).get,s.__fnct=d),h=d((t-w)/(x-w)))),b=u.s||s.e,D=1===s.h?s.s[v]:s.s[v]+(b[v]-s.s[v])*h,"multidimensional"===this.propType?n[v]=D:n=D}return e.lastIndex=m,n}function r(t,e,n){var r,i,o,a,s,u=[],c=t[0],l=t[1],h=t[2],f=t[3],p=e[0],d=e[1],m=e[2],v=e[3];return i=c*p+l*d+h*m+f*v,i<0&&(i=-i,p=-p,d=-d,m=-m,v=-v),1-i>1e-6?(r=Math.acos(i),o=Math.sin(r),a=Math.sin((1-n)*r)/o,s=Math.sin(n*r)/o):(a=1-n,s=n),u[0]=a*c+s*p,u[1]=a*l+s*d,u[2]=a*h+s*m,u[3]=a*f+s*v,u}function i(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=Math.atan2(2*r*o-2*n*i,1-2*r*r-2*i*i),s=Math.asin(2*n*r+2*i*o),u=Math.atan2(2*n*o-2*r*i,1-2*n*n-2*i*i);t[0]=a/degToRads,t[1]=s/degToRads,t[2]=u/degToRads}function o(t){var e=t[0]*degToRads,n=t[1]*degToRads,r=t[2]*degToRads,i=Math.cos(e/2),o=Math.cos(n/2),a=Math.cos(r/2),s=Math.sin(e/2),u=Math.sin(n/2),c=Math.sin(r/2),l=i*o*a-s*u*c,h=s*u*a+i*o*c,f=s*o*a+i*u*c,p=i*u*a-s*o*c;return[h,f,p,l]}function a(){var e=this.comp.renderedFrame-this.offsetTime,n=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(e===this._caching.lastFrame||this._caching.lastFrame!==t&&(this._caching.lastFrame>=r&&e>=r||this._caching.lastFrame<n&&e<n))){this._caching.lastFrame>=e&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0);var i=this.interpolateValue(e,this._caching);this.pv=i}return this._caching.lastFrame=e,this.pv}function s(t){var n;if("unidimensional"===this.propType)n=t*this.mult,e(this.v-n)>1e-5&&(this.v=n,this._mdf=!0);else{var r=0,i=this.v.length;while(r<i)n=t[r]*this.mult,e(this.v[r]-n)>1e-5&&(this.v[r]=n,this._mdf=!0),r+=1}}function u(){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t;this.lock=!0,this._mdf=this._isFirstFrame;var e=this.effectsSequence.length,n=this.kf?this.pv:this.data.k;for(t=0;t<e;t+=1)n=this.effectsSequence[t](n);this.setVValue(n),this._isFirstFrame=!1,this.lock=!1,this.frameId=this.elem.globalData.frameId}}function c(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function l(t,e,n,r){this.propType="unidimensional",this.mult=n||1,this.data=e,this.v=n?e.k*n:e.k,this.pv=e.k,this._mdf=!1,this.elem=t,this.container=r,this.comp=t.comp,this.k=!1,this.kf=!1,this.vel=0,this.effectsSequence=[],this._isFirstFrame=!0,this.getValue=u,this.setVValue=s,this.addEffect=c}function h(t,e,n,r){var i;this.propType="multidimensional",this.mult=n||1,this.data=e,this._mdf=!1,this.elem=t,this.container=r,this.comp=t.comp,this.k=!1,this.kf=!1,this.frameId=-1;var o=e.k.length;for(this.v=createTypedArray("float32",o),this.pv=createTypedArray("float32",o),this.vel=createTypedArray("float32",o),i=0;i<o;i+=1)this.v[i]=e.k[i]*this.mult,this.pv[i]=e.k[i];this._isFirstFrame=!0,this.effectsSequence=[],this.getValue=u,this.setVValue=s,this.addEffect=c}function f(e,r,i,o){this.propType="unidimensional",this.keyframes=r.k,this.offsetTime=e.data.st,this.frameId=-1,this._caching={lastFrame:t,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=r,this.mult=i||1,this.elem=e,this.container=o,this.comp=e.comp,this.v=t,this.pv=t,this._isFirstFrame=!0,this.getValue=u,this.setVValue=s,this.interpolateValue=n,this.effectsSequence=[a.bind(this)],this.addEffect=c}function p(e,r,i,o){var l;this.propType="multidimensional";var h,f,p,d,m=r.k.length;for(l=0;l<m-1;l+=1)r.k[l].to&&r.k[l].s&&r.k[l+1]&&r.k[l+1].s&&(h=r.k[l].s,f=r.k[l+1].s,p=r.k[l].to,d=r.k[l].ti,(2===h.length&&(h[0]!==f[0]||h[1]!==f[1])&&bez.pointOnLine2D(h[0],h[1],f[0],f[1],h[0]+p[0],h[1]+p[1])&&bez.pointOnLine2D(h[0],h[1],f[0],f[1],f[0]+d[0],f[1]+d[1])||3===h.length&&(h[0]!==f[0]||h[1]!==f[1]||h[2]!==f[2])&&bez.pointOnLine3D(h[0],h[1],h[2],f[0],f[1],f[2],h[0]+p[0],h[1]+p[1],h[2]+p[2])&&bez.pointOnLine3D(h[0],h[1],h[2],f[0],f[1],f[2],f[0]+d[0],f[1]+d[1],f[2]+d[2]))&&(r.k[l].to=null,r.k[l].ti=null),h[0]===f[0]&&h[1]===f[1]&&0===p[0]&&0===p[1]&&0===d[0]&&0===d[1]&&(2===h.length||h[2]===f[2]&&0===p[2]&&0===d[2])&&(r.k[l].to=null,r.k[l].ti=null));this.effectsSequence=[a.bind(this)],this.data=r,this.keyframes=r.k,this.offsetTime=e.data.st,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=i||1,this.elem=e,this.container=o,this.comp=e.comp,this.getValue=u,this.setVValue=s,this.interpolateValue=n,this.frameId=-1;var v=r.k[0].s.length;for(this.v=createTypedArray("float32",v),this.pv=createTypedArray("float32",v),l=0;l<v;l+=1)this.v[l]=t,this.pv[l]=t;this._caching={lastFrame:t,lastIndex:0,value:createTypedArray("float32",v)},this.addEffect=c}function d(t,e,n,r,i){var o;if(e.k.length)if("number"===typeof e.k[0])o=new h(t,e,r,i);else switch(n){case 0:o=new f(t,e,r,i);break;case 1:o=new p(t,e,r,i);break;default:break}else o=new l(t,e,r,i);return o.effectsSequence.length&&i.addDynamicProperty(o),o}var m={getProp:d};return m}(),TransformPropertyFactory=function(){var t=[0,0];function e(t){var e=this._mdf;this.iterateDynamicProperties(),this._mdf=this._mdf||e,this.a&&t.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.s&&t.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&t.skewFromAxis(-this.sk.v,this.sa.v),this.r?t.rotate(-this.r.v):t.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.data.p.s?this.data.p.z?t.translate(this.px.v,this.py.v,-this.pz.v):t.translate(this.px.v,this.py.v,0):t.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}function n(e){if(this.elem.globalData.frameId!==this.frameId){if(this._isDirty&&(this.precalculateMatrix(),this._isDirty=!1),this.iterateDynamicProperties(),this._mdf||e){var n;if(this.v.cloneFromProps(this.pre.props),this.appliedTransformations<1&&this.v.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations<2&&this.v.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.sk&&this.appliedTransformations<3&&this.v.skewFromAxis(-this.sk.v,this.sa.v),this.r&&this.appliedTransformations<4?this.v.rotate(-this.r.v):!this.r&&this.appliedTransformations<4&&this.v.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.autoOriented){var r,i;if(n=this.elem.globalData.frameRate,this.p&&this.p.keyframes&&this.p.getValueAtTime)this.p._caching.lastFrame+this.p.offsetTime<=this.p.keyframes[0].t?(r=this.p.getValueAtTime((this.p.keyframes[0].t+.01)/n,0),i=this.p.getValueAtTime(this.p.keyframes[0].t/n,0)):this.p._caching.lastFrame+this.p.offsetTime>=this.p.keyframes[this.p.keyframes.length-1].t?(r=this.p.getValueAtTime(this.p.keyframes[this.p.keyframes.length-1].t/n,0),i=this.p.getValueAtTime((this.p.keyframes[this.p.keyframes.length-1].t-.05)/n,0)):(r=this.p.pv,i=this.p.getValueAtTime((this.p._caching.lastFrame+this.p.offsetTime-.01)/n,this.p.offsetTime));else if(this.px&&this.px.keyframes&&this.py.keyframes&&this.px.getValueAtTime&&this.py.getValueAtTime){r=[],i=[];var o=this.px,a=this.py;o._caching.lastFrame+o.offsetTime<=o.keyframes[0].t?(r[0]=o.getValueAtTime((o.keyframes[0].t+.01)/n,0),r[1]=a.getValueAtTime((a.keyframes[0].t+.01)/n,0),i[0]=o.getValueAtTime(o.keyframes[0].t/n,0),i[1]=a.getValueAtTime(a.keyframes[0].t/n,0)):o._caching.lastFrame+o.offsetTime>=o.keyframes[o.keyframes.length-1].t?(r[0]=o.getValueAtTime(o.keyframes[o.keyframes.length-1].t/n,0),r[1]=a.getValueAtTime(a.keyframes[a.keyframes.length-1].t/n,0),i[0]=o.getValueAtTime((o.keyframes[o.keyframes.length-1].t-.01)/n,0),i[1]=a.getValueAtTime((a.keyframes[a.keyframes.length-1].t-.01)/n,0)):(r=[o.pv,a.pv],i[0]=o.getValueAtTime((o._caching.lastFrame+o.offsetTime-.01)/n,o.offsetTime),i[1]=a.getValueAtTime((a._caching.lastFrame+a.offsetTime-.01)/n,a.offsetTime))}else i=t,r=i;this.v.rotate(-Math.atan2(r[1]-i[1],r[0]-i[0]))}this.data.p&&this.data.p.s?this.data.p.z?this.v.translate(this.px.v,this.py.v,-this.pz.v):this.v.translate(this.px.v,this.py.v,0):this.v.translate(this.p.v[0],this.p.v[1],-this.p.v[2])}this.frameId=this.elem.globalData.frameId}}function r(){if(!this.a.k&&(this.pre.translate(-this.a.v[0],-this.a.v[1],this.a.v[2]),this.appliedTransformations=1,!this.s.effectsSequence.length)){if(this.pre.scale(this.s.v[0],this.s.v[1],this.s.v[2]),this.appliedTransformations=2,this.sk){if(this.sk.effectsSequence.length||this.sa.effectsSequence.length)return;this.pre.skewFromAxis(-this.sk.v,this.sa.v),this.appliedTransformations=3}this.r?this.r.effectsSequence.length||(this.pre.rotate(-this.r.v),this.appliedTransformations=4):this.rz.effectsSequence.length||this.ry.effectsSequence.length||this.rx.effectsSequence.length||this.or.effectsSequence.length||(this.pre.rotateZ(-this.rz.v).rotateY(this.ry.v).rotateX(this.rx.v).rotateZ(-this.or.v[2]).rotateY(this.or.v[1]).rotateX(this.or.v[0]),this.appliedTransformations=4)}}function i(){}function o(t){this._addDynamicProperty(t),this.elem.addDynamicProperty(t),this._isDirty=!0}function a(t,e,n){if(this.elem=t,this.frameId=-1,this.propType="transform",this.data=e,this.v=new Matrix,this.pre=new Matrix,this.appliedTransformations=0,this.initDynamicPropertyContainer(n||t),e.p&&e.p.s?(this.px=PropertyFactory.getProp(t,e.p.x,0,0,this),this.py=PropertyFactory.getProp(t,e.p.y,0,0,this),e.p.z&&(this.pz=PropertyFactory.getProp(t,e.p.z,0,0,this))):this.p=PropertyFactory.getProp(t,e.p||{k:[0,0,0]},1,0,this),e.rx){if(this.rx=PropertyFactory.getProp(t,e.rx,0,degToRads,this),this.ry=PropertyFactory.getProp(t,e.ry,0,degToRads,this),this.rz=PropertyFactory.getProp(t,e.rz,0,degToRads,this),e.or.k[0].ti){var r,i=e.or.k.length;for(r=0;r<i;r+=1)e.or.k[r].to=null,e.or.k[r].ti=null}this.or=PropertyFactory.getProp(t,e.or,1,degToRads,this),this.or.sh=!0}else this.r=PropertyFactory.getProp(t,e.r||{k:0},0,degToRads,this);e.sk&&(this.sk=PropertyFactory.getProp(t,e.sk,0,degToRads,this),this.sa=PropertyFactory.getProp(t,e.sa,0,degToRads,this)),this.a=PropertyFactory.getProp(t,e.a||{k:[0,0,0]},1,0,this),this.s=PropertyFactory.getProp(t,e.s||{k:[100,100,100]},1,.01,this),e.o?this.o=PropertyFactory.getProp(t,e.o,0,.01,t):this.o={_mdf:!1,v:1},this._isDirty=!0,this.dynamicProperties.length||this.getValue(!0)}function s(t,e,n){return new a(t,e,n)}return a.prototype={applyToMatrix:e,getValue:n,precalculateMatrix:r,autoOrient:i},extendPrototype([DynamicPropertyContainer],a),a.prototype.addDynamicProperty=o,a.prototype._addDynamicProperty=DynamicPropertyContainer.prototype.addDynamicProperty,{getTransformProperty:s}}();function ShapePath(){this.c=!1,this._length=0,this._maxLength=8,this.v=createSizedArray(this._maxLength),this.o=createSizedArray(this._maxLength),this.i=createSizedArray(this._maxLength)}ShapePath.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);var n=0;while(n<e)this.v[n]=pointPool.newElement(),this.o[n]=pointPool.newElement(),this.i[n]=pointPool.newElement(),n+=1},ShapePath.prototype.setLength=function(t){while(this._maxLength<t)this.doubleArrayLength();this._length=t},ShapePath.prototype.doubleArrayLength=function(){this.v=this.v.concat(createSizedArray(this._maxLength)),this.i=this.i.concat(createSizedArray(this._maxLength)),this.o=this.o.concat(createSizedArray(this._maxLength)),this._maxLength*=2},ShapePath.prototype.setXYAt=function(t,e,n,r,i){var o;switch(this._length=Math.max(this._length,r+1),this._length>=this._maxLength&&this.doubleArrayLength(),n){case"v":o=this.v;break;case"i":o=this.i;break;case"o":o=this.o;break;default:o=[];break}(!o[r]||o[r]&&!i)&&(o[r]=pointPool.newElement()),o[r][0]=t,o[r][1]=e},ShapePath.prototype.setTripleAt=function(t,e,n,r,i,o,a,s){this.setXYAt(t,e,"v",a,s),this.setXYAt(n,r,"o",a,s),this.setXYAt(i,o,"i",a,s)},ShapePath.prototype.reverse=function(){var t=new ShapePath;t.setPathData(this.c,this._length);var e=this.v,n=this.o,r=this.i,i=0;this.c&&(t.setTripleAt(e[0][0],e[0][1],r[0][0],r[0][1],n[0][0],n[0][1],0,!1),i=1);var o,a=this._length-1,s=this._length;for(o=i;o<s;o+=1)t.setTripleAt(e[a][0],e[a][1],r[a][0],r[a][1],n[a][0],n[a][1],o,!1),a-=1;return t};var ShapePropertyFactory=function(){var t=-999999;function e(t,e,n){var r,i,o,a,s,u,c,l,h,f=n.lastIndex,p=this.keyframes;if(t<p[0].t-this.offsetTime)r=p[0].s[0],o=!0,f=0;else if(t>=p[p.length-1].t-this.offsetTime)r=p[p.length-1].s?p[p.length-1].s[0]:p[p.length-2].e[0],o=!0;else{var d,m,v=f,g=p.length-1,y=!0;while(y){if(d=p[v],m=p[v+1],m.t-this.offsetTime>t)break;v<g-1?v+=1:y=!1}if(o=1===d.h,f=v,!o){if(t>=m.t-this.offsetTime)l=1;else if(t<d.t-this.offsetTime)l=0;else{var b;d.__fnct?b=d.__fnct:(b=BezierFactory.getBezierEasing(d.o.x,d.o.y,d.i.x,d.i.y).get,d.__fnct=b),l=b((t-(d.t-this.offsetTime))/(m.t-this.offsetTime-(d.t-this.offsetTime)))}i=m.s?m.s[0]:d.e[0]}r=d.s[0]}for(u=e._length,c=r.i[0].length,n.lastIndex=f,a=0;a<u;a+=1)for(s=0;s<c;s+=1)h=o?r.i[a][s]:r.i[a][s]+(i.i[a][s]-r.i[a][s])*l,e.i[a][s]=h,h=o?r.o[a][s]:r.o[a][s]+(i.o[a][s]-r.o[a][s])*l,e.o[a][s]=h,h=o?r.v[a][s]:r.v[a][s]+(i.v[a][s]-r.v[a][s])*l,e.v[a][s]=h}function n(){var e=this.comp.renderedFrame-this.offsetTime,n=this.keyframes[0].t-this.offsetTime,r=this.keyframes[this.keyframes.length-1].t-this.offsetTime,i=this._caching.lastFrame;return i!==t&&(i<n&&e<n||i>r&&e>r)||(this._caching.lastIndex=i<e?this._caching.lastIndex:0,this.interpolateShape(e,this.pv,this._caching)),this._caching.lastFrame=e,this.pv}function r(){this.paths=this.localShapeCollection}function i(t,e){if(t._length!==e._length||t.c!==e.c)return!1;var n,r=t._length;for(n=0;n<r;n+=1)if(t.v[n][0]!==e.v[n][0]||t.v[n][1]!==e.v[n][1]||t.o[n][0]!==e.o[n][0]||t.o[n][1]!==e.o[n][1]||t.i[n][0]!==e.i[n][0]||t.i[n][1]!==e.i[n][1])return!1;return!0}function o(t){i(this.v,t)||(this.v=shapePool.clone(t),this.localShapeCollection.releaseShapes(),this.localShapeCollection.addShape(this.v),this._mdf=!0,this.paths=this.localShapeCollection)}function a(){if(this.elem.globalData.frameId!==this.frameId)if(this.effectsSequence.length)if(this.lock)this.setVValue(this.pv);else{var t,e;this.lock=!0,this._mdf=!1,t=this.kf?this.pv:this.data.ks?this.data.ks.k:this.data.pt.k;var n=this.effectsSequence.length;for(e=0;e<n;e+=1)t=this.effectsSequence[e](t);this.setVValue(t),this.lock=!1,this.frameId=this.elem.globalData.frameId}else this._mdf=!1}function s(t,e,n){this.propType="shape",this.comp=t.comp,this.container=t,this.elem=t,this.data=e,this.k=!1,this.kf=!1,this._mdf=!1;var i=3===n?e.pt.k:e.ks.k;this.v=shapePool.clone(i),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.reset=r,this.effectsSequence=[]}function u(t){this.effectsSequence.push(t),this.container.addDynamicProperty(this)}function c(e,i,o){this.propType="shape",this.comp=e.comp,this.elem=e,this.container=e,this.offsetTime=e.data.st,this.keyframes=3===o?i.pt.k:i.ks.k,this.k=!0,this.kf=!0;var a=this.keyframes[0].s[0].i.length;this.v=shapePool.newElement(),this.v.setPathData(this.keyframes[0].s[0].c,a),this.pv=shapePool.clone(this.v),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.paths.addShape(this.v),this.lastFrame=t,this.reset=r,this._caching={lastFrame:t,lastIndex:0},this.effectsSequence=[n.bind(this)]}s.prototype.interpolateShape=e,s.prototype.getValue=a,s.prototype.setVValue=o,s.prototype.addEffect=u,c.prototype.getValue=a,c.prototype.interpolateShape=e,c.prototype.setVValue=o,c.prototype.addEffect=u;var l=function(){var t=roundCorner;function e(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,4),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.paths=this.localShapeCollection,this.localShapeCollection.addShape(this.v),this.d=e.d,this.elem=t,this.comp=t.comp,this.frameId=-1,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertEllToPath())}return e.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertEllToPath())},convertEllToPath:function(){var e=this.p.v[0],n=this.p.v[1],r=this.s.v[0]/2,i=this.s.v[1]/2,o=3!==this.d,a=this.v;a.v[0][0]=e,a.v[0][1]=n-i,a.v[1][0]=o?e+r:e-r,a.v[1][1]=n,a.v[2][0]=e,a.v[2][1]=n+i,a.v[3][0]=o?e-r:e+r,a.v[3][1]=n,a.i[0][0]=o?e-r*t:e+r*t,a.i[0][1]=n-i,a.i[1][0]=o?e+r:e-r,a.i[1][1]=n-i*t,a.i[2][0]=o?e+r*t:e-r*t,a.i[2][1]=n+i,a.i[3][0]=o?e-r:e+r,a.i[3][1]=n+i*t,a.o[0][0]=o?e+r*t:e-r*t,a.o[0][1]=n-i,a.o[1][0]=o?e+r:e-r,a.o[1][1]=n+i*t,a.o[2][0]=o?e-r*t:e+r*t,a.o[2][1]=n+i,a.o[3][0]=o?e-r:e+r,a.o[3][1]=n-i*t}},extendPrototype([DynamicPropertyContainer],e),e}(),h=function(){function t(t,e){this.v=shapePool.newElement(),this.v.setPathData(!0,0),this.elem=t,this.comp=t.comp,this.data=e,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),1===e.sy?(this.ir=PropertyFactory.getProp(t,e.ir,0,0,this),this.is=PropertyFactory.getProp(t,e.is,0,.01,this),this.convertToPath=this.convertStarToPath):this.convertToPath=this.convertPolygonToPath,this.pt=PropertyFactory.getProp(t,e.pt,0,0,this),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,degToRads,this),this.or=PropertyFactory.getProp(t,e.or,0,0,this),this.os=PropertyFactory.getProp(t,e.os,0,.01,this),this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertToPath())}return t.prototype={reset:r,getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertToPath())},convertStarToPath:function(){var t,e,n,r,i=2*Math.floor(this.pt.v),o=2*Math.PI/i,a=!0,s=this.or.v,u=this.ir.v,c=this.os.v,l=this.is.v,h=2*Math.PI*s/(2*i),f=2*Math.PI*u/(2*i),p=-Math.PI/2;p+=this.r.v;var d=3===this.data.d?-1:1;for(this.v._length=0,t=0;t<i;t+=1){e=a?s:u,n=a?c:l,r=a?h:f;var m=e*Math.cos(p),v=e*Math.sin(p),g=0===m&&0===v?0:v/Math.sqrt(m*m+v*v),y=0===m&&0===v?0:-m/Math.sqrt(m*m+v*v);m+=+this.p.v[0],v+=+this.p.v[1],this.v.setTripleAt(m,v,m-g*r*n*d,v-y*r*n*d,m+g*r*n*d,v+y*r*n*d,t,!0),a=!a,p+=o*d}},convertPolygonToPath:function(){var t,e=Math.floor(this.pt.v),n=2*Math.PI/e,r=this.or.v,i=this.os.v,o=2*Math.PI*r/(4*e),a=.5*-Math.PI,s=3===this.data.d?-1:1;for(a+=this.r.v,this.v._length=0,t=0;t<e;t+=1){var u=r*Math.cos(a),c=r*Math.sin(a),l=0===u&&0===c?0:c/Math.sqrt(u*u+c*c),h=0===u&&0===c?0:-u/Math.sqrt(u*u+c*c);u+=+this.p.v[0],c+=+this.p.v[1],this.v.setTripleAt(u,c,u-l*o*i*s,c-h*o*i*s,u+l*o*i*s,c+h*o*i*s,t,!0),a+=n*s}this.paths.length=0,this.paths[0]=this.v}},extendPrototype([DynamicPropertyContainer],t),t}(),f=function(){function t(t,e){this.v=shapePool.newElement(),this.v.c=!0,this.localShapeCollection=shapeCollectionPool.newShapeCollection(),this.localShapeCollection.addShape(this.v),this.paths=this.localShapeCollection,this.elem=t,this.comp=t.comp,this.frameId=-1,this.d=e.d,this.initDynamicPropertyContainer(t),this.p=PropertyFactory.getProp(t,e.p,1,0,this),this.s=PropertyFactory.getProp(t,e.s,1,0,this),this.r=PropertyFactory.getProp(t,e.r,0,0,this),this.dynamicProperties.length?this.k=!0:(this.k=!1,this.convertRectToPath())}return t.prototype={convertRectToPath:function(){var t=this.p.v[0],e=this.p.v[1],n=this.s.v[0]/2,r=this.s.v[1]/2,i=bmMin(n,r,this.r.v),o=i*(1-roundCorner);this.v._length=0,2===this.d||1===this.d?(this.v.setTripleAt(t+n,e-r+i,t+n,e-r+i,t+n,e-r+o,0,!0),this.v.setTripleAt(t+n,e+r-i,t+n,e+r-o,t+n,e+r-i,1,!0),0!==i?(this.v.setTripleAt(t+n-i,e+r,t+n-i,e+r,t+n-o,e+r,2,!0),this.v.setTripleAt(t-n+i,e+r,t-n+o,e+r,t-n+i,e+r,3,!0),this.v.setTripleAt(t-n,e+r-i,t-n,e+r-i,t-n,e+r-o,4,!0),this.v.setTripleAt(t-n,e-r+i,t-n,e-r+o,t-n,e-r+i,5,!0),this.v.setTripleAt(t-n+i,e-r,t-n+i,e-r,t-n+o,e-r,6,!0),this.v.setTripleAt(t+n-i,e-r,t+n-o,e-r,t+n-i,e-r,7,!0)):(this.v.setTripleAt(t-n,e+r,t-n+o,e+r,t-n,e+r,2),this.v.setTripleAt(t-n,e-r,t-n,e-r+o,t-n,e-r,3))):(this.v.setTripleAt(t+n,e-r+i,t+n,e-r+o,t+n,e-r+i,0,!0),0!==i?(this.v.setTripleAt(t+n-i,e-r,t+n-i,e-r,t+n-o,e-r,1,!0),this.v.setTripleAt(t-n+i,e-r,t-n+o,e-r,t-n+i,e-r,2,!0),this.v.setTripleAt(t-n,e-r+i,t-n,e-r+i,t-n,e-r+o,3,!0),this.v.setTripleAt(t-n,e+r-i,t-n,e+r-o,t-n,e+r-i,4,!0),this.v.setTripleAt(t-n+i,e+r,t-n+i,e+r,t-n+o,e+r,5,!0),this.v.setTripleAt(t+n-i,e+r,t+n-o,e+r,t+n-i,e+r,6,!0),this.v.setTripleAt(t+n,e+r-i,t+n,e+r-i,t+n,e+r-o,7,!0)):(this.v.setTripleAt(t-n,e-r,t-n+o,e-r,t-n,e-r,1,!0),this.v.setTripleAt(t-n,e+r,t-n,e+r-o,t-n,e+r,2,!0),this.v.setTripleAt(t+n,e+r,t+n-o,e+r,t+n,e+r,3,!0)))},getValue:function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf&&this.convertRectToPath())},reset:r},extendPrototype([DynamicPropertyContainer],t),t}();function p(t,e,n){var r;if(3===n||4===n){var i=3===n?e.pt:e.ks,o=i.k;r=o.length?new c(t,e,n):new s(t,e,n)}else 5===n?r=new f(t,e):6===n?r=new l(t,e):7===n&&(r=new h(t,e));return r.k&&t.addDynamicProperty(r),r}function d(){return s}function m(){return c}var v={};return v.getShapeProp=p,v.getConstructorFunction=d,v.getKeyframedConstructorFunction=m,v}(),ShapeModifiers=function(){var t={},e={};function n(t,n){e[t]||(e[t]=n)}function r(t,n,r){return new e[t](n,r)}return t.registerModifier=n,t.getModifier=r,t}();function ShapeModifier(){}function TrimModifier(){}function RoundCornersModifier(){}function PuckerAndBloatModifier(){}function RepeaterModifier(){}function ShapeCollection(){this._length=0,this._maxLength=4,this.shapes=createSizedArray(this._maxLength)}function DashProperty(t,e,n,r){var i;this.elem=t,this.frameId=-1,this.dataProps=createSizedArray(e.length),this.renderer=n,this.k=!1,this.dashStr="",this.dashArray=createTypedArray("float32",e.length?e.length-1:0),this.dashoffset=createTypedArray("float32",1),this.initDynamicPropertyContainer(r);var o,a=e.length||0;for(i=0;i<a;i+=1)o=PropertyFactory.getProp(t,e[i].v,0,0,this),this.k=o.k||this.k,this.dataProps[i]={n:e[i].n,p:o};this.k||this.getValue(!0),this._isAnimated=this.k}function GradientProperty(t,e,n){this.data=e,this.c=createTypedArray("uint8c",4*e.p);var r=e.k.k[0].s?e.k.k[0].s.length-4*e.p:e.k.k.length-4*e.p;this.o=createTypedArray("float32",r),this._cmdf=!1,this._omdf=!1,this._collapsable=this.checkCollapsable(),this._hasOpacity=r,this.initDynamicPropertyContainer(n),this.prop=PropertyFactory.getProp(t,e.k,1,null,this),this.k=this.prop.k,this.getValue(!0)}ShapeModifier.prototype.initModifierProperties=function(){},ShapeModifier.prototype.addShapeToModifier=function(){},ShapeModifier.prototype.addShape=function(t){if(!this.closed){t.sh.container.addDynamicProperty(t.sh);var e={shape:t.sh,data:t,localShapeCollection:shapeCollectionPool.newShapeCollection()};this.shapes.push(e),this.addShapeToModifier(e),this._isAnimated&&t.setAsAnimated()}},ShapeModifier.prototype.init=function(t,e){this.shapes=[],this.elem=t,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e),this.frameId=initialDefaultFrame,this.closed=!1,this.k=!1,this.dynamicProperties.length?this.k=!0:this.getValue(!0)},ShapeModifier.prototype.processKeys=function(){this.elem.globalData.frameId!==this.frameId&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties())},extendPrototype([DynamicPropertyContainer],ShapeModifier),extendPrototype([ShapeModifier],TrimModifier),TrimModifier.prototype.initModifierProperties=function(t,e){this.s=PropertyFactory.getProp(t,e.s,0,.01,this),this.e=PropertyFactory.getProp(t,e.e,0,.01,this),this.o=PropertyFactory.getProp(t,e.o,0,0,this),this.sValue=0,this.eValue=0,this.getValue=this.processKeys,this.m=e.m,this._isAnimated=!!this.s.effectsSequence.length||!!this.e.effectsSequence.length||!!this.o.effectsSequence.length},TrimModifier.prototype.addShapeToModifier=function(t){t.pathsData=[]},TrimModifier.prototype.calculateShapeEdges=function(t,e,n,r,i){var o=[];e<=1?o.push({s:t,e:e}):t>=1?o.push({s:t-1,e:e-1}):(o.push({s:t,e:1}),o.push({s:0,e:e-1}));var a,s,u=[],c=o.length;for(a=0;a<c;a+=1){var l,h;if(s=o[a],!(s.e*i<r||s.s*i>r+n))l=s.s*i<=r?0:(s.s*i-r)/n,h=s.e*i>=r+n?1:(s.e*i-r)/n,u.push([l,h])}return u.length||u.push([0,0]),u},TrimModifier.prototype.releasePathsData=function(t){var e,n=t.length;for(e=0;e<n;e+=1)segmentsLengthPool.release(t[e]);return t.length=0,t},TrimModifier.prototype.processShapes=function(t){var e,n,r,i;if(this._mdf||t){var o=this.o.v%360/360;if(o<0&&(o+=1),e=this.s.v>1?1+o:this.s.v<0?0+o:this.s.v+o,n=this.e.v>1?1+o:this.e.v<0?0+o:this.e.v+o,e>n){var a=e;e=n,n=a}e=1e-4*Math.round(1e4*e),n=1e-4*Math.round(1e4*n),this.sValue=e,this.eValue=n}else e=this.sValue,n=this.eValue;var s,u,c,l,h,f=this.shapes.length,p=0;if(n===e)for(i=0;i<f;i+=1)this.shapes[i].localShapeCollection.releaseShapes(),this.shapes[i].shape._mdf=!0,this.shapes[i].shape.paths=this.shapes[i].localShapeCollection,this._mdf&&(this.shapes[i].pathsData.length=0);else if(1===n&&0===e||0===n&&1===e){if(this._mdf)for(i=0;i<f;i+=1)this.shapes[i].pathsData.length=0,this.shapes[i].shape._mdf=!0}else{var d,m,v=[];for(i=0;i<f;i+=1)if(d=this.shapes[i],d.shape._mdf||this._mdf||t||2===this.m){if(r=d.shape.paths,u=r._length,h=0,!d.shape._mdf&&d.pathsData.length)h=d.totalShapeLength;else{for(c=this.releasePathsData(d.pathsData),s=0;s<u;s+=1)l=bez.getSegmentsLength(r.shapes[s]),c.push(l),h+=l.totalLength;d.totalShapeLength=h,d.pathsData=c}p+=h,d.shape._mdf=!0}else d.shape.paths=d.localShapeCollection;var g,y=e,b=n,x=0;for(i=f-1;i>=0;i-=1)if(d=this.shapes[i],d.shape._mdf){for(m=d.localShapeCollection,m.releaseShapes(),2===this.m&&f>1?(g=this.calculateShapeEdges(e,n,d.totalShapeLength,x,p),x+=d.totalShapeLength):g=[[y,b]],u=g.length,s=0;s<u;s+=1){y=g[s][0],b=g[s][1],v.length=0,b<=1?v.push({s:d.totalShapeLength*y,e:d.totalShapeLength*b}):y>=1?v.push({s:d.totalShapeLength*(y-1),e:d.totalShapeLength*(b-1)}):(v.push({s:d.totalShapeLength*y,e:d.totalShapeLength}),v.push({s:0,e:d.totalShapeLength*(b-1)}));var w=this.addShapes(d,v[0]);if(v[0].s!==v[0].e){if(v.length>1){var E=d.shape.paths.shapes[d.shape.paths._length-1];if(E.c){var _=w.pop();this.addPaths(w,m),w=this.addShapes(d,v[1],_)}else this.addPaths(w,m),w=this.addShapes(d,v[1])}this.addPaths(w,m)}}d.shape.paths=m}}},TrimModifier.prototype.addPaths=function(t,e){var n,r=t.length;for(n=0;n<r;n+=1)e.addShape(t[n])},TrimModifier.prototype.addSegment=function(t,e,n,r,i,o,a){i.setXYAt(e[0],e[1],"o",o),i.setXYAt(n[0],n[1],"i",o+1),a&&i.setXYAt(t[0],t[1],"v",o),i.setXYAt(r[0],r[1],"v",o+1)},TrimModifier.prototype.addSegmentFromArray=function(t,e,n,r){e.setXYAt(t[1],t[5],"o",n),e.setXYAt(t[2],t[6],"i",n+1),r&&e.setXYAt(t[0],t[4],"v",n),e.setXYAt(t[3],t[7],"v",n+1)},TrimModifier.prototype.addShapes=function(t,e,n){var r,i,o,a,s,u,c,l,h=t.pathsData,f=t.shape.paths.shapes,p=t.shape.paths._length,d=0,m=[],v=!0;for(n?(s=n._length,l=n._length):(n=shapePool.newElement(),s=0,l=0),m.push(n),r=0;r<p;r+=1){for(u=h[r].lengths,n.c=f[r].c,o=f[r].c?u.length:u.length+1,i=1;i<o;i+=1)if(a=u[i-1],d+a.addedLength<e.s)d+=a.addedLength,n.c=!1;else{if(d>e.e){n.c=!1;break}e.s<=d&&e.e>=d+a.addedLength?(this.addSegment(f[r].v[i-1],f[r].o[i-1],f[r].i[i],f[r].v[i],n,s,v),v=!1):(c=bez.getNewSegment(f[r].v[i-1],f[r].v[i],f[r].o[i-1],f[r].i[i],(e.s-d)/a.addedLength,(e.e-d)/a.addedLength,u[i-1]),this.addSegmentFromArray(c,n,s,v),v=!1,n.c=!1),d+=a.addedLength,s+=1}if(f[r].c&&u.length){if(a=u[i-1],d<=e.e){var g=u[i-1].addedLength;e.s<=d&&e.e>=d+g?(this.addSegment(f[r].v[i-1],f[r].o[i-1],f[r].i[0],f[r].v[0],n,s,v),v=!1):(c=bez.getNewSegment(f[r].v[i-1],f[r].v[0],f[r].o[i-1],f[r].i[0],(e.s-d)/g,(e.e-d)/g,u[i-1]),this.addSegmentFromArray(c,n,s,v),v=!1,n.c=!1)}else n.c=!1;d+=a.addedLength,s+=1}if(n._length&&(n.setXYAt(n.v[l][0],n.v[l][1],"i",l),n.setXYAt(n.v[n._length-1][0],n.v[n._length-1][1],"o",n._length-1)),d>e.e)break;r<p-1&&(n=shapePool.newElement(),v=!0,m.push(n),s=0)}return m},ShapeModifiers.registerModifier("tm",TrimModifier),extendPrototype([ShapeModifier],RoundCornersModifier),RoundCornersModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.rd=PropertyFactory.getProp(t,e.r,0,null,this),this._isAnimated=!!this.rd.effectsSequence.length},RoundCornersModifier.prototype.processPath=function(t,e){var n,r=shapePool.newElement();r.c=t.c;var i,o,a,s,u,c,l,h,f,p,d,m,v=t._length,g=0;for(n=0;n<v;n+=1)i=t.v[n],a=t.o[n],o=t.i[n],i[0]===a[0]&&i[1]===a[1]&&i[0]===o[0]&&i[1]===o[1]?0!==n&&n!==v-1||t.c?(s=0===n?t.v[v-1]:t.v[n-1],u=Math.sqrt(Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)),c=u?Math.min(u/2,e)/u:0,d=i[0]+(s[0]-i[0])*c,l=d,m=i[1]-(i[1]-s[1])*c,h=m,f=l-(l-i[0])*roundCorner,p=h-(h-i[1])*roundCorner,r.setTripleAt(l,h,f,p,d,m,g),g+=1,s=n===v-1?t.v[0]:t.v[n+1],u=Math.sqrt(Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)),c=u?Math.min(u/2,e)/u:0,f=i[0]+(s[0]-i[0])*c,l=f,p=i[1]+(s[1]-i[1])*c,h=p,d=l-(l-i[0])*roundCorner,m=h-(h-i[1])*roundCorner,r.setTripleAt(l,h,f,p,d,m,g),g+=1):(r.setTripleAt(i[0],i[1],a[0],a[1],o[0],o[1],g),g+=1):(r.setTripleAt(t.v[n][0],t.v[n][1],t.o[n][0],t.o[n][1],t.i[n][0],t.i[n][1],g),g+=1);return r},RoundCornersModifier.prototype.processShapes=function(t){var e,n,r,i,o,a,s=this.shapes.length,u=this.rd.v;if(0!==u)for(n=0;n<s;n+=1){if(o=this.shapes[n],a=o.localShapeCollection,o.shape._mdf||this._mdf||t)for(a.releaseShapes(),o.shape._mdf=!0,e=o.shape.paths.shapes,i=o.shape.paths._length,r=0;r<i;r+=1)a.addShape(this.processPath(e[r],u));o.shape.paths=o.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},ShapeModifiers.registerModifier("rd",RoundCornersModifier),extendPrototype([ShapeModifier],PuckerAndBloatModifier),PuckerAndBloatModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.amount=PropertyFactory.getProp(t,e.a,0,null,this),this._isAnimated=!!this.amount.effectsSequence.length},PuckerAndBloatModifier.prototype.processPath=function(t,e){var n=e/100,r=[0,0],i=t._length,o=0;for(o=0;o<i;o+=1)r[0]+=t.v[o][0],r[1]+=t.v[o][1];r[0]/=i,r[1]/=i;var a,s,u,c,l,h,f=shapePool.newElement();for(f.c=t.c,o=0;o<i;o+=1)a=t.v[o][0]+(r[0]-t.v[o][0])*n,s=t.v[o][1]+(r[1]-t.v[o][1])*n,u=t.o[o][0]+(r[0]-t.o[o][0])*-n,c=t.o[o][1]+(r[1]-t.o[o][1])*-n,l=t.i[o][0]+(r[0]-t.i[o][0])*-n,h=t.i[o][1]+(r[1]-t.i[o][1])*-n,f.setTripleAt(a,s,u,c,l,h,o);return f},PuckerAndBloatModifier.prototype.processShapes=function(t){var e,n,r,i,o,a,s=this.shapes.length,u=this.amount.v;if(0!==u)for(n=0;n<s;n+=1){if(o=this.shapes[n],a=o.localShapeCollection,o.shape._mdf||this._mdf||t)for(a.releaseShapes(),o.shape._mdf=!0,e=o.shape.paths.shapes,i=o.shape.paths._length,r=0;r<i;r+=1)a.addShape(this.processPath(e[r],u));o.shape.paths=o.localShapeCollection}this.dynamicProperties.length||(this._mdf=!1)},ShapeModifiers.registerModifier("pb",PuckerAndBloatModifier),extendPrototype([ShapeModifier],RepeaterModifier),RepeaterModifier.prototype.initModifierProperties=function(t,e){this.getValue=this.processKeys,this.c=PropertyFactory.getProp(t,e.c,0,null,this),this.o=PropertyFactory.getProp(t,e.o,0,null,this),this.tr=TransformPropertyFactory.getTransformProperty(t,e.tr,this),this.so=PropertyFactory.getProp(t,e.tr.so,0,.01,this),this.eo=PropertyFactory.getProp(t,e.tr.eo,0,.01,this),this.data=e,this.dynamicProperties.length||this.getValue(!0),this._isAnimated=!!this.dynamicProperties.length,this.pMatrix=new Matrix,this.rMatrix=new Matrix,this.sMatrix=new Matrix,this.tMatrix=new Matrix,this.matrix=new Matrix},RepeaterModifier.prototype.applyTransforms=function(t,e,n,r,i,o){var a=o?-1:1,s=r.s.v[0]+(1-r.s.v[0])*(1-i),u=r.s.v[1]+(1-r.s.v[1])*(1-i);t.translate(r.p.v[0]*a*i,r.p.v[1]*a*i,r.p.v[2]),e.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),e.rotate(-r.r.v*a*i),e.translate(r.a.v[0],r.a.v[1],r.a.v[2]),n.translate(-r.a.v[0],-r.a.v[1],r.a.v[2]),n.scale(o?1/s:s,o?1/u:u),n.translate(r.a.v[0],r.a.v[1],r.a.v[2])},RepeaterModifier.prototype.init=function(t,e,n,r){this.elem=t,this.arr=e,this.pos=n,this.elemsData=r,this._currentCopies=0,this._elements=[],this._groups=[],this.frameId=-1,this.initDynamicPropertyContainer(t),this.initModifierProperties(t,e[n]);while(n>0)n-=1,this._elements.unshift(e[n]);this.dynamicProperties.length?this.k=!0:this.getValue(!0)},RepeaterModifier.prototype.resetElements=function(t){var e,n=t.length;for(e=0;e<n;e+=1)t[e]._processed=!1,"gr"===t[e].ty&&this.resetElements(t[e].it)},RepeaterModifier.prototype.cloneElements=function(t){var e=JSON.parse(JSON.stringify(t));return this.resetElements(e),e},RepeaterModifier.prototype.changeGroupRender=function(t,e){var n,r=t.length;for(n=0;n<r;n+=1)t[n]._render=e,"gr"===t[n].ty&&this.changeGroupRender(t[n].it,e)},RepeaterModifier.prototype.processShapes=function(t){var e,n,r,i,o,a=!1;if(this._mdf||t){var s,u=Math.ceil(this.c.v);if(this._groups.length<u){while(this._groups.length<u){var c={it:this.cloneElements(this._elements),ty:"gr"};c.it.push({a:{a:0,ix:1,k:[0,0]},nm:"Transform",o:{a:0,ix:7,k:100},p:{a:0,ix:2,k:[0,0]},r:{a:1,ix:6,k:[{s:0,e:0,t:0},{s:0,e:0,t:1}]},s:{a:0,ix:3,k:[100,100]},sa:{a:0,ix:5,k:0},sk:{a:0,ix:4,k:0},ty:"tr"}),this.arr.splice(0,0,c),this._groups.splice(0,0,c),this._currentCopies+=1}this.elem.reloadShapes(),a=!0}for(o=0,r=0;r<=this._groups.length-1;r+=1){if(s=o<u,this._groups[r]._render=s,this.changeGroupRender(this._groups[r].it,s),!s){var l=this.elemsData[r].it,h=l[l.length-1];0!==h.transform.op.v?(h.transform.op._mdf=!0,h.transform.op.v=0):h.transform.op._mdf=!1}o+=1}this._currentCopies=u;var f=this.o.v,p=f%1,d=f>0?Math.floor(f):Math.ceil(f),m=this.pMatrix.props,v=this.rMatrix.props,g=this.sMatrix.props;this.pMatrix.reset(),this.rMatrix.reset(),this.sMatrix.reset(),this.tMatrix.reset(),this.matrix.reset();var y,b,x=0;if(f>0){while(x<d)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),x+=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,p,!1),x+=p)}else if(f<0){while(x>d)this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!0),x-=1;p&&(this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,-p,!0),x-=p)}r=1===this.data.m?0:this._currentCopies-1,i=1===this.data.m?1:-1,o=this._currentCopies;while(o){if(e=this.elemsData[r].it,n=e[e.length-1].transform.mProps.v.props,b=n.length,e[e.length-1].transform.mProps._mdf=!0,e[e.length-1].transform.op._mdf=!0,e[e.length-1].transform.op.v=1===this._currentCopies?this.so.v:this.so.v+(this.eo.v-this.so.v)*(r/(this._currentCopies-1)),0!==x){for((0!==r&&1===i||r!==this._currentCopies-1&&-1===i)&&this.applyTransforms(this.pMatrix,this.rMatrix,this.sMatrix,this.tr,1,!1),this.matrix.transform(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]),this.matrix.transform(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],g[8],g[9],g[10],g[11],g[12],g[13],g[14],g[15]),this.matrix.transform(m[0],m[1],m[2],m[3],m[4],m[5],m[6],m[7],m[8],m[9],m[10],m[11],m[12],m[13],m[14],m[15]),y=0;y<b;y+=1)n[y]=this.matrix.props[y];this.matrix.reset()}else for(this.matrix.reset(),y=0;y<b;y+=1)n[y]=this.matrix.props[y];x+=1,o-=1,r+=i}}else{o=this._currentCopies,r=0,i=1;while(o)e=this.elemsData[r].it,n=e[e.length-1].transform.mProps.v.props,e[e.length-1].transform.mProps._mdf=!1,e[e.length-1].transform.op._mdf=!1,o-=1,r+=i}return a},RepeaterModifier.prototype.addShape=function(){},ShapeModifiers.registerModifier("rp",RepeaterModifier),ShapeCollection.prototype.addShape=function(t){this._length===this._maxLength&&(this.shapes=this.shapes.concat(createSizedArray(this._maxLength)),this._maxLength*=2),this.shapes[this._length]=t,this._length+=1},ShapeCollection.prototype.releaseShapes=function(){var t;for(t=0;t<this._length;t+=1)shapePool.release(this.shapes[t]);this._length=0},DashProperty.prototype.getValue=function(t){if((this.elem.globalData.frameId!==this.frameId||t)&&(this.frameId=this.elem.globalData.frameId,this.iterateDynamicProperties(),this._mdf=this._mdf||t,this._mdf)){var e=0,n=this.dataProps.length;for("svg"===this.renderer&&(this.dashStr=""),e=0;e<n;e+=1)"o"!==this.dataProps[e].n?"svg"===this.renderer?this.dashStr+=" "+this.dataProps[e].p.v:this.dashArray[e]=this.dataProps[e].p.v:this.dashoffset[0]=this.dataProps[e].p.v}},extendPrototype([DynamicPropertyContainer],DashProperty),GradientProperty.prototype.comparePoints=function(t,e){var n,r=0,i=this.o.length/2;while(r<i){if(n=Math.abs(t[4*r]-t[4*e+2*r]),n>.01)return!1;r+=1}return!0},GradientProperty.prototype.checkCollapsable=function(){if(this.o.length/2!==this.c.length/4)return!1;if(this.data.k.k[0].s){var t=0,e=this.data.k.k.length;while(t<e){if(!this.comparePoints(this.data.k.k[t].s,this.data.p))return!1;t+=1}}else if(!this.comparePoints(this.data.k.k,this.data.p))return!1;return!0},GradientProperty.prototype.getValue=function(t){if(this.prop.getValue(),this._mdf=!1,this._cmdf=!1,this._omdf=!1,this.prop._mdf||t){var e,n,r,i=4*this.data.p;for(e=0;e<i;e+=1)n=e%4===0?100:255,r=Math.round(this.prop.v[e]*n),this.c[e]!==r&&(this.c[e]=r,this._cmdf=!t);if(this.o.length)for(i=this.prop.v.length,e=4*this.data.p;e<i;e+=1)n=e%2===0?100:1,r=e%2===0?Math.round(100*this.prop.v[e]):this.prop.v[e],this.o[e-4*this.data.p]!==r&&(this.o[e-4*this.data.p]=r,this._omdf=!t);this._mdf=!t}},extendPrototype([DynamicPropertyContainer],GradientProperty);var buildShapeString=function(t,e,n,r){if(0===e)return"";var i,o=t.o,a=t.i,s=t.v,u=" M"+r.applyToPointStringified(s[0][0],s[0][1]);for(i=1;i<e;i+=1)u+=" C"+r.applyToPointStringified(o[i-1][0],o[i-1][1])+" "+r.applyToPointStringified(a[i][0],a[i][1])+" "+r.applyToPointStringified(s[i][0],s[i][1]);return n&&e&&(u+=" C"+r.applyToPointStringified(o[i-1][0],o[i-1][1])+" "+r.applyToPointStringified(a[0][0],a[0][1])+" "+r.applyToPointStringified(s[0][0],s[0][1]),u+="z"),u},audioControllerFactory=function(){function t(t){this.audios=[],this.audioFactory=t,this._volume=1,this._isMuted=!1}return t.prototype={addAudio:function(t){this.audios.push(t)},pause:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].pause()},resume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].resume()},setRate:function(t){var e,n=this.audios.length;for(e=0;e<n;e+=1)this.audios[e].setRate(t)},createAudio:function(t){return this.audioFactory?this.audioFactory(t):Howl?new Howl({src:[t]}):{isPlaying:!1,play:function(){this.isPlaying=!0},seek:function(){this.isPlaying=!1},playing:function(){},rate:function(){},setVolume:function(){}}},setAudioFactory:function(t){this.audioFactory=t},setVolume:function(t){this._volume=t,this._updateVolume()},mute:function(){this._isMuted=!0,this._updateVolume()},unmute:function(){this._isMuted=!1,this._updateVolume()},getVolume:function(){return this._volume},_updateVolume:function(){var t,e=this.audios.length;for(t=0;t<e;t+=1)this.audios[t].volume(this._volume*(this._isMuted?0:1))}},function(){return new t}}(),ImagePreloader=function(){var t=function(){var t=createTag("canvas");t.width=1,t.height=1;var e=t.getContext("2d");return e.fillStyle="rgba(0,0,0,0)",e.fillRect(0,0,1,1),t}();function e(){this.loadedAssets+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function n(){this.loadedFootagesCount+=1,this.loadedAssets===this.totalImages&&this.loadedFootagesCount===this.totalFootages&&this.imagesLoadedCb&&this.imagesLoadedCb(null)}function r(t,e,n){var r="";if(t.e)r=t.p;else if(e){var i=t.p;-1!==i.indexOf("images/")&&(i=i.split("/")[1]),r=e+i}else r=n,r+=t.u?t.u:"",r+=t.p;return r}function i(t){var e=0,n=setInterval(function(){var r=t.getBBox();(r.width||e>500)&&(this._imageLoaded(),clearInterval(n)),e+=1}.bind(this),50)}function o(e){var n=r(e,this.assetsPath,this.path),i=createNS("image");isSafari?this.testImageLoaded(i):i.addEventListener("load",this._imageLoaded,!1),i.addEventListener("error",function(){o.img=t,this._imageLoaded()}.bind(this),!1),i.setAttributeNS("http://www.w3.org/1999/xlink","href",n),this._elementHelper.append?this._elementHelper.append(i):this._elementHelper.appendChild(i);var o={img:i,assetData:e};return o}function a(e){var n=r(e,this.assetsPath,this.path),i=createTag("img");i.crossOrigin="anonymous",i.addEventListener("load",this._imageLoaded,!1),i.addEventListener("error",function(){o.img=t,this._imageLoaded()}.bind(this),!1),i.src=n;var o={img:i,assetData:e};return o}function s(t){var e={assetData:t},n=r(t,this.assetsPath,this.path);return assetLoader.load(n,function(t){e.img=t,this._footageLoaded()}.bind(this),function(){e.img={},this._footageLoaded()}.bind(this)),e}function u(t,e){var n;this.imagesLoadedCb=e;var r=t.length;for(n=0;n<r;n+=1)t[n].layers||(t[n].t&&"seq"!==t[n].t?3===t[n].t&&(this.totalFootages+=1,this.images.push(this.createFootageData(t[n]))):(this.totalImages+=1,this.images.push(this._createImageData(t[n]))))}function c(t){this.path=t||""}function l(t){this.assetsPath=t||""}function h(t){var e=0,n=this.images.length;while(e<n){if(this.images[e].assetData===t)return this.images[e].img;e+=1}return null}function f(){this.imagesLoadedCb=null,this.images.length=0}function p(){return this.totalImages===this.loadedAssets}function d(){return this.totalFootages===this.loadedFootagesCount}function m(t,e){"svg"===t?(this._elementHelper=e,this._createImageData=this.createImageData.bind(this)):this._createImageData=this.createImgData.bind(this)}function v(){this._imageLoaded=e.bind(this),this._footageLoaded=n.bind(this),this.testImageLoaded=i.bind(this),this.createFootageData=s.bind(this),this.assetsPath="",this.path="",this.totalImages=0,this.totalFootages=0,this.loadedAssets=0,this.loadedFootagesCount=0,this.imagesLoadedCb=null,this.images=[]}return v.prototype={loadAssets:u,setAssetsPath:l,setPath:c,loadedImages:p,loadedFootages:d,destroy:f,getAsset:h,createImgData:a,createImageData:o,imageLoaded:e,footageLoaded:n,setCacheType:m},v}(),featureSupport=function(){var t={maskType:!0};return(/MSIE 10/i.test(navigator.userAgent)||/MSIE 9/i.test(navigator.userAgent)||/rv:11.0/i.test(navigator.userAgent)||/Edge\/\d./i.test(navigator.userAgent))&&(t.maskType=!1),t}(),filtersFactory=function(){var t={};function e(t,e){var n=createNS("filter");return n.setAttribute("id",t),!0!==e&&(n.setAttribute("filterUnits","objectBoundingBox"),n.setAttribute("x","0%"),n.setAttribute("y","0%"),n.setAttribute("width","100%"),n.setAttribute("height","100%")),n}function n(){var t=createNS("feColorMatrix");return t.setAttribute("type","matrix"),t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("values","0 0 0 1 0  0 0 0 1 0  0 0 0 1 0  0 0 0 1 1"),t}return t.createFilter=e,t.createAlphaToLuminanceFilter=n,t}(),assetLoader=function(){function t(t){return t.response&&"object"===typeof t.response?t.response:t.response&&"string"===typeof t.response?JSON.parse(t.response):t.responseText?JSON.parse(t.responseText):null}function e(e,n,r){var i,o=new XMLHttpRequest;try{o.responseType="json"}catch(a){}o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status)i=t(o),n(i);else try{i=t(o),n(i)}catch(a){r&&r(a)}},o.open("GET",e,!0),o.send()}return{load:e}}();function TextAnimatorProperty(t,e,n){this._isFirstFrame=!0,this._hasMaskedPath=!1,this._frameId=-1,this._textData=t,this._renderType=e,this._elem=n,this._animatorsData=createSizedArray(this._textData.a.length),this._pathData={},this._moreOptions={alignment:{}},this.renderedLetters=[],this.lettersChangedFlag=!1,this.initDynamicPropertyContainer(n)}function TextAnimatorDataProperty(t,e,n){var r={propType:!1},i=PropertyFactory.getProp,o=e.a;this.a={r:o.r?i(t,o.r,0,degToRads,n):r,rx:o.rx?i(t,o.rx,0,degToRads,n):r,ry:o.ry?i(t,o.ry,0,degToRads,n):r,sk:o.sk?i(t,o.sk,0,degToRads,n):r,sa:o.sa?i(t,o.sa,0,degToRads,n):r,s:o.s?i(t,o.s,1,.01,n):r,a:o.a?i(t,o.a,1,0,n):r,o:o.o?i(t,o.o,0,.01,n):r,p:o.p?i(t,o.p,1,0,n):r,sw:o.sw?i(t,o.sw,0,0,n):r,sc:o.sc?i(t,o.sc,1,0,n):r,fc:o.fc?i(t,o.fc,1,0,n):r,fh:o.fh?i(t,o.fh,0,0,n):r,fs:o.fs?i(t,o.fs,0,.01,n):r,fb:o.fb?i(t,o.fb,0,.01,n):r,t:o.t?i(t,o.t,0,0,n):r},this.s=TextSelectorProp.getTextSelectorProp(t,e.s,n),this.s.t=e.s.t}function LetterProps(t,e,n,r,i,o){this.o=t,this.sw=e,this.sc=n,this.fc=r,this.m=i,this.p=o,this._mdf={o:!0,sw:!!e,sc:!!n,fc:!!r,m:!0,p:!0}}function TextProperty(t,e){this._frameId=initialDefaultFrame,this.pv="",this.v="",this.kf=!1,this._isFirstFrame=!0,this._mdf=!1,this.data=e,this.elem=t,this.comp=this.elem.comp,this.keysIndex=0,this.canResize=!1,this.minimumFontSize=1,this.effectsSequence=[],this.currentData={ascent:0,boxWidth:this.defaultBoxWidth,f:"",fStyle:"",fWeight:"",fc:"",j:"",justifyOffset:"",l:[],lh:0,lineWidths:[],ls:"",of:"",s:"",sc:"",sw:0,t:0,tr:0,sz:0,ps:null,fillColorAnim:!1,strokeColorAnim:!1,strokeWidthAnim:!1,yOffset:0,finalSize:0,finalText:[],finalLineHeight:0,__complete:!1},this.copyData(this.currentData,this.data.d.k[0].s),this.searchProperty()||this.completeTextData(this.currentData)}TextAnimatorProperty.prototype.searchProperties=function(){var t,e,n=this._textData.a.length,r=PropertyFactory.getProp;for(t=0;t<n;t+=1)e=this._textData.a[t],this._animatorsData[t]=new TextAnimatorDataProperty(this._elem,e,this);this._textData.p&&"m"in this._textData.p?(this._pathData={f:r(this._elem,this._textData.p.f,0,0,this),l:r(this._elem,this._textData.p.l,0,0,this),r:this._textData.p.r,m:this._elem.maskManager.getMaskProperty(this._textData.p.m)},this._hasMaskedPath=!0):this._hasMaskedPath=!1,this._moreOptions.alignment=r(this._elem,this._textData.m.a,1,0,this)},TextAnimatorProperty.prototype.getMeasures=function(t,e){if(this.lettersChangedFlag=e,this._mdf||this._isFirstFrame||e||this._hasMaskedPath&&this._pathData.m._mdf){this._isFirstFrame=!1;var n,r,i,o,a,s,u,c,l,h,f,p,d,m,v,g,y,b,x,w=this._moreOptions.alignment.v,E=this._animatorsData,_=this._textData,C=this.mHelper,S=this._renderType,A=this.renderedLetters.length,k=t.l;if(this._hasMaskedPath){if(x=this._pathData.m,!this._pathData.n||this._pathData._mdf){var T,I=x.v;for(this._pathData.r&&(I=I.reverse()),a={tLength:0,segments:[]},o=I._length-1,g=0,i=0;i<o;i+=1)T=bez.buildBezierData(I.v[i],I.v[i+1],[I.o[i][0]-I.v[i][0],I.o[i][1]-I.v[i][1]],[I.i[i+1][0]-I.v[i+1][0],I.i[i+1][1]-I.v[i+1][1]]),a.tLength+=T.segmentLength,a.segments.push(T),g+=T.segmentLength;i=o,x.v.c&&(T=bez.buildBezierData(I.v[i],I.v[0],[I.o[i][0]-I.v[i][0],I.o[i][1]-I.v[i][1]],[I.i[0][0]-I.v[0][0],I.i[0][1]-I.v[0][1]]),a.tLength+=T.segmentLength,a.segments.push(T),g+=T.segmentLength),this._pathData.pi=a}if(a=this._pathData.pi,s=this._pathData.f.v,f=0,h=1,c=0,l=!0,m=a.segments,s<0&&x.v.c){a.tLength<Math.abs(s)&&(s=-Math.abs(s)%a.tLength),f=m.length-1,d=m[f].points,h=d.length-1;while(s<0)s+=d[h].partialLength,h-=1,h<0&&(f-=1,d=m[f].points,h=d.length-1)}d=m[f].points,p=d[h-1],u=d[h],v=u.partialLength}o=k.length,n=0,r=0;var P,D,R,M,F,O,N=1.2*t.finalSize*.714,L=!0;M=E.length;var B,V,z,j,W,G,H,U,q,$,K,X,Y=-1,J=s,Q=f,Z=h,tt=-1,et="",nt=this.defaultPropsArray;if(2===t.j||1===t.j){var rt=0,it=0,ot=2===t.j?-.5:-1,at=0,st=!0;for(i=0;i<o;i+=1)if(k[i].n){rt&&(rt+=it);while(at<i)k[at].animatorJustifyOffset=rt,at+=1;rt=0,st=!0}else{for(R=0;R<M;R+=1)P=E[R].a,P.t.propType&&(st&&2===t.j&&(it+=P.t.v*ot),D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),O.length?rt+=P.t.v*O[0]*ot:rt+=P.t.v*O*ot);st=!1}rt&&(rt+=it);while(at<i)k[at].animatorJustifyOffset=rt,at+=1}for(i=0;i<o;i+=1){if(C.reset(),j=1,k[i].n)n=0,r+=t.yOffset,r+=L?1:0,s=J,L=!1,this._hasMaskedPath&&(f=Q,h=Z,d=m[f].points,p=d[h-1],u=d[h],v=u.partialLength,c=0),et="",K="",q="",X="",nt=this.defaultPropsArray;else{if(this._hasMaskedPath){if(tt!==k[i].line){switch(t.j){case 1:s+=g-t.lineWidths[k[i].line];break;case 2:s+=(g-t.lineWidths[k[i].line])/2;break;default:break}tt=k[i].line}Y!==k[i].ind&&(k[Y]&&(s+=k[Y].extra),s+=k[i].an/2,Y=k[i].ind),s+=w[0]*k[i].an*.005;var ut=0;for(R=0;R<M;R+=1)P=E[R].a,P.p.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),O.length?ut+=P.p.v[0]*O[0]:ut+=P.p.v[0]*O),P.a.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),O.length?ut+=P.a.v[0]*O[0]:ut+=P.a.v[0]*O);l=!0;while(l)c+v>=s+ut||!d?(y=(s+ut-c)/u.partialLength,V=p.point[0]+(u.point[0]-p.point[0])*y,z=p.point[1]+(u.point[1]-p.point[1])*y,C.translate(-w[0]*k[i].an*.005,-w[1]*N*.01),l=!1):d&&(c+=u.partialLength,h+=1,h>=d.length&&(h=0,f+=1,m[f]?d=m[f].points:x.v.c?(h=0,f=0,d=m[f].points):(c-=u.partialLength,d=null)),d&&(p=u,u=d[h],v=u.partialLength));B=k[i].an/2-k[i].add,C.translate(-B,0,0)}else B=k[i].an/2-k[i].add,C.translate(-B,0,0),C.translate(-w[0]*k[i].an*.005,-w[1]*N*.01,0);for(R=0;R<M;R+=1)P=E[R].a,P.t.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),0===n&&0===t.j||(this._hasMaskedPath?O.length?s+=P.t.v*O[0]:s+=P.t.v*O:O.length?n+=P.t.v*O[0]:n+=P.t.v*O));for(t.strokeWidthAnim&&(G=t.sw||0),t.strokeColorAnim&&(W=t.sc?[t.sc[0],t.sc[1],t.sc[2]]:[0,0,0]),t.fillColorAnim&&t.fc&&(H=[t.fc[0],t.fc[1],t.fc[2]]),R=0;R<M;R+=1)P=E[R].a,P.a.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),O.length?C.translate(-P.a.v[0]*O[0],-P.a.v[1]*O[1],P.a.v[2]*O[2]):C.translate(-P.a.v[0]*O,-P.a.v[1]*O,P.a.v[2]*O));for(R=0;R<M;R+=1)P=E[R].a,P.s.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),O.length?C.scale(1+(P.s.v[0]-1)*O[0],1+(P.s.v[1]-1)*O[1],1):C.scale(1+(P.s.v[0]-1)*O,1+(P.s.v[1]-1)*O,1));for(R=0;R<M;R+=1){if(P=E[R].a,D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),P.sk.propType&&(O.length?C.skewFromAxis(-P.sk.v*O[0],P.sa.v*O[1]):C.skewFromAxis(-P.sk.v*O,P.sa.v*O)),P.r.propType&&(O.length?C.rotateZ(-P.r.v*O[2]):C.rotateZ(-P.r.v*O)),P.ry.propType&&(O.length?C.rotateY(P.ry.v*O[1]):C.rotateY(P.ry.v*O)),P.rx.propType&&(O.length?C.rotateX(P.rx.v*O[0]):C.rotateX(P.rx.v*O)),P.o.propType&&(O.length?j+=(P.o.v*O[0]-j)*O[0]:j+=(P.o.v*O-j)*O),t.strokeWidthAnim&&P.sw.propType&&(O.length?G+=P.sw.v*O[0]:G+=P.sw.v*O),t.strokeColorAnim&&P.sc.propType)for(U=0;U<3;U+=1)O.length?W[U]+=(P.sc.v[U]-W[U])*O[0]:W[U]+=(P.sc.v[U]-W[U])*O;if(t.fillColorAnim&&t.fc){if(P.fc.propType)for(U=0;U<3;U+=1)O.length?H[U]+=(P.fc.v[U]-H[U])*O[0]:H[U]+=(P.fc.v[U]-H[U])*O;P.fh.propType&&(H=O.length?addHueToRGB(H,P.fh.v*O[0]):addHueToRGB(H,P.fh.v*O)),P.fs.propType&&(H=O.length?addSaturationToRGB(H,P.fs.v*O[0]):addSaturationToRGB(H,P.fs.v*O)),P.fb.propType&&(H=O.length?addBrightnessToRGB(H,P.fb.v*O[0]):addBrightnessToRGB(H,P.fb.v*O))}}for(R=0;R<M;R+=1)P=E[R].a,P.p.propType&&(D=E[R].s,O=D.getMult(k[i].anIndexes[R],_.a[R].s.totalChars),this._hasMaskedPath?O.length?C.translate(0,P.p.v[1]*O[0],-P.p.v[2]*O[1]):C.translate(0,P.p.v[1]*O,-P.p.v[2]*O):O.length?C.translate(P.p.v[0]*O[0],P.p.v[1]*O[1],-P.p.v[2]*O[2]):C.translate(P.p.v[0]*O,P.p.v[1]*O,-P.p.v[2]*O));if(t.strokeWidthAnim&&(q=G<0?0:G),t.strokeColorAnim&&($="rgb("+Math.round(255*W[0])+","+Math.round(255*W[1])+","+Math.round(255*W[2])+")"),t.fillColorAnim&&t.fc&&(K="rgb("+Math.round(255*H[0])+","+Math.round(255*H[1])+","+Math.round(255*H[2])+")"),this._hasMaskedPath){if(C.translate(0,-t.ls),C.translate(0,w[1]*N*.01+r,0),_.p.p){b=(u.point[1]-p.point[1])/(u.point[0]-p.point[0]);var ct=180*Math.atan(b)/Math.PI;u.point[0]<p.point[0]&&(ct+=180),C.rotate(-ct*Math.PI/180)}C.translate(V,z,0),s-=w[0]*k[i].an*.005,k[i+1]&&Y!==k[i+1].ind&&(s+=k[i].an/2,s+=.001*t.tr*t.finalSize)}else{switch(C.translate(n,r,0),t.ps&&C.translate(t.ps[0],t.ps[1]+t.ascent,0),t.j){case 1:C.translate(k[i].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[k[i].line]),0,0);break;case 2:C.translate(k[i].animatorJustifyOffset+t.justifyOffset+(t.boxWidth-t.lineWidths[k[i].line])/2,0,0);break;default:break}C.translate(0,-t.ls),C.translate(B,0,0),C.translate(w[0]*k[i].an*.005,w[1]*N*.01,0),n+=k[i].l+.001*t.tr*t.finalSize}"html"===S?et=C.toCSS():"svg"===S?et=C.to2dCSS():nt=[C.props[0],C.props[1],C.props[2],C.props[3],C.props[4],C.props[5],C.props[6],C.props[7],C.props[8],C.props[9],C.props[10],C.props[11],C.props[12],C.props[13],C.props[14],C.props[15]],X=j}A<=i?(F=new LetterProps(X,q,$,K,et,nt),this.renderedLetters.push(F),A+=1,this.lettersChangedFlag=!0):(F=this.renderedLetters[i],this.lettersChangedFlag=F.update(X,q,$,K,et,nt)||this.lettersChangedFlag)}}},TextAnimatorProperty.prototype.getValue=function(){this._elem.globalData.frameId!==this._frameId&&(this._frameId=this._elem.globalData.frameId,this.iterateDynamicProperties())},TextAnimatorProperty.prototype.mHelper=new Matrix,TextAnimatorProperty.prototype.defaultPropsArray=[],extendPrototype([DynamicPropertyContainer],TextAnimatorProperty),LetterProps.prototype.update=function(t,e,n,r,i,o){this._mdf.o=!1,this._mdf.sw=!1,this._mdf.sc=!1,this._mdf.fc=!1,this._mdf.m=!1,this._mdf.p=!1;var a=!1;return this.o!==t&&(this.o=t,this._mdf.o=!0,a=!0),this.sw!==e&&(this.sw=e,this._mdf.sw=!0,a=!0),this.sc!==n&&(this.sc=n,this._mdf.sc=!0,a=!0),this.fc!==r&&(this.fc=r,this._mdf.fc=!0,a=!0),this.m!==i&&(this.m=i,this._mdf.m=!0,a=!0),!o.length||this.p[0]===o[0]&&this.p[1]===o[1]&&this.p[4]===o[4]&&this.p[5]===o[5]&&this.p[12]===o[12]&&this.p[13]===o[13]||(this.p=o,this._mdf.p=!0,a=!0),a},TextProperty.prototype.defaultBoxWidth=[0,0],TextProperty.prototype.copyData=function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},TextProperty.prototype.setCurrentData=function(t){t.__complete||this.completeTextData(t),this.currentData=t,this.currentData.boxWidth=this.currentData.boxWidth||this.defaultBoxWidth,this._mdf=!0},TextProperty.prototype.searchProperty=function(){return this.searchKeyframes()},TextProperty.prototype.searchKeyframes=function(){return this.kf=this.data.d.k.length>1,this.kf&&this.addEffect(this.getKeyframeValue.bind(this)),this.kf},TextProperty.prototype.addEffect=function(t){this.effectsSequence.push(t),this.elem.addDynamicProperty(this)},TextProperty.prototype.getValue=function(t){if(this.elem.globalData.frameId!==this.frameId&&this.effectsSequence.length||t){this.currentData.t=this.data.d.k[this.keysIndex].s.t;var e=this.currentData,n=this.keysIndex;if(this.lock)this.setCurrentData(this.currentData);else{var r;this.lock=!0,this._mdf=!1;var i=this.effectsSequence.length,o=t||this.data.d.k[this.keysIndex].s;for(r=0;r<i;r+=1)o=n!==this.keysIndex?this.effectsSequence[r](o,o.t):this.effectsSequence[r](this.currentData,o.t);e!==o&&this.setCurrentData(o),this.v=this.currentData,this.pv=this.v,this.lock=!1,this.frameId=this.elem.globalData.frameId}}},TextProperty.prototype.getKeyframeValue=function(){var t=this.data.d.k,e=this.elem.comp.renderedFrame,n=0,r=t.length;while(n<=r-1){if(n===r-1||t[n+1].t>e)break;n+=1}return this.keysIndex!==n&&(this.keysIndex=n),this.data.d.k[this.keysIndex].s},TextProperty.prototype.buildFinalText=function(t){var e,n=FontManager.getCombinedCharacterCodes(),r=[],i=0,o=t.length;while(i<o)e=t.charCodeAt(i),-1!==n.indexOf(e)?r[r.length-1]+=t.charAt(i):e>=55296&&e<=56319?(e=t.charCodeAt(i+1),e>=56320&&e<=57343?(r.push(t.substr(i,2)),i+=1):r.push(t.charAt(i))):r.push(t.charAt(i)),i+=1;return r},TextProperty.prototype.completeTextData=function(t){t.__complete=!0;var e,n,r,i,o,a,s,u=this.elem.globalData.fontManager,c=this.data,l=[],h=0,f=c.m.g,p=0,d=0,m=0,v=[],g=0,y=0,b=u.getFontByName(t.f),x=0,w=getFontProperties(b);t.fWeight=w.weight,t.fStyle=w.style,t.finalSize=t.s,t.finalText=this.buildFinalText(t.t),n=t.finalText.length,t.finalLineHeight=t.lh;var E,_=t.tr/1e3*t.finalSize;if(t.sz){var C,S,A=!0,k=t.sz[0],T=t.sz[1];while(A){S=this.buildFinalText(t.t),C=0,g=0,n=S.length,_=t.tr/1e3*t.finalSize;var I=-1;for(e=0;e<n;e+=1)E=S[e].charCodeAt(0),r=!1," "===S[e]?I=e:13!==E&&3!==E||(g=0,r=!0,C+=t.finalLineHeight||1.2*t.finalSize),u.chars?(s=u.getCharData(S[e],b.fStyle,b.fFamily),x=r?0:s.w*t.finalSize/100):x=u.measureText(S[e],t.f,t.finalSize),g+x>k&&" "!==S[e]?(-1===I?n+=1:e=I,C+=t.finalLineHeight||1.2*t.finalSize,S.splice(e,I===e?1:0,"\r"),I=-1,g=0):(g+=x,g+=_);C+=b.ascent*t.finalSize/100,this.canResize&&t.finalSize>this.minimumFontSize&&T<C?(t.finalSize-=1,t.finalLineHeight=t.finalSize*t.lh/t.s):(t.finalText=S,n=t.finalText.length,A=!1)}}g=-_,x=0;var P,D=0;for(e=0;e<n;e+=1)if(r=!1,P=t.finalText[e],E=P.charCodeAt(0),13===E||3===E?(D=0,v.push(g),y=g>y?g:y,g=-2*_,i="",r=!0,m+=1):i=P,u.chars?(s=u.getCharData(P,b.fStyle,u.getFontByName(t.f).fFamily),x=r?0:s.w*t.finalSize/100):x=u.measureText(i,t.f,t.finalSize)," "===P?D+=x+_:(g+=x+_+D,D=0),l.push({l:x,an:x,add:p,n:r,anIndexes:[],val:i,line:m,animatorJustifyOffset:0}),2==f){if(p+=x,""===i||" "===i||e===n-1){""!==i&&" "!==i||(p-=x);while(d<=e)l[d].an=p,l[d].ind=h,l[d].extra=x,d+=1;h+=1,p=0}}else if(3==f){if(p+=x,""===i||e===n-1){""===i&&(p-=x);while(d<=e)l[d].an=p,l[d].ind=h,l[d].extra=x,d+=1;p=0,h+=1}}else l[h].ind=h,l[h].extra=0,h+=1;if(t.l=l,y=g>y?g:y,v.push(g),t.sz)t.boxWidth=t.sz[0],t.justifyOffset=0;else switch(t.boxWidth=y,t.j){case 1:t.justifyOffset=-t.boxWidth;break;case 2:t.justifyOffset=-t.boxWidth/2;break;default:t.justifyOffset=0}t.lineWidths=v;var R,M,F,O,N=c.a;a=N.length;var L=[];for(o=0;o<a;o+=1){for(R=N[o],R.a.sc&&(t.strokeColorAnim=!0),R.a.sw&&(t.strokeWidthAnim=!0),(R.a.fc||R.a.fh||R.a.fs||R.a.fb)&&(t.fillColorAnim=!0),O=0,F=R.s.b,e=0;e<n;e+=1)M=l[e],M.anIndexes[o]=O,(1==F&&""!==M.val||2==F&&""!==M.val&&" "!==M.val||3==F&&(M.n||" "==M.val||e==n-1)||4==F&&(M.n||e==n-1))&&(1===R.s.rn&&L.push(O),O+=1);c.a[o].s.totalChars=O;var B,V=-1;if(1===R.s.rn)for(e=0;e<n;e+=1)M=l[e],V!=M.anIndexes[o]&&(V=M.anIndexes[o],B=L.splice(Math.floor(Math.random()*L.length),1)[0]),M.anIndexes[o]=B}t.yOffset=t.finalLineHeight||1.2*t.finalSize,t.ls=t.ls||0,t.ascent=b.ascent*t.finalSize/100},TextProperty.prototype.updateDocumentData=function(t,e){e=void 0===e?this.keysIndex:e;var n=this.copyData({},this.data.d.k[e].s);n=this.copyData(n,t),this.data.d.k[e].s=n,this.recalculate(e),this.elem.addDynamicProperty(this)},TextProperty.prototype.recalculate=function(t){var e=this.data.d.k[t].s;e.__complete=!1,this.keysIndex=0,this._isFirstFrame=!0,this.getValue(e)},TextProperty.prototype.canResizeFont=function(t){this.canResize=t,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)},TextProperty.prototype.setMinimumFontSize=function(t){this.minimumFontSize=Math.floor(t)||1,this.recalculate(this.keysIndex),this.elem.addDynamicProperty(this)};var TextSelectorProp=function(){var t=Math.max,e=Math.min,n=Math.floor;function r(t,e){this._currentTextLength=-1,this.k=!1,this.data=e,this.elem=t,this.comp=t.comp,this.finalS=0,this.finalE=0,this.initDynamicPropertyContainer(t),this.s=PropertyFactory.getProp(t,e.s||{k:0},0,0,this),this.e="e"in e?PropertyFactory.getProp(t,e.e,0,0,this):{v:100},this.o=PropertyFactory.getProp(t,e.o||{k:0},0,0,this),this.xe=PropertyFactory.getProp(t,e.xe||{k:0},0,0,this),this.ne=PropertyFactory.getProp(t,e.ne||{k:0},0,0,this),this.a=PropertyFactory.getProp(t,e.a,0,.01,this),this.dynamicProperties.length||this.getValue()}function i(t,e,n){return new r(t,e,n)}return r.prototype={getMult:function(r){this._currentTextLength!==this.elem.textProperty.currentData.l.length&&this.getValue();var i=0,o=0,a=1,s=1;this.ne.v>0?i=this.ne.v/100:o=-this.ne.v/100,this.xe.v>0?a=1-this.xe.v/100:s=1+this.xe.v/100;var u=BezierFactory.getBezierEasing(i,o,a,s).get,c=0,l=this.finalS,h=this.finalE,f=this.data.sh;if(2===f)c=h===l?r>=h?1:0:t(0,e(.5/(h-l)+(r-l)/(h-l),1)),c=u(c);else if(3===f)c=h===l?r>=h?0:1:1-t(0,e(.5/(h-l)+(r-l)/(h-l),1)),c=u(c);else if(4===f)h===l?c=0:(c=t(0,e(.5/(h-l)+(r-l)/(h-l),1)),c<.5?c*=2:c=1-2*(c-.5)),c=u(c);else if(5===f){if(h===l)c=0;else{var p=h-l;r=e(t(0,r+.5-l),h-l);var d=-p/2+r,m=p/2;c=Math.sqrt(1-d*d/(m*m))}c=u(c)}else 6===f?(h===l?c=0:(r=e(t(0,r+.5-l),h-l),c=(1+Math.cos(Math.PI+2*Math.PI*r/(h-l)))/2),c=u(c)):(r>=n(l)&&(c=t(0,e(r-l<0?e(h,1)-(l-r):h-r,1))),c=u(c));return c*this.a.v},getValue:function(t){this.iterateDynamicProperties(),this._mdf=t||this._mdf,this._currentTextLength=this.elem.textProperty.currentData.l.length||0,t&&2===this.data.r&&(this.e.v=this._currentTextLength);var e=2===this.data.r?1:100/this.data.totalChars,n=this.o.v/e,r=this.s.v/e+n,i=this.e.v/e+n;if(r>i){var o=r;r=i,i=o}this.finalS=r,this.finalE=i}},extendPrototype([DynamicPropertyContainer],r),{getTextSelectorProp:i}}(),poolFactory=function(){return function(t,e,n){var r=0,i=t,o=createSizedArray(i),a={newElement:s,release:u};function s(){var t;return r?(r-=1,t=o[r]):t=e(),t}function u(t){r===i&&(o=pooling.double(o),i*=2),n&&n(t),o[r]=t,r+=1}return a}}(),pooling=function(){function t(t){return t.concat(createSizedArray(t.length))}return{double:t}}(),pointPool=function(){function t(){return createTypedArray("float32",2)}return poolFactory(8,t)}(),shapePool=function(){function t(){return new ShapePath}function e(t){var e,n=t._length;for(e=0;e<n;e+=1)pointPool.release(t.v[e]),pointPool.release(t.i[e]),pointPool.release(t.o[e]),t.v[e]=null,t.i[e]=null,t.o[e]=null;t._length=0,t.c=!1}function n(t){var e,n=r.newElement(),i=void 0===t._length?t.v.length:t._length;for(n.setLength(i),n.c=t.c,e=0;e<i;e+=1)n.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return n}var r=poolFactory(4,t,e);return r.clone=n,r}(),shapeCollectionPool=function(){var t={newShapeCollection:i,release:o},e=0,n=4,r=createSizedArray(n);function i(){var t;return e?(e-=1,t=r[e]):t=new ShapeCollection,t}function o(t){var i,o=t._length;for(i=0;i<o;i+=1)shapePool.release(t.shapes[i]);t._length=0,e===n&&(r=pooling.double(r),n*=2),r[e]=t,e+=1}return t}(),segmentsLengthPool=function(){function t(){return{lengths:[],totalLength:0}}function e(t){var e,n=t.lengths.length;for(e=0;e<n;e+=1)bezierLengthPool.release(t.lengths[e]);t.lengths.length=0}return poolFactory(8,t,e)}(),bezierLengthPool=function(){function t(){return{addedLength:0,percents:createTypedArray("float32",defaultCurveSegments),lengths:createTypedArray("float32",defaultCurveSegments)}}return poolFactory(8,t)}(),markerParser=function(){function t(t){for(var e,n=t.split("\r\n"),r={},i=0,o=0;o<n.length;o+=1)e=n[o].split(":"),2===e.length&&(r[e[0]]=e[1].trim(),i+=1);if(0===i)throw new Error;return r}return function(e){for(var n=[],r=0;r<e.length;r+=1){var i=e[r],o={time:i.tm,duration:i.dr};try{o.payload=JSON.parse(e[r].cm)}catch(a){try{o.payload=t(e[r].cm)}catch(s){o.payload={name:e[r]}}}n.push(o)}return n}}();function BaseRenderer(){}function SVGRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.svgElement=createNS("svg");var n="";if(e&&e.title){var r=createNS("title"),i=createElementID();r.setAttribute("id",i),r.textContent=e.title,this.svgElement.appendChild(r),n+=i}if(e&&e.description){var o=createNS("desc"),a=createElementID();o.setAttribute("id",a),o.textContent=e.description,this.svgElement.appendChild(o),n+=" "+a}n&&this.svgElement.setAttribute("aria-labelledby",n);var s=createNS("defs");this.svgElement.appendChild(s);var u=createNS("g");this.svgElement.appendChild(u),this.layerElement=u,this.renderConfig={preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",progressiveLoad:e&&e.progressiveLoad||!1,hideOnTransparent:!(e&&!1===e.hideOnTransparent),viewBoxOnly:e&&e.viewBoxOnly||!1,viewBoxSize:e&&e.viewBoxSize||!1,className:e&&e.className||"",id:e&&e.id||"",focusable:e&&e.focusable,filterSize:{width:e&&e.filterSize&&e.filterSize.width||"100%",height:e&&e.filterSize&&e.filterSize.height||"100%",x:e&&e.filterSize&&e.filterSize.x||"0%",y:e&&e.filterSize&&e.filterSize.y||"0%"}},this.globalData={_mdf:!1,frameNum:-1,defs:s,renderConfig:this.renderConfig},this.elements=[],this.pendingElements=[],this.destroyed=!1,this.rendererType="svg"}function CanvasRenderer(t,e){this.animationItem=t,this.renderConfig={clearCanvas:!e||void 0===e.clearCanvas||e.clearCanvas,context:e&&e.context||null,progressiveLoad:e&&e.progressiveLoad||!1,preserveAspectRatio:e&&e.preserveAspectRatio||"xMidYMid meet",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",className:e&&e.className||"",id:e&&e.id||""},this.renderConfig.dpr=e&&e.dpr||1,this.animationItem.wrapper&&(this.renderConfig.dpr=e&&e.dpr||window.devicePixelRatio||1),this.renderedFrame=-1,this.globalData={frameNum:-1,_mdf:!1,renderConfig:this.renderConfig,currentGlobalAlpha:-1},this.contextData=new CVContextData,this.elements=[],this.pendingElements=[],this.transformMat=new Matrix,this.completeLayers=!1,this.rendererType="canvas"}function HybridRenderer(t,e){this.animationItem=t,this.layers=null,this.renderedFrame=-1,this.renderConfig={className:e&&e.className||"",imagePreserveAspectRatio:e&&e.imagePreserveAspectRatio||"xMidYMid slice",hideOnTransparent:!(e&&!1===e.hideOnTransparent),filterSize:{width:e&&e.filterSize&&e.filterSize.width||"400%",height:e&&e.filterSize&&e.filterSize.height||"400%",x:e&&e.filterSize&&e.filterSize.x||"-100%",y:e&&e.filterSize&&e.filterSize.y||"-100%"}},this.globalData={_mdf:!1,frameNum:-1,renderConfig:this.renderConfig},this.pendingElements=[],this.elements=[],this.threeDElements=[],this.destroyed=!1,this.camera=null,this.supports3d=!0,this.rendererType="html"}function MaskElement(t,e,n){this.data=t,this.element=e,this.globalData=n,this.storedData=[],this.masksProperties=this.data.masksProperties||[],this.maskElement=null;var r,i,o=this.globalData.defs,a=this.masksProperties?this.masksProperties.length:0;this.viewData=createSizedArray(a),this.solidPath="";var s,u,c,l,h,f,p=this.masksProperties,d=0,m=[],v=createElementID(),g="clipPath",y="clip-path";for(r=0;r<a;r+=1)if(("a"!==p[r].mode&&"n"!==p[r].mode||p[r].inv||100!==p[r].o.k||p[r].o.x)&&(g="mask",y="mask"),"s"!==p[r].mode&&"i"!==p[r].mode||0!==d?c=null:(c=createNS("rect"),c.setAttribute("fill","#ffffff"),c.setAttribute("width",this.element.comp.data.w||0),c.setAttribute("height",this.element.comp.data.h||0),m.push(c)),i=createNS("path"),"n"===p[r].mode)this.viewData[r]={op:PropertyFactory.getProp(this.element,p[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[r],3),elem:i,lastPath:""},o.appendChild(i);else{var b;if(d+=1,i.setAttribute("fill","s"===p[r].mode?"#000000":"#ffffff"),i.setAttribute("clip-rule","nonzero"),0!==p[r].x.k?(g="mask",y="mask",f=PropertyFactory.getProp(this.element,p[r].x,0,null,this.element),b=createElementID(),l=createNS("filter"),l.setAttribute("id",b),h=createNS("feMorphology"),h.setAttribute("operator","erode"),h.setAttribute("in","SourceGraphic"),h.setAttribute("radius","0"),l.appendChild(h),o.appendChild(l),i.setAttribute("stroke","s"===p[r].mode?"#000000":"#ffffff")):(h=null,f=null),this.storedData[r]={elem:i,x:f,expan:h,lastPath:"",lastOperator:"",filterId:b,lastRadius:0},"i"===p[r].mode){u=m.length;var x=createNS("g");for(s=0;s<u;s+=1)x.appendChild(m[s]);var w=createNS("mask");w.setAttribute("mask-type","alpha"),w.setAttribute("id",v+"_"+d),w.appendChild(i),o.appendChild(w),x.setAttribute("mask","url("+locationHref+"#"+v+"_"+d+")"),m.length=0,m.push(x)}else m.push(i);p[r].inv&&!this.solidPath&&(this.solidPath=this.createLayerSolidPath()),this.viewData[r]={elem:i,lastPath:"",op:PropertyFactory.getProp(this.element,p[r].o,0,.01,this.element),prop:ShapePropertyFactory.getShapeProp(this.element,p[r],3),invRect:c},this.viewData[r].prop.k||this.drawPath(p[r],this.viewData[r].prop.v,this.viewData[r])}for(this.maskElement=createNS(g),a=m.length,r=0;r<a;r+=1)this.maskElement.appendChild(m[r]);d>0&&(this.maskElement.setAttribute("id",v),this.element.maskedElement.setAttribute(y,"url("+locationHref+"#"+v+")"),o.appendChild(this.maskElement)),this.viewData.length&&this.element.addRenderableComponent(this)}function HierarchyElement(){}function FrameElement(){}function TransformElement(){}function RenderableElement(){}function RenderableDOMElement(){}function ProcessedElement(t,e){this.elem=t,this.pos=e}function SVGStyleData(t,e){this.data=t,this.type=t.ty,this.d="",this.lvl=e,this._mdf=!1,this.closed=!0===t.hd,this.pElem=createNS("path"),this.msElem=null}function SVGShapeData(t,e,n){this.caches=[],this.styles=[],this.transformers=t,this.lStr="",this.sh=n,this.lvl=e,this._isAnimated=!!n.k;var r=0,i=t.length;while(r<i){if(t[r].mProps.dynamicProperties.length){this._isAnimated=!0;break}r+=1}}function SVGTransformData(t,e,n){this.transform={mProps:t,op:e,container:n},this.elements=[],this._isAnimated=this.transform.mProps.dynamicProperties.length||this.transform.op.effectsSequence.length}function SVGStrokeStyleData(t,e,n){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=n,this._isAnimated=!!this._isAnimated}function SVGFillStyleData(t,e,n){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.c=PropertyFactory.getProp(t,e.c,1,255,this),this.style=n}function SVGGradientFillStyleData(t,e,n){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.initGradientData(t,e,n)}function SVGGradientStrokeStyleData(t,e,n){this.initDynamicPropertyContainer(t),this.getValue=this.iterateDynamicProperties,this.w=PropertyFactory.getProp(t,e.w,0,null,this),this.d=new DashProperty(t,e.d||{},"svg",this),this.initGradientData(t,e,n),this._isAnimated=!!this._isAnimated}function ShapeGroupData(){this.it=[],this.prevViewData=[],this.gr=createNS("g")}BaseRenderer.prototype.checkLayers=function(t){var e,n,r=this.layers.length;for(this.completeLayers=!0,e=r-1;e>=0;e-=1)this.elements[e]||(n=this.layers[e],n.ip-n.st<=t-this.layers[e].st&&n.op-n.st>t-this.layers[e].st&&this.buildItem(e)),this.completeLayers=!!this.elements[e]&&this.completeLayers;this.checkPendingElements()},BaseRenderer.prototype.createItem=function(t){switch(t.ty){case 2:return this.createImage(t);case 0:return this.createComp(t);case 1:return this.createSolid(t);case 3:return this.createNull(t);case 4:return this.createShape(t);case 5:return this.createText(t);case 6:return this.createAudio(t);case 13:return this.createCamera(t);case 15:return this.createFootage(t);default:return this.createNull(t)}},BaseRenderer.prototype.createCamera=function(){throw new Error("You're using a 3d camera. Try the html renderer.")},BaseRenderer.prototype.createAudio=function(t){return new AudioElement(t,this.globalData,this)},BaseRenderer.prototype.createFootage=function(t){return new FootageElement(t,this.globalData,this)},BaseRenderer.prototype.buildAllItems=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.buildItem(t);this.checkPendingElements()},BaseRenderer.prototype.includeLayers=function(t){var e;this.completeLayers=!1;var n,r=t.length,i=this.layers.length;for(e=0;e<r;e+=1){n=0;while(n<i){if(this.layers[n].id===t[e].id){this.layers[n]=t[e];break}n+=1}}},BaseRenderer.prototype.setProjectInterface=function(t){this.globalData.projectInterface=t},BaseRenderer.prototype.initItems=function(){this.globalData.progressiveLoad||this.buildAllItems()},BaseRenderer.prototype.buildElementParenting=function(t,e,n){var r=this.elements,i=this.layers,o=0,a=i.length;while(o<a)i[o].ind==e&&(r[o]&&!0!==r[o]?(n.push(r[o]),r[o].setAsParent(),void 0!==i[o].parent?this.buildElementParenting(t,i[o].parent,n):t.setHierarchy(n)):(this.buildItem(o),this.addPendingElement(t))),o+=1},BaseRenderer.prototype.addPendingElement=function(t){this.pendingElements.push(t)},BaseRenderer.prototype.searchExtraCompositions=function(t){var e,n=t.length;for(e=0;e<n;e+=1)if(t[e].xt){var r=this.createComp(t[e]);r.initExpressions(),this.globalData.projectInterface.registerComposition(r)}},BaseRenderer.prototype.setupGlobalData=function(t,e){this.globalData.fontManager=new FontManager,this.globalData.fontManager.addChars(t.chars),this.globalData.fontManager.addFonts(t.fonts,e),this.globalData.getAssetData=this.animationItem.getAssetData.bind(this.animationItem),this.globalData.getAssetsPath=this.animationItem.getAssetsPath.bind(this.animationItem),this.globalData.imageLoader=this.animationItem.imagePreloader,this.globalData.audioController=this.animationItem.audioController,this.globalData.frameId=0,this.globalData.frameRate=t.fr,this.globalData.nm=t.nm,this.globalData.compSize={w:t.w,h:t.h}},extendPrototype([BaseRenderer],SVGRenderer),SVGRenderer.prototype.createNull=function(t){return new NullElement(t,this.globalData,this)},SVGRenderer.prototype.createShape=function(t){return new SVGShapeElement(t,this.globalData,this)},SVGRenderer.prototype.createText=function(t){return new SVGTextLottieElement(t,this.globalData,this)},SVGRenderer.prototype.createImage=function(t){return new IImageElement(t,this.globalData,this)},SVGRenderer.prototype.createComp=function(t){return new SVGCompElement(t,this.globalData,this)},SVGRenderer.prototype.createSolid=function(t){return new ISolidElement(t,this.globalData,this)},SVGRenderer.prototype.configAnimation=function(t){this.svgElement.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.renderConfig.viewBoxSize?this.svgElement.setAttribute("viewBox",this.renderConfig.viewBoxSize):this.svgElement.setAttribute("viewBox","0 0 "+t.w+" "+t.h),this.renderConfig.viewBoxOnly||(this.svgElement.setAttribute("width",t.w),this.svgElement.setAttribute("height",t.h),this.svgElement.style.width="100%",this.svgElement.style.height="100%",this.svgElement.style.transform="translate3d(0,0,0)"),this.renderConfig.className&&this.svgElement.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.svgElement.setAttribute("id",this.renderConfig.id),void 0!==this.renderConfig.focusable&&this.svgElement.setAttribute("focusable",this.renderConfig.focusable),this.svgElement.setAttribute("preserveAspectRatio",this.renderConfig.preserveAspectRatio),this.animationItem.wrapper.appendChild(this.svgElement);var e=this.globalData.defs;this.setupGlobalData(t,e),this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.data=t;var n=createNS("clipPath"),r=createNS("rect");r.setAttribute("width",t.w),r.setAttribute("height",t.h),r.setAttribute("x",0),r.setAttribute("y",0);var i=createElementID();n.setAttribute("id",i),n.appendChild(r),this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+i+")"),e.appendChild(n),this.layers=t.layers,this.elements=createSizedArray(t.layers.length)},SVGRenderer.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.layerElement=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},SVGRenderer.prototype.updateContainerSize=function(){},SVGRenderer.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){e[t]=!0;var n=this.createItem(this.layers[t]);e[t]=n,expressionsPlugin&&(0===this.layers[t].ty&&this.globalData.projectInterface.registerComposition(n),n.initExpressions()),this.appendElementInPos(n,t),this.layers[t].tt&&(this.elements[t-1]&&!0!==this.elements[t-1]?n.setMatte(e[t-1].layerId):(this.buildItem(t-1),this.addPendingElement(n)))}},SVGRenderer.prototype.checkPendingElements=function(){while(this.pendingElements.length){var t=this.pendingElements.pop();if(t.checkParenting(),t.data.tt){var e=0,n=this.elements.length;while(e<n){if(this.elements[e]===t){t.setMatte(this.elements[e-1].layerId);break}e+=1}}}},SVGRenderer.prototype.renderFrame=function(t){if(this.renderedFrame!==t&&!this.destroyed){var e;null===t?t=this.renderedFrame:this.renderedFrame=t,this.globalData.frameNum=t,this.globalData.frameId+=1,this.globalData.projectInterface.currentFrame=t,this.globalData._mdf=!1;var n=this.layers.length;for(this.completeLayers||this.checkLayers(t),e=n-1;e>=0;e-=1)(this.completeLayers||this.elements[e])&&this.elements[e].prepareFrame(t-this.layers[e].st);if(this.globalData._mdf)for(e=0;e<n;e+=1)(this.completeLayers||this.elements[e])&&this.elements[e].renderFrame()}},SVGRenderer.prototype.appendElementInPos=function(t,e){var n=t.getBaseElement();if(n){var r,i=0;while(i<e)this.elements[i]&&!0!==this.elements[i]&&this.elements[i].getBaseElement()&&(r=this.elements[i].getBaseElement()),i+=1;r?this.layerElement.insertBefore(n,r):this.layerElement.appendChild(n)}},SVGRenderer.prototype.hide=function(){this.layerElement.style.display="none"},SVGRenderer.prototype.show=function(){this.layerElement.style.display="block"},extendPrototype([BaseRenderer],CanvasRenderer),CanvasRenderer.prototype.createShape=function(t){return new CVShapeElement(t,this.globalData,this)},CanvasRenderer.prototype.createText=function(t){return new CVTextElement(t,this.globalData,this)},CanvasRenderer.prototype.createImage=function(t){return new CVImageElement(t,this.globalData,this)},CanvasRenderer.prototype.createComp=function(t){return new CVCompElement(t,this.globalData,this)},CanvasRenderer.prototype.createSolid=function(t){return new CVSolidElement(t,this.globalData,this)},CanvasRenderer.prototype.createNull=SVGRenderer.prototype.createNull,CanvasRenderer.prototype.ctxTransform=function(t){if(1!==t[0]||0!==t[1]||0!==t[4]||1!==t[5]||0!==t[12]||0!==t[13])if(this.renderConfig.clearCanvas){this.transformMat.cloneFromProps(t);var e=this.contextData.cTr.props;this.transformMat.transform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]),this.contextData.cTr.cloneFromProps(this.transformMat.props);var n=this.contextData.cTr.props;this.canvasContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13])}else this.canvasContext.transform(t[0],t[1],t[4],t[5],t[12],t[13])},CanvasRenderer.prototype.ctxOpacity=function(t){if(!this.renderConfig.clearCanvas)return this.canvasContext.globalAlpha*=t<0?0:t,void(this.globalData.currentGlobalAlpha=this.contextData.cO);this.contextData.cO*=t<0?0:t,this.globalData.currentGlobalAlpha!==this.contextData.cO&&(this.canvasContext.globalAlpha=this.contextData.cO,this.globalData.currentGlobalAlpha=this.contextData.cO)},CanvasRenderer.prototype.reset=function(){this.renderConfig.clearCanvas?this.contextData.reset():this.canvasContext.restore()},CanvasRenderer.prototype.save=function(t){if(this.renderConfig.clearCanvas){t&&this.canvasContext.save();var e,n=this.contextData.cTr.props;this.contextData._length<=this.contextData.cArrPos&&this.contextData.duplicate();var r=this.contextData.saved[this.contextData.cArrPos];for(e=0;e<16;e+=1)r[e]=n[e];this.contextData.savedOp[this.contextData.cArrPos]=this.contextData.cO,this.contextData.cArrPos+=1}else this.canvasContext.save()},CanvasRenderer.prototype.restore=function(t){if(this.renderConfig.clearCanvas){t&&(this.canvasContext.restore(),this.globalData.blendMode="source-over"),this.contextData.cArrPos-=1;var e,n=this.contextData.saved[this.contextData.cArrPos],r=this.contextData.cTr.props;for(e=0;e<16;e+=1)r[e]=n[e];this.canvasContext.setTransform(n[0],n[1],n[4],n[5],n[12],n[13]),n=this.contextData.savedOp[this.contextData.cArrPos],this.contextData.cO=n,this.globalData.currentGlobalAlpha!==n&&(this.canvasContext.globalAlpha=n,this.globalData.currentGlobalAlpha=n)}else this.canvasContext.restore()},CanvasRenderer.prototype.configAnimation=function(t){if(this.animationItem.wrapper){this.animationItem.container=createTag("canvas");var e=this.animationItem.container.style;e.width="100%",e.height="100%";var n="0px 0px 0px";e.transformOrigin=n,e.mozTransformOrigin=n,e.webkitTransformOrigin=n,e["-webkit-transform"]=n,this.animationItem.wrapper.appendChild(this.animationItem.container),this.canvasContext=this.animationItem.container.getContext("2d"),this.renderConfig.className&&this.animationItem.container.setAttribute("class",this.renderConfig.className),this.renderConfig.id&&this.animationItem.container.setAttribute("id",this.renderConfig.id)}else this.canvasContext=this.renderConfig.context;this.data=t,this.layers=t.layers,this.transformCanvas={w:t.w,h:t.h,sx:0,sy:0,tx:0,ty:0},this.setupGlobalData(t,document.body),this.globalData.canvasContext=this.canvasContext,this.globalData.renderer=this,this.globalData.isDashed=!1,this.globalData.progressiveLoad=this.renderConfig.progressiveLoad,this.globalData.transformCanvas=this.transformCanvas,this.elements=createSizedArray(t.layers.length),this.updateContainerSize()},CanvasRenderer.prototype.updateContainerSize=function(){var t,e,n,r;if(this.reset(),this.animationItem.wrapper&&this.animationItem.container?(t=this.animationItem.wrapper.offsetWidth,e=this.animationItem.wrapper.offsetHeight,this.animationItem.container.setAttribute("width",t*this.renderConfig.dpr),this.animationItem.container.setAttribute("height",e*this.renderConfig.dpr)):(t=this.canvasContext.canvas.width*this.renderConfig.dpr,e=this.canvasContext.canvas.height*this.renderConfig.dpr),-1!==this.renderConfig.preserveAspectRatio.indexOf("meet")||-1!==this.renderConfig.preserveAspectRatio.indexOf("slice")){var i=this.renderConfig.preserveAspectRatio.split(" "),o=i[1]||"meet",a=i[0]||"xMidYMid",s=a.substr(0,4),u=a.substr(4);n=t/e,r=this.transformCanvas.w/this.transformCanvas.h,r>n&&"meet"===o||r<n&&"slice"===o?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=t/(this.transformCanvas.w/this.renderConfig.dpr)):(this.transformCanvas.sx=e/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.sy=e/(this.transformCanvas.h/this.renderConfig.dpr)),this.transformCanvas.tx="xMid"===s&&(r<n&&"meet"===o||r>n&&"slice"===o)?(t-this.transformCanvas.w*(e/this.transformCanvas.h))/2*this.renderConfig.dpr:"xMax"===s&&(r<n&&"meet"===o||r>n&&"slice"===o)?(t-this.transformCanvas.w*(e/this.transformCanvas.h))*this.renderConfig.dpr:0,this.transformCanvas.ty="YMid"===u&&(r>n&&"meet"===o||r<n&&"slice"===o)?(e-this.transformCanvas.h*(t/this.transformCanvas.w))/2*this.renderConfig.dpr:"YMax"===u&&(r>n&&"meet"===o||r<n&&"slice"===o)?(e-this.transformCanvas.h*(t/this.transformCanvas.w))*this.renderConfig.dpr:0}else"none"===this.renderConfig.preserveAspectRatio?(this.transformCanvas.sx=t/(this.transformCanvas.w/this.renderConfig.dpr),this.transformCanvas.sy=e/(this.transformCanvas.h/this.renderConfig.dpr),this.transformCanvas.tx=0,this.transformCanvas.ty=0):(this.transformCanvas.sx=this.renderConfig.dpr,this.transformCanvas.sy=this.renderConfig.dpr,this.transformCanvas.tx=0,this.transformCanvas.ty=0);this.transformCanvas.props=[this.transformCanvas.sx,0,0,0,0,this.transformCanvas.sy,0,0,0,0,1,0,this.transformCanvas.tx,this.transformCanvas.ty,0,1],this.ctxTransform(this.transformCanvas.props),this.canvasContext.beginPath(),this.canvasContext.rect(0,0,this.transformCanvas.w,this.transformCanvas.h),this.canvasContext.closePath(),this.canvasContext.clip(),this.renderFrame(this.renderedFrame,!0)},CanvasRenderer.prototype.destroy=function(){var t;this.renderConfig.clearCanvas&&this.animationItem.wrapper&&(this.animationItem.wrapper.innerText="");var e=this.layers?this.layers.length:0;for(t=e-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.elements.length=0,this.globalData.canvasContext=null,this.animationItem.container=null,this.destroyed=!0},CanvasRenderer.prototype.renderFrame=function(t,e){if((this.renderedFrame!==t||!0!==this.renderConfig.clearCanvas||e)&&!this.destroyed&&-1!==t){var n;this.renderedFrame=t,this.globalData.frameNum=t-this.animationItem._isFirstFrame,this.globalData.frameId+=1,this.globalData._mdf=!this.renderConfig.clearCanvas||e,this.globalData.projectInterface.currentFrame=t;var r=this.layers.length;for(this.completeLayers||this.checkLayers(t),n=0;n<r;n+=1)(this.completeLayers||this.elements[n])&&this.elements[n].prepareFrame(t-this.layers[n].st);if(this.globalData._mdf){for(!0===this.renderConfig.clearCanvas?this.canvasContext.clearRect(0,0,this.transformCanvas.w,this.transformCanvas.h):this.save(),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&this.elements[n].renderFrame();!0!==this.renderConfig.clearCanvas&&this.restore()}}},CanvasRenderer.prototype.buildItem=function(t){var e=this.elements;if(!e[t]&&99!==this.layers[t].ty){var n=this.createItem(this.layers[t],this,this.globalData);e[t]=n,n.initExpressions()}},CanvasRenderer.prototype.checkPendingElements=function(){while(this.pendingElements.length){var t=this.pendingElements.pop();t.checkParenting()}},CanvasRenderer.prototype.hide=function(){this.animationItem.container.style.display="none"},CanvasRenderer.prototype.show=function(){this.animationItem.container.style.display="block"},extendPrototype([BaseRenderer],HybridRenderer),HybridRenderer.prototype.buildItem=SVGRenderer.prototype.buildItem,HybridRenderer.prototype.checkPendingElements=function(){while(this.pendingElements.length){var t=this.pendingElements.pop();t.checkParenting()}},HybridRenderer.prototype.appendElementInPos=function(t,e){var n=t.getBaseElement();if(n){var r=this.layers[e];if(r.ddd&&this.supports3d)this.addTo3dContainer(n,e);else if(this.threeDElements)this.addTo3dContainer(n,e);else{var i,o,a,s=0;while(s<e)this.elements[s]&&!0!==this.elements[s]&&this.elements[s].getBaseElement&&(o=this.elements[s],a=this.layers[s].ddd?this.getThreeDContainerByPos(s):o.getBaseElement(),i=a||i),s+=1;i?r.ddd&&this.supports3d||this.layerElement.insertBefore(n,i):r.ddd&&this.supports3d||this.layerElement.appendChild(n)}}},HybridRenderer.prototype.createShape=function(t){return this.supports3d?new HShapeElement(t,this.globalData,this):new SVGShapeElement(t,this.globalData,this)},HybridRenderer.prototype.createText=function(t){return this.supports3d?new HTextElement(t,this.globalData,this):new SVGTextLottieElement(t,this.globalData,this)},HybridRenderer.prototype.createCamera=function(t){return this.camera=new HCameraElement(t,this.globalData,this),this.camera},HybridRenderer.prototype.createImage=function(t){return this.supports3d?new HImageElement(t,this.globalData,this):new IImageElement(t,this.globalData,this)},HybridRenderer.prototype.createComp=function(t){return this.supports3d?new HCompElement(t,this.globalData,this):new SVGCompElement(t,this.globalData,this)},HybridRenderer.prototype.createSolid=function(t){return this.supports3d?new HSolidElement(t,this.globalData,this):new ISolidElement(t,this.globalData,this)},HybridRenderer.prototype.createNull=SVGRenderer.prototype.createNull,HybridRenderer.prototype.getThreeDContainerByPos=function(t){var e=0,n=this.threeDElements.length;while(e<n){if(this.threeDElements[e].startPos<=t&&this.threeDElements[e].endPos>=t)return this.threeDElements[e].perspectiveElem;e+=1}return null},HybridRenderer.prototype.createThreeDContainer=function(t,e){var n,r,i=createTag("div");styleDiv(i);var o=createTag("div");if(styleDiv(o),"3d"===e){n=i.style,n.width=this.globalData.compSize.w+"px",n.height=this.globalData.compSize.h+"px";var a="50% 50%";n.webkitTransformOrigin=a,n.mozTransformOrigin=a,n.transformOrigin=a,r=o.style;var s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";r.transform=s,r.webkitTransform=s}i.appendChild(o);var u={container:o,perspectiveElem:i,startPos:t,endPos:t,type:e};return this.threeDElements.push(u),u},HybridRenderer.prototype.build3dContainers=function(){var t,e,n=this.layers.length,r="";for(t=0;t<n;t+=1)this.layers[t].ddd&&3!==this.layers[t].ty?("3d"!==r&&(r="3d",e=this.createThreeDContainer(t,"3d")),e.endPos=Math.max(e.endPos,t)):("2d"!==r&&(r="2d",e=this.createThreeDContainer(t,"2d")),e.endPos=Math.max(e.endPos,t));for(n=this.threeDElements.length,t=n-1;t>=0;t-=1)this.resizerElem.appendChild(this.threeDElements[t].perspectiveElem)},HybridRenderer.prototype.addTo3dContainer=function(t,e){var n=0,r=this.threeDElements.length;while(n<r){if(e<=this.threeDElements[n].endPos){var i,o=this.threeDElements[n].startPos;while(o<e)this.elements[o]&&this.elements[o].getBaseElement&&(i=this.elements[o].getBaseElement()),o+=1;i?this.threeDElements[n].container.insertBefore(t,i):this.threeDElements[n].container.appendChild(t);break}n+=1}},HybridRenderer.prototype.configAnimation=function(t){var e=createTag("div"),n=this.animationItem.wrapper,r=e.style;r.width=t.w+"px",r.height=t.h+"px",this.resizerElem=e,styleDiv(e),r.transformStyle="flat",r.mozTransformStyle="flat",r.webkitTransformStyle="flat",this.renderConfig.className&&e.setAttribute("class",this.renderConfig.className),n.appendChild(e),r.overflow="hidden";var i=createNS("svg");i.setAttribute("width","1"),i.setAttribute("height","1"),styleDiv(i),this.resizerElem.appendChild(i);var o=createNS("defs");i.appendChild(o),this.data=t,this.setupGlobalData(t,i),this.globalData.defs=o,this.layers=t.layers,this.layerElement=this.resizerElem,this.build3dContainers(),this.updateContainerSize()},HybridRenderer.prototype.destroy=function(){var t;this.animationItem.wrapper&&(this.animationItem.wrapper.innerText=""),this.animationItem.container=null,this.globalData.defs=null;var e=this.layers?this.layers.length:0;for(t=0;t<e;t+=1)this.elements[t].destroy();this.elements.length=0,this.destroyed=!0,this.animationItem=null},HybridRenderer.prototype.updateContainerSize=function(){var t,e,n,r,i=this.animationItem.wrapper.offsetWidth,o=this.animationItem.wrapper.offsetHeight,a=i/o,s=this.globalData.compSize.w/this.globalData.compSize.h;s>a?(t=i/this.globalData.compSize.w,e=i/this.globalData.compSize.w,n=0,r=(o-this.globalData.compSize.h*(i/this.globalData.compSize.w))/2):(t=o/this.globalData.compSize.h,e=o/this.globalData.compSize.h,n=(i-this.globalData.compSize.w*(o/this.globalData.compSize.h))/2,r=0);var u=this.resizerElem.style;u.webkitTransform="matrix3d("+t+",0,0,0,0,"+e+",0,0,0,0,1,0,"+n+","+r+",0,1)",u.transform=u.webkitTransform},HybridRenderer.prototype.renderFrame=SVGRenderer.prototype.renderFrame,HybridRenderer.prototype.hide=function(){this.resizerElem.style.display="none"},HybridRenderer.prototype.show=function(){this.resizerElem.style.display="block"},HybridRenderer.prototype.initItems=function(){if(this.buildAllItems(),this.camera)this.camera.setup();else{var t,e=this.globalData.compSize.w,n=this.globalData.compSize.h,r=this.threeDElements.length;for(t=0;t<r;t+=1){var i=this.threeDElements[t].perspectiveElem.style;i.webkitPerspective=Math.sqrt(Math.pow(e,2)+Math.pow(n,2))+"px",i.perspective=i.webkitPerspective}}},HybridRenderer.prototype.searchExtraCompositions=function(t){var e,n=t.length,r=createTag("div");for(e=0;e<n;e+=1)if(t[e].xt){var i=this.createComp(t[e],r,this.globalData.comp,null);i.initExpressions(),this.globalData.projectInterface.registerComposition(i)}},MaskElement.prototype.getMaskProperty=function(t){return this.viewData[t].prop},MaskElement.prototype.renderFrame=function(t){var e,n=this.element.finalTransform.mat,r=this.masksProperties.length;for(e=0;e<r;e+=1)if((this.viewData[e].prop._mdf||t)&&this.drawPath(this.masksProperties[e],this.viewData[e].prop.v,this.viewData[e]),(this.viewData[e].op._mdf||t)&&this.viewData[e].elem.setAttribute("fill-opacity",this.viewData[e].op.v),"n"!==this.masksProperties[e].mode&&(this.viewData[e].invRect&&(this.element.finalTransform.mProp._mdf||t)&&this.viewData[e].invRect.setAttribute("transform",n.getInverseMatrix().to2dCSS()),this.storedData[e].x&&(this.storedData[e].x._mdf||t))){var i=this.storedData[e].expan;this.storedData[e].x.v<0?("erode"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="erode",this.storedData[e].elem.setAttribute("filter","url("+locationHref+"#"+this.storedData[e].filterId+")")),i.setAttribute("radius",-this.storedData[e].x.v)):("dilate"!==this.storedData[e].lastOperator&&(this.storedData[e].lastOperator="dilate",this.storedData[e].elem.setAttribute("filter",null)),this.storedData[e].elem.setAttribute("stroke-width",2*this.storedData[e].x.v))}},MaskElement.prototype.getMaskelement=function(){return this.maskElement},MaskElement.prototype.createLayerSolidPath=function(){var t="M0,0 ";return t+=" h"+this.globalData.compSize.w,t+=" v"+this.globalData.compSize.h,t+=" h-"+this.globalData.compSize.w,t+=" v-"+this.globalData.compSize.h+" ",t},MaskElement.prototype.drawPath=function(t,e,n){var r,i,o=" M"+e.v[0][0]+","+e.v[0][1];for(i=e._length,r=1;r<i;r+=1)o+=" C"+e.o[r-1][0]+","+e.o[r-1][1]+" "+e.i[r][0]+","+e.i[r][1]+" "+e.v[r][0]+","+e.v[r][1];if(e.c&&i>1&&(o+=" C"+e.o[r-1][0]+","+e.o[r-1][1]+" "+e.i[0][0]+","+e.i[0][1]+" "+e.v[0][0]+","+e.v[0][1]),n.lastPath!==o){var a="";n.elem&&(e.c&&(a=t.inv?this.solidPath+o:o),n.elem.setAttribute("d",a)),n.lastPath=o}},MaskElement.prototype.destroy=function(){this.element=null,this.globalData=null,this.maskElement=null,this.data=null,this.masksProperties=null},HierarchyElement.prototype={initHierarchy:function(){this.hierarchy=[],this._isParent=!1,this.checkParenting()},setHierarchy:function(t){this.hierarchy=t},setAsParent:function(){this._isParent=!0},checkParenting:function(){void 0!==this.data.parent&&this.comp.buildElementParenting(this,this.data.parent,[])}},FrameElement.prototype={initFrame:function(){this._isFirstFrame=!1,this.dynamicProperties=[],this._mdf=!1},prepareProperties:function(t,e){var n,r=this.dynamicProperties.length;for(n=0;n<r;n+=1)(e||this._isParent&&"transform"===this.dynamicProperties[n].propType)&&(this.dynamicProperties[n].getValue(),this.dynamicProperties[n]._mdf&&(this.globalData._mdf=!0,this._mdf=!0))},addDynamicProperty:function(t){-1===this.dynamicProperties.indexOf(t)&&this.dynamicProperties.push(t)}},TransformElement.prototype={initTransform:function(){this.finalTransform={mProp:this.data.ks?TransformPropertyFactory.getTransformProperty(this,this.data.ks,this):{o:0},_matMdf:!1,_opMdf:!1,mat:new Matrix},this.data.ao&&(this.finalTransform.mProp.autoOriented=!0),this.data.ty},renderTransform:function(){if(this.finalTransform._opMdf=this.finalTransform.mProp.o._mdf||this._isFirstFrame,this.finalTransform._matMdf=this.finalTransform.mProp._mdf||this._isFirstFrame,this.hierarchy){var t,e=this.finalTransform.mat,n=0,r=this.hierarchy.length;if(!this.finalTransform._matMdf)while(n<r){if(this.hierarchy[n].finalTransform.mProp._mdf){this.finalTransform._matMdf=!0;break}n+=1}if(this.finalTransform._matMdf)for(t=this.finalTransform.mProp.v.props,e.cloneFromProps(t),n=0;n<r;n+=1)t=this.hierarchy[n].finalTransform.mProp.v.props,e.transform(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}},globalToLocal:function(t){var e=[];e.push(this.finalTransform);var n,r=!0,i=this.comp;while(r)i.finalTransform?(i.data.hasMask&&e.splice(0,0,i.finalTransform),i=i.comp):r=!1;var o,a=e.length;for(n=0;n<a;n+=1)o=e[n].mat.applyToPointArray(0,0,0),t=[t[0]-o[0],t[1]-o[1],0];return t},mHelper:new Matrix},RenderableElement.prototype={initRenderable:function(){this.isInRange=!1,this.hidden=!1,this.isTransparent=!1,this.renderableComponents=[]},addRenderableComponent:function(t){-1===this.renderableComponents.indexOf(t)&&this.renderableComponents.push(t)},removeRenderableComponent:function(t){-1!==this.renderableComponents.indexOf(t)&&this.renderableComponents.splice(this.renderableComponents.indexOf(t),1)},prepareRenderableFrame:function(t){this.checkLayerLimits(t)},checkTransparency:function(){this.finalTransform.mProp.o.v<=0?!this.isTransparent&&this.globalData.renderConfig.hideOnTransparent&&(this.isTransparent=!0,this.hide()):this.isTransparent&&(this.isTransparent=!1,this.show())},checkLayerLimits:function(t){this.data.ip-this.data.st<=t&&this.data.op-this.data.st>t?!0!==this.isInRange&&(this.globalData._mdf=!0,this._mdf=!0,this.isInRange=!0,this.show()):!1!==this.isInRange&&(this.globalData._mdf=!0,this.isInRange=!1,this.hide())},renderRenderable:function(){var t,e=this.renderableComponents.length;for(t=0;t<e;t+=1)this.renderableComponents[t].renderFrame(this._isFirstFrame)},sourceRectAtTime:function(){return{top:0,left:0,width:100,height:100}},getLayerSize:function(){return 5===this.data.ty?{w:this.data.textData.width,h:this.data.textData.height}:{w:this.data.width,h:this.data.height}}},function(){var t={initElement:function(t,e,n){this.initFrame(),this.initBaseData(t,e,n),this.initTransform(t,e,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide()},hide:function(){if(!this.hidden&&(!this.isInRange||this.isTransparent)){var t=this.baseElement||this.layerElement;t.style.display="none",this.hidden=!0}},show:function(){if(this.isInRange&&!this.isTransparent){if(!this.data.hd){var t=this.baseElement||this.layerElement;t.style.display="block"}this.hidden=!1,this._isFirstFrame=!0}},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},renderInnerContent:function(){},prepareFrame:function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.checkTransparency()},destroy:function(){this.innerElem=null,this.destroyBaseElement()}};extendPrototype([RenderableElement,createProxyFunction(t)],RenderableDOMElement)}(),SVGStyleData.prototype.reset=function(){this.d="",this._mdf=!1},SVGShapeData.prototype.setAsAnimated=function(){this._isAnimated=!0},extendPrototype([DynamicPropertyContainer],SVGStrokeStyleData),extendPrototype([DynamicPropertyContainer],SVGFillStyleData),SVGGradientFillStyleData.prototype.initGradientData=function(t,e,n){this.o=PropertyFactory.getProp(t,e.o,0,.01,this),this.s=PropertyFactory.getProp(t,e.s,1,null,this),this.e=PropertyFactory.getProp(t,e.e,1,null,this),this.h=PropertyFactory.getProp(t,e.h||{k:0},0,.01,this),this.a=PropertyFactory.getProp(t,e.a||{k:0},0,degToRads,this),this.g=new GradientProperty(t,e.g,this),this.style=n,this.stops=[],this.setGradientData(n.pElem,e),this.setGradientOpacity(e,n),this._isAnimated=!!this._isAnimated},SVGGradientFillStyleData.prototype.setGradientData=function(t,e){var n=createElementID(),r=createNS(1===e.t?"linearGradient":"radialGradient");r.setAttribute("id",n),r.setAttribute("spreadMethod","pad"),r.setAttribute("gradientUnits","userSpaceOnUse");var i,o,a,s=[];for(a=4*e.g.p,o=0;o<a;o+=4)i=createNS("stop"),r.appendChild(i),s.push(i);t.setAttribute("gf"===e.ty?"fill":"stroke","url("+locationHref+"#"+n+")"),this.gf=r,this.cst=s},SVGGradientFillStyleData.prototype.setGradientOpacity=function(t,e){if(this.g._hasOpacity&&!this.g._collapsable){var n,r,i,o=createNS("mask"),a=createNS("path");o.appendChild(a);var s=createElementID(),u=createElementID();o.setAttribute("id",u);var c=createNS(1===t.t?"linearGradient":"radialGradient");c.setAttribute("id",s),c.setAttribute("spreadMethod","pad"),c.setAttribute("gradientUnits","userSpaceOnUse"),i=t.g.k.k[0].s?t.g.k.k[0].s.length:t.g.k.k.length;var l=this.stops;for(r=4*t.g.p;r<i;r+=2)n=createNS("stop"),n.setAttribute("stop-color","rgb(255,255,255)"),c.appendChild(n),l.push(n);a.setAttribute("gf"===t.ty?"fill":"stroke","url("+locationHref+"#"+s+")"),this.of=c,this.ms=o,this.ost=l,this.maskId=u,e.msElem=a}},extendPrototype([DynamicPropertyContainer],SVGGradientFillStyleData),extendPrototype([SVGGradientFillStyleData,DynamicPropertyContainer],SVGGradientStrokeStyleData);var SVGElementsRenderer=function(){var t=new Matrix,e=new Matrix,n={createRenderFunction:r};function r(t){switch(t.ty){case"fl":return a;case"gf":return u;case"gs":return s;case"st":return c;case"sh":case"el":case"rc":case"sr":return o;case"tr":return i;default:return null}}function i(t,e,n){(n||e.transform.op._mdf)&&e.transform.container.setAttribute("opacity",e.transform.op.v),(n||e.transform.mProps._mdf)&&e.transform.container.setAttribute("transform",e.transform.mProps.v.to2dCSS())}function o(n,r,i){var o,a,s,u,c,l,h,f,p,d,m,v=r.styles.length,g=r.lvl;for(l=0;l<v;l+=1){if(u=r.sh._mdf||i,r.styles[l].lvl<g){f=e.reset(),d=g-r.styles[l].lvl,m=r.transformers.length-1;while(!u&&d>0)u=r.transformers[m].mProps._mdf||u,d-=1,m-=1;if(u){d=g-r.styles[l].lvl,m=r.transformers.length-1;while(d>0)p=r.transformers[m].mProps.v.props,f.transform(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],p[9],p[10],p[11],p[12],p[13],p[14],p[15]),d-=1,m-=1}}else f=t;if(h=r.sh.paths,a=h._length,u){for(s="",o=0;o<a;o+=1)c=h.shapes[o],c&&c._length&&(s+=buildShapeString(c,c._length,c.c,f));r.caches[l]=s}else s=r.caches[l];r.styles[l].d+=!0===n.hd?"":s,r.styles[l]._mdf=u||r.styles[l]._mdf}}function a(t,e,n){var r=e.style;(e.c._mdf||n)&&r.pElem.setAttribute("fill","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||n)&&r.pElem.setAttribute("fill-opacity",e.o.v)}function s(t,e,n){u(t,e,n),c(t,e,n)}function u(t,e,n){var r,i,o,a,s,u=e.gf,c=e.g._hasOpacity,l=e.s.v,h=e.e.v;if(e.o._mdf||n){var f="gf"===t.ty?"fill-opacity":"stroke-opacity";e.style.pElem.setAttribute(f,e.o.v)}if(e.s._mdf||n){var p=1===t.t?"x1":"cx",d="x1"===p?"y1":"cy";u.setAttribute(p,l[0]),u.setAttribute(d,l[1]),c&&!e.g._collapsable&&(e.of.setAttribute(p,l[0]),e.of.setAttribute(d,l[1]))}if(e.g._cmdf||n){r=e.cst;var m=e.g.c;for(o=r.length,i=0;i<o;i+=1)a=r[i],a.setAttribute("offset",m[4*i]+"%"),a.setAttribute("stop-color","rgb("+m[4*i+1]+","+m[4*i+2]+","+m[4*i+3]+")")}if(c&&(e.g._omdf||n)){var v=e.g.o;for(r=e.g._collapsable?e.cst:e.ost,o=r.length,i=0;i<o;i+=1)a=r[i],e.g._collapsable||a.setAttribute("offset",v[2*i]+"%"),a.setAttribute("stop-opacity",v[2*i+1])}if(1===t.t)(e.e._mdf||n)&&(u.setAttribute("x2",h[0]),u.setAttribute("y2",h[1]),c&&!e.g._collapsable&&(e.of.setAttribute("x2",h[0]),e.of.setAttribute("y2",h[1])));else if((e.s._mdf||e.e._mdf||n)&&(s=Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)),u.setAttribute("r",s),c&&!e.g._collapsable&&e.of.setAttribute("r",s)),e.e._mdf||e.h._mdf||e.a._mdf||n){s||(s=Math.sqrt(Math.pow(l[0]-h[0],2)+Math.pow(l[1]-h[1],2)));var g=Math.atan2(h[1]-l[1],h[0]-l[0]),y=e.h.v;y>=1?y=.99:y<=-1&&(y=-.99);var b=s*y,x=Math.cos(g+e.a.v)*b+l[0],w=Math.sin(g+e.a.v)*b+l[1];u.setAttribute("fx",x),u.setAttribute("fy",w),c&&!e.g._collapsable&&(e.of.setAttribute("fx",x),e.of.setAttribute("fy",w))}}function c(t,e,n){var r=e.style,i=e.d;i&&(i._mdf||n)&&i.dashStr&&(r.pElem.setAttribute("stroke-dasharray",i.dashStr),r.pElem.setAttribute("stroke-dashoffset",i.dashoffset[0])),e.c&&(e.c._mdf||n)&&r.pElem.setAttribute("stroke","rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||n)&&r.pElem.setAttribute("stroke-opacity",e.o.v),(e.w._mdf||n)&&(r.pElem.setAttribute("stroke-width",e.w.v),r.msElem&&r.msElem.setAttribute("stroke-width",e.w.v))}return n}();function ShapeTransformManager(){this.sequences={},this.sequenceList=[],this.transform_key_count=0}function CVShapeData(t,e,n,r){this.styledShapes=[],this.tr=[0,0,0,0,0,0];var i,o=4;"rc"===e.ty?o=5:"el"===e.ty?o=6:"sr"===e.ty&&(o=7),this.sh=ShapePropertyFactory.getShapeProp(t,e,o,t);var a,s=n.length;for(i=0;i<s;i+=1)n[i].closed||(a={transforms:r.addTransformSequence(n[i].transforms),trNodes:[]},this.styledShapes.push(a),n[i].elements.push(a))}function BaseElement(){}function NullElement(t,e,n){this.initFrame(),this.initBaseData(t,e,n),this.initFrame(),this.initTransform(t,e,n),this.initHierarchy()}function SVGBaseElement(){}function IShapeElement(){}function ITextElement(){}function ICompElement(){}function IImageElement(t,e,n){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,n),this.sourceRect={top:0,left:0,width:this.assetData.w,height:this.assetData.h}}function ISolidElement(t,e,n){this.initElement(t,e,n)}function AudioElement(t,e,n){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.initBaseData(t,e,n),this._isPlaying=!1,this._canPlay=!1;var r=this.globalData.getAssetsPath(this.assetData);this.audio=this.globalData.audioController.createAudio(r),this._currentTime=0,this.globalData.audioController.addAudio(this),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function FootageElement(t,e,n){this.initFrame(),this.initRenderable(),this.assetData=e.getAssetData(t.refId),this.footageData=e.imageLoader.getAsset(this.assetData),this.initBaseData(t,e,n)}function SVGCompElement(t,e,n){this.layers=t.layers,this.supports3d=!0,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,n),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function SVGTextLottieElement(t,e,n){this.textSpans=[],this.renderType="svg",this.initElement(t,e,n)}function SVGShapeElement(t,e,n){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.initElement(t,e,n),this.prevViewData=[]}function SVGTintFilter(t,e){this.filterManager=e;var n=createNS("feColorMatrix");if(n.setAttribute("type","matrix"),n.setAttribute("color-interpolation-filters","linearRGB"),n.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),n.setAttribute("result","f1"),t.appendChild(n),n=createNS("feColorMatrix"),n.setAttribute("type","matrix"),n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),n.setAttribute("result","f2"),t.appendChild(n),this.matrixFilter=n,100!==e.effectElements[2].p.v||e.effectElements[2].p.k){var r,i=createNS("feMerge");t.appendChild(i),r=createNS("feMergeNode"),r.setAttribute("in","SourceGraphic"),i.appendChild(r),r=createNS("feMergeNode"),r.setAttribute("in","f2"),i.appendChild(r)}}function SVGFillFilter(t,e){this.filterManager=e;var n=createNS("feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("values","1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0"),t.appendChild(n),this.matrixFilter=n}function SVGGaussianBlurEffect(t,e){t.setAttribute("x","-100%"),t.setAttribute("y","-100%"),t.setAttribute("width","300%"),t.setAttribute("height","300%"),this.filterManager=e;var n=createNS("feGaussianBlur");t.appendChild(n),this.feGaussianBlur=n}function SVGStrokeEffect(t,e){this.initialized=!1,this.filterManager=e,this.elem=t,this.paths=[]}function SVGTritoneFilter(t,e){this.filterManager=e;var n=createNS("feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("color-interpolation-filters","linearRGB"),n.setAttribute("values","0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0"),n.setAttribute("result","f1"),t.appendChild(n);var r=createNS("feComponentTransfer");r.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(r),this.matrixFilter=r;var i=createNS("feFuncR");i.setAttribute("type","table"),r.appendChild(i),this.feFuncR=i;var o=createNS("feFuncG");o.setAttribute("type","table"),r.appendChild(o),this.feFuncG=o;var a=createNS("feFuncB");a.setAttribute("type","table"),r.appendChild(a),this.feFuncB=a}function SVGProLevelsFilter(t,e){this.filterManager=e;var n=this.filterManager.effectElements,r=createNS("feComponentTransfer");(n[10].p.k||0!==n[10].p.v||n[11].p.k||1!==n[11].p.v||n[12].p.k||1!==n[12].p.v||n[13].p.k||0!==n[13].p.v||n[14].p.k||1!==n[14].p.v)&&(this.feFuncR=this.createFeFunc("feFuncR",r)),(n[17].p.k||0!==n[17].p.v||n[18].p.k||1!==n[18].p.v||n[19].p.k||1!==n[19].p.v||n[20].p.k||0!==n[20].p.v||n[21].p.k||1!==n[21].p.v)&&(this.feFuncG=this.createFeFunc("feFuncG",r)),(n[24].p.k||0!==n[24].p.v||n[25].p.k||1!==n[25].p.v||n[26].p.k||1!==n[26].p.v||n[27].p.k||0!==n[27].p.v||n[28].p.k||1!==n[28].p.v)&&(this.feFuncB=this.createFeFunc("feFuncB",r)),(n[31].p.k||0!==n[31].p.v||n[32].p.k||1!==n[32].p.v||n[33].p.k||1!==n[33].p.v||n[34].p.k||0!==n[34].p.v||n[35].p.k||1!==n[35].p.v)&&(this.feFuncA=this.createFeFunc("feFuncA",r)),(this.feFuncR||this.feFuncG||this.feFuncB||this.feFuncA)&&(r.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(r),r=createNS("feComponentTransfer")),(n[3].p.k||0!==n[3].p.v||n[4].p.k||1!==n[4].p.v||n[5].p.k||1!==n[5].p.v||n[6].p.k||0!==n[6].p.v||n[7].p.k||1!==n[7].p.v)&&(r.setAttribute("color-interpolation-filters","sRGB"),t.appendChild(r),this.feFuncRComposed=this.createFeFunc("feFuncR",r),this.feFuncGComposed=this.createFeFunc("feFuncG",r),this.feFuncBComposed=this.createFeFunc("feFuncB",r))}function SVGDropShadowEffect(t,e){var n=e.container.globalData.renderConfig.filterSize;t.setAttribute("x",n.x),t.setAttribute("y",n.y),t.setAttribute("width",n.width),t.setAttribute("height",n.height),this.filterManager=e;var r=createNS("feGaussianBlur");r.setAttribute("in","SourceAlpha"),r.setAttribute("result","drop_shadow_1"),r.setAttribute("stdDeviation","0"),this.feGaussianBlur=r,t.appendChild(r);var i=createNS("feOffset");i.setAttribute("dx","25"),i.setAttribute("dy","0"),i.setAttribute("in","drop_shadow_1"),i.setAttribute("result","drop_shadow_2"),this.feOffset=i,t.appendChild(i);var o=createNS("feFlood");o.setAttribute("flood-color","#00ff00"),o.setAttribute("flood-opacity","1"),o.setAttribute("result","drop_shadow_3"),this.feFlood=o,t.appendChild(o);var a=createNS("feComposite");a.setAttribute("in","drop_shadow_3"),a.setAttribute("in2","drop_shadow_2"),a.setAttribute("operator","in"),a.setAttribute("result","drop_shadow_4"),t.appendChild(a);var s,u=createNS("feMerge");t.appendChild(u),s=createNS("feMergeNode"),u.appendChild(s),s=createNS("feMergeNode"),s.setAttribute("in","SourceGraphic"),this.feMergeNode=s,this.feMerge=u,this.originalNodeAdded=!1,u.appendChild(s)}ShapeTransformManager.prototype={addTransformSequence:function(t){var e,n=t.length,r="_";for(e=0;e<n;e+=1)r+=t[e].transform.key+"_";var i=this.sequences[r];return i||(i={transforms:[].concat(t),finalTransform:new Matrix,_mdf:!1},this.sequences[r]=i,this.sequenceList.push(i)),i},processSequence:function(t,e){var n,r=0,i=t.transforms.length,o=e;while(r<i&&!e){if(t.transforms[r].transform.mProps._mdf){o=!0;break}r+=1}if(o)for(t.finalTransform.reset(),r=i-1;r>=0;r-=1)n=t.transforms[r].transform.mProps.v.props,t.finalTransform.transform(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15]);t._mdf=o},processSequences:function(t){var e,n=this.sequenceList.length;for(e=0;e<n;e+=1)this.processSequence(this.sequenceList[e],t)},getNewKey:function(){return this.transform_key_count+=1,"_"+this.transform_key_count}},CVShapeData.prototype.setAsAnimated=SVGShapeData.prototype.setAsAnimated,BaseElement.prototype={checkMasks:function(){if(!this.data.hasMask)return!1;var t=0,e=this.data.masksProperties.length;while(t<e){if("n"!==this.data.masksProperties[t].mode&&!1!==this.data.masksProperties[t].cl)return!0;t+=1}return!1},initExpressions:function(){this.layerInterface=LayerExpressionInterface(this),this.data.hasMask&&this.maskManager&&this.layerInterface.registerMaskInterface(this.maskManager);var t=EffectsExpressionInterface.createEffectsInterface(this,this.layerInterface);this.layerInterface.registerEffectsInterface(t),0===this.data.ty||this.data.xt?this.compInterface=CompExpressionInterface(this):4===this.data.ty?(this.layerInterface.shapeInterface=ShapeExpressionInterface(this.shapesData,this.itemsData,this.layerInterface),this.layerInterface.content=this.layerInterface.shapeInterface):5===this.data.ty&&(this.layerInterface.textInterface=TextExpressionInterface(this),this.layerInterface.text=this.layerInterface.textInterface)},setBlendMode:function(){var t=getBlendMode(this.data.bm),e=this.baseElement||this.layerElement;e.style["mix-blend-mode"]=t},initBaseData:function(t,e,n){this.globalData=e,this.comp=n,this.data=t,this.layerId=createElementID(),this.data.sr||(this.data.sr=1),this.effectsManager=new EffectsManager(this.data,this,this.dynamicProperties)},getType:function(){return this.type},sourceRectAtTime:function(){}},NullElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},NullElement.prototype.renderFrame=function(){},NullElement.prototype.getBaseElement=function(){return null},NullElement.prototype.destroy=function(){},NullElement.prototype.sourceRectAtTime=function(){},NullElement.prototype.hide=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement],NullElement),SVGBaseElement.prototype={initRendererElement:function(){this.layerElement=createNS("g")},createContainerElements:function(){this.matteElement=createNS("g"),this.transformedElement=this.layerElement,this.maskedElement=this.layerElement,this._sizeChanged=!1;var t,e,n,r=null;if(this.data.td){if(3==this.data.td||1==this.data.td){var i=createNS("mask");i.setAttribute("id",this.layerId),i.setAttribute("mask-type",3==this.data.td?"luminance":"alpha"),i.appendChild(this.layerElement),r=i,this.globalData.defs.appendChild(i),featureSupport.maskType||1!=this.data.td||(i.setAttribute("mask-type","luminance"),t=createElementID(),e=filtersFactory.createFilter(t),this.globalData.defs.appendChild(e),e.appendChild(filtersFactory.createAlphaToLuminanceFilter()),n=createNS("g"),n.appendChild(this.layerElement),r=n,i.appendChild(n),n.setAttribute("filter","url("+locationHref+"#"+t+")"))}else if(2==this.data.td){var o=createNS("mask");o.setAttribute("id",this.layerId),o.setAttribute("mask-type","alpha");var a=createNS("g");o.appendChild(a),t=createElementID(),e=filtersFactory.createFilter(t);var s=createNS("feComponentTransfer");s.setAttribute("in","SourceGraphic"),e.appendChild(s);var u=createNS("feFuncA");u.setAttribute("type","table"),u.setAttribute("tableValues","1.0 0.0"),s.appendChild(u),this.globalData.defs.appendChild(e);var c=createNS("rect");c.setAttribute("width",this.comp.data.w),c.setAttribute("height",this.comp.data.h),c.setAttribute("x","0"),c.setAttribute("y","0"),c.setAttribute("fill","#ffffff"),c.setAttribute("opacity","0"),a.setAttribute("filter","url("+locationHref+"#"+t+")"),a.appendChild(c),a.appendChild(this.layerElement),r=a,featureSupport.maskType||(o.setAttribute("mask-type","luminance"),e.appendChild(filtersFactory.createAlphaToLuminanceFilter()),n=createNS("g"),a.appendChild(c),n.appendChild(this.layerElement),r=n,a.appendChild(n)),this.globalData.defs.appendChild(o)}}else this.data.tt?(this.matteElement.appendChild(this.layerElement),r=this.matteElement,this.baseElement=this.matteElement):this.baseElement=this.layerElement;if(this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0===this.data.ty&&!this.data.hd){var l=createNS("clipPath"),h=createNS("path");h.setAttribute("d","M0,0 L"+this.data.w+",0 L"+this.data.w+","+this.data.h+" L0,"+this.data.h+"z");var f=createElementID();if(l.setAttribute("id",f),l.appendChild(h),this.globalData.defs.appendChild(l),this.checkMasks()){var p=createNS("g");p.setAttribute("clip-path","url("+locationHref+"#"+f+")"),p.appendChild(this.layerElement),this.transformedElement=p,r?r.appendChild(this.transformedElement):this.baseElement=this.transformedElement}else this.layerElement.setAttribute("clip-path","url("+locationHref+"#"+f+")")}0!==this.data.bm&&this.setBlendMode()},renderElement:function(){this.finalTransform._matMdf&&this.transformedElement.setAttribute("transform",this.finalTransform.mat.to2dCSS()),this.finalTransform._opMdf&&this.transformedElement.setAttribute("opacity",this.finalTransform.mProp.o.v)},destroyBaseElement:function(){this.layerElement=null,this.matteElement=null,this.maskManager.destroy()},getBaseElement:function(){return this.data.hd?null:this.baseElement},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData),this.renderableEffectsManager=new SVGEffects(this)},setMatte:function(t){this.matteElement&&this.matteElement.setAttribute("mask","url("+locationHref+"#"+t+")")}},IShapeElement.prototype={addShapeToModifiers:function(t){var e,n=this.shapeModifiers.length;for(e=0;e<n;e+=1)this.shapeModifiers[e].addShape(t)},isShapeInAnimatedModifiers:function(t){var e=0,n=this.shapeModifiers.length;while(e<n)if(this.shapeModifiers[e].isAnimatedWithShape(t))return!0;return!1},renderModifiers:function(){if(this.shapeModifiers.length){var t,e,n=this.shapes.length;for(t=0;t<n;t+=1)this.shapes[t].sh.reset();for(n=this.shapeModifiers.length,t=n-1;t>=0;t-=1)if(e=this.shapeModifiers[t].processShapes(this._isFirstFrame),e)break}},lcEnum:{1:"butt",2:"round",3:"square"},ljEnum:{1:"miter",2:"round",3:"bevel"},searchProcessedElement:function(t){var e=this.processedElements,n=0,r=e.length;while(n<r){if(e[n].elem===t)return e[n].pos;n+=1}return 0},addProcessedElement:function(t,e){var n=this.processedElements,r=n.length;while(r)if(r-=1,n[r].elem===t)return void(n[r].pos=e);n.push(new ProcessedElement(t,e))},prepareFrame:function(t){this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange)}},ITextElement.prototype.initElement=function(t,e,n){this.lettersChangedFlag=!0,this.initFrame(),this.initBaseData(t,e,n),this.textProperty=new TextProperty(this,t.t,this.dynamicProperties),this.textAnimator=new TextAnimatorProperty(t.t,this.renderType,this),this.initTransform(t,e,n),this.initHierarchy(),this.initRenderable(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),this.createContent(),this.hide(),this.textAnimator.searchProperties(this.dynamicProperties)},ITextElement.prototype.prepareFrame=function(t){this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),(this.textProperty._mdf||this.textProperty._isFirstFrame)&&(this.buildNewText(),this.textProperty._isFirstFrame=!1,this.textProperty._mdf=!1)},ITextElement.prototype.createPathShape=function(t,e){var n,r,i=e.length,o="";for(n=0;n<i;n+=1)r=e[n].ks.k,o+=buildShapeString(r,r.i.length,!0,t);return o},ITextElement.prototype.updateDocumentData=function(t,e){this.textProperty.updateDocumentData(t,e)},ITextElement.prototype.canResizeFont=function(t){this.textProperty.canResizeFont(t)},ITextElement.prototype.setMinimumFontSize=function(t){this.textProperty.setMinimumFontSize(t)},ITextElement.prototype.applyTextPropertiesToMatrix=function(t,e,n,r,i){switch(t.ps&&e.translate(t.ps[0],t.ps[1]+t.ascent,0),e.translate(0,-t.ls,0),t.j){case 1:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[n]),0,0);break;case 2:e.translate(t.justifyOffset+(t.boxWidth-t.lineWidths[n])/2,0,0);break;default:break}e.translate(r,i,0)},ITextElement.prototype.buildColor=function(t){return"rgb("+Math.round(255*t[0])+","+Math.round(255*t[1])+","+Math.round(255*t[2])+")"},ITextElement.prototype.emptyProp=new LetterProps,ITextElement.prototype.destroy=function(){},extendPrototype([BaseElement,TransformElement,HierarchyElement,FrameElement,RenderableDOMElement],ICompElement),ICompElement.prototype.initElement=function(t,e,n){this.initFrame(),this.initBaseData(t,e,n),this.initTransform(t,e,n),this.initRenderable(),this.initHierarchy(),this.initRendererElement(),this.createContainerElements(),this.createRenderableComponents(),!this.data.xt&&e.progressiveLoad||this.buildAllItems(),this.hide()},ICompElement.prototype.prepareFrame=function(t){if(this._mdf=!1,this.prepareRenderableFrame(t),this.prepareProperties(t,this.isInRange),this.isInRange||this.data.xt){if(this.tm._placeholder)this.renderedFrame=t/this.data.sr;else{var e=this.tm.v;e===this.data.op&&(e=this.data.op-1),this.renderedFrame=e}var n,r=this.elements.length;for(this.completeLayers||this.checkLayers(this.renderedFrame),n=r-1;n>=0;n-=1)(this.completeLayers||this.elements[n])&&(this.elements[n].prepareFrame(this.renderedFrame-this.layers[n].st),this.elements[n]._mdf&&(this._mdf=!0))}},ICompElement.prototype.renderInnerContent=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},ICompElement.prototype.setElements=function(t){this.elements=t},ICompElement.prototype.getElements=function(){return this.elements},ICompElement.prototype.destroyElements=function(){var t,e=this.layers.length;for(t=0;t<e;t+=1)this.elements[t]&&this.elements[t].destroy()},ICompElement.prototype.destroy=function(){this.destroyElements(),this.destroyBaseElement()},extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],IImageElement),IImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData);this.innerElem=createNS("image"),this.innerElem.setAttribute("width",this.assetData.w+"px"),this.innerElem.setAttribute("height",this.assetData.h+"px"),this.innerElem.setAttribute("preserveAspectRatio",this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio),this.innerElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.innerElem)},IImageElement.prototype.sourceRectAtTime=function(){return this.sourceRect},extendPrototype([IImageElement],ISolidElement),ISolidElement.prototype.createContent=function(){var t=createNS("rect");t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.layerElement.appendChild(t)},AudioElement.prototype.prepareFrame=function(t){if(this.prepareRenderableFrame(t,!0),this.prepareProperties(t,!0),this.tm._placeholder)this._currentTime=t/this.data.sr;else{var e=this.tm.v;this._currentTime=e}},extendPrototype([RenderableElement,BaseElement,FrameElement],AudioElement),AudioElement.prototype.renderFrame=function(){this.isInRange&&this._canPlay&&(this._isPlaying?(!this.audio.playing()||Math.abs(this._currentTime/this.globalData.frameRate-this.audio.seek())>.1)&&this.audio.seek(this._currentTime/this.globalData.frameRate):(this.audio.play(),this.audio.seek(this._currentTime/this.globalData.frameRate),this._isPlaying=!0))},AudioElement.prototype.show=function(){},AudioElement.prototype.hide=function(){this.audio.pause(),this._isPlaying=!1},AudioElement.prototype.pause=function(){this.audio.pause(),this._isPlaying=!1,this._canPlay=!1},AudioElement.prototype.resume=function(){this._canPlay=!0},AudioElement.prototype.setRate=function(t){this.audio.rate(t)},AudioElement.prototype.volume=function(t){this.audio.volume(t)},AudioElement.prototype.getBaseElement=function(){return null},AudioElement.prototype.destroy=function(){},AudioElement.prototype.sourceRectAtTime=function(){},AudioElement.prototype.initExpressions=function(){},FootageElement.prototype.prepareFrame=function(){},extendPrototype([RenderableElement,BaseElement,FrameElement],FootageElement),FootageElement.prototype.getBaseElement=function(){return null},FootageElement.prototype.renderFrame=function(){},FootageElement.prototype.destroy=function(){},FootageElement.prototype.initExpressions=function(){this.layerInterface=FootageInterface(this)},FootageElement.prototype.getFootageData=function(){return this.footageData},extendPrototype([SVGRenderer,ICompElement,SVGBaseElement],SVGCompElement),extendPrototype([BaseElement,TransformElement,SVGBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],SVGTextLottieElement),SVGTextLottieElement.prototype.createContent=function(){this.data.singleShape&&!this.globalData.fontManager.chars&&(this.textContainer=createNS("text"))},SVGTextLottieElement.prototype.buildTextContents=function(t){var e=0,n=t.length,r=[],i="";while(e<n)t[e]===String.fromCharCode(13)||t[e]===String.fromCharCode(3)?(r.push(i),i=""):i+=t[e],e+=1;return r.push(i),r},SVGTextLottieElement.prototype.buildNewText=function(){var t,e,n=this.textProperty.currentData;this.renderedLetters=createSizedArray(n?n.l.length:0),n.fc?this.layerElement.setAttribute("fill",this.buildColor(n.fc)):this.layerElement.setAttribute("fill","rgba(0,0,0,0)"),n.sc&&(this.layerElement.setAttribute("stroke",this.buildColor(n.sc)),this.layerElement.setAttribute("stroke-width",n.sw)),this.layerElement.setAttribute("font-size",n.finalSize);var r=this.globalData.fontManager.getFontByName(n.f);if(r.fClass)this.layerElement.setAttribute("class",r.fClass);else{this.layerElement.setAttribute("font-family",r.fFamily);var i=n.fWeight,o=n.fStyle;this.layerElement.setAttribute("font-style",o),this.layerElement.setAttribute("font-weight",i)}this.layerElement.setAttribute("aria-label",n.t);var a,s=n.l||[],u=!!this.globalData.fontManager.chars;e=s.length;var c,l=this.mHelper,h="",f=this.data.singleShape,p=0,d=0,m=!0,v=.001*n.tr*n.finalSize;if(!f||u||n.sz){var g,y,b=this.textSpans.length;for(t=0;t<e;t+=1)u&&f&&0!==t||(a=b>t?this.textSpans[t]:createNS(u?"path":"text"),b<=t&&(a.setAttribute("stroke-linecap","butt"),a.setAttribute("stroke-linejoin","round"),a.setAttribute("stroke-miterlimit","4"),this.textSpans[t]=a,this.layerElement.appendChild(a)),a.style.display="inherit"),l.reset(),l.scale(n.finalSize/100,n.finalSize/100),f&&(s[t].n&&(p=-v,d+=n.yOffset,d+=m?1:0,m=!1),this.applyTextPropertiesToMatrix(n,l,s[t].line,p,d),p+=s[t].l||0,p+=v),u?(y=this.globalData.fontManager.getCharData(n.finalText[t],r.fStyle,this.globalData.fontManager.getFontByName(n.f).fFamily),g=y&&y.data||{},c=g.shapes?g.shapes[0].it:[],f?h+=this.createPathShape(l,c):a.setAttribute("d",this.createPathShape(l,c))):(f&&a.setAttribute("transform","translate("+l.props[12]+","+l.props[13]+")"),a.textContent=s[t].val,a.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"));f&&a&&a.setAttribute("d",h)}else{var x=this.textContainer,w="start";switch(n.j){case 1:w="end";break;case 2:w="middle";break;default:w="start";break}x.setAttribute("text-anchor",w),x.setAttribute("letter-spacing",v);var E=this.buildTextContents(n.finalText);for(e=E.length,d=n.ps?n.ps[1]+n.ascent:0,t=0;t<e;t+=1)a=this.textSpans[t]||createNS("tspan"),a.textContent=E[t],a.setAttribute("x",0),a.setAttribute("y",d),a.style.display="inherit",x.appendChild(a),this.textSpans[t]=a,d+=n.finalLineHeight;this.layerElement.appendChild(x)}while(t<this.textSpans.length)this.textSpans[t].style.display="none",t+=1;this._sizeChanged=!0},SVGTextLottieElement.prototype.sourceRectAtTime=function(){if(this.prepareFrame(this.comp.renderedFrame-this.data.st),this.renderInnerContent(),this._sizeChanged){this._sizeChanged=!1;var t=this.layerElement.getBBox();this.bbox={top:t.y,left:t.x,width:t.width,height:t.height}}return this.bbox},SVGTextLottieElement.prototype.renderInnerContent=function(){if(!this.data.singleShape&&(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag)){var t,e;this._sizeChanged=!0;var n,r,i=this.textAnimator.renderedLetters,o=this.textProperty.currentData.l;for(e=o.length,t=0;t<e;t+=1)o[t].n||(n=i[t],r=this.textSpans[t],n._mdf.m&&r.setAttribute("transform",n.m),n._mdf.o&&r.setAttribute("opacity",n.o),n._mdf.sw&&r.setAttribute("stroke-width",n.sw),n._mdf.sc&&r.setAttribute("stroke",n.sc),n._mdf.fc&&r.setAttribute("fill",n.fc))}},extendPrototype([BaseElement,TransformElement,SVGBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableDOMElement],SVGShapeElement),SVGShapeElement.prototype.initSecondaryElement=function(){},SVGShapeElement.prototype.identityMatrix=new Matrix,SVGShapeElement.prototype.buildExpressionInterface=function(){},SVGShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes()},SVGShapeElement.prototype.filterUniqueShapes=function(){var t,e,n,r,i=this.shapes.length,o=this.stylesList.length,a=[],s=!1;for(n=0;n<o;n+=1){for(r=this.stylesList[n],s=!1,a.length=0,t=0;t<i;t+=1)e=this.shapes[t],-1!==e.styles.indexOf(r)&&(a.push(e),s=e._isAnimated||s);a.length>1&&s&&this.setShapesAsAnimated(a)}},SVGShapeElement.prototype.setShapesAsAnimated=function(t){var e,n=t.length;for(e=0;e<n;e+=1)t[e].setAsAnimated()},SVGShapeElement.prototype.createStyleElement=function(t,e){var n,r=new SVGStyleData(t,e),i=r.pElem;if("st"===t.ty)n=new SVGStrokeStyleData(this,t,r);else if("fl"===t.ty)n=new SVGFillStyleData(this,t,r);else if("gf"===t.ty||"gs"===t.ty){var o="gf"===t.ty?SVGGradientFillStyleData:SVGGradientStrokeStyleData;n=new o(this,t,r),this.globalData.defs.appendChild(n.gf),n.maskId&&(this.globalData.defs.appendChild(n.ms),this.globalData.defs.appendChild(n.of),i.setAttribute("mask","url("+locationHref+"#"+n.maskId+")"))}return"st"!==t.ty&&"gs"!==t.ty||(i.setAttribute("stroke-linecap",this.lcEnum[t.lc]||"round"),i.setAttribute("stroke-linejoin",this.ljEnum[t.lj]||"round"),i.setAttribute("fill-opacity","0"),1===t.lj&&i.setAttribute("stroke-miterlimit",t.ml)),2===t.r&&i.setAttribute("fill-rule","evenodd"),t.ln&&i.setAttribute("id",t.ln),t.cl&&i.setAttribute("class",t.cl),t.bm&&(i.style["mix-blend-mode"]=getBlendMode(t.bm)),this.stylesList.push(r),this.addToAnimatedContents(t,n),n},SVGShapeElement.prototype.createGroupElement=function(t){var e=new ShapeGroupData;return t.ln&&e.gr.setAttribute("id",t.ln),t.cl&&e.gr.setAttribute("class",t.cl),t.bm&&(e.gr.style["mix-blend-mode"]=getBlendMode(t.bm)),e},SVGShapeElement.prototype.createTransformElement=function(t,e){var n=TransformPropertyFactory.getTransformProperty(this,t,this),r=new SVGTransformData(n,n.o,e);return this.addToAnimatedContents(t,r),r},SVGShapeElement.prototype.createShapeElement=function(t,e,n){var r=4;"rc"===t.ty?r=5:"el"===t.ty?r=6:"sr"===t.ty&&(r=7);var i=ShapePropertyFactory.getShapeProp(this,t,r,this),o=new SVGShapeData(e,n,i);return this.shapes.push(o),this.addShapeToModifiers(o),this.addToAnimatedContents(t,o),o},SVGShapeElement.prototype.addToAnimatedContents=function(t,e){var n=0,r=this.animatedContents.length;while(n<r){if(this.animatedContents[n].element===e)return;n+=1}this.animatedContents.push({fn:SVGElementsRenderer.createRenderFunction(t),element:e,data:t})},SVGShapeElement.prototype.setElementStyles=function(t){var e,n=t.styles,r=this.stylesList.length;for(e=0;e<r;e+=1)this.stylesList[e].closed||n.push(this.stylesList[e])},SVGShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.layerElement,0,[],!0),this.filterUniqueShapes(),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers()},SVGShapeElement.prototype.searchShapes=function(t,e,n,r,i,o,a){var s,u,c,l,h,f,p=[].concat(o),d=t.length-1,m=[],v=[];for(s=d;s>=0;s-=1){if(f=this.searchProcessedElement(t[s]),f?e[s]=n[f-1]:t[s]._render=a,"fl"===t[s].ty||"st"===t[s].ty||"gf"===t[s].ty||"gs"===t[s].ty)f?e[s].style.closed=!1:e[s]=this.createStyleElement(t[s],i),t[s]._render&&r.appendChild(e[s].style.pElem),m.push(e[s].style);else if("gr"===t[s].ty){if(f)for(c=e[s].it.length,u=0;u<c;u+=1)e[s].prevViewData[u]=e[s].it[u];else e[s]=this.createGroupElement(t[s]);this.searchShapes(t[s].it,e[s].it,e[s].prevViewData,e[s].gr,i+1,p,a),t[s]._render&&r.appendChild(e[s].gr)}else"tr"===t[s].ty?(f||(e[s]=this.createTransformElement(t[s],r)),l=e[s].transform,p.push(l)):"sh"===t[s].ty||"rc"===t[s].ty||"el"===t[s].ty||"sr"===t[s].ty?(f||(e[s]=this.createShapeElement(t[s],p,i)),this.setElementStyles(e[s])):"tm"===t[s].ty||"rd"===t[s].ty||"ms"===t[s].ty||"pb"===t[s].ty?(f?(h=e[s],h.closed=!1):(h=ShapeModifiers.getModifier(t[s].ty),h.init(this,t[s]),e[s]=h,this.shapeModifiers.push(h)),v.push(h)):"rp"===t[s].ty&&(f?(h=e[s],h.closed=!0):(h=ShapeModifiers.getModifier(t[s].ty),e[s]=h,h.init(this,t,s,e),this.shapeModifiers.push(h),a=!1),v.push(h));this.addProcessedElement(t[s],s+1)}for(d=m.length,s=0;s<d;s+=1)m[s].closed=!0;for(d=v.length,s=0;s<d;s+=1)v[s].closed=!0},SVGShapeElement.prototype.renderInnerContent=function(){var t;this.renderModifiers();var e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].reset();for(this.renderShape(),t=0;t<e;t+=1)(this.stylesList[t]._mdf||this._isFirstFrame)&&(this.stylesList[t].msElem&&(this.stylesList[t].msElem.setAttribute("d",this.stylesList[t].d),this.stylesList[t].d="M0 0"+this.stylesList[t].d),this.stylesList[t].pElem.setAttribute("d",this.stylesList[t].d||"M0 0"))},SVGShapeElement.prototype.renderShape=function(){var t,e,n=this.animatedContents.length;for(t=0;t<n;t+=1)e=this.animatedContents[t],(this._isFirstFrame||e.element._isAnimated)&&!0!==e.data&&e.fn(e.data,e.element,this._isFirstFrame)},SVGShapeElement.prototype.destroy=function(){this.destroyBaseElement(),this.shapesData=null,this.itemsData=null},SVGTintFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v/100;this.matrixFilter.setAttribute("values",n[0]-e[0]+" 0 0 0 "+e[0]+" "+(n[1]-e[1])+" 0 0 0 "+e[1]+" "+(n[2]-e[2])+" 0 0 0 "+e[2]+" 0 0 0 "+r+" 0")}},SVGFillFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[2].p.v,n=this.filterManager.effectElements[6].p.v;this.matrixFilter.setAttribute("values","0 0 0 0 "+e[0]+" 0 0 0 0 "+e[1]+" 0 0 0 0 "+e[2]+" 0 0 0 "+n+" 0")}},SVGGaussianBlurEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=.3,n=this.filterManager.effectElements[0].p.v*e,r=this.filterManager.effectElements[1].p.v,i=3==r?0:n,o=2==r?0:n;this.feGaussianBlur.setAttribute("stdDeviation",i+" "+o);var a=1==this.filterManager.effectElements[2].p.v?"wrap":"duplicate";this.feGaussianBlur.setAttribute("edgeMode",a)}},SVGStrokeEffect.prototype.initialize=function(){var t,e,n,r,i=this.elem.layerElement.children||this.elem.layerElement.childNodes;for(1===this.filterManager.effectElements[1].p.v?(r=this.elem.maskManager.masksProperties.length,n=0):(n=this.filterManager.effectElements[0].p.v-1,r=n+1),e=createNS("g"),e.setAttribute("fill","none"),e.setAttribute("stroke-linecap","round"),e.setAttribute("stroke-dashoffset",1),n;n<r;n+=1)t=createNS("path"),e.appendChild(t),this.paths.push({p:t,m:n});if(3===this.filterManager.effectElements[10].p.v){var o=createNS("mask"),a=createElementID();o.setAttribute("id",a),o.setAttribute("mask-type","alpha"),o.appendChild(e),this.elem.globalData.defs.appendChild(o);var s=createNS("g");s.setAttribute("mask","url("+locationHref+"#"+a+")");while(i[0])s.appendChild(i[0]);this.elem.layerElement.appendChild(s),this.masker=o,e.setAttribute("stroke","#fff")}else if(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v){if(2===this.filterManager.effectElements[10].p.v){i=this.elem.layerElement.children||this.elem.layerElement.childNodes;while(i.length)this.elem.layerElement.removeChild(i[0])}this.elem.layerElement.appendChild(e),this.elem.layerElement.removeAttribute("mask"),e.setAttribute("stroke","#fff")}this.initialized=!0,this.pathMasker=e},SVGStrokeEffect.prototype.renderFrame=function(t){var e;this.initialized||this.initialize();var n,r,i=this.paths.length;for(e=0;e<i;e+=1)if(-1!==this.paths[e].m&&(n=this.elem.maskManager.viewData[this.paths[e].m],r=this.paths[e].p,(t||this.filterManager._mdf||n.prop._mdf)&&r.setAttribute("d",n.lastPath),t||this.filterManager.effectElements[9].p._mdf||this.filterManager.effectElements[4].p._mdf||this.filterManager.effectElements[7].p._mdf||this.filterManager.effectElements[8].p._mdf||n.prop._mdf)){var o;if(0!==this.filterManager.effectElements[7].p.v||100!==this.filterManager.effectElements[8].p.v){var a=.01*Math.min(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),s=.01*Math.max(this.filterManager.effectElements[7].p.v,this.filterManager.effectElements[8].p.v),u=r.getTotalLength();o="0 0 0 "+u*a+" ";var c,l=u*(s-a),h=1+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01,f=Math.floor(l/h);for(c=0;c<f;c+=1)o+="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01+" ";o+="0 "+10*u+" 0 0"}else o="1 "+2*this.filterManager.effectElements[4].p.v*this.filterManager.effectElements[9].p.v*.01;r.setAttribute("stroke-dasharray",o)}if((t||this.filterManager.effectElements[4].p._mdf)&&this.pathMasker.setAttribute("stroke-width",2*this.filterManager.effectElements[4].p.v),(t||this.filterManager.effectElements[6].p._mdf)&&this.pathMasker.setAttribute("opacity",this.filterManager.effectElements[6].p.v),(1===this.filterManager.effectElements[10].p.v||2===this.filterManager.effectElements[10].p.v)&&(t||this.filterManager.effectElements[3].p._mdf)){var p=this.filterManager.effectElements[3].p.v;this.pathMasker.setAttribute("stroke","rgb("+bmFloor(255*p[0])+","+bmFloor(255*p[1])+","+bmFloor(255*p[2])+")")}},SVGTritoneFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e=this.filterManager.effectElements[0].p.v,n=this.filterManager.effectElements[1].p.v,r=this.filterManager.effectElements[2].p.v,i=r[0]+" "+n[0]+" "+e[0],o=r[1]+" "+n[1]+" "+e[1],a=r[2]+" "+n[2]+" "+e[2];this.feFuncR.setAttribute("tableValues",i),this.feFuncG.setAttribute("tableValues",o),this.feFuncB.setAttribute("tableValues",a)}},SVGProLevelsFilter.prototype.createFeFunc=function(t,e){var n=createNS(t);return n.setAttribute("type","table"),e.appendChild(n),n},SVGProLevelsFilter.prototype.getTableValue=function(t,e,n,r,i){var o,a,s=0,u=256,c=Math.min(t,e),l=Math.max(t,e),h=Array.call(null,{length:u}),f=0,p=i-r,d=e-t;while(s<=256)o=s/256,a=o<=c?d<0?i:r:o>=l?d<0?r:i:r+p*Math.pow((o-t)/d,1/n),h[f]=a,f+=1,s+=256/(u-1);return h.join(" ")},SVGProLevelsFilter.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){var e,n=this.filterManager.effectElements;this.feFuncRComposed&&(t||n[3].p._mdf||n[4].p._mdf||n[5].p._mdf||n[6].p._mdf||n[7].p._mdf)&&(e=this.getTableValue(n[3].p.v,n[4].p.v,n[5].p.v,n[6].p.v,n[7].p.v),this.feFuncRComposed.setAttribute("tableValues",e),this.feFuncGComposed.setAttribute("tableValues",e),this.feFuncBComposed.setAttribute("tableValues",e)),this.feFuncR&&(t||n[10].p._mdf||n[11].p._mdf||n[12].p._mdf||n[13].p._mdf||n[14].p._mdf)&&(e=this.getTableValue(n[10].p.v,n[11].p.v,n[12].p.v,n[13].p.v,n[14].p.v),this.feFuncR.setAttribute("tableValues",e)),this.feFuncG&&(t||n[17].p._mdf||n[18].p._mdf||n[19].p._mdf||n[20].p._mdf||n[21].p._mdf)&&(e=this.getTableValue(n[17].p.v,n[18].p.v,n[19].p.v,n[20].p.v,n[21].p.v),this.feFuncG.setAttribute("tableValues",e)),this.feFuncB&&(t||n[24].p._mdf||n[25].p._mdf||n[26].p._mdf||n[27].p._mdf||n[28].p._mdf)&&(e=this.getTableValue(n[24].p.v,n[25].p.v,n[26].p.v,n[27].p.v,n[28].p.v),this.feFuncB.setAttribute("tableValues",e)),this.feFuncA&&(t||n[31].p._mdf||n[32].p._mdf||n[33].p._mdf||n[34].p._mdf||n[35].p._mdf)&&(e=this.getTableValue(n[31].p.v,n[32].p.v,n[33].p.v,n[34].p.v,n[35].p.v),this.feFuncA.setAttribute("tableValues",e))}},SVGDropShadowEffect.prototype.renderFrame=function(t){if(t||this.filterManager._mdf){if((t||this.filterManager.effectElements[4].p._mdf)&&this.feGaussianBlur.setAttribute("stdDeviation",this.filterManager.effectElements[4].p.v/4),t||this.filterManager.effectElements[0].p._mdf){var e=this.filterManager.effectElements[0].p.v;this.feFlood.setAttribute("flood-color",rgbToHex(Math.round(255*e[0]),Math.round(255*e[1]),Math.round(255*e[2])))}if((t||this.filterManager.effectElements[1].p._mdf)&&this.feFlood.setAttribute("flood-opacity",this.filterManager.effectElements[1].p.v/255),t||this.filterManager.effectElements[2].p._mdf||this.filterManager.effectElements[3].p._mdf){var n=this.filterManager.effectElements[3].p.v,r=(this.filterManager.effectElements[2].p.v-90)*degToRads,i=n*Math.cos(r),o=n*Math.sin(r);this.feOffset.setAttribute("dx",i),this.feOffset.setAttribute("dy",o)}}};var _svgMatteSymbols=[];function SVGMatte3Effect(t,e,n){this.initialized=!1,this.filterManager=e,this.filterElem=t,this.elem=n,n.matteElement=createNS("g"),n.matteElement.appendChild(n.layerElement),n.matteElement.appendChild(n.transformedElement),n.baseElement=n.matteElement}function SVGEffects(t){var e,n,r=t.data.ef?t.data.ef.length:0,i=createElementID(),o=filtersFactory.createFilter(i,!0),a=0;for(this.filters=[],e=0;e<r;e+=1)n=null,20===t.data.ef[e].ty?(a+=1,n=new SVGTintFilter(o,t.effectsManager.effectElements[e])):21===t.data.ef[e].ty?(a+=1,n=new SVGFillFilter(o,t.effectsManager.effectElements[e])):22===t.data.ef[e].ty?n=new SVGStrokeEffect(t,t.effectsManager.effectElements[e]):23===t.data.ef[e].ty?(a+=1,n=new SVGTritoneFilter(o,t.effectsManager.effectElements[e])):24===t.data.ef[e].ty?(a+=1,n=new SVGProLevelsFilter(o,t.effectsManager.effectElements[e])):25===t.data.ef[e].ty?(a+=1,n=new SVGDropShadowEffect(o,t.effectsManager.effectElements[e])):28===t.data.ef[e].ty?n=new SVGMatte3Effect(o,t.effectsManager.effectElements[e],t):29===t.data.ef[e].ty&&(a+=1,n=new SVGGaussianBlurEffect(o,t.effectsManager.effectElements[e])),n&&this.filters.push(n);a&&(t.globalData.defs.appendChild(o),t.layerElement.setAttribute("filter","url("+locationHref+"#"+i+")")),this.filters.length&&t.addRenderableComponent(this)}function CVContextData(){var t;this.saved=[],this.cArrPos=0,this.cTr=new Matrix,this.cO=1;var e=15;for(this.savedOp=createTypedArray("float32",e),t=0;t<e;t+=1)this.saved[t]=createTypedArray("float32",16);this._length=e}function CVBaseElement(){}function CVImageElement(t,e,n){this.assetData=e.getAssetData(t.refId),this.img=e.imageLoader.getAsset(this.assetData),this.initElement(t,e,n)}function CVCompElement(t,e,n){this.completeLayers=!1,this.layers=t.layers,this.pendingElements=[],this.elements=createSizedArray(this.layers.length),this.initElement(t,e,n),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function CVMaskElement(t,e){var n;this.data=t,this.element=e,this.masksProperties=this.data.masksProperties||[],this.viewData=createSizedArray(this.masksProperties.length);var r=this.masksProperties.length,i=!1;for(n=0;n<r;n+=1)"n"!==this.masksProperties[n].mode&&(i=!0),this.viewData[n]=ShapePropertyFactory.getShapeProp(this.element,this.masksProperties[n],3);this.hasMasks=i,i&&this.element.addRenderableComponent(this)}function CVShapeElement(t,e,n){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.itemsData=[],this.prevViewData=[],this.shapeModifiers=[],this.processedElements=[],this.transformsManager=new ShapeTransformManager,this.initElement(t,e,n)}function CVSolidElement(t,e,n){this.initElement(t,e,n)}function CVTextElement(t,e,n){this.textSpans=[],this.yOffset=0,this.fillColorAnim=!1,this.strokeColorAnim=!1,this.strokeWidthAnim=!1,this.stroke=!1,this.fill=!1,this.justifyOffset=0,this.currentRender=null,this.renderType="canvas",this.values={fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)",sWidth:0,fValue:""},this.initElement(t,e,n)}function CVEffects(){}function HBaseElement(){}function HSolidElement(t,e,n){this.initElement(t,e,n)}function HCompElement(t,e,n){this.layers=t.layers,this.supports3d=!t.hasMask,this.completeLayers=!1,this.pendingElements=[],this.elements=this.layers?createSizedArray(this.layers.length):[],this.initElement(t,e,n),this.tm=t.tm?PropertyFactory.getProp(this,t.tm,0,e.frameRate,this):{_placeholder:!0}}function HShapeElement(t,e,n){this.shapes=[],this.shapesData=t.shapes,this.stylesList=[],this.shapeModifiers=[],this.itemsData=[],this.processedElements=[],this.animatedContents=[],this.shapesContainer=createNS("g"),this.initElement(t,e,n),this.prevViewData=[],this.currentBBox={x:999999,y:-999999,h:0,w:0}}function HTextElement(t,e,n){this.textSpans=[],this.textPaths=[],this.currentBBox={x:999999,y:-999999,h:0,w:0},this.renderType="svg",this.isMasked=!1,this.initElement(t,e,n)}function HImageElement(t,e,n){this.assetData=e.getAssetData(t.refId),this.initElement(t,e,n)}function HCameraElement(t,e,n){this.initFrame(),this.initBaseData(t,e,n),this.initHierarchy();var r=PropertyFactory.getProp;if(this.pe=r(this,t.pe,0,0,this),t.ks.p.s?(this.px=r(this,t.ks.p.x,1,0,this),this.py=r(this,t.ks.p.y,1,0,this),this.pz=r(this,t.ks.p.z,1,0,this)):this.p=r(this,t.ks.p,1,0,this),t.ks.a&&(this.a=r(this,t.ks.a,1,0,this)),t.ks.or.k.length&&t.ks.or.k[0].to){var i,o=t.ks.or.k.length;for(i=0;i<o;i+=1)t.ks.or.k[i].to=null,t.ks.or.k[i].ti=null}this.or=r(this,t.ks.or,1,degToRads,this),this.or.sh=!0,this.rx=r(this,t.ks.rx,0,degToRads,this),this.ry=r(this,t.ks.ry,0,degToRads,this),this.rz=r(this,t.ks.rz,0,degToRads,this),this.mat=new Matrix,this._prevMat=new Matrix,this._isFirstFrame=!0,this.finalTransform={mProp:this}}function HEffects(){}SVGMatte3Effect.prototype.findSymbol=function(t){var e=0,n=_svgMatteSymbols.length;while(e<n){if(_svgMatteSymbols[e]===t)return _svgMatteSymbols[e];e+=1}return null},SVGMatte3Effect.prototype.replaceInParent=function(t,e){var n=t.layerElement.parentNode;if(n){var r,i=n.children,o=0,a=i.length;while(o<a){if(i[o]===t.layerElement)break;o+=1}o<=a-2&&(r=i[o+1]);var s=createNS("use");s.setAttribute("href","#"+e),r?n.insertBefore(s,r):n.appendChild(s)}},SVGMatte3Effect.prototype.setElementAsMask=function(t,e){if(!this.findSymbol(e)){var n=createElementID(),r=createNS("mask");r.setAttribute("id",e.layerId),r.setAttribute("mask-type","alpha"),_svgMatteSymbols.push(e);var i=t.globalData.defs;i.appendChild(r);var o=createNS("symbol");o.setAttribute("id",n),this.replaceInParent(e,n),o.appendChild(e.layerElement),i.appendChild(o);var a=createNS("use");a.setAttribute("href","#"+n),r.appendChild(a),e.data.hd=!1,e.show()}t.setMatte(e.layerId)},SVGMatte3Effect.prototype.initialize=function(){var t=this.filterManager.effectElements[0].p.v,e=this.elem.comp.elements,n=0,r=e.length;while(n<r)e[n]&&e[n].data.ind===t&&this.setElementAsMask(this.elem,e[n]),n+=1;this.initialized=!0},SVGMatte3Effect.prototype.renderFrame=function(){this.initialized||this.initialize()},SVGEffects.prototype.renderFrame=function(t){var e,n=this.filters.length;for(e=0;e<n;e+=1)this.filters[e].renderFrame(t)},CVContextData.prototype.duplicate=function(){var t=2*this._length,e=this.savedOp;this.savedOp=createTypedArray("float32",t),this.savedOp.set(e);var n=0;for(n=this._length;n<t;n+=1)this.saved[n]=createTypedArray("float32",16);this._length=t},CVContextData.prototype.reset=function(){this.cArrPos=0,this.cTr.reset(),this.cO=1},CVBaseElement.prototype={createElements:function(){},initRendererElement:function(){},createContainerElements:function(){this.canvasContext=this.globalData.canvasContext,this.renderableEffectsManager=new CVEffects(this)},createContent:function(){},setBlendMode:function(){var t=this.globalData;if(t.blendMode!==this.data.bm){t.blendMode=this.data.bm;var e=getBlendMode(this.data.bm);t.canvasContext.globalCompositeOperation=e}},createRenderableComponents:function(){this.maskManager=new CVMaskElement(this.data,this)},hideElement:function(){this.hidden||this.isInRange&&!this.isTransparent||(this.hidden=!0)},showElement:function(){this.isInRange&&!this.isTransparent&&(this.hidden=!1,this._isFirstFrame=!0,this.maskManager._isFirstFrame=!0)},renderFrame:function(){if(!this.hidden&&!this.data.hd){this.renderTransform(),this.renderRenderable(),this.setBlendMode();var t=0===this.data.ty;this.globalData.renderer.save(t),this.globalData.renderer.ctxTransform(this.finalTransform.mat.props),this.globalData.renderer.ctxOpacity(this.finalTransform.mProp.o.v),this.renderInnerContent(),this.globalData.renderer.restore(t),this.maskManager.hasMasks&&this.globalData.renderer.restore(!0),this._isFirstFrame&&(this._isFirstFrame=!1)}},destroy:function(){this.canvasContext=null,this.data=null,this.globalData=null,this.maskManager.destroy()},mHelper:new Matrix},CVBaseElement.prototype.hide=CVBaseElement.prototype.hideElement,CVBaseElement.prototype.show=CVBaseElement.prototype.showElement,extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVImageElement),CVImageElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVImageElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVImageElement.prototype.createContent=function(){if(this.img.width&&(this.assetData.w!==this.img.width||this.assetData.h!==this.img.height)){var t=createTag("canvas");t.width=this.assetData.w,t.height=this.assetData.h;var e,n,r=t.getContext("2d"),i=this.img.width,o=this.img.height,a=i/o,s=this.assetData.w/this.assetData.h,u=this.assetData.pr||this.globalData.renderConfig.imagePreserveAspectRatio;a>s&&"xMidYMid slice"===u||a<s&&"xMidYMid slice"!==u?(n=o,e=n*s):(e=i,n=e/s),r.drawImage(this.img,(i-e)/2,(o-n)/2,e,n,0,0,this.assetData.w,this.assetData.h),this.img=t}},CVImageElement.prototype.renderInnerContent=function(){this.canvasContext.drawImage(this.img,0,0)},CVImageElement.prototype.destroy=function(){this.img=null},extendPrototype([CanvasRenderer,ICompElement,CVBaseElement],CVCompElement),CVCompElement.prototype.renderInnerContent=function(){var t,e=this.canvasContext;e.beginPath(),e.moveTo(0,0),e.lineTo(this.data.w,0),e.lineTo(this.data.w,this.data.h),e.lineTo(0,this.data.h),e.lineTo(0,0),e.clip();var n=this.layers.length;for(t=n-1;t>=0;t-=1)(this.completeLayers||this.elements[t])&&this.elements[t].renderFrame()},CVCompElement.prototype.destroy=function(){var t,e=this.layers.length;for(t=e-1;t>=0;t-=1)this.elements[t]&&this.elements[t].destroy();this.layers=null,this.elements=null},CVMaskElement.prototype.renderFrame=function(){if(this.hasMasks){var t,e,n,r,i=this.element.finalTransform.mat,o=this.element.canvasContext,a=this.masksProperties.length;for(o.beginPath(),t=0;t<a;t+=1)if("n"!==this.masksProperties[t].mode){var s;this.masksProperties[t].inv&&(o.moveTo(0,0),o.lineTo(this.element.globalData.compSize.w,0),o.lineTo(this.element.globalData.compSize.w,this.element.globalData.compSize.h),o.lineTo(0,this.element.globalData.compSize.h),o.lineTo(0,0)),r=this.viewData[t].v,e=i.applyToPointArray(r.v[0][0],r.v[0][1],0),o.moveTo(e[0],e[1]);var u=r._length;for(s=1;s<u;s+=1)n=i.applyToTriplePoints(r.o[s-1],r.i[s],r.v[s]),o.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5]);n=i.applyToTriplePoints(r.o[s-1],r.i[0],r.v[0]),o.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}this.element.globalData.renderer.save(!0),o.clip()}},CVMaskElement.prototype.getMaskProperty=MaskElement.prototype.getMaskProperty,CVMaskElement.prototype.destroy=function(){this.element=null},extendPrototype([BaseElement,TransformElement,CVBaseElement,IShapeElement,HierarchyElement,FrameElement,RenderableElement],CVShapeElement),CVShapeElement.prototype.initElement=RenderableDOMElement.prototype.initElement,CVShapeElement.prototype.transformHelper={opacity:1,_opMdf:!1},CVShapeElement.prototype.dashResetter=[],CVShapeElement.prototype.createContent=function(){this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[])},CVShapeElement.prototype.createStyleElement=function(t,e){var n={data:t,type:t.ty,preTransforms:this.transformsManager.addTransformSequence(e),transforms:[],elements:[],closed:!0===t.hd},r={};if("fl"===t.ty||"st"===t.ty?(r.c=PropertyFactory.getProp(this,t.c,1,255,this),r.c.k||(n.co="rgb("+bmFloor(r.c.v[0])+","+bmFloor(r.c.v[1])+","+bmFloor(r.c.v[2])+")")):"gf"!==t.ty&&"gs"!==t.ty||(r.s=PropertyFactory.getProp(this,t.s,1,null,this),r.e=PropertyFactory.getProp(this,t.e,1,null,this),r.h=PropertyFactory.getProp(this,t.h||{k:0},0,.01,this),r.a=PropertyFactory.getProp(this,t.a||{k:0},0,degToRads,this),r.g=new GradientProperty(this,t.g,this)),r.o=PropertyFactory.getProp(this,t.o,0,.01,this),"st"===t.ty||"gs"===t.ty){if(n.lc=this.lcEnum[t.lc]||"round",n.lj=this.ljEnum[t.lj]||"round",1==t.lj&&(n.ml=t.ml),r.w=PropertyFactory.getProp(this,t.w,0,null,this),r.w.k||(n.wi=r.w.v),t.d){var i=new DashProperty(this,t.d,"canvas",this);r.d=i,r.d.k||(n.da=r.d.dashArray,n.do=r.d.dashoffset[0])}}else n.r=2===t.r?"evenodd":"nonzero";return this.stylesList.push(n),r.style=n,r},CVShapeElement.prototype.createGroupElement=function(){var t={it:[],prevViewData:[]};return t},CVShapeElement.prototype.createTransformElement=function(t){var e={transform:{opacity:1,_opMdf:!1,key:this.transformsManager.getNewKey(),op:PropertyFactory.getProp(this,t.o,0,.01,this),mProps:TransformPropertyFactory.getTransformProperty(this,t,this)}};return e},CVShapeElement.prototype.createShapeElement=function(t){var e=new CVShapeData(this,t,this.stylesList,this.transformsManager);return this.shapes.push(e),this.addShapeToModifiers(e),e},CVShapeElement.prototype.reloadShapes=function(){var t;this._isFirstFrame=!0;var e=this.itemsData.length;for(t=0;t<e;t+=1)this.prevViewData[t]=this.itemsData[t];for(this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,!0,[]),e=this.dynamicProperties.length,t=0;t<e;t+=1)this.dynamicProperties[t].getValue();this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame)},CVShapeElement.prototype.addTransformToStyleList=function(t){var e,n=this.stylesList.length;for(e=0;e<n;e+=1)this.stylesList[e].closed||this.stylesList[e].transforms.push(t)},CVShapeElement.prototype.removeTransformFromStyleList=function(){var t,e=this.stylesList.length;for(t=0;t<e;t+=1)this.stylesList[t].closed||this.stylesList[t].transforms.pop()},CVShapeElement.prototype.closeStyles=function(t){var e,n=t.length;for(e=0;e<n;e+=1)t[e].closed=!0},CVShapeElement.prototype.searchShapes=function(t,e,n,r,i){var o,a,s,u,c,l,h=t.length-1,f=[],p=[],d=[].concat(i);for(o=h;o>=0;o-=1){if(u=this.searchProcessedElement(t[o]),u?e[o]=n[u-1]:t[o]._shouldRender=r,"fl"===t[o].ty||"st"===t[o].ty||"gf"===t[o].ty||"gs"===t[o].ty)u?e[o].style.closed=!1:e[o]=this.createStyleElement(t[o],d),f.push(e[o].style);else if("gr"===t[o].ty){if(u)for(s=e[o].it.length,a=0;a<s;a+=1)e[o].prevViewData[a]=e[o].it[a];else e[o]=this.createGroupElement(t[o]);this.searchShapes(t[o].it,e[o].it,e[o].prevViewData,r,d)}else"tr"===t[o].ty?(u||(l=this.createTransformElement(t[o]),e[o]=l),d.push(e[o]),this.addTransformToStyleList(e[o])):"sh"===t[o].ty||"rc"===t[o].ty||"el"===t[o].ty||"sr"===t[o].ty?u||(e[o]=this.createShapeElement(t[o])):"tm"===t[o].ty||"rd"===t[o].ty||"pb"===t[o].ty?(u?(c=e[o],c.closed=!1):(c=ShapeModifiers.getModifier(t[o].ty),c.init(this,t[o]),e[o]=c,this.shapeModifiers.push(c)),p.push(c)):"rp"===t[o].ty&&(u?(c=e[o],c.closed=!0):(c=ShapeModifiers.getModifier(t[o].ty),e[o]=c,c.init(this,t,o,e),this.shapeModifiers.push(c),r=!1),p.push(c));this.addProcessedElement(t[o],o+1)}for(this.removeTransformFromStyleList(),this.closeStyles(f),h=p.length,o=0;o<h;o+=1)p[o].closed=!0},CVShapeElement.prototype.renderInnerContent=function(){this.transformHelper.opacity=1,this.transformHelper._opMdf=!1,this.renderModifiers(),this.transformsManager.processSequences(this._isFirstFrame),this.renderShape(this.transformHelper,this.shapesData,this.itemsData,!0)},CVShapeElement.prototype.renderShapeTransform=function(t,e){(t._opMdf||e.op._mdf||this._isFirstFrame)&&(e.opacity=t.opacity,e.opacity*=e.op.v,e._opMdf=!0)},CVShapeElement.prototype.drawLayer=function(){var t,e,n,r,i,o,a,s,u,c=this.stylesList.length,l=this.globalData.renderer,h=this.globalData.canvasContext;for(t=0;t<c;t+=1)if(u=this.stylesList[t],s=u.type,("st"!==s&&"gs"!==s||0!==u.wi)&&u.data._shouldRender&&0!==u.coOp&&0!==this.globalData.currentGlobalAlpha){for(l.save(),o=u.elements,"st"===s||"gs"===s?(h.strokeStyle="st"===s?u.co:u.grd,h.lineWidth=u.wi,h.lineCap=u.lc,h.lineJoin=u.lj,h.miterLimit=u.ml||0):h.fillStyle="fl"===s?u.co:u.grd,l.ctxOpacity(u.coOp),"st"!==s&&"gs"!==s&&h.beginPath(),l.ctxTransform(u.preTransforms.finalTransform.props),n=o.length,e=0;e<n;e+=1){for("st"!==s&&"gs"!==s||(h.beginPath(),u.da&&(h.setLineDash(u.da),h.lineDashOffset=u.do)),a=o[e].trNodes,i=a.length,r=0;r<i;r+=1)"m"===a[r].t?h.moveTo(a[r].p[0],a[r].p[1]):"c"===a[r].t?h.bezierCurveTo(a[r].pts[0],a[r].pts[1],a[r].pts[2],a[r].pts[3],a[r].pts[4],a[r].pts[5]):h.closePath();"st"!==s&&"gs"!==s||(h.stroke(),u.da&&h.setLineDash(this.dashResetter))}"st"!==s&&"gs"!==s&&h.fill(u.r),l.restore()}},CVShapeElement.prototype.renderShape=function(t,e,n,r){var i,o,a=e.length-1;for(o=t,i=a;i>=0;i-=1)"tr"===e[i].ty?(o=n[i].transform,this.renderShapeTransform(t,o)):"sh"===e[i].ty||"el"===e[i].ty||"rc"===e[i].ty||"sr"===e[i].ty?this.renderPath(e[i],n[i]):"fl"===e[i].ty?this.renderFill(e[i],n[i],o):"st"===e[i].ty?this.renderStroke(e[i],n[i],o):"gf"===e[i].ty||"gs"===e[i].ty?this.renderGradientFill(e[i],n[i],o):"gr"===e[i].ty?this.renderShape(o,e[i].it,n[i].it):e[i].ty;r&&this.drawLayer()},CVShapeElement.prototype.renderStyledShape=function(t,e){if(this._isFirstFrame||e._mdf||t.transforms._mdf){var n,r,i,o=t.trNodes,a=e.paths,s=a._length;o.length=0;var u=t.transforms.finalTransform;for(i=0;i<s;i+=1){var c=a.shapes[i];if(c&&c.v){for(r=c._length,n=1;n<r;n+=1)1===n&&o.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),o.push({t:"c",pts:u.applyToTriplePoints(c.o[n-1],c.i[n],c.v[n])});1===r&&o.push({t:"m",p:u.applyToPointArray(c.v[0][0],c.v[0][1],0)}),c.c&&r&&(o.push({t:"c",pts:u.applyToTriplePoints(c.o[n-1],c.i[0],c.v[0])}),o.push({t:"z"}))}}t.trNodes=o}},CVShapeElement.prototype.renderPath=function(t,e){if(!0!==t.hd&&t._shouldRender){var n,r=e.styledShapes.length;for(n=0;n<r;n+=1)this.renderStyledShape(e.styledShapes[n],e.sh)}},CVShapeElement.prototype.renderFill=function(t,e,n){var r=e.style;(e.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=e.o.v*n.opacity)},CVShapeElement.prototype.renderGradientFill=function(t,e,n){var r,i=e.style;if(!i.grd||e.g._mdf||e.s._mdf||e.e._mdf||1!==t.t&&(e.h._mdf||e.a._mdf)){var o,a=this.globalData.canvasContext,s=e.s.v,u=e.e.v;if(1===t.t)r=a.createLinearGradient(s[0],s[1],u[0],u[1]);else{var c=Math.sqrt(Math.pow(s[0]-u[0],2)+Math.pow(s[1]-u[1],2)),l=Math.atan2(u[1]-s[1],u[0]-s[0]),h=e.h.v;h>=1?h=.99:h<=-1&&(h=-.99);var f=c*h,p=Math.cos(l+e.a.v)*f+s[0],d=Math.sin(l+e.a.v)*f+s[1];r=a.createRadialGradient(p,d,0,s[0],s[1],c)}var m=t.g.p,v=e.g.c,g=1;for(o=0;o<m;o+=1)e.g._hasOpacity&&e.g._collapsable&&(g=e.g.o[2*o+1]),r.addColorStop(v[4*o]/100,"rgba("+v[4*o+1]+","+v[4*o+2]+","+v[4*o+3]+","+g+")");i.grd=r}i.coOp=e.o.v*n.opacity},CVShapeElement.prototype.renderStroke=function(t,e,n){var r=e.style,i=e.d;i&&(i._mdf||this._isFirstFrame)&&(r.da=i.dashArray,r.do=i.dashoffset[0]),(e.c._mdf||this._isFirstFrame)&&(r.co="rgb("+bmFloor(e.c.v[0])+","+bmFloor(e.c.v[1])+","+bmFloor(e.c.v[2])+")"),(e.o._mdf||n._opMdf||this._isFirstFrame)&&(r.coOp=e.o.v*n.opacity),(e.w._mdf||this._isFirstFrame)&&(r.wi=e.w.v)},CVShapeElement.prototype.destroy=function(){this.shapesData=null,this.globalData=null,this.canvasContext=null,this.stylesList.length=0,this.itemsData.length=0},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement],CVSolidElement),CVSolidElement.prototype.initElement=SVGShapeElement.prototype.initElement,CVSolidElement.prototype.prepareFrame=IImageElement.prototype.prepareFrame,CVSolidElement.prototype.renderInnerContent=function(){var t=this.canvasContext;t.fillStyle=this.data.sc,t.fillRect(0,0,this.data.sw,this.data.sh)},extendPrototype([BaseElement,TransformElement,CVBaseElement,HierarchyElement,FrameElement,RenderableElement,ITextElement],CVTextElement),CVTextElement.prototype.tHelper=createTag("canvas").getContext("2d"),CVTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=!1;t.fc?(e=!0,this.values.fill=this.buildColor(t.fc)):this.values.fill="rgba(0,0,0,0)",this.fill=e;var n=!1;t.sc&&(n=!0,this.values.stroke=this.buildColor(t.sc),this.values.sWidth=t.sw);var r,i,o,a,s,u,c,l,h,f,p,d,m=this.globalData.fontManager.getFontByName(t.f),v=t.l,g=this.mHelper;this.stroke=n,this.values.fValue=t.finalSize+"px "+this.globalData.fontManager.getFontByName(t.f).fFamily,i=t.finalText.length;var y=this.data.singleShape,b=.001*t.tr*t.finalSize,x=0,w=0,E=!0,_=0;for(r=0;r<i;r+=1){for(o=this.globalData.fontManager.getCharData(t.finalText[r],m.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily),a=o&&o.data||{},g.reset(),y&&v[r].n&&(x=-b,w+=t.yOffset,w+=E?1:0,E=!1),c=a.shapes?a.shapes[0].it:[],h=c.length,g.scale(t.finalSize/100,t.finalSize/100),y&&this.applyTextPropertiesToMatrix(t,g,v[r].line,x,w),p=createSizedArray(h),l=0;l<h;l+=1){for(u=c[l].ks.k.i.length,f=c[l].ks.k,d=[],s=1;s<u;s+=1)1===s&&d.push(g.applyToX(f.v[0][0],f.v[0][1],0),g.applyToY(f.v[0][0],f.v[0][1],0)),d.push(g.applyToX(f.o[s-1][0],f.o[s-1][1],0),g.applyToY(f.o[s-1][0],f.o[s-1][1],0),g.applyToX(f.i[s][0],f.i[s][1],0),g.applyToY(f.i[s][0],f.i[s][1],0),g.applyToX(f.v[s][0],f.v[s][1],0),g.applyToY(f.v[s][0],f.v[s][1],0));d.push(g.applyToX(f.o[s-1][0],f.o[s-1][1],0),g.applyToY(f.o[s-1][0],f.o[s-1][1],0),g.applyToX(f.i[0][0],f.i[0][1],0),g.applyToY(f.i[0][0],f.i[0][1],0),g.applyToX(f.v[0][0],f.v[0][1],0),g.applyToY(f.v[0][0],f.v[0][1],0)),p[l]=d}y&&(x+=v[r].l,x+=b),this.textSpans[_]?this.textSpans[_].elem=p:this.textSpans[_]={elem:p},_+=1}},CVTextElement.prototype.renderInnerContent=function(){var t,e,n,r,i,o,a=this.canvasContext;a.font=this.values.fValue,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,this.data.singleShape||this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag);var s,u=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;e=c.length;var l,h,f=null,p=null,d=null;for(t=0;t<e;t+=1)if(!c[t].n){if(s=u[t],s&&(this.globalData.renderer.save(),this.globalData.renderer.ctxTransform(s.p),this.globalData.renderer.ctxOpacity(s.o)),this.fill){for(s&&s.fc?f!==s.fc&&(f=s.fc,a.fillStyle=s.fc):f!==this.values.fill&&(f=this.values.fill,a.fillStyle=this.values.fill),l=this.textSpans[t].elem,r=l.length,this.globalData.canvasContext.beginPath(),n=0;n<r;n+=1)for(h=l[n],o=h.length,this.globalData.canvasContext.moveTo(h[0],h[1]),i=2;i<o;i+=6)this.globalData.canvasContext.bezierCurveTo(h[i],h[i+1],h[i+2],h[i+3],h[i+4],h[i+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.fill()}if(this.stroke){for(s&&s.sw?d!==s.sw&&(d=s.sw,a.lineWidth=s.sw):d!==this.values.sWidth&&(d=this.values.sWidth,a.lineWidth=this.values.sWidth),s&&s.sc?p!==s.sc&&(p=s.sc,a.strokeStyle=s.sc):p!==this.values.stroke&&(p=this.values.stroke,a.strokeStyle=this.values.stroke),l=this.textSpans[t].elem,r=l.length,this.globalData.canvasContext.beginPath(),n=0;n<r;n+=1)for(h=l[n],o=h.length,this.globalData.canvasContext.moveTo(h[0],h[1]),i=2;i<o;i+=6)this.globalData.canvasContext.bezierCurveTo(h[i],h[i+1],h[i+2],h[i+3],h[i+4],h[i+5]);this.globalData.canvasContext.closePath(),this.globalData.canvasContext.stroke()}s&&this.globalData.renderer.restore()}},CVEffects.prototype.renderFrame=function(){},HBaseElement.prototype={checkBlendMode:function(){},initRendererElement:function(){this.baseElement=createTag(this.data.tg||"div"),this.data.hasMask?(this.svgElement=createNS("svg"),this.layerElement=createNS("g"),this.maskedElement=this.layerElement,this.svgElement.appendChild(this.layerElement),this.baseElement.appendChild(this.svgElement)):this.layerElement=this.baseElement,styleDiv(this.baseElement)},createContainerElements:function(){this.renderableEffectsManager=new CVEffects(this),this.transformedElement=this.baseElement,this.maskedElement=this.layerElement,this.data.ln&&this.layerElement.setAttribute("id",this.data.ln),this.data.cl&&this.layerElement.setAttribute("class",this.data.cl),0!==this.data.bm&&this.setBlendMode()},renderElement:function(){var t=this.transformedElement?this.transformedElement.style:{};if(this.finalTransform._matMdf){var e=this.finalTransform.mat.toCSS();t.transform=e,t.webkitTransform=e}this.finalTransform._opMdf&&(t.opacity=this.finalTransform.mProp.o.v)},renderFrame:function(){this.data.hd||this.hidden||(this.renderTransform(),this.renderRenderable(),this.renderElement(),this.renderInnerContent(),this._isFirstFrame&&(this._isFirstFrame=!1))},destroy:function(){this.layerElement=null,this.transformedElement=null,this.matteElement&&(this.matteElement=null),this.maskManager&&(this.maskManager.destroy(),this.maskManager=null)},createRenderableComponents:function(){this.maskManager=new MaskElement(this.data,this,this.globalData)},addEffects:function(){},setMatte:function(){}},HBaseElement.prototype.getBaseElement=SVGBaseElement.prototype.getBaseElement,HBaseElement.prototype.destroyBaseElement=HBaseElement.prototype.destroy,HBaseElement.prototype.buildElementParenting=HybridRenderer.prototype.buildElementParenting,extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement],HSolidElement),HSolidElement.prototype.createContent=function(){var t;this.data.hasMask?(t=createNS("rect"),t.setAttribute("width",this.data.sw),t.setAttribute("height",this.data.sh),t.setAttribute("fill",this.data.sc),this.svgElement.setAttribute("width",this.data.sw),this.svgElement.setAttribute("height",this.data.sh)):(t=createTag("div"),t.style.width=this.data.sw+"px",t.style.height=this.data.sh+"px",t.style.backgroundColor=this.data.sc),this.layerElement.appendChild(t)},extendPrototype([HybridRenderer,ICompElement,HBaseElement],HCompElement),HCompElement.prototype._createBaseContainerElements=HCompElement.prototype.createContainerElements,HCompElement.prototype.createContainerElements=function(){this._createBaseContainerElements(),this.data.hasMask?(this.svgElement.setAttribute("width",this.data.w),this.svgElement.setAttribute("height",this.data.h),this.transformedElement=this.baseElement):this.transformedElement=this.layerElement},HCompElement.prototype.addTo3dContainer=function(t,e){var n,r=0;while(r<e)this.elements[r]&&this.elements[r].getBaseElement&&(n=this.elements[r].getBaseElement()),r+=1;n?this.layerElement.insertBefore(t,n):this.layerElement.appendChild(t)},extendPrototype([BaseElement,TransformElement,HSolidElement,SVGShapeElement,HBaseElement,HierarchyElement,FrameElement,RenderableElement],HShapeElement),HShapeElement.prototype._renderShapeFrame=HShapeElement.prototype.renderInnerContent,HShapeElement.prototype.createContent=function(){var t;if(this.baseElement.style.fontSize=0,this.data.hasMask)this.layerElement.appendChild(this.shapesContainer),t=this.svgElement;else{t=createNS("svg");var e=this.comp.data?this.comp.data:this.globalData.compSize;t.setAttribute("width",e.w),t.setAttribute("height",e.h),t.appendChild(this.shapesContainer),this.layerElement.appendChild(t)}this.searchShapes(this.shapesData,this.itemsData,this.prevViewData,this.shapesContainer,0,[],!0),this.filterUniqueShapes(),this.shapeCont=t},HShapeElement.prototype.getTransformedPoint=function(t,e){var n,r=t.length;for(n=0;n<r;n+=1)e=t[n].mProps.v.applyToPointArray(e[0],e[1],0);return e},HShapeElement.prototype.calculateShapeBoundingBox=function(t,e){var n,r,i,o,a,s=t.sh.v,u=t.transformers,c=s._length;if(!(c<=1)){for(n=0;n<c-1;n+=1)r=this.getTransformedPoint(u,s.v[n]),i=this.getTransformedPoint(u,s.o[n]),o=this.getTransformedPoint(u,s.i[n+1]),a=this.getTransformedPoint(u,s.v[n+1]),this.checkBounds(r,i,o,a,e);s.c&&(r=this.getTransformedPoint(u,s.v[n]),i=this.getTransformedPoint(u,s.o[n]),o=this.getTransformedPoint(u,s.i[0]),a=this.getTransformedPoint(u,s.v[0]),this.checkBounds(r,i,o,a,e))}},HShapeElement.prototype.checkBounds=function(t,e,n,r,i){this.getBoundsOfCurve(t,e,n,r);var o=this.shapeBoundingBox;i.x=bmMin(o.left,i.x),i.xMax=bmMax(o.right,i.xMax),i.y=bmMin(o.top,i.y),i.yMax=bmMax(o.bottom,i.yMax)},HShapeElement.prototype.shapeBoundingBox={left:0,right:0,top:0,bottom:0},HShapeElement.prototype.tempBoundingBox={x:0,xMax:0,y:0,yMax:0,width:0,height:0},HShapeElement.prototype.getBoundsOfCurve=function(t,e,n,r){for(var i,o,a,s,u,c,l,h=[[t[0],r[0]],[t[1],r[1]]],f=0;f<2;++f)o=6*t[f]-12*e[f]+6*n[f],i=-3*t[f]+9*e[f]-9*n[f]+3*r[f],a=3*e[f]-3*t[f],o|=0,i|=0,a|=0,0===i&&0===o||(0===i?(s=-a/o,s>0&&s<1&&h[f].push(this.calculateF(s,t,e,n,r,f))):(u=o*o-4*a*i,u>=0&&(c=(-o+bmSqrt(u))/(2*i),c>0&&c<1&&h[f].push(this.calculateF(c,t,e,n,r,f)),l=(-o-bmSqrt(u))/(2*i),l>0&&l<1&&h[f].push(this.calculateF(l,t,e,n,r,f)))));this.shapeBoundingBox.left=bmMin.apply(null,h[0]),this.shapeBoundingBox.top=bmMin.apply(null,h[1]),this.shapeBoundingBox.right=bmMax.apply(null,h[0]),this.shapeBoundingBox.bottom=bmMax.apply(null,h[1])},HShapeElement.prototype.calculateF=function(t,e,n,r,i,o){return bmPow(1-t,3)*e[o]+3*bmPow(1-t,2)*t*n[o]+3*(1-t)*bmPow(t,2)*r[o]+bmPow(t,3)*i[o]},HShapeElement.prototype.calculateBoundingBox=function(t,e){var n,r=t.length;for(n=0;n<r;n+=1)t[n]&&t[n].sh?this.calculateShapeBoundingBox(t[n],e):t[n]&&t[n].it&&this.calculateBoundingBox(t[n].it,e)},HShapeElement.prototype.currentBoxContains=function(t){return this.currentBBox.x<=t.x&&this.currentBBox.y<=t.y&&this.currentBBox.width+this.currentBBox.x>=t.x+t.width&&this.currentBBox.height+this.currentBBox.y>=t.y+t.height},HShapeElement.prototype.renderInnerContent=function(){if(this._renderShapeFrame(),!this.hidden&&(this._isFirstFrame||this._mdf)){var t=this.tempBoundingBox,e=999999;if(t.x=e,t.xMax=-e,t.y=e,t.yMax=-e,this.calculateBoundingBox(this.itemsData,t),t.width=t.xMax<t.x?0:t.xMax-t.x,t.height=t.yMax<t.y?0:t.yMax-t.y,this.currentBoxContains(t))return;var n=!1;if(this.currentBBox.w!==t.width&&(this.currentBBox.w=t.width,this.shapeCont.setAttribute("width",t.width),n=!0),this.currentBBox.h!==t.height&&(this.currentBBox.h=t.height,this.shapeCont.setAttribute("height",t.height),n=!0),n||this.currentBBox.x!==t.x||this.currentBBox.y!==t.y){this.currentBBox.w=t.width,this.currentBBox.h=t.height,this.currentBBox.x=t.x,this.currentBBox.y=t.y,this.shapeCont.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h);var r=this.shapeCont.style,i="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";r.transform=i,r.webkitTransform=i}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HierarchyElement,FrameElement,RenderableDOMElement,ITextElement],HTextElement),HTextElement.prototype.createContent=function(){if(this.isMasked=this.checkMasks(),this.isMasked){this.renderType="svg",this.compW=this.comp.data.w,this.compH=this.comp.data.h,this.svgElement.setAttribute("width",this.compW),this.svgElement.setAttribute("height",this.compH);var t=createNS("g");this.maskedElement.appendChild(t),this.innerElem=t}else this.renderType="html",this.innerElem=this.layerElement;this.checkParenting()},HTextElement.prototype.buildNewText=function(){var t=this.textProperty.currentData;this.renderedLetters=createSizedArray(t.l?t.l.length:0);var e=this.innerElem.style,n=t.fc?this.buildColor(t.fc):"rgba(0,0,0,0)";e.fill=n,e.color=n,t.sc&&(e.stroke=this.buildColor(t.sc),e.strokeWidth=t.sw+"px");var r,i,o=this.globalData.fontManager.getFontByName(t.f);if(!this.globalData.fontManager.chars)if(e.fontSize=t.finalSize+"px",e.lineHeight=t.finalSize+"px",o.fClass)this.innerElem.className=o.fClass;else{e.fontFamily=o.fFamily;var a=t.fWeight,s=t.fStyle;e.fontStyle=s,e.fontWeight=a}var u,c,l,h=t.l;i=h.length;var f,p=this.mHelper,d="",m=0;for(r=0;r<i;r+=1){if(this.globalData.fontManager.chars?(this.textPaths[m]?u=this.textPaths[m]:(u=createNS("path"),u.setAttribute("stroke-linecap","butt"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit","4")),this.isMasked||(this.textSpans[m]?(c=this.textSpans[m],l=c.children[0]):(c=createTag("div"),c.style.lineHeight=0,l=createNS("svg"),l.appendChild(u),styleDiv(c)))):this.isMasked?u=this.textPaths[m]?this.textPaths[m]:createNS("text"):this.textSpans[m]?(c=this.textSpans[m],u=this.textPaths[m]):(c=createTag("span"),styleDiv(c),u=createTag("span"),styleDiv(u),c.appendChild(u)),this.globalData.fontManager.chars){var v,g=this.globalData.fontManager.getCharData(t.finalText[r],o.fStyle,this.globalData.fontManager.getFontByName(t.f).fFamily);if(v=g?g.data:null,p.reset(),v&&v.shapes&&(f=v.shapes[0].it,p.scale(t.finalSize/100,t.finalSize/100),d=this.createPathShape(p,f),u.setAttribute("d",d)),this.isMasked)this.innerElem.appendChild(u);else{if(this.innerElem.appendChild(c),v&&v.shapes){document.body.appendChild(l);var y=l.getBBox();l.setAttribute("width",y.width+2),l.setAttribute("height",y.height+2),l.setAttribute("viewBox",y.x-1+" "+(y.y-1)+" "+(y.width+2)+" "+(y.height+2));var b=l.style,x="translate("+(y.x-1)+"px,"+(y.y-1)+"px)";b.transform=x,b.webkitTransform=x,h[r].yOffset=y.y-1}else l.setAttribute("width",1),l.setAttribute("height",1);c.appendChild(l)}}else if(u.textContent=h[r].val,u.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),this.isMasked)this.innerElem.appendChild(u);else{this.innerElem.appendChild(c);var w=u.style,E="translate3d(0,"+-t.finalSize/1.2+"px,0)";w.transform=E,w.webkitTransform=E}this.isMasked?this.textSpans[m]=u:this.textSpans[m]=c,this.textSpans[m].style.display="block",this.textPaths[m]=u,m+=1}while(m<this.textSpans.length)this.textSpans[m].style.display="none",m+=1},HTextElement.prototype.renderInnerContent=function(){var t;if(this.data.singleShape){if(!this._isFirstFrame&&!this.lettersChangedFlag)return;if(this.isMasked&&this.finalTransform._matMdf){this.svgElement.setAttribute("viewBox",-this.finalTransform.mProp.p.v[0]+" "+-this.finalTransform.mProp.p.v[1]+" "+this.compW+" "+this.compH),t=this.svgElement.style;var e="translate("+-this.finalTransform.mProp.p.v[0]+"px,"+-this.finalTransform.mProp.p.v[1]+"px)";t.transform=e,t.webkitTransform=e}}if(this.textAnimator.getMeasures(this.textProperty.currentData,this.lettersChangedFlag),this.lettersChangedFlag||this.textAnimator.lettersChangedFlag){var n,r,i,o,a,s=0,u=this.textAnimator.renderedLetters,c=this.textProperty.currentData.l;for(r=c.length,n=0;n<r;n+=1)c[n].n?s+=1:(o=this.textSpans[n],a=this.textPaths[n],i=u[s],s+=1,i._mdf.m&&(this.isMasked?o.setAttribute("transform",i.m):(o.style.webkitTransform=i.m,o.style.transform=i.m)),o.style.opacity=i.o,i.sw&&i._mdf.sw&&a.setAttribute("stroke-width",i.sw),i.sc&&i._mdf.sc&&a.setAttribute("stroke",i.sc),i.fc&&i._mdf.fc&&(a.setAttribute("fill",i.fc),a.style.color=i.fc));if(this.innerElem.getBBox&&!this.hidden&&(this._isFirstFrame||this._mdf)){var l=this.innerElem.getBBox();this.currentBBox.w!==l.width&&(this.currentBBox.w=l.width,this.svgElement.setAttribute("width",l.width)),this.currentBBox.h!==l.height&&(this.currentBBox.h=l.height,this.svgElement.setAttribute("height",l.height));var h=1;if(this.currentBBox.w!==l.width+2*h||this.currentBBox.h!==l.height+2*h||this.currentBBox.x!==l.x-h||this.currentBBox.y!==l.y-h){this.currentBBox.w=l.width+2*h,this.currentBBox.h=l.height+2*h,this.currentBBox.x=l.x-h,this.currentBBox.y=l.y-h,this.svgElement.setAttribute("viewBox",this.currentBBox.x+" "+this.currentBBox.y+" "+this.currentBBox.w+" "+this.currentBBox.h),t=this.svgElement.style;var f="translate("+this.currentBBox.x+"px,"+this.currentBBox.y+"px)";t.transform=f,t.webkitTransform=f}}}},extendPrototype([BaseElement,TransformElement,HBaseElement,HSolidElement,HierarchyElement,FrameElement,RenderableElement],HImageElement),HImageElement.prototype.createContent=function(){var t=this.globalData.getAssetsPath(this.assetData),e=new Image;this.data.hasMask?(this.imageElem=createNS("image"),this.imageElem.setAttribute("width",this.assetData.w+"px"),this.imageElem.setAttribute("height",this.assetData.h+"px"),this.imageElem.setAttributeNS("http://www.w3.org/1999/xlink","href",t),this.layerElement.appendChild(this.imageElem),this.baseElement.setAttribute("width",this.assetData.w),this.baseElement.setAttribute("height",this.assetData.h)):this.layerElement.appendChild(e),e.crossOrigin="anonymous",e.src=t,this.data.ln&&this.baseElement.setAttribute("id",this.data.ln)},extendPrototype([BaseElement,FrameElement,HierarchyElement],HCameraElement),HCameraElement.prototype.setup=function(){var t,e,n,r,i=this.comp.threeDElements.length;for(t=0;t<i;t+=1)if(e=this.comp.threeDElements[t],"3d"===e.type){n=e.perspectiveElem.style,r=e.container.style;var o=this.pe.v+"px",a="0px 0px 0px",s="matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)";n.perspective=o,n.webkitPerspective=o,r.transformOrigin=a,r.mozTransformOrigin=a,r.webkitTransformOrigin=a,n.transform=s,n.webkitTransform=s}},HCameraElement.prototype.createElements=function(){},HCameraElement.prototype.hide=function(){},HCameraElement.prototype.renderFrame=function(){var t,e,n=this._isFirstFrame;if(this.hierarchy)for(e=this.hierarchy.length,t=0;t<e;t+=1)n=this.hierarchy[t].finalTransform.mProp._mdf||n;if(n||this.pe._mdf||this.p&&this.p._mdf||this.px&&(this.px._mdf||this.py._mdf||this.pz._mdf)||this.rx._mdf||this.ry._mdf||this.rz._mdf||this.or._mdf||this.a&&this.a._mdf){if(this.mat.reset(),this.hierarchy)for(e=this.hierarchy.length-1,t=e;t>=0;t-=1){var r=this.hierarchy[t].finalTransform.mProp;this.mat.translate(-r.p.v[0],-r.p.v[1],r.p.v[2]),this.mat.rotateX(-r.or.v[0]).rotateY(-r.or.v[1]).rotateZ(r.or.v[2]),this.mat.rotateX(-r.rx.v).rotateY(-r.ry.v).rotateZ(r.rz.v),this.mat.scale(1/r.s.v[0],1/r.s.v[1],1/r.s.v[2]),this.mat.translate(r.a.v[0],r.a.v[1],r.a.v[2])}if(this.p?this.mat.translate(-this.p.v[0],-this.p.v[1],this.p.v[2]):this.mat.translate(-this.px.v,-this.py.v,this.pz.v),this.a){var i;i=this.p?[this.p.v[0]-this.a.v[0],this.p.v[1]-this.a.v[1],this.p.v[2]-this.a.v[2]]:[this.px.v-this.a.v[0],this.py.v-this.a.v[1],this.pz.v-this.a.v[2]];var o=Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2)+Math.pow(i[2],2)),a=[i[0]/o,i[1]/o,i[2]/o],s=Math.sqrt(a[2]*a[2]+a[0]*a[0]),u=Math.atan2(a[1],s),c=Math.atan2(a[0],-a[2]);this.mat.rotateY(c).rotateX(-u)}this.mat.rotateX(-this.rx.v).rotateY(-this.ry.v).rotateZ(this.rz.v),this.mat.rotateX(-this.or.v[0]).rotateY(-this.or.v[1]).rotateZ(this.or.v[2]),this.mat.translate(this.globalData.compSize.w/2,this.globalData.compSize.h/2,0),this.mat.translate(0,0,this.pe.v);var l=!this._prevMat.equals(this.mat);if((l||this.pe._mdf)&&this.comp.threeDElements){var h,f,p;for(e=this.comp.threeDElements.length,t=0;t<e;t+=1)if(h=this.comp.threeDElements[t],"3d"===h.type){if(l){var d=this.mat.toCSS();p=h.container.style,p.transform=d,p.webkitTransform=d}this.pe._mdf&&(f=h.perspectiveElem.style,f.perspective=this.pe.v+"px",f.webkitPerspective=this.pe.v+"px")}this.mat.clone(this._prevMat)}}this._isFirstFrame=!1},HCameraElement.prototype.prepareFrame=function(t){this.prepareProperties(t,!0)},HCameraElement.prototype.destroy=function(){},HCameraElement.prototype.getBaseElement=function(){return null},HEffects.prototype.renderFrame=function(){};var animationManager=function(){var t={},e=[],n=0,r=0,i=0,o=!0,a=!1;function s(t){var n=0,i=t.target;while(n<r)e[n].animation===i&&(e.splice(n,1),n-=1,r-=1,i.isPaused||h()),n+=1}function u(t,n){if(!t)return null;var i=0;while(i<r){if(e[i].elem===t&&null!==e[i].elem)return e[i].animation;i+=1}var o=new AnimationItem;return f(o,t),o.setData(t,n),o}function c(){var t,n=e.length,r=[];for(t=0;t<n;t+=1)r.push(e[t].animation);return r}function l(){i+=1,A()}function h(){i-=1}function f(t,n){t.addEventListener("destroy",s),t.addEventListener("_active",l),t.addEventListener("_idle",h),e.push({elem:n,animation:t}),r+=1}function p(t){var e=new AnimationItem;return f(e,null),e.setParams(t),e}function d(t,n){var i;for(i=0;i<r;i+=1)e[i].animation.setSpeed(t,n)}function m(t,n){var i;for(i=0;i<r;i+=1)e[i].animation.setDirection(t,n)}function v(t){var n;for(n=0;n<r;n+=1)e[n].animation.play(t)}function g(t){var s,u=t-n;for(s=0;s<r;s+=1)e[s].animation.advanceTime(u);n=t,i&&!a?window.requestAnimationFrame(g):o=!0}function y(t){n=t,window.requestAnimationFrame(g)}function b(t){var n;for(n=0;n<r;n+=1)e[n].animation.pause(t)}function x(t,n,i){var o;for(o=0;o<r;o+=1)e[o].animation.goToAndStop(t,n,i)}function w(t){var n;for(n=0;n<r;n+=1)e[n].animation.stop(t)}function E(t){var n;for(n=0;n<r;n+=1)e[n].animation.togglePause(t)}function _(t){var n;for(n=r-1;n>=0;n-=1)e[n].animation.destroy(t)}function C(t,e,n){var r,i=[].concat([].slice.call(document.getElementsByClassName("lottie")),[].slice.call(document.getElementsByClassName("bodymovin"))),o=i.length;for(r=0;r<o;r+=1)n&&i[r].setAttribute("data-bm-type",n),u(i[r],t);if(e&&0===o){n||(n="svg");var a=document.getElementsByTagName("body")[0];a.innerText="";var s=createTag("div");s.style.width="100%",s.style.height="100%",s.setAttribute("data-bm-type",n),a.appendChild(s),u(s,t)}}function S(){var t;for(t=0;t<r;t+=1)e[t].animation.resize()}function A(){!a&&i&&o&&(window.requestAnimationFrame(y),o=!1)}function k(){a=!0}function T(){a=!1,A()}function I(t,n){var i;for(i=0;i<r;i+=1)e[i].animation.setVolume(t,n)}function P(t){var n;for(n=0;n<r;n+=1)e[n].animation.mute(t)}function D(t){var n;for(n=0;n<r;n+=1)e[n].animation.unmute(t)}return t.registerAnimation=u,t.loadAnimation=p,t.setSpeed=d,t.setDirection=m,t.play=v,t.pause=b,t.stop=w,t.togglePause=E,t.searchAnimations=C,t.resize=S,t.goToAndStop=x,t.destroy=_,t.freeze=k,t.unfreeze=T,t.setVolume=I,t.mute=P,t.unmute=D,t.getRegisteredAnimations=c,t}(),AnimationItem=function(){this._cbs=[],this.name="",this.path="",this.isLoaded=!1,this.currentFrame=0,this.currentRawFrame=0,this.firstFrame=0,this.totalFrames=0,this.frameRate=0,this.frameMult=0,this.playSpeed=1,this.playDirection=1,this.playCount=0,this.animationData={},this.assets=[],this.isPaused=!0,this.autoplay=!1,this.loop=!0,this.renderer=null,this.animationID=createElementID(),this.assetsPath="",this.timeCompleted=0,this.segmentPos=0,this.isSubframeEnabled=subframeEnabled,this.segments=[],this._idle=!0,this._completedLoop=!1,this.projectInterface=ProjectInterface(),this.imagePreloader=new ImagePreloader,this.audioController=audioControllerFactory(),this.markers=[]};extendPrototype([BaseEvent],AnimationItem),AnimationItem.prototype.setParams=function(t){(t.wrapper||t.container)&&(this.wrapper=t.wrapper||t.container);var e="svg";switch(t.animType?e=t.animType:t.renderer&&(e=t.renderer),e){case"canvas":this.renderer=new CanvasRenderer(this,t.rendererSettings);break;case"svg":this.renderer=new SVGRenderer(this,t.rendererSettings);break;default:this.renderer=new HybridRenderer(this,t.rendererSettings);break}this.imagePreloader.setCacheType(e,this.renderer.globalData.defs),this.renderer.setProjectInterface(this.projectInterface),this.animType=e,""===t.loop||null===t.loop||void 0===t.loop||!0===t.loop?this.loop=!0:!1===t.loop?this.loop=!1:this.loop=parseInt(t.loop,10),this.autoplay=!("autoplay"in t)||t.autoplay,this.name=t.name?t.name:"",this.autoloadSegments=!Object.prototype.hasOwnProperty.call(t,"autoloadSegments")||t.autoloadSegments,this.assetsPath=t.assetsPath,this.initialSegment=t.initialSegment,t.audioFactory&&this.audioController.setAudioFactory(t.audioFactory),t.animationData?this.configAnimation(t.animationData):t.path&&(-1!==t.path.lastIndexOf("\\")?this.path=t.path.substr(0,t.path.lastIndexOf("\\")+1):this.path=t.path.substr(0,t.path.lastIndexOf("/")+1),this.fileName=t.path.substr(t.path.lastIndexOf("/")+1),this.fileName=this.fileName.substr(0,this.fileName.lastIndexOf(".json")),assetLoader.load(t.path,this.configAnimation.bind(this),function(){this.trigger("data_failed")}.bind(this)))},AnimationItem.prototype.setData=function(t,e){e&&"object"!==typeof e&&(e=JSON.parse(e));var n={wrapper:t,animationData:e},r=t.attributes;n.path=r.getNamedItem("data-animation-path")?r.getNamedItem("data-animation-path").value:r.getNamedItem("data-bm-path")?r.getNamedItem("data-bm-path").value:r.getNamedItem("bm-path")?r.getNamedItem("bm-path").value:"",n.animType=r.getNamedItem("data-anim-type")?r.getNamedItem("data-anim-type").value:r.getNamedItem("data-bm-type")?r.getNamedItem("data-bm-type").value:r.getNamedItem("bm-type")?r.getNamedItem("bm-type").value:r.getNamedItem("data-bm-renderer")?r.getNamedItem("data-bm-renderer").value:r.getNamedItem("bm-renderer")?r.getNamedItem("bm-renderer").value:"canvas";var i=r.getNamedItem("data-anim-loop")?r.getNamedItem("data-anim-loop").value:r.getNamedItem("data-bm-loop")?r.getNamedItem("data-bm-loop").value:r.getNamedItem("bm-loop")?r.getNamedItem("bm-loop").value:"";"false"===i?n.loop=!1:"true"===i?n.loop=!0:""!==i&&(n.loop=parseInt(i,10));var o=r.getNamedItem("data-anim-autoplay")?r.getNamedItem("data-anim-autoplay").value:r.getNamedItem("data-bm-autoplay")?r.getNamedItem("data-bm-autoplay").value:!r.getNamedItem("bm-autoplay")||r.getNamedItem("bm-autoplay").value;n.autoplay="false"!==o,n.name=r.getNamedItem("data-name")?r.getNamedItem("data-name").value:r.getNamedItem("data-bm-name")?r.getNamedItem("data-bm-name").value:r.getNamedItem("bm-name")?r.getNamedItem("bm-name").value:"";var a=r.getNamedItem("data-anim-prerender")?r.getNamedItem("data-anim-prerender").value:r.getNamedItem("data-bm-prerender")?r.getNamedItem("data-bm-prerender").value:r.getNamedItem("bm-prerender")?r.getNamedItem("bm-prerender").value:"";"false"===a&&(n.prerender=!1),this.setParams(n)},AnimationItem.prototype.includeLayers=function(t){t.op>this.animationData.op&&(this.animationData.op=t.op,this.totalFrames=Math.floor(t.op-this.animationData.ip));var e,n,r=this.animationData.layers,i=r.length,o=t.layers,a=o.length;for(n=0;n<a;n+=1){e=0;while(e<i){if(r[e].id===o[n].id){r[e]=o[n];break}e+=1}}if((t.chars||t.fonts)&&(this.renderer.globalData.fontManager.addChars(t.chars),this.renderer.globalData.fontManager.addFonts(t.fonts,this.renderer.globalData.defs)),t.assets)for(i=t.assets.length,e=0;e<i;e+=1)this.animationData.assets.push(t.assets[e]);this.animationData.__complete=!1,dataManager.completeData(this.animationData,this.renderer.globalData.fontManager),this.renderer.includeLayers(t.layers),expressionsPlugin&&expressionsPlugin.initExpressions(this),this.loadNextSegment()},AnimationItem.prototype.loadNextSegment=function(){var t=this.animationData.segments;if(!t||0===t.length||!this.autoloadSegments)return this.trigger("data_ready"),void(this.timeCompleted=this.totalFrames);var e=t.shift();this.timeCompleted=e.time*this.frameRate;var n=this.path+this.fileName+"_"+this.segmentPos+".json";this.segmentPos+=1,assetLoader.load(n,this.includeLayers.bind(this),function(){this.trigger("data_failed")}.bind(this))},AnimationItem.prototype.loadSegments=function(){var t=this.animationData.segments;t||(this.timeCompleted=this.totalFrames),this.loadNextSegment()},AnimationItem.prototype.imagesLoaded=function(){this.trigger("loaded_images"),this.checkLoaded()},AnimationItem.prototype.preloadImages=function(){this.imagePreloader.setAssetsPath(this.assetsPath),this.imagePreloader.setPath(this.path),this.imagePreloader.loadAssets(this.animationData.assets,this.imagesLoaded.bind(this))},AnimationItem.prototype.configAnimation=function(t){if(this.renderer)try{this.animationData=t,this.initialSegment?(this.totalFrames=Math.floor(this.initialSegment[1]-this.initialSegment[0]),this.firstFrame=Math.round(this.initialSegment[0])):(this.totalFrames=Math.floor(this.animationData.op-this.animationData.ip),this.firstFrame=Math.round(this.animationData.ip)),this.renderer.configAnimation(t),t.assets||(t.assets=[]),this.assets=this.animationData.assets,this.frameRate=this.animationData.fr,this.frameMult=this.animationData.fr/1e3,this.renderer.searchExtraCompositions(t.assets),this.markers=markerParser(t.markers||[]),this.trigger("config_ready"),this.preloadImages(),this.loadSegments(),this.updaFrameModifier(),this.waitForFontsLoaded(),this.isPaused&&this.audioController.pause()}catch(e){this.triggerConfigError(e)}},AnimationItem.prototype.waitForFontsLoaded=function(){this.renderer&&(this.renderer.globalData.fontManager.isLoaded?this.checkLoaded():setTimeout(this.waitForFontsLoaded.bind(this),20))},AnimationItem.prototype.checkLoaded=function(){!this.isLoaded&&this.renderer.globalData.fontManager.isLoaded&&(this.imagePreloader.loadedImages()||"canvas"!==this.renderer.rendererType)&&this.imagePreloader.loadedFootages()&&(this.isLoaded=!0,dataManager.completeData(this.animationData,this.renderer.globalData.fontManager),expressionsPlugin&&expressionsPlugin.initExpressions(this),this.renderer.initItems(),setTimeout(function(){this.trigger("DOMLoaded")}.bind(this),0),this.gotoFrame(),this.autoplay&&this.play())},AnimationItem.prototype.resize=function(){this.renderer.updateContainerSize()},AnimationItem.prototype.setSubframe=function(t){this.isSubframeEnabled=!!t},AnimationItem.prototype.gotoFrame=function(){this.currentFrame=this.isSubframeEnabled?this.currentRawFrame:~~this.currentRawFrame,this.timeCompleted!==this.totalFrames&&this.currentFrame>this.timeCompleted&&(this.currentFrame=this.timeCompleted),this.trigger("enterFrame"),this.renderFrame()},AnimationItem.prototype.renderFrame=function(){if(!1!==this.isLoaded&&this.renderer)try{this.renderer.renderFrame(this.currentFrame+this.firstFrame)}catch(t){this.triggerRenderFrameError(t)}},AnimationItem.prototype.play=function(t){t&&this.name!==t||!0===this.isPaused&&(this.isPaused=!1,this.audioController.resume(),this._idle&&(this._idle=!1,this.trigger("_active")))},AnimationItem.prototype.pause=function(t){t&&this.name!==t||!1===this.isPaused&&(this.isPaused=!0,this._idle=!0,this.trigger("_idle"),this.audioController.pause())},AnimationItem.prototype.togglePause=function(t){t&&this.name!==t||(!0===this.isPaused?this.play():this.pause())},AnimationItem.prototype.stop=function(t){t&&this.name!==t||(this.pause(),this.playCount=0,this._completedLoop=!1,this.setCurrentRawFrameValue(0))},AnimationItem.prototype.getMarkerData=function(t){for(var e,n=0;n<this.markers.length;n+=1)if(e=this.markers[n],e.payload&&e.payload.name===t)return e;return null},AnimationItem.prototype.goToAndStop=function(t,e,n){if(!n||this.name===n){var r=Number(t);if(isNaN(r)){var i=this.getMarkerData(t);i&&this.goToAndStop(i.time,!0)}else e?this.setCurrentRawFrameValue(t):this.setCurrentRawFrameValue(t*this.frameModifier);this.pause()}},AnimationItem.prototype.goToAndPlay=function(t,e,n){if(!n||this.name===n){var r=Number(t);if(isNaN(r)){var i=this.getMarkerData(t);i&&(i.duration?this.playSegments([i.time,i.time+i.duration],!0):this.goToAndStop(i.time,!0))}else this.goToAndStop(r,e,n);this.play()}},AnimationItem.prototype.advanceTime=function(t){if(!0!==this.isPaused&&!1!==this.isLoaded){var e=this.currentRawFrame+t*this.frameModifier,n=!1;e>=this.totalFrames-1&&this.frameModifier>0?this.loop&&this.playCount!==this.loop?e>=this.totalFrames?(this.playCount+=1,this.checkSegments(e%this.totalFrames)||(this.setCurrentRawFrameValue(e%this.totalFrames),this._completedLoop=!0,this.trigger("loopComplete"))):this.setCurrentRawFrameValue(e):this.checkSegments(e>this.totalFrames?e%this.totalFrames:0)||(n=!0,e=this.totalFrames-1):e<0?this.checkSegments(e%this.totalFrames)||(!this.loop||this.playCount--<=0&&!0!==this.loop?(n=!0,e=0):(this.setCurrentRawFrameValue(this.totalFrames+e%this.totalFrames),this._completedLoop?this.trigger("loopComplete"):this._completedLoop=!0)):this.setCurrentRawFrameValue(e),n&&(this.setCurrentRawFrameValue(e),this.pause(),this.trigger("complete"))}},AnimationItem.prototype.adjustSegment=function(t,e){this.playCount=0,t[1]<t[0]?(this.frameModifier>0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(-1)),this.totalFrames=t[0]-t[1],this.timeCompleted=this.totalFrames,this.firstFrame=t[1],this.setCurrentRawFrameValue(this.totalFrames-.001-e)):t[1]>t[0]&&(this.frameModifier<0&&(this.playSpeed<0?this.setSpeed(-this.playSpeed):this.setDirection(1)),this.totalFrames=t[1]-t[0],this.timeCompleted=this.totalFrames,this.firstFrame=t[0],this.setCurrentRawFrameValue(.001+e)),this.trigger("segmentStart")},AnimationItem.prototype.setSegment=function(t,e){var n=-1;this.isPaused&&(this.currentRawFrame+this.firstFrame<t?n=t:this.currentRawFrame+this.firstFrame>e&&(n=e-t)),this.firstFrame=t,this.totalFrames=e-t,this.timeCompleted=this.totalFrames,-1!==n&&this.goToAndStop(n,!0)},AnimationItem.prototype.playSegments=function(t,e){if(e&&(this.segments.length=0),"object"===typeof t[0]){var n,r=t.length;for(n=0;n<r;n+=1)this.segments.push(t[n])}else this.segments.push(t);this.segments.length&&e&&this.adjustSegment(this.segments.shift(),0),this.isPaused&&this.play()},AnimationItem.prototype.resetSegments=function(t){this.segments.length=0,this.segments.push([this.animationData.ip,this.animationData.op]),t&&this.checkSegments(0)},AnimationItem.prototype.checkSegments=function(t){return!!this.segments.length&&(this.adjustSegment(this.segments.shift(),t),!0)},AnimationItem.prototype.destroy=function(t){t&&this.name!==t||!this.renderer||(this.renderer.destroy(),this.imagePreloader.destroy(),this.trigger("destroy"),this._cbs=null,this.onEnterFrame=null,this.onLoopComplete=null,this.onComplete=null,this.onSegmentStart=null,this.onDestroy=null,this.renderer=null,this.renderer=null,this.imagePreloader=null,this.projectInterface=null)},AnimationItem.prototype.setCurrentRawFrameValue=function(t){this.currentRawFrame=t,this.gotoFrame()},AnimationItem.prototype.setSpeed=function(t){this.playSpeed=t,this.updaFrameModifier()},AnimationItem.prototype.setDirection=function(t){this.playDirection=t<0?-1:1,this.updaFrameModifier()},AnimationItem.prototype.setVolume=function(t,e){e&&this.name!==e||this.audioController.setVolume(t)},AnimationItem.prototype.getVolume=function(){return this.audioController.getVolume()},AnimationItem.prototype.mute=function(t){t&&this.name!==t||this.audioController.mute()},AnimationItem.prototype.unmute=function(t){t&&this.name!==t||this.audioController.unmute()},AnimationItem.prototype.updaFrameModifier=function(){this.frameModifier=this.frameMult*this.playSpeed*this.playDirection,this.audioController.setRate(this.playSpeed*this.playDirection)},AnimationItem.prototype.getPath=function(){return this.path},AnimationItem.prototype.getAssetsPath=function(t){var e="";if(t.e)e=t.p;else if(this.assetsPath){var n=t.p;-1!==n.indexOf("images/")&&(n=n.split("/")[1]),e=this.assetsPath+n}else e=this.path,e+=t.u?t.u:"",e+=t.p;return e},AnimationItem.prototype.getAssetData=function(t){var e=0,n=this.assets.length;while(e<n){if(t===this.assets[e].id)return this.assets[e];e+=1}return null},AnimationItem.prototype.hide=function(){this.renderer.hide()},AnimationItem.prototype.show=function(){this.renderer.show()},AnimationItem.prototype.getDuration=function(t){return t?this.totalFrames:this.totalFrames/this.frameRate},AnimationItem.prototype.trigger=function(t){if(this._cbs&&this._cbs[t])switch(t){case"enterFrame":this.triggerEvent(t,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameModifier));break;case"loopComplete":this.triggerEvent(t,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult));break;case"complete":this.triggerEvent(t,new BMCompleteEvent(t,this.frameMult));break;case"segmentStart":this.triggerEvent(t,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames));break;case"destroy":this.triggerEvent(t,new BMDestroyEvent(t,this));break;default:this.triggerEvent(t)}"enterFrame"===t&&this.onEnterFrame&&this.onEnterFrame.call(this,new BMEnterFrameEvent(t,this.currentFrame,this.totalFrames,this.frameMult)),"loopComplete"===t&&this.onLoopComplete&&this.onLoopComplete.call(this,new BMCompleteLoopEvent(t,this.loop,this.playCount,this.frameMult)),"complete"===t&&this.onComplete&&this.onComplete.call(this,new BMCompleteEvent(t,this.frameMult)),"segmentStart"===t&&this.onSegmentStart&&this.onSegmentStart.call(this,new BMSegmentStartEvent(t,this.firstFrame,this.totalFrames)),"destroy"===t&&this.onDestroy&&this.onDestroy.call(this,new BMDestroyEvent(t,this))},AnimationItem.prototype.triggerRenderFrameError=function(t){var e=new BMRenderFrameErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)},AnimationItem.prototype.triggerConfigError=function(t){var e=new BMConfigErrorEvent(t,this.currentFrame);this.triggerEvent("error",e),this.onError&&this.onError.call(this,e)};var Expressions=function(){var t={};function e(t){var e=0,n=[];function r(){e+=1}function i(){e-=1,0===e&&a()}function o(t){-1===n.indexOf(t)&&n.push(t)}function a(){var t,e=n.length;for(t=0;t<e;t+=1)n[t].release();n.length=0}t.renderer.compInterface=CompExpressionInterface(t.renderer),t.renderer.globalData.projectInterface.registerComposition(t.renderer),t.renderer.globalData.pushExpression=r,t.renderer.globalData.popExpression=i,t.renderer.globalData.registerExpressionProperty=o}return t.initExpressions=e,t}();expressionsPlugin=Expressions;var ExpressionManager=function(){var ob={},Math=BMMath,window=null,document=null,XMLHttpRequest=null,fetch=null;function $bm_isInstanceOfArray(t){return t.constructor===Array||t.constructor===Float32Array}function isNumerable(t,e){return"number"===t||"boolean"===t||"string"===t||e instanceof Number}function $bm_neg(t){var e=typeof t;if("number"===e||"boolean"===e||t instanceof Number)return-t;if($bm_isInstanceOfArray(t)){var n,r=t.length,i=[];for(n=0;n<r;n+=1)i[n]=-t[n];return i}return t.propType?t.v:-t}var easeInBez=BezierFactory.getBezierEasing(.333,0,.833,.833,"easeIn").get,easeOutBez=BezierFactory.getBezierEasing(.167,.167,.667,1,"easeOut").get,easeInOutBez=BezierFactory.getBezierEasing(.33,0,.667,1,"easeInOut").get;function sum(t,e){var n=typeof t,r=typeof e;if("string"===n||"string"===r)return t+e;if(isNumerable(n,t)&&isNumerable(r,e))return t+e;if($bm_isInstanceOfArray(t)&&isNumerable(r,e))return t=t.slice(0),t[0]+=e,t;if(isNumerable(n,t)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=t+e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){var i=0,o=t.length,a=e.length,s=[];while(i<o||i<a)("number"===typeof t[i]||t[i]instanceof Number)&&("number"===typeof e[i]||e[i]instanceof Number)?s[i]=t[i]+e[i]:s[i]=void 0===e[i]?t[i]:t[i]||e[i],i+=1;return s}return 0}var add=sum;function sub(t,e){var n=typeof t,r=typeof e;if(isNumerable(n,t)&&isNumerable(r,e))return"string"===n&&(t=parseInt(t,10)),"string"===r&&(e=parseInt(e,10)),t-e;if($bm_isInstanceOfArray(t)&&isNumerable(r,e))return t=t.slice(0),t[0]-=e,t;if(isNumerable(n,t)&&$bm_isInstanceOfArray(e))return e=e.slice(0),e[0]=t-e[0],e;if($bm_isInstanceOfArray(t)&&$bm_isInstanceOfArray(e)){var i=0,o=t.length,a=e.length,s=[];while(i<o||i<a)("number"===typeof t[i]||t[i]instanceof Number)&&("number"===typeof e[i]||e[i]instanceof Number)?s[i]=t[i]-e[i]:s[i]=void 0===e[i]?t[i]:t[i]||e[i],i+=1;return s}return 0}function mul(t,e){var n,r,i,o=typeof t,a=typeof e;if(isNumerable(o,t)&&isNumerable(a,e))return t*e;if($bm_isInstanceOfArray(t)&&isNumerable(a,e)){for(i=t.length,n=createTypedArray("float32",i),r=0;r<i;r+=1)n[r]=t[r]*e;return n}if(isNumerable(o,t)&&$bm_isInstanceOfArray(e)){for(i=e.length,n=createTypedArray("float32",i),r=0;r<i;r+=1)n[r]=t*e[r];return n}return 0}function div(t,e){var n,r,i,o=typeof t,a=typeof e;if(isNumerable(o,t)&&isNumerable(a,e))return t/e;if($bm_isInstanceOfArray(t)&&isNumerable(a,e)){for(i=t.length,n=createTypedArray("float32",i),r=0;r<i;r+=1)n[r]=t[r]/e;return n}if(isNumerable(o,t)&&$bm_isInstanceOfArray(e)){for(i=e.length,n=createTypedArray("float32",i),r=0;r<i;r+=1)n[r]=t/e[r];return n}return 0}function mod(t,e){return"string"===typeof t&&(t=parseInt(t,10)),"string"===typeof e&&(e=parseInt(e,10)),t%e}var $bm_sum=sum,$bm_sub=sub,$bm_mul=mul,$bm_div=div,$bm_mod=mod;function clamp(t,e,n){if(e>n){var r=n;n=e,e=r}return Math.min(Math.max(t,e),n)}function radiansToDegrees(t){return t/degToRads}var radians_to_degrees=radiansToDegrees;function degreesToRadians(t){return t*degToRads}var degrees_to_radians=radiansToDegrees,helperLengthArray=[0,0,0,0,0,0];function length(t,e){if("number"===typeof t||t instanceof Number)return e=e||0,Math.abs(t-e);var n;e||(e=helperLengthArray);var r=Math.min(t.length,e.length),i=0;for(n=0;n<r;n+=1)i+=Math.pow(e[n]-t[n],2);return Math.sqrt(i)}function normalize(t){return div(t,length(t))}function rgbToHsl(t){var e,n,r=t[0],i=t[1],o=t[2],a=Math.max(r,i,o),s=Math.min(r,i,o),u=(a+s)/2;if(a===s)e=0,n=0;else{var c=a-s;switch(n=u>.5?c/(2-a-s):c/(a+s),a){case r:e=(i-o)/c+(i<o?6:0);break;case i:e=(o-r)/c+2;break;case o:e=(r-i)/c+4;break;default:break}e/=6}return[e,n,u,t[3]]}function hue2rgb(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function hslToRgb(t){var e,n,r,i=t[0],o=t[1],a=t[2];if(0===o)e=a,r=a,n=a;else{var s=a<.5?a*(1+o):a+o-a*o,u=2*a-s;e=hue2rgb(u,s,i+1/3),n=hue2rgb(u,s,i),r=hue2rgb(u,s,i-1/3)}return[e,n,r,t[3]]}function linear(t,e,n,r,i){if(void 0!==r&&void 0!==i||(r=e,i=n,e=0,n=1),n<e){var o=n;n=e,e=o}if(t<=e)return r;if(t>=n)return i;var a,s=n===e?0:(t-e)/(n-e);if(!r.length)return r+(i-r)*s;var u=r.length,c=createTypedArray("float32",u);for(a=0;a<u;a+=1)c[a]=r[a]+(i[a]-r[a])*s;return c}function random(t,e){if(void 0===e&&(void 0===t?(t=0,e=1):(e=t,t=void 0)),e.length){var n,r=e.length;t||(t=createTypedArray("float32",r));var i=createTypedArray("float32",r),o=BMMath.random();for(n=0;n<r;n+=1)i[n]=t[n]+o*(e[n]-t[n]);return i}void 0===t&&(t=0);var a=BMMath.random();return t+a*(e-t)}function createPath(t,e,n,r){var i,o=t.length,a=shapePool.newElement();a.setPathData(!!r,o);var s,u,c=[0,0];for(i=0;i<o;i+=1)s=e&&e[i]?e[i]:c,u=n&&n[i]?n[i]:c,a.setTripleAt(t[i][0],t[i][1],u[0]+t[i][0],u[1]+t[i][1],s[0]+t[i][0],s[1]+t[i][1],i,!0);return a}function initiateExpression(elem,data,property){var val=data.x,needsVelocity=/velocity(?![\w\d])/.test(val),_needsRandom=-1!==val.indexOf("random"),elemType=elem.data.ty,transform,$bm_transform,content,effect,thisProperty=property;thisProperty.valueAtTime=thisProperty.getValueAtTime,Object.defineProperty(thisProperty,"value",{get:function(){return thisProperty.v}}),elem.comp.frameDuration=1/elem.comp.globalData.frameRate,elem.comp.displayStartTime=0;var inPoint=elem.data.ip/elem.comp.globalData.frameRate,outPoint=elem.data.op/elem.comp.globalData.frameRate,width=elem.data.sw?elem.data.sw:0,height=elem.data.sh?elem.data.sh:0,name=elem.data.nm,loopIn,loop_in,loopOut,loop_out,smooth,toWorld,fromWorld,fromComp,toComp,fromCompToSurface,position,rotation,anchorPoint,scale,thisLayer,thisComp,mask,valueAtTime,velocityAtTime,scoped_bm_rt,expression_function=eval("[function _expression_function(){"+val+";scoped_bm_rt=$bm_rt}]")[0],numKeys=property.kf?data.k.length:0,active=!this.data||!0!==this.data.hd,wiggle=function(t,e){var n,r,i=this.pv.length?this.pv.length:1,o=createTypedArray("float32",i);t=5;var a=Math.floor(time*t);n=0,r=0;while(n<a){for(r=0;r<i;r+=1)o[r]+=-e+2*e*BMMath.random();n+=1}var s=time*t,u=s-Math.floor(s),c=createTypedArray("float32",i);if(i>1){for(r=0;r<i;r+=1)c[r]=this.pv[r]+o[r]+(-e+2*e*BMMath.random())*u;return c}return this.pv+o[0]+(-e+2*e*BMMath.random())*u}.bind(this);function loopInDuration(t,e){return loopIn(t,e,!0)}function loopOutDuration(t,e){return loopOut(t,e,!0)}thisProperty.loopIn&&(loopIn=thisProperty.loopIn.bind(thisProperty),loop_in=loopIn),thisProperty.loopOut&&(loopOut=thisProperty.loopOut.bind(thisProperty),loop_out=loopOut),thisProperty.smooth&&(smooth=thisProperty.smooth.bind(thisProperty)),this.getValueAtTime&&(valueAtTime=this.getValueAtTime.bind(this)),this.getVelocityAtTime&&(velocityAtTime=this.getVelocityAtTime.bind(this));var comp=elem.comp.globalData.projectInterface.bind(elem.comp.globalData.projectInterface),time,velocity,value,text,textIndex,textTotal,selectorValue;function lookAt(t,e){var n=[e[0]-t[0],e[1]-t[1],e[2]-t[2]],r=Math.atan2(n[0],Math.sqrt(n[1]*n[1]+n[2]*n[2]))/degToRads,i=-Math.atan2(n[1],n[2])/degToRads;return[i,r,0]}function easeOut(t,e,n,r,i){return applyEase(easeOutBez,t,e,n,r,i)}function easeIn(t,e,n,r,i){return applyEase(easeInBez,t,e,n,r,i)}function ease(t,e,n,r,i){return applyEase(easeInOutBez,t,e,n,r,i)}function applyEase(t,e,n,r,i,o){void 0===i?(i=n,o=r):e=(e-n)/(r-n),e>1?e=1:e<0&&(e=0);var a=t(e);if($bm_isInstanceOfArray(i)){var s,u=i.length,c=createTypedArray("float32",u);for(s=0;s<u;s+=1)c[s]=(o[s]-i[s])*a+i[s];return c}return(o-i)*a+i}function nearestKey(t){var e,n,r,i=data.k.length;if(data.k.length&&"number"!==typeof data.k[0])if(n=-1,t*=elem.comp.globalData.frameRate,t<data.k[0].t)n=1,r=data.k[0].t;else{for(e=0;e<i-1;e+=1){if(t===data.k[e].t){n=e+1,r=data.k[e].t;break}if(t>data.k[e].t&&t<data.k[e+1].t){t-data.k[e].t>data.k[e+1].t-t?(n=e+2,r=data.k[e+1].t):(n=e+1,r=data.k[e].t);break}}-1===n&&(n=e+1,r=data.k[e].t)}else n=0,r=0;var o={};return o.index=n,o.time=r/elem.comp.globalData.frameRate,o}function key(t){var e,n,r;if(!data.k.length||"number"===typeof data.k[0])throw new Error("The property has no keyframe at index "+t);t-=1,e={time:data.k[t].t/elem.comp.globalData.frameRate,value:[]};var i=Object.prototype.hasOwnProperty.call(data.k[t],"s")?data.k[t].s:data.k[t-1].e;for(r=i.length,n=0;n<r;n+=1)e[n]=i[n],e.value[n]=i[n];return e}function framesToTime(t,e){return e||(e=elem.comp.globalData.frameRate),t/e}function timeToFrames(t,e){return t||0===t||(t=time),e||(e=elem.comp.globalData.frameRate),t*e}function seedRandom(t){BMMath.seedrandom(randSeed+t)}function sourceRectAtTime(){return elem.sourceRectAtTime()}function substring(t,e){return"string"===typeof value?void 0===e?value.substring(t):value.substring(t,e):""}function substr(t,e){return"string"===typeof value?void 0===e?value.substr(t):value.substr(t,e):""}function posterizeTime(t){time=0===t?0:Math.floor(time*t)/t,value=valueAtTime(time)}var index=elem.data.ind,hasParent=!(!elem.hierarchy||!elem.hierarchy.length),parent,randSeed=Math.floor(1e6*Math.random()),globalData=elem.globalData;function executeExpression(t){return value=t,_needsRandom&&seedRandom(randSeed),this.frameExpressionId===elem.globalData.frameId&&"textSelector"!==this.propType?value:("textSelector"===this.propType&&(textIndex=this.textIndex,textTotal=this.textTotal,selectorValue=this.selectorValue),thisLayer||(text=elem.layerInterface.text,thisLayer=elem.layerInterface,thisComp=elem.comp.compInterface,toWorld=thisLayer.toWorld.bind(thisLayer),fromWorld=thisLayer.fromWorld.bind(thisLayer),fromComp=thisLayer.fromComp.bind(thisLayer),toComp=thisLayer.toComp.bind(thisLayer),mask=thisLayer.mask?thisLayer.mask.bind(thisLayer):null,fromCompToSurface=fromComp),transform||(transform=elem.layerInterface("ADBE Transform Group"),$bm_transform=transform,transform&&(anchorPoint=transform.anchorPoint)),4!==elemType||content||(content=thisLayer("ADBE Root Vectors Group")),effect||(effect=thisLayer(4)),hasParent=!(!elem.hierarchy||!elem.hierarchy.length),hasParent&&!parent&&(parent=elem.hierarchy[0].layerInterface),time=this.comp.renderedFrame/this.comp.globalData.frameRate,needsVelocity&&(velocity=velocityAtTime(time)),expression_function(),this.frameExpressionId=elem.globalData.frameId,"shape"===scoped_bm_rt.propType&&(scoped_bm_rt=scoped_bm_rt.v),scoped_bm_rt)}return executeExpression}return ob.initiateExpression=initiateExpression,ob}(),expressionHelpers=function(){function t(t,e,n){e.x&&(n.k=!0,n.x=!0,n.initiateExpression=ExpressionManager.initiateExpression,n.effectsSequence.push(n.initiateExpression(t,e,n).bind(n)))}function e(t){return t*=this.elem.globalData.frameRate,t-=this.offsetTime,t!==this._cachingAtTime.lastFrame&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastFrame<t?this._cachingAtTime.lastIndex:0,this._cachingAtTime.value=this.interpolateValue(t,this._cachingAtTime),this._cachingAtTime.lastFrame=t),this._cachingAtTime.value}function n(t){var e=-.01,n=this.getValueAtTime(t),r=this.getValueAtTime(t+e),i=0;if(n.length){var o;for(o=0;o<n.length;o+=1)i+=Math.pow(r[o]-n[o],2);i=100*Math.sqrt(i)}else i=0;return i}function r(t){if(void 0!==this.vel)return this.vel;var e,n,r=-.001,i=this.getValueAtTime(t),o=this.getValueAtTime(t+r);if(i.length)for(e=createTypedArray("float32",i.length),n=0;n<i.length;n+=1)e[n]=(o[n]-i[n])/r;else e=(o-i)/r;return e}function i(){return this.pv}function o(t){this.propertyGroup=t}return{searchExpressions:t,getSpeedAtTime:n,getVelocityAtTime:r,getValueAtTime:e,getStaticValueAtTime:i,setGroupProperty:o}}();(function(){function t(t,e,n){if(!this.k||!this.keyframes)return this.pv;t=t?t.toLowerCase():"";var r,i,o,a,s,u=this.comp.renderedFrame,c=this.keyframes,l=c[c.length-1].t;if(u<=l)return this.pv;if(n?(r=e?Math.abs(l-this.elem.comp.globalData.frameRate*e):Math.max(0,l-this.elem.data.ip),i=l-r):((!e||e>c.length-1)&&(e=c.length-1),i=c[c.length-1-e].t,r=l-i),"pingpong"===t){var h=Math.floor((u-i)/r);if(h%2!==0)return this.getValueAtTime((r-(u-i)%r+i)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var f=this.getValueAtTime(i/this.comp.globalData.frameRate,0),p=this.getValueAtTime(l/this.comp.globalData.frameRate,0),d=this.getValueAtTime(((u-i)%r+i)/this.comp.globalData.frameRate,0),m=Math.floor((u-i)/r);if(this.pv.length){for(s=new Array(f.length),a=s.length,o=0;o<a;o+=1)s[o]=(p[o]-f[o])*m+d[o];return s}return(p-f)*m+d}if("continue"===t){var v=this.getValueAtTime(l/this.comp.globalData.frameRate,0),g=this.getValueAtTime((l-.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=new Array(v.length),a=s.length,o=0;o<a;o+=1)s[o]=v[o]+(v[o]-g[o])*((u-l)/this.comp.globalData.frameRate)/5e-4;return s}return v+(u-l)/.001*(v-g)}}return this.getValueAtTime(((u-i)%r+i)/this.comp.globalData.frameRate,0)}function e(t,e,n){if(!this.k)return this.pv;t=t?t.toLowerCase():"";var r,i,o,a,s,u=this.comp.renderedFrame,c=this.keyframes,l=c[0].t;if(u>=l)return this.pv;if(n?(r=e?Math.abs(this.elem.comp.globalData.frameRate*e):Math.max(0,this.elem.data.op-l),i=l+r):((!e||e>c.length-1)&&(e=c.length-1),i=c[e].t,r=i-l),"pingpong"===t){var h=Math.floor((l-u)/r);if(h%2===0)return this.getValueAtTime(((l-u)%r+l)/this.comp.globalData.frameRate,0)}else{if("offset"===t){var f=this.getValueAtTime(l/this.comp.globalData.frameRate,0),p=this.getValueAtTime(i/this.comp.globalData.frameRate,0),d=this.getValueAtTime((r-(l-u)%r+l)/this.comp.globalData.frameRate,0),m=Math.floor((l-u)/r)+1;if(this.pv.length){for(s=new Array(f.length),a=s.length,o=0;o<a;o+=1)s[o]=d[o]-(p[o]-f[o])*m;return s}return d-(p-f)*m}if("continue"===t){var v=this.getValueAtTime(l/this.comp.globalData.frameRate,0),g=this.getValueAtTime((l+.001)/this.comp.globalData.frameRate,0);if(this.pv.length){for(s=new Array(v.length),a=s.length,o=0;o<a;o+=1)s[o]=v[o]+(v[o]-g[o])*(l-u)/.001;return s}return v+(v-g)*(l-u)/.001}}return this.getValueAtTime((r-((l-u)%r+l))/this.comp.globalData.frameRate,0)}function n(t,e){if(!this.k)return this.pv;if(t=.5*(t||.4),e=Math.floor(e||5),e<=1)return this.pv;var n,r,i=this.comp.renderedFrame/this.comp.globalData.frameRate,o=i-t,a=i+t,s=e>1?(a-o)/(e-1):1,u=0,c=0;n=this.pv.length?createTypedArray("float32",this.pv.length):0;while(u<e){if(r=this.getValueAtTime(o+u*s),this.pv.length)for(c=0;c<this.pv.length;c+=1)n[c]+=r[c];else n+=r;u+=1}if(this.pv.length)for(c=0;c<this.pv.length;c+=1)n[c]/=e;else n/=e;return n}function r(t){this._transformCachingAtTime||(this._transformCachingAtTime={v:new Matrix});var e=this._transformCachingAtTime.v;if(e.cloneFromProps(this.pre.props),this.appliedTransformations<1){var n=this.a.getValueAtTime(t);e.translate(-n[0]*this.a.mult,-n[1]*this.a.mult,n[2]*this.a.mult)}if(this.appliedTransformations<2){var r=this.s.getValueAtTime(t);e.scale(r[0]*this.s.mult,r[1]*this.s.mult,r[2]*this.s.mult)}if(this.sk&&this.appliedTransformations<3){var i=this.sk.getValueAtTime(t),o=this.sa.getValueAtTime(t);e.skewFromAxis(-i*this.sk.mult,o*this.sa.mult)}if(this.r&&this.appliedTransformations<4){var a=this.r.getValueAtTime(t);e.rotate(-a*this.r.mult)}else if(!this.r&&this.appliedTransformations<4){var s=this.rz.getValueAtTime(t),u=this.ry.getValueAtTime(t),c=this.rx.getValueAtTime(t),l=this.or.getValueAtTime(t);e.rotateZ(-s*this.rz.mult).rotateY(u*this.ry.mult).rotateX(c*this.rx.mult).rotateZ(-l[2]*this.or.mult).rotateY(l[1]*this.or.mult).rotateX(l[0]*this.or.mult)}if(this.data.p&&this.data.p.s){var h=this.px.getValueAtTime(t),f=this.py.getValueAtTime(t);if(this.data.p.z){var p=this.pz.getValueAtTime(t);e.translate(h*this.px.mult,f*this.py.mult,-p*this.pz.mult)}else e.translate(h*this.px.mult,f*this.py.mult,0)}else{var d=this.p.getValueAtTime(t);e.translate(d[0]*this.p.mult,d[1]*this.p.mult,-d[2]*this.p.mult)}return e}function i(){return this.v.clone(new Matrix)}var o=TransformPropertyFactory.getTransformProperty;TransformPropertyFactory.getTransformProperty=function(t,e,n){var a=o(t,e,n);return a.dynamicProperties.length?a.getValueAtTime=r.bind(a):a.getValueAtTime=i.bind(a),a.setGroupProperty=expressionHelpers.setGroupProperty,a};var a=PropertyFactory.getProp;function s(t){return this._cachingAtTime||(this._cachingAtTime={shapeValue:shapePool.clone(this.pv),lastIndex:0,lastTime:initialDefaultFrame}),t*=this.elem.globalData.frameRate,t-=this.offsetTime,t!==this._cachingAtTime.lastTime&&(this._cachingAtTime.lastIndex=this._cachingAtTime.lastTime<t?this._caching.lastIndex:0,this._cachingAtTime.lastTime=t,this.interpolateShape(t,this._cachingAtTime.shapeValue,this._cachingAtTime)),this._cachingAtTime.shapeValue}PropertyFactory.getProp=function(r,i,o,s,u){var c=a(r,i,o,s,u);c.kf?c.getValueAtTime=expressionHelpers.getValueAtTime.bind(c):c.getValueAtTime=expressionHelpers.getStaticValueAtTime.bind(c),c.setGroupProperty=expressionHelpers.setGroupProperty,c.loopOut=t,c.loopIn=e,c.smooth=n,c.getVelocityAtTime=expressionHelpers.getVelocityAtTime.bind(c),c.getSpeedAtTime=expressionHelpers.getSpeedAtTime.bind(c),c.numKeys=1===i.a?i.k.length:0,c.propertyIndex=i.ix;var l=0;return 0!==o&&(l=createTypedArray("float32",1===i.a?i.k[0].s.length:i.k.length)),c._cachingAtTime={lastFrame:initialDefaultFrame,lastIndex:0,value:l},expressionHelpers.searchExpressions(r,i,c),c.k&&u.addDynamicProperty(c),c};var u=ShapePropertyFactory.getConstructorFunction(),c=ShapePropertyFactory.getKeyframedConstructorFunction();function l(){}l.prototype={vertices:function(t,e){this.k&&this.getValue();var n,r=this.v;void 0!==e&&(r=this.getValueAtTime(e,0));var i=r._length,o=r[t],a=r.v,s=createSizedArray(i);for(n=0;n<i;n+=1)s[n]="i"===t||"o"===t?[o[n][0]-a[n][0],o[n][1]-a[n][1]]:[o[n][0],o[n][1]];return s},points:function(t){return this.vertices("v",t)},inTangents:function(t){return this.vertices("i",t)},outTangents:function(t){return this.vertices("o",t)},isClosed:function(){return this.v.c},pointOnPath:function(t,e){var n=this.v;void 0!==e&&(n=this.getValueAtTime(e,0)),this._segmentsLength||(this._segmentsLength=bez.getSegmentsLength(n));var r,i=this._segmentsLength,o=i.lengths,a=i.totalLength*t,s=0,u=o.length,c=0;while(s<u){if(c+o[s].addedLength>a){var l=s,h=n.c&&s===u-1?0:s+1,f=(a-c)/o[s].addedLength;r=bez.getPointInSegment(n.v[l],n.v[h],n.o[l],n.i[h],f,o[s]);break}c+=o[s].addedLength,s+=1}return r||(r=n.c?[n.v[0][0],n.v[0][1]]:[n.v[n._length-1][0],n.v[n._length-1][1]]),r},vectorOnPath:function(t,e,n){1==t?t=this.v.c:0==t&&(t=.999);var r=this.pointOnPath(t,e),i=this.pointOnPath(t+.001,e),o=i[0]-r[0],a=i[1]-r[1],s=Math.sqrt(Math.pow(o,2)+Math.pow(a,2));if(0===s)return[0,0];var u="tangent"===n?[o/s,a/s]:[-a/s,o/s];return u},tangentOnPath:function(t,e){return this.vectorOnPath(t,e,"tangent")},normalOnPath:function(t,e){return this.vectorOnPath(t,e,"normal")},setGroupProperty:expressionHelpers.setGroupProperty,getValueAtTime:expressionHelpers.getStaticValueAtTime},extendPrototype([l],u),extendPrototype([l],c),c.prototype.getValueAtTime=s,c.prototype.initiateExpression=ExpressionManager.initiateExpression;var h=ShapePropertyFactory.getShapeProp;ShapePropertyFactory.getShapeProp=function(t,e,n,r,i){var o=h(t,e,n,r,i);return o.propertyIndex=e.ix,o.lock=!1,3===n?expressionHelpers.searchExpressions(t,e.pt,o):4===n&&expressionHelpers.searchExpressions(t,e.ks,o),o.k&&t.addDynamicProperty(o),o}})(),function(){function t(){return this.data.d.x?(this.calculateExpression=ExpressionManager.initiateExpression.bind(this)(this.elem,this.data.d,this),this.addEffect(this.getExpressionValue.bind(this)),!0):null}TextProperty.prototype.getExpressionValue=function(t,e){var n=this.calculateExpression(e);if(t.t!==n){var r={};return this.copyData(r,t),r.t=n.toString(),r.__complete=!1,r}return t},TextProperty.prototype.searchProperty=function(){var t=this.searchKeyframes(),e=this.searchExpressions();return this.kf=t||e,this.kf},TextProperty.prototype.searchExpressions=t}();var ShapePathInterface=function(){return function(t,e,n){var r=e.sh;function i(t){return"Shape"===t||"shape"===t||"Path"===t||"path"===t||"ADBE Vector Shape"===t||2===t?i.path:null}var o=propertyGroupFactory(i,n);return r.setGroupProperty(PropertyInterface("Path",o)),Object.defineProperties(i,{path:{get:function(){return r.k&&r.getValue(),r}},shape:{get:function(){return r.k&&r.getValue(),r}},_name:{value:t.nm},ix:{value:t.ix},propertyIndex:{value:t.ix},mn:{value:t.mn},propertyGroup:{value:n}}),i}}(),propertyGroupFactory=function(){return function(t,e){return function(n){return n=void 0===n?1:n,n<=0?t:e(n-1)}}}(),PropertyInterface=function(){return function(t,e){var n={_name:t};function r(t){return t=void 0===t?1:t,t<=0?n:e(t-1)}return r}}(),ShapeExpressionInterface=function(){function t(t,e,u){var d,m=[],v=t?t.length:0;for(d=0;d<v;d+=1)"gr"===t[d].ty?m.push(n(t[d],e[d],u)):"fl"===t[d].ty?m.push(r(t[d],e[d],u)):"st"===t[d].ty?m.push(a(t[d],e[d],u)):"tm"===t[d].ty?m.push(s(t[d],e[d],u)):"tr"===t[d].ty||("el"===t[d].ty?m.push(c(t[d],e[d],u)):"sr"===t[d].ty?m.push(l(t[d],e[d],u)):"sh"===t[d].ty?m.push(ShapePathInterface(t[d],e[d],u)):"rc"===t[d].ty?m.push(h(t[d],e[d],u)):"rd"===t[d].ty?m.push(f(t[d],e[d],u)):"rp"===t[d].ty?m.push(p(t[d],e[d],u)):"gf"===t[d].ty?m.push(i(t[d],e[d],u)):m.push(o(t[d],e[d],u)));return m}function e(e,n,r){var i,o=function(t){var e=0,n=i.length;while(e<n){if(i[e]._name===t||i[e].mn===t||i[e].propertyIndex===t||i[e].ix===t||i[e].ind===t)return i[e];e+=1}return"number"===typeof t?i[t-1]:null};o.propertyGroup=propertyGroupFactory(o,r),i=t(e.it,n.it,o.propertyGroup),o.numProperties=i.length;var a=u(e.it[e.it.length-1],n.it[n.it.length-1],o.propertyGroup);return o.transform=a,o.propertyIndex=e.cix,o._name=e.nm,o}function n(t,n,r){var i=function(t){switch(t){case"ADBE Vectors Group":case"Contents":case 2:return i.content;default:return i.transform}};i.propertyGroup=propertyGroupFactory(i,r);var o=e(t,n,i.propertyGroup),a=u(t.it[t.it.length-1],n.it[n.it.length-1],i.propertyGroup);return i.content=o,i.transform=a,Object.defineProperty(i,"_name",{get:function(){return t.nm}}),i.numProperties=t.np,i.propertyIndex=t.ix,i.nm=t.nm,i.mn=t.mn,i}function r(t,e,n){function r(t){return"Color"===t||"color"===t?r.color:"Opacity"===t||"opacity"===t?r.opacity:null}return Object.defineProperties(r,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",n)),e.o.setGroupProperty(PropertyInterface("Opacity",n)),r}function i(t,e,n){function r(t){return"Start Point"===t||"start point"===t?r.startPoint:"End Point"===t||"end point"===t?r.endPoint:"Opacity"===t||"opacity"===t?r.opacity:null}return Object.defineProperties(r,{startPoint:{get:ExpressionPropertyInterface(e.s)},endPoint:{get:ExpressionPropertyInterface(e.e)},opacity:{get:ExpressionPropertyInterface(e.o)},type:{get:function(){return"a"}},_name:{value:t.nm},mn:{value:t.mn}}),e.s.setGroupProperty(PropertyInterface("Start Point",n)),e.e.setGroupProperty(PropertyInterface("End Point",n)),e.o.setGroupProperty(PropertyInterface("Opacity",n)),r}function o(){function t(){return null}return t}function a(t,e,n){var r,i=propertyGroupFactory(c,n),o=propertyGroupFactory(u,i);function a(n){Object.defineProperty(u,t.d[n].nm,{get:ExpressionPropertyInterface(e.d.dataProps[n].p)})}var s=t.d?t.d.length:0,u={};for(r=0;r<s;r+=1)a(r),e.d.dataProps[r].p.setGroupProperty(o);function c(t){return"Color"===t||"color"===t?c.color:"Opacity"===t||"opacity"===t?c.opacity:"Stroke Width"===t||"stroke width"===t?c.strokeWidth:null}return Object.defineProperties(c,{color:{get:ExpressionPropertyInterface(e.c)},opacity:{get:ExpressionPropertyInterface(e.o)},strokeWidth:{get:ExpressionPropertyInterface(e.w)},dash:{get:function(){return u}},_name:{value:t.nm},mn:{value:t.mn}}),e.c.setGroupProperty(PropertyInterface("Color",i)),e.o.setGroupProperty(PropertyInterface("Opacity",i)),e.w.setGroupProperty(PropertyInterface("Stroke Width",i)),c}function s(t,e,n){function r(e){return e===t.e.ix||"End"===e||"end"===e?r.end:e===t.s.ix?r.start:e===t.o.ix?r.offset:null}var i=propertyGroupFactory(r,n);return r.propertyIndex=t.ix,e.s.setGroupProperty(PropertyInterface("Start",i)),e.e.setGroupProperty(PropertyInterface("End",i)),e.o.setGroupProperty(PropertyInterface("Offset",i)),r.propertyIndex=t.ix,r.propertyGroup=n,Object.defineProperties(r,{start:{get:ExpressionPropertyInterface(e.s)},end:{get:ExpressionPropertyInterface(e.e)},offset:{get:ExpressionPropertyInterface(e.o)},_name:{value:t.nm}}),r.mn=t.mn,r}function u(t,e,n){function r(e){return t.a.ix===e||"Anchor Point"===e?r.anchorPoint:t.o.ix===e||"Opacity"===e?r.opacity:t.p.ix===e||"Position"===e?r.position:t.r.ix===e||"Rotation"===e||"ADBE Vector Rotation"===e?r.rotation:t.s.ix===e||"Scale"===e?r.scale:t.sk&&t.sk.ix===e||"Skew"===e?r.skew:t.sa&&t.sa.ix===e||"Skew Axis"===e?r.skewAxis:null}var i=propertyGroupFactory(r,n);return e.transform.mProps.o.setGroupProperty(PropertyInterface("Opacity",i)),e.transform.mProps.p.setGroupProperty(PropertyInterface("Position",i)),e.transform.mProps.a.setGroupProperty(PropertyInterface("Anchor Point",i)),e.transform.mProps.s.setGroupProperty(PropertyInterface("Scale",i)),e.transform.mProps.r.setGroupProperty(PropertyInterface("Rotation",i)),e.transform.mProps.sk&&(e.transform.mProps.sk.setGroupProperty(PropertyInterface("Skew",i)),e.transform.mProps.sa.setGroupProperty(PropertyInterface("Skew Angle",i))),e.transform.op.setGroupProperty(PropertyInterface("Opacity",i)),Object.defineProperties(r,{opacity:{get:ExpressionPropertyInterface(e.transform.mProps.o)},position:{get:ExpressionPropertyInterface(e.transform.mProps.p)},anchorPoint:{get:ExpressionPropertyInterface(e.transform.mProps.a)},scale:{get:ExpressionPropertyInterface(e.transform.mProps.s)},rotation:{get:ExpressionPropertyInterface(e.transform.mProps.r)},skew:{get:ExpressionPropertyInterface(e.transform.mProps.sk)},skewAxis:{get:ExpressionPropertyInterface(e.transform.mProps.sa)},_name:{value:t.nm}}),r.ty="tr",r.mn=t.mn,r.propertyGroup=n,r}function c(t,e,n){function r(e){return t.p.ix===e?r.position:t.s.ix===e?r.size:null}var i=propertyGroupFactory(r,n);r.propertyIndex=t.ix;var o="tm"===e.sh.ty?e.sh.prop:e.sh;return o.s.setGroupProperty(PropertyInterface("Size",i)),o.p.setGroupProperty(PropertyInterface("Position",i)),Object.defineProperties(r,{size:{get:ExpressionPropertyInterface(o.s)},position:{get:ExpressionPropertyInterface(o.p)},_name:{value:t.nm}}),r.mn=t.mn,r}function l(t,e,n){function r(e){return t.p.ix===e?r.position:t.r.ix===e?r.rotation:t.pt.ix===e?r.points:t.or.ix===e||"ADBE Vector Star Outer Radius"===e?r.outerRadius:t.os.ix===e?r.outerRoundness:!t.ir||t.ir.ix!==e&&"ADBE Vector Star Inner Radius"!==e?t.is&&t.is.ix===e?r.innerRoundness:null:r.innerRadius}var i=propertyGroupFactory(r,n),o="tm"===e.sh.ty?e.sh.prop:e.sh;return r.propertyIndex=t.ix,o.or.setGroupProperty(PropertyInterface("Outer Radius",i)),o.os.setGroupProperty(PropertyInterface("Outer Roundness",i)),o.pt.setGroupProperty(PropertyInterface("Points",i)),o.p.setGroupProperty(PropertyInterface("Position",i)),o.r.setGroupProperty(PropertyInterface("Rotation",i)),t.ir&&(o.ir.setGroupProperty(PropertyInterface("Inner Radius",i)),o.is.setGroupProperty(PropertyInterface("Inner Roundness",i))),Object.defineProperties(r,{position:{get:ExpressionPropertyInterface(o.p)},rotation:{get:ExpressionPropertyInterface(o.r)},points:{get:ExpressionPropertyInterface(o.pt)},outerRadius:{get:ExpressionPropertyInterface(o.or)},outerRoundness:{get:ExpressionPropertyInterface(o.os)},innerRadius:{get:ExpressionPropertyInterface(o.ir)},innerRoundness:{get:ExpressionPropertyInterface(o.is)},_name:{value:t.nm}}),r.mn=t.mn,r}function h(t,e,n){function r(e){return t.p.ix===e?r.position:t.r.ix===e?r.roundness:t.s.ix===e||"Size"===e||"ADBE Vector Rect Size"===e?r.size:null}var i=propertyGroupFactory(r,n),o="tm"===e.sh.ty?e.sh.prop:e.sh;return r.propertyIndex=t.ix,o.p.setGroupProperty(PropertyInterface("Position",i)),o.s.setGroupProperty(PropertyInterface("Size",i)),o.r.setGroupProperty(PropertyInterface("Rotation",i)),Object.defineProperties(r,{position:{get:ExpressionPropertyInterface(o.p)},roundness:{get:ExpressionPropertyInterface(o.r)},size:{get:ExpressionPropertyInterface(o.s)},_name:{value:t.nm}}),r.mn=t.mn,r}function f(t,e,n){function r(e){return t.r.ix===e||"Round Corners 1"===e?r.radius:null}var i=propertyGroupFactory(r,n),o=e;return r.propertyIndex=t.ix,o.rd.setGroupProperty(PropertyInterface("Radius",i)),Object.defineProperties(r,{radius:{get:ExpressionPropertyInterface(o.rd)},_name:{value:t.nm}}),r.mn=t.mn,r}function p(t,e,n){function r(e){return t.c.ix===e||"Copies"===e?r.copies:t.o.ix===e||"Offset"===e?r.offset:null}var i=propertyGroupFactory(r,n),o=e;return r.propertyIndex=t.ix,o.c.setGroupProperty(PropertyInterface("Copies",i)),o.o.setGroupProperty(PropertyInterface("Offset",i)),Object.defineProperties(r,{copies:{get:ExpressionPropertyInterface(o.c)},offset:{get:ExpressionPropertyInterface(o.o)},_name:{value:t.nm}}),r.mn=t.mn,r}return function(e,n,r){var i;function o(t){if("number"===typeof t)return t=void 0===t?1:t,0===t?r:i[t-1];var e=0,n=i.length;while(e<n){if(i[e]._name===t)return i[e];e+=1}return null}function a(){return r}return o.propertyGroup=propertyGroupFactory(o,a),i=t(e,n,o.propertyGroup),o.numProperties=i.length,o._name="Contents",o}}(),TextExpressionInterface=function(){return function(t){var e,n;function r(t){switch(t){case"ADBE Text Document":return r.sourceText;default:return null}}return Object.defineProperty(r,"sourceText",{get:function(){t.textProperty.getValue();var r=t.textProperty.currentData.t;return r!==e&&(t.textProperty.currentData.t=e,n=new String(r),n.value=r||new String(r)),n}}),r}}(),LayerExpressionInterface=function(){function t(t){var e=new Matrix;if(void 0!==t){var n=this._elem.finalTransform.mProp.getValueAtTime(t);n.clone(e)}else{var r=this._elem.finalTransform.mProp;r.applyToMatrix(e)}return e}function e(t,e){var n=this.getMatrix(e);return n.props[12]=0,n.props[13]=0,n.props[14]=0,this.applyPoint(n,t)}function n(t,e){var n=this.getMatrix(e);return this.applyPoint(n,t)}function r(t,e){var n=this.getMatrix(e);return n.props[12]=0,n.props[13]=0,n.props[14]=0,this.invertPoint(n,t)}function i(t,e){var n=this.getMatrix(e);return this.invertPoint(n,t)}function o(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(t)}return t.applyToPointArray(e[0],e[1],e[2]||0)}function a(t,e){if(this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(t)}return t.inversePoint(e)}function s(t){var e=new Matrix;if(e.reset(),this._elem.finalTransform.mProp.applyToMatrix(e),this._elem.hierarchy&&this._elem.hierarchy.length){var n,r=this._elem.hierarchy.length;for(n=0;n<r;n+=1)this._elem.hierarchy[n].finalTransform.mProp.applyToMatrix(e);return e.inversePoint(t)}return e.inversePoint(t)}function u(){return[1,1,1,1]}return function(c){var l;function h(t){p.mask=new MaskManagerInterface(t,c)}function f(t){p.effect=t}function p(t){switch(t){case"ADBE Root Vectors Group":case"Contents":case 2:return p.shapeInterface;case 1:case 6:case"Transform":case"transform":case"ADBE Transform Group":return l;case 4:case"ADBE Effect Parade":case"effects":case"Effects":return p.effect;case"ADBE Text Properties":return p.textInterface;default:return null}}p.getMatrix=t,p.invertPoint=a,p.applyPoint=o,p.toWorld=n,p.toWorldVec=e,p.fromWorld=i,p.fromWorldVec=r,p.toComp=n,p.fromComp=s,p.sampleImage=u,p.sourceRectAtTime=c.sourceRectAtTime.bind(c),p._elem=c,l=TransformExpressionInterface(c.finalTransform.mProp);var d=getDescriptor(l,"anchorPoint");return Object.defineProperties(p,{hasParent:{get:function(){return c.hierarchy.length}},parent:{get:function(){return c.hierarchy[0].layerInterface}},rotation:getDescriptor(l,"rotation"),scale:getDescriptor(l,"scale"),position:getDescriptor(l,"position"),opacity:getDescriptor(l,"opacity"),anchorPoint:d,anchor_point:d,transform:{get:function(){return l}},active:{get:function(){return c.isInRange}}}),p.startTime=c.data.st,p.index=c.data.ind,p.source=c.data.refId,p.height=0===c.data.ty?c.data.h:100,p.width=0===c.data.ty?c.data.w:100,p.inPoint=c.data.ip/c.comp.globalData.frameRate,p.outPoint=c.data.op/c.comp.globalData.frameRate,p._name=c.data.nm,p.registerMaskInterface=h,p.registerEffectsInterface=f,p}}(),FootageInterface=function(){var t=function(t){var e="",n=t.getFootageData();function r(){return e="",n=t.getFootageData(),i}function i(t){if(n[t])return e=t,n=n[t],"object"===typeof n?i:n;var r=t.indexOf(e);if(-1!==r){var o=parseInt(t.substr(r+e.length),10);return n=n[o],"object"===typeof n?i:n}return""}return r},e=function(e){function n(t){return"Outline"===t?n.outlineInterface():null}return n._name="Outline",n.outlineInterface=t(e),n};return function(t){function n(t){return"Data"===t?n.dataInterface:null}return n._name="Data",n.dataInterface=e(t),n}}(),CompExpressionInterface=function(){return function(t){function e(e){var n=0,r=t.layers.length;while(n<r){if(t.layers[n].nm===e||t.layers[n].ind===e)return t.elements[n].layerInterface;n+=1}return null}return Object.defineProperty(e,"_name",{value:t.data.nm}),e.layer=e,e.pixelAspect=1,e.height=t.data.h||t.globalData.compSize.h,e.width=t.data.w||t.globalData.compSize.w,e.pixelAspect=1,e.frameDuration=1/t.globalData.frameRate,e.displayStartTime=0,e.numLayers=t.layers.length,e}}(),TransformExpressionInterface=function(){return function(t){function e(t){switch(t){case"scale":case"Scale":case"ADBE Scale":case 6:return e.scale;case"rotation":case"Rotation":case"ADBE Rotation":case"ADBE Rotate Z":case 10:return e.rotation;case"ADBE Rotate X":return e.xRotation;case"ADBE Rotate Y":return e.yRotation;case"position":case"Position":case"ADBE Position":case 2:return e.position;case"ADBE Position_0":return e.xPosition;case"ADBE Position_1":return e.yPosition;case"ADBE Position_2":return e.zPosition;case"anchorPoint":case"AnchorPoint":case"Anchor Point":case"ADBE AnchorPoint":case 1:return e.anchorPoint;case"opacity":case"Opacity":case 11:return e.opacity;default:return null}}var n,r,i,o;return Object.defineProperty(e,"rotation",{get:ExpressionPropertyInterface(t.r||t.rz)}),Object.defineProperty(e,"zRotation",{get:ExpressionPropertyInterface(t.rz||t.r)}),Object.defineProperty(e,"xRotation",{get:ExpressionPropertyInterface(t.rx)}),Object.defineProperty(e,"yRotation",{get:ExpressionPropertyInterface(t.ry)}),Object.defineProperty(e,"scale",{get:ExpressionPropertyInterface(t.s)}),t.p?o=ExpressionPropertyInterface(t.p):(n=ExpressionPropertyInterface(t.px),r=ExpressionPropertyInterface(t.py),t.pz&&(i=ExpressionPropertyInterface(t.pz))),Object.defineProperty(e,"position",{get:function(){return t.p?o():[n(),r(),i?i():0]}}),Object.defineProperty(e,"xPosition",{get:ExpressionPropertyInterface(t.px)}),Object.defineProperty(e,"yPosition",{get:ExpressionPropertyInterface(t.py)}),Object.defineProperty(e,"zPosition",{get:ExpressionPropertyInterface(t.pz)}),Object.defineProperty(e,"anchorPoint",{get:ExpressionPropertyInterface(t.a)}),Object.defineProperty(e,"opacity",{get:ExpressionPropertyInterface(t.o)}),Object.defineProperty(e,"skew",{get:ExpressionPropertyInterface(t.sk)}),Object.defineProperty(e,"skewAxis",{get:ExpressionPropertyInterface(t.sa)}),Object.defineProperty(e,"orientation",{get:ExpressionPropertyInterface(t.or)}),e}}(),ProjectInterface=function(){function t(t){this.compositions.push(t)}return function(){function e(t){var e=0,n=this.compositions.length;while(e<n){if(this.compositions[e].data&&this.compositions[e].data.nm===t)return this.compositions[e].prepareFrame&&this.compositions[e].data.xt&&this.compositions[e].prepareFrame(this.currentFrame),this.compositions[e].compInterface;e+=1}return null}return e.compositions=[],e.currentFrame=0,e.registerComposition=t,e}}(),EffectsExpressionInterface=function(){var t={createEffectsInterface:e};function e(t,e){if(t.effectsManager){var r,i=[],o=t.data.ef,a=t.effectsManager.effectElements.length;for(r=0;r<a;r+=1)i.push(n(o[r],t.effectsManager.effectElements[r],e,t));var s=t.data.ef||[],u=function(t){r=0,a=s.length;while(r<a){if(t===s[r].nm||t===s[r].mn||t===s[r].ix)return i[r];r+=1}return null};return Object.defineProperty(u,"numProperties",{get:function(){return s.length}}),u}return null}function n(t,e,i,o){function a(e){var n=t.ef,r=0,i=n.length;while(r<i){if(e===n[r].nm||e===n[r].mn||e===n[r].ix)return 5===n[r].ty?c[r]:c[r]();r+=1}throw new Error}var s,u=propertyGroupFactory(a,i),c=[],l=t.ef.length;for(s=0;s<l;s+=1)5===t.ef[s].ty?c.push(n(t.ef[s],e.effectElements[s],e.effectElements[s].propertyGroup,o)):c.push(r(e.effectElements[s],t.ef[s].ty,o,u));return"ADBE Color Control"===t.mn&&Object.defineProperty(a,"color",{get:function(){return c[0]()}}),Object.defineProperties(a,{numProperties:{get:function(){return t.np}},_name:{value:t.nm},propertyGroup:{value:u}}),a.enabled=0!==t.en,a.active=a.enabled,a}function r(t,e,n,r){var i=ExpressionPropertyInterface(t.p);function o(){return 10===e?n.comp.compInterface(t.p.v):i()}return t.p.setGroupProperty&&t.p.setGroupProperty(PropertyInterface("",r)),o}return t}(),MaskManagerInterface=function(){function t(t,e){this._mask=t,this._data=e}Object.defineProperty(t.prototype,"maskPath",{get:function(){return this._mask.prop.k&&this._mask.prop.getValue(),this._mask.prop}}),Object.defineProperty(t.prototype,"maskOpacity",{get:function(){return this._mask.op.k&&this._mask.op.getValue(),100*this._mask.op.v}});var e=function(e){var n,r=createSizedArray(e.viewData.length),i=e.viewData.length;for(n=0;n<i;n+=1)r[n]=new t(e.viewData[n],e.masksProperties[n]);var o=function(t){n=0;while(n<i){if(e.masksProperties[n].nm===t)return r[n];n+=1}return null};return o};return e}(),ExpressionPropertyInterface=function(){var t={pv:0,v:0,mult:1},e={pv:[0,0,0],v:[0,0,0],mult:1};function n(t,e,n){Object.defineProperty(t,"velocity",{get:function(){return e.getVelocityAtTime(e.comp.currentFrame)}}),t.numKeys=e.keyframes?e.keyframes.length:0,t.key=function(r){if(!t.numKeys)return 0;var i="";i="s"in e.keyframes[r-1]?e.keyframes[r-1].s:"e"in e.keyframes[r-2]?e.keyframes[r-2].e:e.keyframes[r-2].s;var o="unidimensional"===n?new Number(i):Object.assign({},i);return o.time=e.keyframes[r-1].t/e.elem.comp.globalData.frameRate,o.value="unidimensional"===n?i[0]:i,o},t.valueAtTime=e.getValueAtTime,t.speedAtTime=e.getSpeedAtTime,t.velocityAtTime=e.getVelocityAtTime,t.propertyGroup=e.propertyGroup}function r(e){e&&"pv"in e||(e=t);var r=1/e.mult,i=e.pv*r,o=new Number(i);return o.value=i,n(o,e,"unidimensional"),function(){return e.k&&e.getValue(),i=e.v*r,o.value!==i&&(o=new Number(i),o.value=i,n(o,e,"unidimensional")),o}}function i(t){t&&"pv"in t||(t=e);var r=1/t.mult,i=t.data&&t.data.l||t.pv.length,o=createTypedArray("float32",i),a=createTypedArray("float32",i);return o.value=a,n(o,t,"multidimensional"),function(){t.k&&t.getValue();for(var e=0;e<i;e+=1)a[e]=t.v[e]*r,o[e]=a[e];return o}}function o(){return t}return function(t){return t?"unidimensional"===t.propType?r(t):i(t):o}}();function SliderEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,0,0,n)}function AngleEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,0,0,n)}function ColorEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,1,0,n)}function PointEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,1,0,n)}function LayerIndexEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,0,0,n)}function MaskIndexEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,0,0,n)}function CheckboxEffect(t,e,n){this.p=PropertyFactory.getProp(e,t.v,0,0,n)}function NoValueEffect(){this.p={}}function EffectsManager(t,e){var n,r=t.ef||[];this.effectElements=[];var i,o=r.length;for(n=0;n<o;n+=1)i=new GroupEffect(r[n],e),this.effectElements.push(i)}function GroupEffect(t,e){this.init(t,e)}(function(){(function(){function t(t,e){return this.textIndex=t+1,this.textTotal=e,this.v=this.getValue()*this.mult,this.v}})();var t=TextSelectorProp.getTextSelectorProp;TextSelectorProp.getTextSelectorProp=function(e,n,r){return 1===n.t?new TextExpressionSelectorPropFactory(e,n,r):t(e,n,r)}})(),extendPrototype([DynamicPropertyContainer],GroupEffect),GroupEffect.prototype.getValue=GroupEffect.prototype.iterateDynamicProperties,GroupEffect.prototype.init=function(t,e){var n;this.data=t,this.effectElements=[],this.initDynamicPropertyContainer(e);var r,i=this.data.ef.length,o=this.data.ef;for(n=0;n<i;n+=1){switch(r=null,o[n].ty){case 0:r=new SliderEffect(o[n],e,this);break;case 1:r=new AngleEffect(o[n],e,this);break;case 2:r=new ColorEffect(o[n],e,this);break;case 3:r=new PointEffect(o[n],e,this);break;case 4:case 7:r=new CheckboxEffect(o[n],e,this);break;case 10:r=new LayerIndexEffect(o[n],e,this);break;case 11:r=new MaskIndexEffect(o[n],e,this);break;case 5:r=new EffectsManager(o[n],e,this);break;default:r=new NoValueEffect(o[n],e,this);break}r&&this.effectElements.push(r)}};var lottie={};function setLocationHref(t){locationHref=t}function searchAnimations(){!0===standalone?animationManager.searchAnimations(animationData,standalone,renderer):animationManager.searchAnimations()}function setSubframeRendering(t){subframeEnabled=t}function setIDPrefix(t){idPrefix=t}function loadAnimation(t){return!0===standalone&&(t.animationData=JSON.parse(animationData)),animationManager.loadAnimation(t)}function setQuality(t){if("string"===typeof t)switch(t){case"high":defaultCurveSegments=200;break;default:case"medium":defaultCurveSegments=50;break;case"low":defaultCurveSegments=10;break}else!isNaN(t)&&t>1&&(defaultCurveSegments=t);roundValues(!(defaultCurveSegments>=50))}function inBrowser(){return"undefined"!==typeof navigator}function installPlugin(t,e){"expressions"===t&&(expressionsPlugin=e)}function getFactory(t){switch(t){case"propertyFactory":return PropertyFactory;case"shapePropertyFactory":return ShapePropertyFactory;case"matrix":return Matrix;default:return null}}function checkReady(){"complete"===document.readyState&&(clearInterval(readyStateCheckInterval),searchAnimations())}function getQueryVariable(t){for(var e=queryString.split("&"),n=0;n<e.length;n+=1){var r=e[n].split("=");if(decodeURIComponent(r[0])==t)return decodeURIComponent(r[1])}return null}lottie.play=animationManager.play,lottie.pause=animationManager.pause,lottie.setLocationHref=setLocationHref,lottie.togglePause=animationManager.togglePause,lottie.setSpeed=animationManager.setSpeed,lottie.setDirection=animationManager.setDirection,lottie.stop=animationManager.stop,lottie.searchAnimations=searchAnimations,lottie.registerAnimation=animationManager.registerAnimation,lottie.loadAnimation=loadAnimation,lottie.setSubframeRendering=setSubframeRendering,lottie.resize=animationManager.resize,lottie.goToAndStop=animationManager.goToAndStop,lottie.destroy=animationManager.destroy,lottie.setQuality=setQuality,lottie.inBrowser=inBrowser,lottie.installPlugin=installPlugin,lottie.freeze=animationManager.freeze,lottie.unfreeze=animationManager.unfreeze,lottie.setVolume=animationManager.setVolume,lottie.mute=animationManager.mute,lottie.unmute=animationManager.unmute,lottie.getRegisteredAnimations=animationManager.getRegisteredAnimations,lottie.setIDPrefix=setIDPrefix,lottie.__getFactory=getFactory,lottie.version="5.7.11";var standalone="__[STANDALONE]__",animationData="__[ANIMATIONDATA]__",renderer="",queryString;if(standalone){var scripts=document.getElementsByTagName("script"),index=scripts.length-1,myScript=scripts[index]||{src:""};queryString=myScript.src.replace(/^[^\?]+\??/,""),renderer=getQueryVariable("renderer")}var readyStateCheckInterval=setInterval(checkReady,100);return lottie}))},"99af":function(t,e,n){"use strict";var r=n("23e7"),i=n("d039"),o=n("e8b5"),a=n("861d"),s=n("7b0b"),u=n("50c4"),c=n("8418"),l=n("65f0"),h=n("1dde"),f=n("b622"),p=n("2d00"),d=f("isConcatSpreadable"),m=9007199254740991,v="Maximum allowed index exceeded",g=p>=51||!i((function(){var t=[];return t[d]=!1,t.concat()[0]!==t})),y=h("concat"),b=function(t){if(!a(t))return!1;var e=t[d];return void 0!==e?!!e:o(t)},x=!g||!y;r({target:"Array",proto:!0,forced:x},{concat:function(t){var e,n,r,i,o,a=s(this),h=l(a,0),f=0;for(e=-1,r=arguments.length;e<r;e++)if(o=-1===e?a:arguments[e],b(o)){if(i=u(o.length),f+i>m)throw TypeError(v);for(n=0;n<i;n++,f++)n in o&&c(h,f,o[n])}else{if(f>=m)throw TypeError(v);c(h,f++,o)}return h.length=f,h}})},"9ab4":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"e",(function(){return u}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},r(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},o.apply(this,arguments)};function a(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}},"9bf2":function(t,e,n){var r=n("83ab"),i=n("0cfb"),o=n("825a"),a=n("c04e"),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(o(t),e=a(e,!0),o(n),i)try{return s(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},"9ed3":function(t,e,n){"use strict";var r=n("ae93").IteratorPrototype,i=n("7c73"),o=n("5c6c"),a=n("d44e"),s=n("3f8c"),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=i(r,{next:o(1,n)}),a(t,c,!1,!0),s[c]=u,t}},"9f7f":function(t,e,n){var r=n("d039"),i=function(t,e){return RegExp(t,e)};e.UNSUPPORTED_Y=r((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=r((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a4b4:function(t,e,n){var r=n("342f");t.exports=/web0s(?!.*chrome)/i.test(r)},a4d3:function(t,e,n){"use strict";var r=n("23e7"),i=n("da84"),o=n("d066"),a=n("c430"),s=n("83ab"),u=n("4930"),c=n("fdbf"),l=n("d039"),h=n("5135"),f=n("e8b5"),p=n("861d"),d=n("825a"),m=n("7b0b"),v=n("fc6a"),g=n("c04e"),y=n("5c6c"),b=n("7c73"),x=n("df75"),w=n("241c"),E=n("057f"),_=n("7418"),C=n("06cf"),S=n("9bf2"),A=n("d1e7"),k=n("9112"),T=n("6eeb"),I=n("5692"),P=n("f772"),D=n("d012"),R=n("90e3"),M=n("b622"),F=n("e538"),O=n("746f"),N=n("d44e"),L=n("69f3"),B=n("b727").forEach,V=P("hidden"),z="Symbol",j="prototype",W=M("toPrimitive"),G=L.set,H=L.getterFor(z),U=Object[j],q=i.Symbol,$=o("JSON","stringify"),K=C.f,X=S.f,Y=E.f,J=A.f,Q=I("symbols"),Z=I("op-symbols"),tt=I("string-to-symbol-registry"),et=I("symbol-to-string-registry"),nt=I("wks"),rt=i.QObject,it=!rt||!rt[j]||!rt[j].findChild,ot=s&&l((function(){return 7!=b(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=K(U,e);r&&delete U[e],X(t,e,n),r&&t!==U&&X(U,e,r)}:X,at=function(t,e){var n=Q[t]=b(q[j]);return G(n,{type:z,tag:t,description:e}),s||(n.description=e),n},st=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof q},ut=function(t,e,n){t===U&&ut(Z,e,n),d(t);var r=g(e,!0);return d(n),h(Q,r)?(n.enumerable?(h(t,V)&&t[V][r]&&(t[V][r]=!1),n=b(n,{enumerable:y(0,!1)})):(h(t,V)||X(t,V,y(1,{})),t[V][r]=!0),ot(t,r,n)):X(t,r,n)},ct=function(t,e){d(t);var n=v(e),r=x(n).concat(dt(n));return B(r,(function(e){s&&!ht.call(n,e)||ut(t,e,n[e])})),t},lt=function(t,e){return void 0===e?b(t):ct(b(t),e)},ht=function(t){var e=g(t,!0),n=J.call(this,e);return!(this===U&&h(Q,e)&&!h(Z,e))&&(!(n||!h(this,e)||!h(Q,e)||h(this,V)&&this[V][e])||n)},ft=function(t,e){var n=v(t),r=g(e,!0);if(n!==U||!h(Q,r)||h(Z,r)){var i=K(n,r);return!i||!h(Q,r)||h(n,V)&&n[V][r]||(i.enumerable=!0),i}},pt=function(t){var e=Y(v(t)),n=[];return B(e,(function(t){h(Q,t)||h(D,t)||n.push(t)})),n},dt=function(t){var e=t===U,n=Y(e?Z:v(t)),r=[];return B(n,(function(t){!h(Q,t)||e&&!h(U,t)||r.push(Q[t])})),r};if(u||(q=function(){if(this instanceof q)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=R(t),n=function(t){this===U&&n.call(Z,t),h(this,V)&&h(this[V],e)&&(this[V][e]=!1),ot(this,e,y(1,t))};return s&&it&&ot(U,e,{configurable:!0,set:n}),at(e,t)},T(q[j],"toString",(function(){return H(this).tag})),T(q,"withoutSetter",(function(t){return at(R(t),t)})),A.f=ht,S.f=ut,C.f=ft,w.f=E.f=pt,_.f=dt,F.f=function(t){return at(M(t),t)},s&&(X(q[j],"description",{configurable:!0,get:function(){return H(this).description}}),a||T(U,"propertyIsEnumerable",ht,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:q}),B(x(nt),(function(t){O(t)})),r({target:z,stat:!0,forced:!u},{for:function(t){var e=String(t);if(h(tt,e))return tt[e];var n=q(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(h(et,t))return et[t]},useSetter:function(){it=!0},useSimple:function(){it=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!s},{create:lt,defineProperty:ut,defineProperties:ct,getOwnPropertyDescriptor:ft}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:pt,getOwnPropertySymbols:dt}),r({target:"Object",stat:!0,forced:l((function(){_.f(1)}))},{getOwnPropertySymbols:function(t){return _.f(m(t))}}),$){var mt=!u||l((function(){var t=q();return"[null]"!=$([t])||"{}"!=$({a:t})||"{}"!=$(Object(t))}));r({target:"JSON",stat:!0,forced:mt},{stringify:function(t,e,n){var r,i=[t],o=1;while(arguments.length>o)i.push(arguments[o++]);if(r=e,(p(e)||void 0!==t)&&!st(t))return f(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!st(e))return e}),i[1]=e,$.apply(null,i)}})}q[j][W]||k(q[j],W,q[j].valueOf),N(q,z),D[V]=!0},a640:function(t,e,n){"use strict";var r=n("d039");t.exports=function(t,e){var n=[][t];return!!n&&r((function(){n.call(null,e||function(){throw 1},1)}))}},a691:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},a79d:function(t,e,n){"use strict";var r=n("23e7"),i=n("c430"),o=n("fea9"),a=n("d039"),s=n("d066"),u=n("4840"),c=n("cdf9"),l=n("6eeb"),h=!!o&&a((function(){o.prototype["finally"].call({then:function(){}},(function(){}))}));if(r({target:"Promise",proto:!0,real:!0,forced:h},{finally:function(t){var e=u(this,s("Promise")),n="function"==typeof t;return this.then(n?function(n){return c(e,t()).then((function(){return n}))}:t,n?function(n){return c(e,t()).then((function(){throw n}))}:t)}}),!i&&"function"==typeof o){var f=s("Promise").prototype["finally"];o.prototype["finally"]!==f&&l(o.prototype,"finally",f,{unsafe:!0})}},a9e3:function(t,e,n){"use strict";var r=n("83ab"),i=n("da84"),o=n("94ca"),a=n("6eeb"),s=n("5135"),u=n("c6b6"),c=n("7156"),l=n("c04e"),h=n("d039"),f=n("7c73"),p=n("241c").f,d=n("06cf").f,m=n("9bf2").f,v=n("58a8").trim,g="Number",y=i[g],b=y.prototype,x=u(f(b))==g,w=function(t){var e,n,r,i,o,a,s,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(c=v(c),e=c.charCodeAt(0),43===e||45===e){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+c}for(o=c.slice(2),a=o.length,s=0;s<a;s++)if(u=o.charCodeAt(s),u<48||u>i)return NaN;return parseInt(o,r)}return+c};if(o(g,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var E,_=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof _&&(x?h((function(){b.valueOf.call(n)})):u(n)!=g)?c(new y(w(e)),n,_):w(e)},C=r?p(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),S=0;C.length>S;S++)s(y,E=C[S])&&!s(_,E)&&m(_,E,d(y,E));_.prototype=b,b.constructor=_,a(i,g,_)}},ab39:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return St})),n.d(e,"b",(function(){return wr})),n.d(e,"e",(function(){return nr})),n.d(e,"a",(function(){return Sn})),n.d(e,"f",(function(){return _r}));var r={};n.r(r),n.d(r,"drawContour",(function(){return o})),n.d(r,"drawDetections",(function(){return ut})),n.d(r,"drawFaceExpressions",(function(){return ee})),n.d(r,"DrawBoxOptions",(function(){return at})),n.d(r,"DrawBox",(function(){return st})),n.d(r,"DrawFaceLandmarksOptions",(function(){return ie})),n.d(r,"DrawFaceLandmarks",(function(){return oe})),n.d(r,"drawFaceLandmarks",(function(){return ae})),n.d(r,"AnchorPosition",(function(){return tt})),n.d(r,"DrawTextFieldOptions",(function(){return it})),n.d(r,"DrawTextField",(function(){return ot}));var i=n("45ef");function o(t,e,n){if(void 0===n&&(n=!1),t.beginPath(),e.slice(1).forEach((function(n,r){var i=n.x,o=n.y,a=e[r];t.moveTo(a.x,a.y),t.lineTo(i,o)})),n){var r=e[e.length-1],i=e[0];if(!r||!i)return;t.moveTo(r.x,r.y),t.lineTo(i.x,i.y)}t.stroke()}var a=n("9ab4"),s=function(){function t(t,e){if(!b(t)||!b(e))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:e}));this._width=t,this._height=e}return Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.reverse=function(){return new t(1/this.width,1/this.height)},t}();function u(t,e){return t instanceof i["a"]&&t.shape.length===e}function c(t){return u(t,2)}function l(t){return u(t,3)}function h(t){return u(t,4)}function f(t){return t%1!==0}function p(t){return t%2===0}function d(t,e){void 0===e&&(e=2);var n=Math.pow(10,e);return Math.floor(t*n)/n}function m(t){return t&&t.width&&t.height}function v(t,e){var n=t.width,r=t.height,i=e/Math.max(r,n);return new s(Math.round(n*i),Math.round(r*i))}function g(t){return t.reduce((function(t,e){return t.add(e)}),new w(0,0)).div(new w(t.length,t.length))}function y(t,e,n){return Array(t).fill(0).map((function(t,r){return e+r*n}))}function b(t){return!!t&&t!==1/0&&t!==-1/0&&!isNaN(t)||0===t}function x(t){return b(t)&&0<=t&&t<=1}var w=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.mul=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.div=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.abs=function(){return new t(Math.abs(this.x),Math.abs(this.y))},t.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t}(),E=function(){function t(e,n){void 0===n&&(n=!0);var r=e||{},i=[r.left,r.top,r.right,r.bottom].every(b),o=[r.x,r.y,r.width,r.height].every(b);if(!o&&!i)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=o?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];t.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return t.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(b)},t.assertIsValidBox=function(e,n,r){if(void 0===r&&(r=!1),!t.isRect(e))throw new Error(n+" - invalid box: "+JSON.stringify(e)+", expected object with properties x, y, width, height");if(!r&&(e.width<0||e.height<0))throw new Error(n+" - width ("+e.width+") and height ("+e.height+") must be positive numbers")},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLeft",{get:function(){return new w(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topRight",{get:function(){return new w(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomLeft",{get:function(){return new w(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomRight",{get:function(){return new w(this.right,this.bottom)},enumerable:!0,configurable:!0}),t.prototype.round=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.round(t)})),n=e[0],r=e[1],i=e[2],o=e[3];return new t({x:n,y:r,width:i,height:o})},t.prototype.floor=function(){var e=[this.x,this.y,this.width,this.height].map((function(t){return Math.floor(t)})),n=e[0],r=e[1],i=e[2],o=e[3];return new t({x:n,y:r,width:i,height:o})},t.prototype.toSquare=function(){var e=this,n=e.x,r=e.y,i=e.width,o=e.height,a=Math.abs(i-o);return i<o&&(n-=a/2,i+=a),o<i&&(r-=a/2,o+=a),new t({x:n,y:r,width:i,height:o})},t.prototype.rescale=function(e){var n=m(e)?e.width:e,r=m(e)?e.height:e;return new t({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},t.prototype.pad=function(e,n){var r=[this.x-e/2,this.y-n/2,this.width+e,this.height+n],i=r[0],o=r[1],a=r[2],s=r[3];return new t({x:i,y:o,width:a,height:s})},t.prototype.clipAtImageBorders=function(e,n){var r=this,i=r.x,o=r.y,a=r.right,s=r.bottom,u=Math.max(i,0),c=Math.max(o,0),l=a-u,h=s-c,f=Math.min(l,e-u),p=Math.min(h,n-c);return new t({x:u,y:c,width:f,height:p}).floor()},t.prototype.shift=function(e,n){var r=this,i=r.width,o=r.height,a=this.x+e,s=this.y+n;return new t({x:a,y:s,width:i,height:o})},t.prototype.padAtBorders=function(t,e){var n=this.width+1,r=this.height+1,i=1,o=1,a=n,s=r,u=this.left,c=this.top,l=this.right,h=this.bottom;return l>e&&(a=-l+e+n,l=e),h>t&&(s=-h+t+r,h=t),u<1&&(s=2-u,u=1),c<1&&(s=2-c,c=1),{dy:o,edy:s,dx:i,edx:a,y:c,ey:h,x:u,ex:l,w:n,h:r}},t.prototype.calibrate=function(e){return new t({left:this.left+e.left*this.width,top:this.top+e.top*this.height,right:this.right+e.right*this.width,bottom:this.bottom+e.bottom*this.height}).toSquare().round()},t}(),_=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{left:e,top:n,right:r,bottom:i},o)||this}return Object(a["c"])(e,t),e}(E),C=function(){function t(t,e,n,r,i){this._imageDims=new s(i.width,i.height),this._score=t,this._classScore=e,this._className=n,this._box=new E(r).rescale(this._imageDims)}return Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativeBox",{get:function(){return new E(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),t.prototype.forSize=function(e,n){return new t(this.score,this.classScore,this.className,this.relativeBox,{width:e,height:n})},t}(),S=function(t){function e(e,n,r){return t.call(this,e,e,"",n,r)||this}return Object(a["c"])(e,t),e.prototype.forSize=function(n,r){var i=t.prototype.forSize.call(this,n,r),o=i.score,a=i.relativeBox,s=i.imageDims;return new e(o,a,s)},e}(C);function A(t,e,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),i=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top)),o=r*i;return n?o/(t.area+e.area-o):o/Math.min(t.area,e.area)}function k(t){var e=t.map((function(t){return t.x})),n=t.map((function(t){return t.y})),r=e.reduce((function(t,e){return e<t?e:t}),1/0),i=n.reduce((function(t,e){return e<t?e:t}),1/0),o=e.reduce((function(t,e){return t<e?e:t}),0),a=n.reduce((function(t,e){return t<e?e:t}),0);return new _(r,i,o,a)}function T(t,e,n,r){void 0===r&&(r=!0);var i=e.map((function(t,e){return{score:t,boxIndex:e}})).sort((function(t,e){return t.score-e.score})).map((function(t){return t.boxIndex})),o=[],a=function(){var e=i.pop();o.push(e);for(var a=i,s=[],u=0;u<a.length;u++){var c=a[u],l=t[e],h=t[c];s.push(A(l,h,r))}i=i.filter((function(t,e){return s[e]<=n}))};while(i.length>0)a();return o}function I(t,e){return i["L"]((function(){var n=e[0],r=e[1],o=e[2],s=i["n"](Object(a["e"])(t.shape.slice(0,3),[1]),n),u=i["n"](Object(a["e"])(t.shape.slice(0,3),[1]),r),c=i["n"](Object(a["e"])(t.shape.slice(0,3),[1]),o),l=i["h"]([s,u,c],3);return i["F"](t,l)}))}function P(t,e){return void 0===e&&(e=!1),i["L"]((function(){var n=t.shape.slice(1),r=n[0],o=n[1];if(r===o)return t;var a=Math.abs(r-o),s=Math.round(a*(e?.5:1)),u=r>o?2:1,c=function(e){var n=t.shape.slice();return n[u]=e,i["n"](n,0)},l=c(s),h=a-l.shape[u],f=e&&h?c(h):null,p=[f,t,l].filter((function(t){return!!t})).map((function(t){return t.toFloat()}));return i["h"](p,u)}))}function D(t){return 1/(1+Math.exp(-t))}var R=function(t){function e(e,n,r,i,o){return void 0===o&&(o=!1),t.call(this,{x:e,y:n,width:r,height:i},o)||this}return Object(a["c"])(e,t),e}(E),M=.5,F=.43,O=.45,N=function(){function t(t,e,n){void 0===n&&(n=new w(0,0));var r=e.width,i=e.height;this._imgDims=new s(r,i),this._shift=n,this._positions=t.map((function(t){return t.mul(new w(r,i)).add(n)}))}return Object.defineProperty(t.prototype,"shift",{get:function(){return new w(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map((function(e){return e.sub(t._shift).div(new w(t.imageWidth,t.imageHeight))}))},enumerable:!0,configurable:!0}),t.prototype.forSize=function(t,e){return new this.constructor(this.relativePositions,{width:t,height:e})},t.prototype.shiftBy=function(t,e){return new this.constructor(this.relativePositions,this._imgDims,new w(t,e))},t.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},t.prototype.align=function(t,e){if(void 0===e&&(e={}),t){var n=t instanceof S?t.box.floor():new E(t);return this.shiftBy(n.x,n.y).align(null,e)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},e),i=r.useDlibAlignment,o=r.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(o)},t.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),e=t[0],n=t[1],r=t[2],i=function(t){return r.sub(t).magnitude()},o=(i(e)+i(n))/2,a=Math.floor(o/O),s=g(t),u=Math.floor(Math.max(0,s.x-M*a)),c=Math.floor(Math.max(0,s.y-F*a));return new R(u,c,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+c))},t.prototype.alignMinBbox=function(t){var e=k(this.positions);return e.pad(e.width*t,e.height*t)},t.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},t}(),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.getRefPointsForAlignment=function(){var t=this.positions;return[t[0],t[1],g([t[3],t[4]])]},e}(N),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.getJawOutline=function(){return this.positions.slice(0,17)},e.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},e.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},e.prototype.getNose=function(){return this.positions.slice(27,36)},e.prototype.getLeftEye=function(){return this.positions.slice(36,42)},e.prototype.getRightEye=function(){return this.positions.slice(42,48)},e.prototype.getMouth=function(){return this.positions.slice(48,68)},e.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(g)},e}(N),V=function(){function t(t,e){this._label=t,this._distance=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){return void 0===t&&(t=!0),this.label+(t?" ("+d(this.distance)+")":"")},t}(),z=function(t){function e(e,n){var r=t.call(this,e)||this;return r._label=n,r}return Object(a["c"])(e,t),e.assertIsValidLabeledBox=function(t,e){if(E.assertIsValidBox(t,e),!b(t.label))throw new Error(e+" - expected property label ("+t.label+") to be a number")},Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e}(E),j=function(){function t(t,e){if("string"!==typeof t)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(e)||e.some((function(t){return!(t instanceof Float32Array)})))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=e}return Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),t.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map((function(t){return Array.from(t)}))}},t.fromJSON=function(e){var n=e.descriptors.map((function(t){return new Float32Array(t)}));return new t(e.label,n)},t}();(function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o._score=r,o._classScore=i,o}Object(a["c"])(e,t),e.assertIsValidPredictedBox=function(t,e){if(z.assertIsValidLabeledBox(t,e),!x(t.score)||!x(t.classScore))throw new Error(e+" - expected properties score ("+t.score+") and ("+t.classScore+") to be a number between [0, 1]")},Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})})(z);function W(t){return t["detection"]instanceof S}function G(t,e){var n={detection:e};return Object.assign({},t,n)}function H(){var t=window["fetch"]||function(){throw new Error("fetch - missing fetch implementation for browser environment")},e=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:t,readFile:e}}var U=n("eea0"),q=n("602d");function $(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}var K,X=n("abab");function Y(){if(!K)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return K}function J(t){K=t}function Q(){$()&&J(H()),Object(X["a"])()&&J(Object(q["a"])())}function Z(t){if(K||Q(),!K)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var e=t.Canvas,n=void 0===e?K.Canvas:e,r=t.Image,i=void 0===r?K.Image:r;K.Canvas=n,K.Image=i,K.createCanvasElement=t.createCanvasElement||function(){return new n},K.createImageElement=t.createImageElement||function(){return new i},K.ImageData=t.ImageData||K.ImageData,K.Video=t.Video||K.Video,K.fetch=t.fetch||K.fetch,K.readFile=t.readFile||K.readFile}var tt,et={getEnv:Y,setEnv:J,initialize:Q,createBrowserEnv:H,createFileSystem:U["a"],createNodejsEnv:q["a"],monkeyPatch:Z,isBrowser:$,isNodejs:X["a"]};function nt(t){return et.isNodejs()||"string"!==typeof t?t:document.getElementById(t)}function rt(t){var e=et.getEnv(),n=e.Canvas,r=e.CanvasRenderingContext2D;if(t instanceof r)return t;var i=nt(t);if(!(i instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=i.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}Q(),function(t){t["TOP_LEFT"]="TOP_LEFT",t["TOP_RIGHT"]="TOP_RIGHT",t["BOTTOM_LEFT"]="BOTTOM_LEFT",t["BOTTOM_RIGHT"]="BOTTOM_RIGHT"}(tt||(tt={}));var it=function(){function t(t){void 0===t&&(t={});var e=t.anchorPosition,n=t.backgroundColor,r=t.fontColor,i=t.fontSize,o=t.fontStyle,a=t.padding;this.anchorPosition=e||tt.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=i||14,this.fontStyle=o||"Georgia",this.padding=a||4}return t}(),ot=function(){function t(e,n,r){void 0===r&&(r={}),this.text="string"===typeof e?[e]:e instanceof t?e.text:e,this.anchor=n,this.options=new it(r)}return t.prototype.measureWidth=function(t){var e=this.options.padding;return this.text.map((function(e){return t.measureText(e).width})).reduce((function(t,e){return t<e?e:t}),0)+2*e},t.prototype.measureHeight=function(){var t=this.options,e=t.fontSize,n=t.padding;return this.text.length*e+2*n},t.prototype.getUpperLeft=function(t,e){var n=this.options.anchorPosition,r=n===tt.BOTTOM_RIGHT||n===tt.TOP_RIGHT,i=n===tt.BOTTOM_LEFT||n===tt.BOTTOM_RIGHT,o=this.measureWidth(t),a=this.measureHeight(),s=r?this.anchor.x-o:this.anchor.x,u=i?this.anchor.y-a:this.anchor.y;if(e){var c=e.width,l=e.height,h=Math.max(Math.min(s,c-o),0),f=Math.max(Math.min(u,l-a),0);return{x:h,y:f}}return{x:s,y:u}},t.prototype.draw=function(t){var e=nt(t),n=rt(e),r=this.options,i=r.backgroundColor,o=r.fontColor,a=r.fontSize,s=r.fontStyle,u=r.padding;n.font=a+"px "+s;var c=this.measureWidth(n),l=this.measureHeight();n.fillStyle=i;var h=this.getUpperLeft(n,e);n.fillRect(h.x,h.y,c,l),n.fillStyle=o,this.text.forEach((function(t,e){var r=u+h.x,i=u+h.y+(e+1)*a;n.fillText(t,r,i)}))},t}(),at=function(){function t(t){void 0===t&&(t={});var e=t.boxColor,n=t.lineWidth,r=t.label,i=t.drawLabelOptions;this.boxColor=e||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var o={anchorPosition:tt.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new it(Object.assign({},o,i))}return t}(),st=function(){function t(t,e){void 0===e&&(e={}),this.box=new E(t),this.options=new at(e)}return t.prototype.draw=function(t){var e=rt(t),n=this.options,r=n.boxColor,i=n.lineWidth,o=this.box,a=o.x,s=o.y,u=o.width,c=o.height;e.strokeStyle=r,e.lineWidth=i,e.strokeRect(a,s,u,c);var l=this.options.label;l&&new ot([l],{x:a-i/2,y:s},this.options.drawLabelOptions).draw(t)},t}();function ut(t,e){var n=Array.isArray(e)?e:[e];n.forEach((function(e){var n=e instanceof S?e.score:W(e)?e.detection.score:void 0,r=e instanceof S?e.box:W(e)?e.detection.box:new E(e),i=n?""+d(n):void 0;new st(r,{label:i}).draw(t)}))}function ct(t){var e=et.getEnv(),n=e.Image,r=e.Video;return t instanceof n&&t.complete||t instanceof r&&t.readyState>=3}function lt(t){return new Promise((function(e,n){if(t instanceof et.getEnv().Canvas||ct(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",i),e(t))}function i(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",i),n(t))}t.addEventListener("load",r),t.addEventListener("error",i)}))}function ht(t){var e=et.getEnv(),n=e.Image,r=e.Video;return t instanceof n?new s(t.naturalWidth,t.naturalHeight):t instanceof r?new s(t.videoWidth,t.videoHeight):new s(t.width,t.height)}function ft(t){var e=t.width,n=t.height,r=et.getEnv().createCanvasElement,i=r();return i.width=e,i.height=n,i}function pt(t,e){var n=et.getEnv().ImageData;if(!(t instanceof n)&&!ct(t))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=e||ht(t),i=r.width,o=r.height,a=ft({width:i,height:o});return t instanceof n?rt(a).putImageData(t,0,0):rt(a).drawImage(t,0,0,i,o),a}function dt(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n,r,o,s,u,c;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=e||et.getEnv().createCanvasElement(),r=t.shape.slice(h(t)?1:0),o=r[0],s=r[1],u=r[2],c=i["L"]((function(){return t.as3D(o,s,u).toInt()})),[4,i["f"].toPixels(c,n)];case 1:return a.sent(),c.dispose(),[2,n]}}))}))}function mt(t){var e=et.getEnv(),n=e.Image,r=e.Canvas,i=e.Video;return t instanceof n||t instanceof r||t instanceof i}function vt(t,e,n){void 0===n&&(n=!1);var r=et.getEnv(),i=r.Image,o=r.Canvas;if(!(t instanceof i||t instanceof o))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=ht(t),s=e/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=ft({width:e,height:e}),h=t instanceof o?t:pt(t),f=Math.abs(u-c)/2,p=n&&u<c?f:0,d=n&&c<u?f:0;return rt(l).drawImage(h,p,d,u,c),l}var gt=function(){function t(t,e){var n=this;if(void 0===e&&(e=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=e,this._batchSize=t.length,t.forEach((function(t,e){if(l(t))return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape);if(h(t)){var r=t.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[e]=t,void(n._inputDimensions[e]=t.shape.slice(1))}var i=t instanceof et.getEnv().Canvas?t:pt(t);n._canvases[e]=i,n._inputDimensions[e]=[i.height,i.width,3]}))}return Object.defineProperty(t.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reshapedInputDimensions",{get:function(){var t=this;return y(this.batchSize,0,1).map((function(e,n){return t.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),t.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},t.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},t.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},t.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},t.prototype.getReshapedInputDimensions=function(t){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var e=this.getInputWidth(t),n=this.getInputHeight(t);return v({width:e,height:n},this.inputSize)},t.prototype.toBatchTensor=function(t,e){var n=this;return void 0===e&&(e=!0),this._inputSize=t,i["L"]((function(){var r=y(n.batchSize,0,1).map((function(r){var o=n.getInput(r);if(o instanceof i["a"]){var a=h(o)?o:o.expandDims();return a=P(a,e),a.shape[1]===t&&a.shape[2]===t||(a=i["o"].resizeBilinear(a,[t,t])),a.as3D(t,t,3)}if(o instanceof et.getEnv().Canvas)return i["f"].fromPixels(vt(o,t,e));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)})),o=i["E"](r.map((function(t){return t.toFloat()}))).as4D(n.batchSize,t,t,3);return o}))},t}();function yt(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r;return Object(a["d"])(this,(function(i){switch(i.label){case 0:if(t instanceof gt)return[2,t];if(e=Array.isArray(t)?t:[t],!e.length)throw new Error("toNetInput - empty array passed as input");return n=function(e){return Array.isArray(t)?" at input index "+e+":":""},r=e.map(nt),r.forEach((function(t,r){if(!mt(t)&&!l(t)&&!h(t)){if("string"===typeof e[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+e[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(h(t)){var i=t.shape[0];if(1!==i)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+i+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(t){return mt(t)&&lt(t)})))];case 1:return i.sent(),[2,new gt(r,Array.isArray(t))]}}))}))}function bt(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n,r,i,o,s,u,c;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=et.getEnv().Canvas,r=t,t instanceof n?[3,5]:[4,yt(t)];case 1:if(i=a.sent(),i.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return o=i.getInput(0),o instanceof n?(s=o,[3,4]):[3,2];case 2:return[4,dt(o)];case 3:s=a.sent(),a.label=4;case 4:r=s,a.label=5;case 5:return u=rt(r),c=e.map((function(t){return t instanceof S?t.forSize(r.width,r.height).box.floor():t})).map((function(t){return t.clipAtImageBorders(r.width,r.height)})),[2,c.map((function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=ft({width:r,height:i});return rt(o).putImageData(u.getImageData(e,n,r,i),0,0),o}))]}}))}))}function xt(t,e){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(n){if(!l(t)&&!h(t))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(h(t)&&t.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,i["L"]((function(){var n=t.shape.slice(h(t)?1:0),r=n[0],o=n[1],a=n[2],s=e.map((function(t){return t instanceof S?t.forSize(o,r).box:t})).map((function(t){return t.clipAtImageBorders(o,r)})),u=s.map((function(e){var n=e.x,s=e.y,u=e.width,c=e.height;return i["C"](t.as3D(r,o,a),[s,n,0],[c,u,a])}));return u}))]}))}))}function wt(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n,r;return Object(a["d"])(this,(function(i){switch(i.label){case 0:return n=et.getEnv().fetch,[4,n(t,e)];case 1:if(r=i.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}}))}))}function Et(t){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(e){switch(e.label){case 0:return[4,wt(t)];case 1:return[2,e.sent().json()]}}))}))}function _t(t,e){var n=e+"-weights_manifest.json";if(!t)return{modelBaseUri:"",manifestUri:n};if("/"===t)return{modelBaseUri:"/",manifestUri:"/"+n};var r=t.startsWith("http://")?"http://":t.startsWith("https://")?"https://":"";t=t.replace(r,"");var i=t.split("/").filter((function(t){return t})),o=t.endsWith(".json")?i[i.length-1]:n,a=r+(t.endsWith(".json")?i.slice(0,i.length-1):i).join("/");return a=t.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:"/"===a?"/"+o:a+"/"+o}}function Ct(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n,r,o,s;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=_t(t,e),r=n.manifestUri,o=n.modelBaseUri,[4,Et(r)];case 1:return s=a.sent(),[2,i["p"].loadWeights(s,o)]}}))}))}function St(t,e,n){void 0===n&&(n=!1);var r=n?ht(e):e,i=r.width,o=r.height;return t.width=i,t.height=o,{width:i,height:o}}var At=function(){function t(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(t.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),t.prototype.getParamFromPath=function(t){var e=this.traversePropertyPath(t),n=e.obj,r=e.objProp;return n[r]},t.prototype.reassignParamFromPath=function(t,e){var n=this.traversePropertyPath(t),r=n.obj,i=n.objProp;r[i].dispose(),r[i]=e},t.prototype.getParamList=function(){var t=this;return this._paramMappings.map((function(e){var n=e.paramPath;return{path:n,tensor:t.getParamFromPath(n)}}))},t.prototype.getTrainableParams=function(){return this.getParamList().filter((function(t){return t.tensor instanceof i["b"]}))},t.prototype.getFrozenParams=function(){return this.getParamList().filter((function(t){return!(t.tensor instanceof i["b"])}))},t.prototype.variable=function(){var t=this;this.getFrozenParams().forEach((function(e){var n=e.path,r=e.tensor;t.reassignParamFromPath(n,r.variable())}))},t.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach((function(e){var n=e.path,r=e.tensor,o=i["G"](r.dataSync());r.dispose(),t.reassignParamFromPath(n,o)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.getParamList().forEach((function(e){if(t&&e.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+e.path);e.tensor.dispose()})),this._params=void 0},t.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(t){var e=t.tensor;return Array.from(e.dataSync())})).reduce((function(t,e){return t.concat(e)})))},t.prototype.load=function(t){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(e){switch(e.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return e.sent(),[2]}}))}))},t.prototype.loadFromUri=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:if(t&&"string"!==typeof t)throw new Error(this._name+".loadFromUri - expected model uri");return[4,Ct(t,this.getDefaultModelName())];case 1:return e=n.sent(),this.loadFromWeightMap(e),[2]}}))}))},t.prototype.loadFromDisk=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r,o,s,u,c,l,h,f;return Object(a["d"])(this,(function(a){switch(a.label){case 0:if(t&&"string"!==typeof t)throw new Error(this._name+".loadFromDisk - expected model file path");return e=et.getEnv().readFile,n=_t(t,this.getDefaultModelName()),r=n.manifestUri,o=n.modelBaseUri,s=function(t){return Promise.all(t.map((function(t){return e(t).then((function(t){return t.buffer}))})))},u=i["p"].weightsLoaderFactory(s),h=(l=JSON).parse,[4,e(r)];case 1:return c=h.apply(l,[a.sent().toString()]),[4,u(c,o)];case 2:return f=a.sent(),this.loadFromWeightMap(f),[2]}}))}))},t.prototype.loadFromWeightMap=function(t){var e=this.extractParamsFromWeigthMap(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.extractWeights=function(t){var e=this.extractParams(t),n=e.paramMappings,r=e.params;this._paramMappings=n,this._params=r},t.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var e=t.split("/").reduce((function(e,n){if(!e.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+t);return{obj:e.nextObj,objProp:n,nextObj:e.nextObj[n]}}),{nextObj:this.params}),n=e.obj,r=e.objProp;if(!n||!r||!(n[r]instanceof i["a"]))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:n,objProp:r}},t}();function kt(t,e,n){return i["L"]((function(){var r=i["z"](t,e.depthwise_filter,e.pointwise_filter,n,"same");return r=i["c"](r,e.bias),r}))}function Tt(t,e,n){return void 0===n&&(n=!1),i["L"]((function(){var r=i["w"](n?i["c"](i["i"](t,e.conv0.filters,[2,2],"same"),e.conv0.bias):kt(t,e.conv0,[2,2])),o=kt(r,e.conv1,[1,1]),a=i["w"](i["c"](r,o)),s=kt(a,e.conv2,[1,1]);return i["w"](i["c"](r,i["c"](o,s)))}))}function It(t,e,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),i["L"]((function(){var o=i["w"](n?i["c"](i["i"](t,e.conv0.filters,r?[2,2]:[1,1],"same"),e.conv0.bias):kt(t,e.conv0,r?[2,2]:[1,1])),a=kt(o,e.conv1,[1,1]),s=i["w"](i["c"](o,a)),u=kt(s,e.conv2,[1,1]),c=i["w"](i["c"](o,i["c"](a,u))),l=kt(c,e.conv3,[1,1]);return i["w"](i["c"](o,i["c"](a,i["c"](u,l))))}))}function Pt(t,e,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),i["L"]((function(){var o=i["c"](i["i"](t,e.filters,[1,1],n),e.bias);return r?i["w"](o):o}))}function Dt(t,e){Object.keys(t).forEach((function(n){e.some((function(t){return t.originalPath===n}))||t[n].dispose()}))}function Rt(t,e){return function(n,r,o,a){var s=i["K"](t(n*r*o*o),[o,o,n,r]),u=i["H"](t(r));return e.push({paramPath:a+"/filters"},{paramPath:a+"/bias"}),{filters:s,bias:u}}}function Mt(t,e){return function(n,r,o){var a=i["I"](t(n*r),[n,r]),s=i["H"](t(r));return e.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:a,bias:s}}}var Ft=function(){function t(t,e,n){this.depthwise_filter=t,this.pointwise_filter=e,this.bias=n}return t}();function Ot(t,e){return function(n,r,o){var a=i["K"](t(9*n),[3,3,n,1]),s=i["K"](t(n*r),[1,1,n,r]),u=i["H"](t(r));return e.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new Ft(a,s,u)}}function Nt(t){return function(e){var n=t(e+"/depthwise_filter",4),r=t(e+"/pointwise_filter",4),i=t(e+"/bias",1);return new Ft(n,r,i)}}function Lt(t,e){return function(n,r,i){var o=t[n];if(!u(o,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+o);return e.push({originalPath:n,paramPath:i||n}),o}}function Bt(t){var e=t;function n(t){var n=e.slice(0,t);return e=e.slice(t),n}function r(){return e}return{extractWeights:n,getRemainingWeights:r}}function Vt(t,e){var n=Rt(t,e),r=Ot(t,e);function i(t,e,i,o){void 0===o&&(o=!1);var a=o?n(t,e,3,i+"/conv0"):r(t,e,i+"/conv0"),s=r(e,e,i+"/conv1"),u=r(e,e,i+"/conv2");return{conv0:a,conv1:s,conv2:u}}function o(t,e,n,o){void 0===o&&(o=!1);var a=i(t,e,n,o),s=a.conv0,u=a.conv1,c=a.conv2,l=r(e,e,n+"/conv3");return{conv0:s,conv1:u,conv2:c,conv3:l}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:o}}function zt(t){var e=[],n=Bt(t),r=n.extractWeights,i=n.getRemainingWeights,o=Vt(r,e).extractDenseBlock4Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2"),c=o(128,256,"dense3");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}function jt(t){return function(e){var n=t(e+"/filters",4),r=t(e+"/bias",1);return{filters:n,bias:r}}}function Wt(t,e){var n=Lt(t,e),r=jt(n),i=Nt(n);function o(t,e){void 0===e&&(e=!1);var n=e?r(t+"/conv0"):i(t+"/conv0"),o=i(t+"/conv1"),a=i(t+"/conv2");return{conv0:n,conv1:o,conv2:a}}function a(t,e){void 0===e&&(e=!1);var n=e?r(t+"/conv0"):i(t+"/conv0"),o=i(t+"/conv1"),a=i(t+"/conv2"),s=i(t+"/conv3");return{conv0:n,conv1:o,conv2:a,conv3:s}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:a}}function Gt(t){var e=[],n=Wt(t,e).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Dt(t,e),{params:r,paramMappings:e}}var Ht=function(t){function e(){return t.call(this,"FaceFeatureExtractor")||this}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceFeatureExtractor - load model before inference");return i["L"]((function(){var n=t.toBatchTensor(112,!0),r=[122.782,117.001,104.298],o=I(n,r).div(i["y"](255)),a=It(o,e.dense0,!0);return a=It(a,e.dense1),a=It(a,e.dense2),a=It(a,e.dense3),a=i["d"](a,[7,7],[2,2],"valid"),a}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Gt(t)},e.prototype.extractParams=function(t){return zt(t)},e}(At);function Ut(t,e){return i["L"]((function(){return i["c"](i["q"](t,e.weights),e.bias)}))}function qt(t,e,n){var r=[],i=Bt(t),o=i.extractWeights,a=i.getRemainingWeights,s=Mt(o,r),u=s(e,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function $t(t){var e=[],n=Lt(t,e);function r(t){var e=n(t+"/weights",2),r=n(t+"/bias",1);return{weights:e,bias:r}}var i={fc:r("fc")};return Dt(t,e),{params:i,paramMappings:e}}function Kt(t){var e={},n={};return Object.keys(t).forEach((function(r){var i=r.startsWith("fc")?n:e;i[r]=t[r]})),{featureExtractorMap:e,classifierMap:n}}var Xt=function(t){function e(e,n){var r=t.call(this,e)||this;return r._faceFeatureExtractor=n,r}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return i["L"]((function(){var r=t instanceof gt?e.faceFeatureExtractor.forwardInput(t):t;return Ut(r.as2D(r.shape[0],-1),n.fc)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return qt(t,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},e.prototype.extractParamsFromWeigthMap=function(t){var e=Kt(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),$t(r)},e.prototype.extractParams=function(t){var e=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*e+n,i=t.slice(0,t.length-r),o=t.slice(t.length-r);return this.faceFeatureExtractor.extractWeights(i),this.extractClassifierParams(o)},e}(At),Yt=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Jt=function(){function t(t){var e=this;if(7!==t.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Yt.forEach((function(n,r){e[n]=t[r]}))}return t.prototype.asSortedArray=function(){var t=this;return Yt.map((function(e){return{expression:e,probability:t[e]}})).sort((function(t,e){return e.probability-t.probability}))},t}(),Qt=function(t){function e(e){return void 0===e&&(e=new Ht),t.call(this,"FaceExpressionNet",e)||this}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this;return i["L"]((function(){return i["D"](e.runNet(t))}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictExpressions=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r,o,s=this;return Object(a["d"])(this,(function(u){switch(u.label){case 0:return[4,yt(t)];case 1:return e=u.sent(),[4,this.forwardInput(e)];case 2:return n=u.sent(),[4,Promise.all(i["O"](n).map((function(t){return Object(a["b"])(s,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,t.data()];case 1:return e=n.sent(),t.dispose(),[2,e]}}))}))})))];case 3:return r=u.sent(),n.dispose(),o=r.map((function(t){return new Jt(t)})),[2,e.isBatchInput?o:o[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_expression_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e.prototype.getClassifierChannelsOut=function(){return 7},e}(Xt);function Zt(t){return t["expressions"]instanceof Jt}function te(t,e){var n={expressions:e};return Object.assign({},t,n)}function ee(t,e,n,r){void 0===n&&(n=.1);var i=Array.isArray(e)?e:[e];i.forEach((function(e){var i=e instanceof Jt?e:Zt(e)?e.expressions:void 0;if(!i)throw new Error("drawFaceExpressions - expected faceExpressions to be FaceExpressions | WithFaceExpressions<{}> or array thereof");var o=i.asSortedArray(),a=o.filter((function(t){return t.probability>n})),s=W(e)?e.detection.box.bottomLeft:r||new w(0,0),u=new ot(a.map((function(t){return t.expression+" ("+d(t.probability)+")"})),s);u.draw(t)}))}function ne(t){return W(t)&&t["landmarks"]instanceof N&&t["unshiftedLandmarks"]instanceof N&&t["alignedRect"]instanceof S}function re(t,e){var n=t.detection.box,r=e.shiftBy(n.x,n.y),i=r.align(),o=t.detection.imageDims,a=new S(t.detection.score,i.rescale(o.reverse()),o),s={landmarks:r,unshiftedLandmarks:e,alignedRect:a};return Object.assign({},t,s)}var ie=function(){function t(t){void 0===t&&(t={});var e=t.drawLines,n=void 0===e||e,r=t.drawPoints,i=void 0===r||r,o=t.lineWidth,a=t.lineColor,s=t.pointSize,u=t.pointColor;this.drawLines=n,this.drawPoints=i,this.lineWidth=o||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=u||"rgba(255, 0, 255, 1)"}return t}(),oe=function(){function t(t,e){void 0===e&&(e={}),this.faceLandmarks=t,this.options=new ie(e)}return t.prototype.draw=function(t){var e=rt(t),n=this.options,r=n.drawLines,i=n.drawPoints,a=n.lineWidth,s=n.lineColor,u=n.pointSize,c=n.pointColor;if(r&&this.faceLandmarks instanceof B&&(e.strokeStyle=s,e.lineWidth=a,o(e,this.faceLandmarks.getJawOutline()),o(e,this.faceLandmarks.getLeftEyeBrow()),o(e,this.faceLandmarks.getRightEyeBrow()),o(e,this.faceLandmarks.getNose()),o(e,this.faceLandmarks.getLeftEye(),!0),o(e,this.faceLandmarks.getRightEye(),!0),o(e,this.faceLandmarks.getMouth(),!0)),i){e.strokeStyle=c,e.fillStyle=c;var l=function(t){e.beginPath(),e.arc(t.x,t.y,u,0,2*Math.PI),e.fill()};this.faceLandmarks.positions.forEach(l)}},t}();function ae(t,e){var n=Array.isArray(e)?e:[e];n.forEach((function(e){var n=e instanceof N?e:ne(e)?e.landmarks:void 0;if(!n)throw new Error("drawFaceLandmarks - expected faceExpressions to be FaceLandmarks | WithFaceLandmarks<WithFaceDetection<{}>> or array thereof");new oe(n).draw(t)}))}function se(t,e){var n=Rt(t,e),r=Ot(t,e);function i(t,e,i){var o=r(t,e,i+"/separable_conv0"),a=r(e,e,i+"/separable_conv1"),s=n(t,e,1,i+"/expansion_conv");return{separable_conv0:o,separable_conv1:a,expansion_conv:s}}function o(t,e){var n=r(t,t,e+"/separable_conv0"),i=r(t,t,e+"/separable_conv1"),o=r(t,t,e+"/separable_conv2");return{separable_conv0:n,separable_conv1:i,separable_conv2:o}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:i,extractMainBlockParams:o}}function ue(t,e){var n=[],r=Bt(t),i=r.extractWeights,o=r.getRemainingWeights,a=se(i,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,h=s(3,32,3,"entry_flow/conv_in"),f=c(32,64,"entry_flow/reduction_block_0"),p=c(64,128,"entry_flow/reduction_block_1"),d={conv_in:h,reduction_block_0:f,reduction_block_1:p},m={};y(e,0,1).forEach((function(t){m["main_block_"+t]=l(128,"middle_flow/main_block_"+t)}));var v=c(128,256,"exit_flow/reduction_block"),g=u(256,512,"exit_flow/separable_conv"),b={reduction_block:v,separable_conv:g};if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:n,params:{entry_flow:d,middle_flow:m,exit_flow:b}}}function ce(t,e){var n=Lt(t,e),r=jt(n),i=Nt(n);function o(t){var e=i(t+"/separable_conv0"),n=i(t+"/separable_conv1"),o=r(t+"/expansion_conv");return{separable_conv0:e,separable_conv1:n,expansion_conv:o}}function a(t){var e=i(t+"/separable_conv0"),n=i(t+"/separable_conv1"),r=i(t+"/separable_conv2");return{separable_conv0:e,separable_conv1:n,separable_conv2:r}}return{extractConvParams:r,extractSeparableConvParams:i,extractReductionBlockParams:o,extractMainBlockParams:a}}function le(t,e){var n=[],r=ce(t,n),i=r.extractConvParams,o=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=i("entry_flow/conv_in"),c=a("entry_flow/reduction_block_0"),l=a("entry_flow/reduction_block_1"),h={conv_in:u,reduction_block_0:c,reduction_block_1:l},f={};y(e,0,1).forEach((function(t){f["main_block_"+t]=s("middle_flow/main_block_"+t)}));var p=a("exit_flow/reduction_block"),d=o("exit_flow/separable_conv"),m={reduction_block:p,separable_conv:d};return Dt(t,n),{params:{entry_flow:h,middle_flow:f,exit_flow:m},paramMappings:n}}function he(t,e,n){return i["c"](i["i"](t,e.filters,n,"same"),e.bias)}function fe(t,e,n){void 0===n&&(n=!0);var r=n?i["w"](t):t;return r=kt(r,e.separable_conv0,[1,1]),r=kt(i["w"](r),e.separable_conv1,[1,1]),r=i["s"](r,[3,3],[2,2],"same"),r=i["c"](r,he(t,e.expansion_conv,[2,2])),r}function pe(t,e){var n=kt(i["w"](t),e.separable_conv0,[1,1]);return n=kt(i["w"](n),e.separable_conv1,[1,1]),n=kt(i["w"](n),e.separable_conv2,[1,1]),n=i["c"](n,t),n}var de,me=function(t){function e(e){var n=t.call(this,"TinyXception")||this;return n._numMainBlocks=e,n}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return i["L"]((function(){var r=t.toBatchTensor(112,!0),o=[122.782,117.001,104.298],a=I(r,o).div(i["y"](256)),s=i["w"](he(a,n.entry_flow.conv_in,[2,2]));return s=fe(s,n.entry_flow.reduction_block_0,!1),s=fe(s,n.entry_flow.reduction_block_1),y(e._numMainBlocks,0,1).forEach((function(t){s=pe(s,n.middle_flow["main_block_"+t])})),s=fe(s,n.exit_flow.reduction_block),s=i["w"](kt(s,n.exit_flow.separable_conv,[1,1])),s}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_xception_model"},e.prototype.extractParamsFromWeigthMap=function(t){return le(t,this._numMainBlocks)},e.prototype.extractParams=function(t){return ue(t,this._numMainBlocks)},e}(At);function ve(t){var e=[],n=Bt(t),r=n.extractWeights,i=n.getRemainingWeights,o=Mt(r,e),a=o(512,1,"fc/age"),s=o(512,2,"fc/gender");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{fc:{age:a,gender:s}}}}function ge(t){var e=[],n=Lt(t,e);function r(t){var e=n(t+"/weights",2),r=n(t+"/bias",1);return{weights:e,bias:r}}var i={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Dt(t,e),{params:i,paramMappings:e}}(function(t){t["FEMALE"]="female",t["MALE"]="male"})(de||(de={}));var ye=function(t){function e(e){void 0===e&&(e=new me(2));var n=t.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=e,n}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),e.prototype.runNet=function(t){var e=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return i["L"]((function(){var r=t instanceof gt?e.faceFeatureExtractor.forwardInput(t):t,o=i["d"](r,[7,7],[2,2],"valid").as2D(r.shape[0],-1),a=Ut(o,n.fc.age).as1D(),s=Ut(o,n.fc.gender);return{age:a,gender:s}}))},e.prototype.forwardInput=function(t){var e=this;return i["L"]((function(){var n=e.runNet(t),r=n.age,o=n.gender;return{age:r,gender:i["D"](o)}}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.predictAgeAndGender=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r,o,s,u,c=this;return Object(a["d"])(this,(function(l){switch(l.label){case 0:return[4,yt(t)];case 1:return e=l.sent(),[4,this.forwardInput(e)];case 2:return n=l.sent(),r=i["O"](n.age),o=i["O"](n.gender),s=r.map((function(t,e){return{ageTensor:t,genderTensor:o[e]}})),[4,Promise.all(s.map((function(t){var e=t.ageTensor,n=t.genderTensor;return Object(a["b"])(c,void 0,void 0,(function(){var t,r,i,o,s;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return[4,e.data()];case 1:return t=a.sent()[0],[4,n.data()];case 2:return r=a.sent()[0],i=r>.5,o=i?de.MALE:de.FEMALE,s=i?r:1-r,e.dispose(),n.dispose(),[2,{age:t,gender:o,genderProbability:s}]}}))}))})))];case 3:return u=l.sent(),n.age.dispose(),n.gender.dispose(),[2,e.isBatchInput?u:u[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"age_gender_model"},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.faceFeatureExtractor.dispose(e),t.prototype.dispose.call(this,e)},e.prototype.loadClassifierParams=function(t){var e=this.extractClassifierParams(t),n=e.params,r=e.paramMappings;this._params=n,this._paramMappings=r},e.prototype.extractClassifierParams=function(t){return ve(t)},e.prototype.extractParamsFromWeigthMap=function(t){var e=Kt(t),n=e.featureExtractorMap,r=e.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),ge(r)},e.prototype.extractParams=function(t){var e=1539,n=t.slice(0,t.length-e),r=t.slice(t.length-e);return this.faceFeatureExtractor.extractWeights(n),this.extractClassifierParams(r)},e}(At),be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.postProcess=function(t,e,n){var r=n.map((function(t){var n=t.width,r=t.height,i=e/Math.max(r,n);return{width:n*i,height:r*i}})),o=r.length;return i["L"]((function(){var n=function(t,e){return i["E"]([i["n"]([68],t),i["n"]([68],e)],1).as2D(1,136).as1D()},a=function(t,e){var n=r[t],i=n.width,o=n.height;return e(i,o)?Math.abs(i-o)/2:0},s=function(t){return a(t,(function(t,e){return t<e}))},u=function(t){return a(t,(function(t,e){return e<t}))},c=t.mul(i["n"]([o,136],e)).sub(i["E"](Array.from(Array(o),(function(t,e){return n(s(e),u(e))})))).div(i["E"](Array.from(Array(o),(function(t,e){return n(r[e].width,r[e].height)}))));return c}))},e.prototype.forwardInput=function(t){var e=this;return i["L"]((function(){var n=e.runNet(t);return e.postProcess(n,t.inputSize,t.inputDimensions.map((function(t){var e=t[0],n=t[1];return{height:e,width:n}})))}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.detectLandmarks=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r,o=this;return Object(a["d"])(this,(function(s){switch(s.label){case 0:return[4,yt(t)];case 1:return e=s.sent(),n=i["L"]((function(){return i["O"](o.forwardInput(e))})),[4,Promise.all(n.map((function(t,n){return Object(a["b"])(o,void 0,void 0,(function(){var r,i,o,s,u;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return o=(i=Array).from,[4,t.data()];case 1:return r=o.apply(i,[a.sent()]),s=r.filter((function(t,e){return p(e)})),u=r.filter((function(t,e){return!p(e)})),[2,new B(Array(68).fill(0).map((function(t,e){return new w(s[e],u[e])})),{height:e.getInputHeight(n),width:e.getInputWidth(n)})]}}))}))})))];case 2:return r=s.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getClassifierChannelsOut=function(){return 136},e}(Xt),xe=function(t){function e(e){return void 0===e&&(e=new Ht),t.call(this,"FaceLandmark68Net",e)||this}return Object(a["c"])(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},e.prototype.getClassifierChannelsIn=function(){return 256},e}(be);function we(t){var e=[],n=Wt(t,e).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Dt(t,e),{params:r,paramMappings:e}}function Ee(t){var e=[],n=Bt(t),r=n.extractWeights,i=n.getRemainingWeights,o=Vt(r,e).extractDenseBlock3Params,a=o(3,32,"dense0",!0),s=o(32,64,"dense1"),u=o(64,128,"dense2");if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:e,params:{dense0:a,dense1:s,dense2:u}}}var _e=function(t){function e(){return t.call(this,"TinyFaceFeatureExtractor")||this}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("TinyFaceFeatureExtractor - load model before inference");return i["L"]((function(){var n=t.toBatchTensor(112,!0),r=[122.782,117.001,104.298],o=I(n,r).div(i["y"](255)),a=Tt(o,e.dense0,!0);return a=Tt(a,e.dense1),a=Tt(a,e.dense2),a=i["d"](a,[14,14],[2,2],"valid"),a}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},e.prototype.extractParamsFromWeigthMap=function(t){return we(t)},e.prototype.extractParams=function(t){return Ee(t)},e}(At),Ce=function(t){function e(e){return void 0===e&&(e=new _e),t.call(this,"FaceLandmark68TinyNet",e)||this}return Object(a["c"])(e,t),e.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},e.prototype.getClassifierChannelsIn=function(){return 128},e}(be);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(a["c"])(e,t)})(xe);function Se(t,e){return i["c"](i["t"](t,e.weights),e.biases)}function Ae(t,e,n,r,o){void 0===o&&(o="same");var a=e.conv,s=a.filters,u=a.bias,c=i["i"](t,s,n,o);return c=i["c"](c,u),c=Se(c,e.scale),r?i["w"](c):c}function ke(t,e){return Ae(t,e,[1,1],!0)}function Te(t,e){return Ae(t,e,[1,1],!1)}function Ie(t,e){return Ae(t,e,[2,2],!0,"valid")}function Pe(t,e){function n(e,n,r){var o=t(e),a=o.length/(n*r*r);if(f(a))throw new Error("depth has to be an integer: "+a+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return i["L"]((function(){return i["N"](i["K"](o,[n,a,r,r]),[2,3,1,0])}))}function r(r,o,a,s){var u=n(r,o,a),c=i["H"](t(o));return e.push({paramPath:s+"/filters"},{paramPath:s+"/bias"}),{filters:u,bias:c}}function o(n,r){var o=i["H"](t(n)),a=i["H"](t(n));return e.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:o,biases:a}}function a(t,e,n,i){var a=r(t,e,n,i+"/conv"),s=o(e,i+"/scale");return{conv:a,scale:s}}function s(t,e,n,r,i){void 0===i&&(i=!1);var o=a((i?.5:1)*t,e,n,r+"/conv1"),s=a(t,e,n,r+"/conv2");return{conv1:o,conv2:s}}return{extractConvLayerParams:a,extractResidualLayerParams:s}}function De(t){var e=Bt(t),n=e.extractWeights,r=e.getRemainingWeights,o=[],a=Pe(n,o),s=a.extractConvLayerParams,u=a.extractResidualLayerParams,c=s(4704,32,7,"conv32_down"),l=u(9216,32,3,"conv32_1"),h=u(9216,32,3,"conv32_2"),f=u(9216,32,3,"conv32_3"),p=u(36864,64,3,"conv64_down",!0),d=u(36864,64,3,"conv64_1"),m=u(36864,64,3,"conv64_2"),v=u(36864,64,3,"conv64_3"),g=u(147456,128,3,"conv128_down",!0),y=u(147456,128,3,"conv128_1"),b=u(147456,128,3,"conv128_2"),x=u(589824,256,3,"conv256_down",!0),w=u(589824,256,3,"conv256_1"),E=u(589824,256,3,"conv256_2"),_=u(589824,256,3,"conv256_down_out"),C=i["L"]((function(){return i["N"](i["I"](n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);var S={conv32_down:c,conv32_1:l,conv32_2:h,conv32_3:f,conv64_down:p,conv64_1:d,conv64_2:m,conv64_3:v,conv128_down:g,conv128_1:y,conv128_2:b,conv256_down:x,conv256_1:w,conv256_2:E,conv256_down_out:_,fc:C};return{params:S,paramMappings:o}}function Re(t,e){var n=Lt(t,e);function r(t){var e=n(t+"/scale/weights",1),r=n(t+"/scale/biases",1);return{weights:e,biases:r}}function i(t){var e=n(t+"/conv/filters",4),i=n(t+"/conv/bias",1),o=r(t);return{conv:{filters:e,bias:i},scale:o}}function o(t){return{conv1:i(t+"/conv1"),conv2:i(t+"/conv2")}}return{extractConvLayerParams:i,extractResidualLayerParams:o}}function Me(t){var e=[],n=Re(t,e),r=n.extractConvLayerParams,i=n.extractResidualLayerParams,o=r("conv32_down"),a=i("conv32_1"),s=i("conv32_2"),u=i("conv32_3"),l=i("conv64_down"),h=i("conv64_1"),f=i("conv64_2"),p=i("conv64_3"),d=i("conv128_down"),m=i("conv128_1"),v=i("conv128_2"),g=i("conv256_down"),y=i("conv256_1"),b=i("conv256_2"),x=i("conv256_down_out"),w=t["fc"];if(e.push({originalPath:"fc",paramPath:"fc"}),!c(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var E={conv32_down:o,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:h,conv64_2:f,conv64_3:p,conv128_down:d,conv128_1:m,conv128_2:v,conv256_down:g,conv256_1:y,conv256_2:b,conv256_down_out:x,fc:w};return Dt(t,e),{params:E,paramMappings:e}}function Fe(t,e){var n=ke(t,e.conv1);return n=Te(n,e.conv2),n=i["c"](n,t),n=i["w"](n),n}function Oe(t,e){var n=Ie(t,e.conv1);n=Te(n,e.conv2);var r=i["d"](t,2,2,"valid"),o=i["P"](r.shape),s=r.shape[3]!==n.shape[3],u=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(u){var c=Object(a["e"])(n.shape);c[1]=1;var l=i["P"](c);n=i["h"]([n,l],1);var h=Object(a["e"])(n.shape);h[2]=1;var f=i["P"](h);n=i["h"]([n,f],2)}return r=s?i["h"]([r,o],3):r,n=i["c"](r,n),n=i["w"](n),n}var Ne=function(t){function e(){return t.call(this,"FaceRecognitionNet")||this}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("FaceRecognitionNet - load model before inference");return i["L"]((function(){var n=t.toBatchTensor(150,!0).toFloat(),r=[122.782,117.001,104.298],o=I(n,r).div(i["y"](256)),a=Ie(o,e.conv32_down);a=i["s"](a,3,2,"valid"),a=Fe(a,e.conv32_1),a=Fe(a,e.conv32_2),a=Fe(a,e.conv32_3),a=Oe(a,e.conv64_down),a=Fe(a,e.conv64_1),a=Fe(a,e.conv64_2),a=Fe(a,e.conv64_3),a=Oe(a,e.conv128_down),a=Fe(a,e.conv128_1),a=Fe(a,e.conv128_2),a=Oe(a,e.conv256_down),a=Fe(a,e.conv256_1),a=Fe(a,e.conv256_2),a=Oe(a,e.conv256_down_out);var s=a.mean([1,2]),u=i["q"](s,e.fc);return u}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.computeFaceDescriptor=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e,n,r,o=this;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return[4,yt(t)];case 1:return e=a.sent(),n=i["L"]((function(){return i["O"](o.forwardInput(e))})),[4,Promise.all(n.map((function(t){return t.data()})))];case 2:return r=a.sent(),n.forEach((function(t){return t.dispose()})),[2,e.isBatchInput?r:r[0]]}}))}))},e.prototype.getDefaultModelName=function(){return"face_recognition_model"},e.prototype.extractParamsFromWeigthMap=function(t){return Me(t)},e.prototype.extractParams=function(t){return De(t)},e}(At);function Le(t,e){var n={descriptor:e};return Object.assign({},t,n)}function Be(t,e){var n={age:e};return Object.assign({},t,n)}function Ve(t,e,n){var r={gender:e,genderProbability:n};return Object.assign({},t,r)}var ze=function(){function t(t){var e=void 0===t?{}:t,n=e.minFaceSize,r=e.scaleFactor,i=e.maxNumScales,o=e.scoreThresholds,a=e.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=i||10,this._scoreThresholds=o||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(t){return"number"!==typeof t})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(t){return"number"!==typeof t}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(t.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),t}();function je(t,e){function n(n,r){var o=i["K"](t(9*n),[3,3,n,1]),a=i["H"](t(n)),s=i["H"](t(n)),u=i["H"](t(n)),c=i["H"](t(n));return e.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:o,batch_norm_scale:a,batch_norm_offset:s,batch_norm_mean:u,batch_norm_variance:c}}function r(n,r,o,a,s){var u=i["K"](t(n*r*o*o),[o,o,n,r]),c=i["H"](t(r));return e.push({paramPath:a+"/filters"},{paramPath:a+"/"+(s?"batch_norm_offset":"bias")}),{filters:u,bias:c}}function o(t,e,n,i){var o=r(t,e,n,i,!0),a=o.filters,s=o.bias;return{filters:a,batch_norm_offset:s}}function a(t,e,r){var i=n(t,r+"/depthwise_conv"),a=o(t,e,1,r+"/pointwise_conv");return{depthwise_conv:i,pointwise_conv:a}}function s(){var t=o(3,32,3,"mobilenetv1/conv_0"),e=a(32,64,"mobilenetv1/conv_1"),n=a(64,128,"mobilenetv1/conv_2"),r=a(128,128,"mobilenetv1/conv_3"),i=a(128,256,"mobilenetv1/conv_4"),s=a(256,256,"mobilenetv1/conv_5"),u=a(256,512,"mobilenetv1/conv_6"),c=a(512,512,"mobilenetv1/conv_7"),l=a(512,512,"mobilenetv1/conv_8"),h=a(512,512,"mobilenetv1/conv_9"),f=a(512,512,"mobilenetv1/conv_10"),p=a(512,512,"mobilenetv1/conv_11"),d=a(512,1024,"mobilenetv1/conv_12"),m=a(1024,1024,"mobilenetv1/conv_13");return{conv_0:t,conv_1:e,conv_2:n,conv_3:r,conv_4:i,conv_5:s,conv_6:u,conv_7:c,conv_8:l,conv_9:h,conv_10:f,conv_11:p,conv_12:d,conv_13:m}}function u(){var t=o(1024,256,1,"prediction_layer/conv_0"),e=o(256,512,3,"prediction_layer/conv_1"),n=o(512,128,1,"prediction_layer/conv_2"),i=o(128,256,3,"prediction_layer/conv_3"),a=o(256,128,1,"prediction_layer/conv_4"),s=o(128,256,3,"prediction_layer/conv_5"),u=o(256,64,1,"prediction_layer/conv_6"),c=o(64,128,3,"prediction_layer/conv_7"),l=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),h=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),f=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),p=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),d=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),m=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),v=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),g=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),y=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),b=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),x=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),w=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),E={box_encoding_predictor:l,class_predictor:h},_={box_encoding_predictor:f,class_predictor:p},C={box_encoding_predictor:d,class_predictor:m},S={box_encoding_predictor:v,class_predictor:g},A={box_encoding_predictor:y,class_predictor:b},k={box_encoding_predictor:x,class_predictor:w};return{conv_0:t,conv_1:e,conv_2:n,conv_3:i,conv_4:a,conv_5:s,conv_6:u,conv_7:c,box_predictor_0:E,box_predictor_1:_,box_predictor_2:C,box_predictor_3:S,box_predictor_4:A,box_predictor_5:k}}return{extractMobilenetV1Params:s,extractPredictionLayerParams:u}}function We(t){var e=[],n=Bt(t),r=n.extractWeights,o=n.getRemainingWeights,a=je(r,e),s=a.extractMobilenetV1Params,u=a.extractPredictionLayerParams,c=s(),l=u(),h=i["J"](r(20472),[1,5118,4]),f={extra_dim:h};if(e.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:c,prediction_layer:l,output_layer:f},paramMappings:e}}function Ge(t,e){var n=Lt(t,e);function r(t,e,r){var i=n(t+"/Conv2d_"+e+"_pointwise/weights",4,r+"/filters"),o=n(t+"/Conv2d_"+e+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset");return{filters:i,batch_norm_offset:o}}function i(t){var e="mobilenetv1/conv_"+t,i="MobilenetV1/Conv2d_"+t+"_depthwise",o=e+"/depthwise_conv",a=e+"/pointwise_conv",s=n(i+"/depthwise_weights",4,o+"/filters"),u=n(i+"/BatchNorm/gamma",1,o+"/batch_norm_scale"),c=n(i+"/BatchNorm/beta",1,o+"/batch_norm_offset"),l=n(i+"/BatchNorm/moving_mean",1,o+"/batch_norm_mean"),h=n(i+"/BatchNorm/moving_variance",1,o+"/batch_norm_variance");return{depthwise_conv:{filters:s,batch_norm_scale:u,batch_norm_offset:c,batch_norm_mean:l,batch_norm_variance:h},pointwise_conv:r("MobilenetV1",t,a)}}function o(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:i(1),conv_2:i(2),conv_3:i(3),conv_4:i(4),conv_5:i(5),conv_6:i(6),conv_7:i(7),conv_8:i(8),conv_9:i(9),conv_10:i(10),conv_11:i(11),conv_12:i(12),conv_13:i(13)}}function a(t,e){var r=n(t+"/weights",4,e+"/filters"),i=n(t+"/biases",1,e+"/bias");return{filters:r,bias:i}}function s(t){var e=a("Prediction/BoxPredictor_"+t+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+t+"/box_encoding_predictor"),n=a("Prediction/BoxPredictor_"+t+"/ClassPredictor","prediction_layer/box_predictor_"+t+"/class_predictor");return{box_encoding_predictor:e,class_predictor:n}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:o,extractPredictionLayerParams:u}}function He(t){var e=[],n=Ge(t,e),r=n.extractMobilenetV1Params,i=n.extractPredictionLayerParams,o=t["Output/extra_dim"];if(e.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!l(o))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+o);var a={mobilenetv1:r(),prediction_layer:i(),output_layer:{extra_dim:o}};return Dt(t,e),{params:a,paramMappings:e}}function Ue(t,e,n){return i["L"]((function(){var r=i["i"](t,e.filters,n,"same");return r=i["c"](r,e.batch_norm_offset),i["g"](r,0,6)}))}var qe=.0010000000474974513;function $e(t,e,n){return i["L"]((function(){var r=i["j"](t,e.filters,n,"same");return r=i["e"](r,e.batch_norm_mean,e.batch_norm_variance,e.batch_norm_offset,e.batch_norm_scale,qe),i["g"](r,0,6)}))}function Ke(t){return[2,4,6,12].some((function(e){return e===t}))?[2,2]:[1,1]}function Xe(t,e){return i["L"]((function(){var n=null,r=Ue(t,e.conv_0,[2,2]),i=[e.conv_1,e.conv_2,e.conv_3,e.conv_4,e.conv_5,e.conv_6,e.conv_7,e.conv_8,e.conv_9,e.conv_10,e.conv_11,e.conv_12,e.conv_13];if(i.forEach((function(t,e){var i=e+1,o=Ke(i);r=$e(r,t.depthwise_conv,o),r=Ue(r,t.pointwise_conv,[1,1]),11===i&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function Ye(t,e,n,r,i){var o=t.shape[0],a=Math.min(n,o),s=e.map((function(t,e){return{score:t,boxIndex:e}})).filter((function(t){return t.score>i})).sort((function(t,e){return e.score-t.score})),u=function(t){return t<=r?1:0},c=[];return s.forEach((function(e){if(!(c.length>=a)){for(var n=e.score,r=c.length-1;r>=0;--r){var o=Je(t,e.boxIndex,c[r]);if(0!==o&&(e.score*=u(o),e.score<=i))break}n===e.score&&c.push(e.boxIndex)}})),c}function Je(t,e,n){var r=t.arraySync(),i=Math.min(r[e][0],r[e][2]),o=Math.min(r[e][1],r[e][3]),a=Math.max(r[e][0],r[e][2]),s=Math.max(r[e][1],r[e][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),h=Math.max(r[n][1],r[n][3]),f=(a-i)*(s-o),p=(l-u)*(h-c);if(f<=0||p<=0)return 0;var d=Math.max(i,u),m=Math.max(o,c),v=Math.min(a,l),g=Math.min(s,h),y=Math.max(v-d,0)*Math.max(g-m,0);return y/(f+p-y)}function Qe(t){var e=i["O"](i["N"](t,[1,0])),n=[i["F"](e[2],e[0]),i["F"](e[3],e[1])],r=[i["c"](e[0],i["k"](n[0],i["y"](2))),i["c"](e[1],i["k"](n[1],i["y"](2)))];return{sizes:n,centers:r}}function Ze(t,e){var n=Qe(t),r=n.sizes,o=n.centers,a=i["O"](i["N"](e,[1,0])),s=i["k"](i["t"](i["l"](i["k"](a[2],i["y"](5))),r[0]),i["y"](2)),u=i["c"](i["t"](i["k"](a[0],i["y"](10)),r[0]),o[0]),c=i["k"](i["t"](i["l"](i["k"](a[3],i["y"](5))),r[1]),i["y"](2)),l=i["c"](i["t"](i["k"](a[1],i["y"](10)),r[1]),o[1]);return i["N"](i["E"]([i["F"](u,s),i["F"](l,c),i["c"](u,s),i["c"](l,c)]),[1,0])}function tn(t,e,n){return i["L"]((function(){var r=t.shape[0],o=Ze(i["x"](i["M"](n.extra_dim,[r,1,1]),[-1,4]),i["x"](t,[-1,4]));o=i["x"](o,[r,o.shape[0]/r,4]);var a=i["A"](i["B"](e,[0,0,1],[-1,-1,-1])),s=i["B"](a,[0,0,0],[-1,-1,1]);s=i["x"](s,[r,s.shape[1]]);var u=i["O"](o),c=i["O"](s);return{boxes:u,scores:c}}))}function en(t,e){return i["L"]((function(){var n=t.shape[0],r=i["x"](Pt(t,e.box_encoding_predictor),[n,-1,1,4]),o=i["x"](Pt(t,e.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}}))}function nn(t,e,n){return i["L"]((function(){var r=Ue(t,n.conv_0,[1,1]),o=Ue(r,n.conv_1,[2,2]),a=Ue(o,n.conv_2,[1,1]),s=Ue(a,n.conv_3,[2,2]),u=Ue(s,n.conv_4,[1,1]),c=Ue(u,n.conv_5,[2,2]),l=Ue(c,n.conv_6,[1,1]),h=Ue(l,n.conv_7,[2,2]),f=en(e,n.box_predictor_0),p=en(t,n.box_predictor_1),d=en(o,n.box_predictor_2),m=en(s,n.box_predictor_3),v=en(c,n.box_predictor_4),g=en(h,n.box_predictor_5),y=i["h"]([f.boxPredictionEncoding,p.boxPredictionEncoding,d.boxPredictionEncoding,m.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding],1),b=i["h"]([f.classPrediction,p.classPrediction,d.classPrediction,m.classPrediction,v.classPrediction,g.classPrediction],1);return{boxPredictions:y,classPredictions:b}}))}var rn=function(){function t(t){var e=void 0===t?{}:t,n=e.minConfidence,r=e.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(t.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),t}(),on=function(t){function e(){return t.call(this,"SsdMobilenetv1")||this}return Object(a["c"])(e,t),e.prototype.forwardInput=function(t){var e=this.params;if(!e)throw new Error("SsdMobilenetv1 - load model before inference");return i["L"]((function(){var n=t.toBatchTensor(512,!1).toFloat(),r=i["F"](i["t"](n,i["y"](.007843137718737125)),i["y"](1)),o=Xe(r,e.mobilenetv1),a=nn(o.out,o.conv11,e.prediction_layer),s=a.boxPredictions,u=a.classPredictions;return tn(s,u,e.output_layer)}))},e.prototype.forward=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=this.forwardInput,[4,yt(t)];case 1:return[2,e.apply(this,[n.sent()])]}}))}))},e.prototype.locateFaces=function(t,e){return void 0===e&&(e={}),Object(a["b"])(this,void 0,void 0,(function(){var n,r,i,o,s,u,c,l,h,f,p,d,m,v,g,y,b,x,w,E,_;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=new rn(e),r=n.maxResults,i=n.minConfidence,[4,yt(t)];case 1:for(o=a.sent(),s=this.forwardInput(o),u=s.boxes,c=s.scores,l=u[0],h=c[0],f=1;f<u.length;f++)u[f].dispose(),c[f].dispose();return m=(d=Array).from,[4,h.data()];case 2:return p=m.apply(d,[a.sent()]),v=.5,g=Ye(l,p,r,v,i),y=o.getReshapedInputDimensions(0),b=o.inputSize,x=b/y.width,w=b/y.height,E=l.arraySync(),_=g.map((function(t){var e=[Math.max(0,E[t][0]),Math.min(1,E[t][2])].map((function(t){return t*w})),n=e[0],r=e[1],i=[Math.max(0,E[t][1]),Math.min(1,E[t][3])].map((function(t){return t*x})),a=i[0],s=i[1];return new S(p[t],new R(a,n,s-a,r-n),{height:o.getInputHeight(0),width:o.getInputWidth(0)})})),l.dispose(),h.dispose(),[2,_]}}))}))},e.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},e.prototype.extractParamsFromWeigthMap=function(t){return He(t)},e.prototype.extractParams=function(t){return We(t)},e}(At);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(a["c"])(e,t)})(on);var an,sn=.4,un=[new w(.738768,.874946),new w(2.42204,2.65704),new w(4.30971,7.04493),new w(10.246,4.59428),new w(12.6868,11.8741)],cn=[new w(1.603231,2.094468),new w(6.041143,7.080126),new w(2.882459,3.518061),new w(4.266906,5.178857),new w(9.041765,10.66308)],ln=[117.001,114.697,97.404],hn="tiny_yolov2_model",fn="tiny_yolov2_separable_conv_model",pn=function(t){return"number"===typeof t};function dn(t){if(!t)throw new Error("invalid config: "+t);if("boolean"!==typeof t.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+t.withSeparableConvs);if(!pn(t.iouThreshold)||t.iouThreshold<0||t.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+t.iouThreshold);if(!Array.isArray(t.classes)||!t.classes.length||!t.classes.every((function(t){return"string"===typeof t})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(t.classes));if(!Array.isArray(t.anchors)||!t.anchors.length||!t.anchors.map((function(t){return t||{}})).every((function(t){return pn(t.x)&&pn(t.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(t.anchors));if(t.meanRgb&&(!Array.isArray(t.meanRgb)||3!==t.meanRgb.length||!t.meanRgb.every(pn)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(t.meanRgb))}function mn(t){return i["L"]((function(){var e=i["t"](t,i["y"](.10000000149011612));return i["c"](i["w"](i["F"](t,e)),e)}))}function vn(t,e){return i["L"]((function(){var n=i["v"](t,[[0,0],[1,1],[1,1],[0,0]]);return n=i["i"](n,e.conv.filters,[1,1],"valid"),n=i["F"](n,e.bn.sub),n=i["t"](n,e.bn.truediv),n=i["c"](n,e.conv.bias),mn(n)}))}function gn(t,e){return i["L"]((function(){var n=i["v"](t,[[0,0],[1,1],[1,1],[0,0]]);return n=i["z"](n,e.depthwise_filter,e.pointwise_filter,[1,1],"valid"),n=i["c"](n,e.bias),mn(n)}))}function yn(t,e){var n=Rt(t,e);function r(n,r){var o=i["H"](t(n)),a=i["H"](t(n));return e.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:o,truediv:a}}function o(t,e,i){var o=n(t,e,3,i+"/conv"),a=r(e,i+"/bn");return{conv:o,bn:a}}var a=Ot(t,e);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:a}}function bn(t,e,n,r){var i,o=Bt(t),a=o.extractWeights,s=o.getRemainingWeights,u=[],c=yn(a,u),l=c.extractConvParams,h=c.extractConvWithBatchNormParams,f=c.extractSeparableConvParams;if(e.withSeparableConvs){var p=r[0],d=r[1],m=r[2],v=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8],E=e.isFirstLayerConv2d?l(p,d,3,"conv0"):f(p,d,"conv0"),_=f(d,m,"conv1"),C=f(m,v,"conv2"),S=f(v,g,"conv3"),A=f(g,y,"conv4"),k=f(y,b,"conv5"),T=x?f(b,x,"conv6"):void 0,I=w?f(x,w,"conv7"):void 0,P=l(w||x||b,5*n,1,"conv8");i={conv0:E,conv1:_,conv2:C,conv3:S,conv4:A,conv5:k,conv6:T,conv7:I,conv8:P}}else{p=r[0],d=r[1],m=r[2],v=r[3],g=r[4],y=r[5],b=r[6],x=r[7],w=r[8],E=h(p,d,"conv0"),_=h(d,m,"conv1"),C=h(m,v,"conv2"),S=h(v,g,"conv3"),A=h(g,y,"conv4"),k=h(y,b,"conv5"),T=h(b,x,"conv6"),I=h(x,w,"conv7"),P=l(w,5*n,1,"conv8");i={conv0:E,conv1:_,conv2:C,conv3:S,conv4:A,conv5:k,conv6:T,conv7:I,conv8:P}}if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:i,paramMappings:u}}function xn(t,e){var n=Lt(t,e);function r(t){var e=n(t+"/sub",1),r=n(t+"/truediv",1);return{sub:e,truediv:r}}function i(t){var e=n(t+"/filters",4),r=n(t+"/bias",1);return{filters:e,bias:r}}function o(t){var e=i(t+"/conv"),n=r(t+"/bn");return{conv:e,bn:n}}var a=Nt(n);return{extractConvParams:i,extractConvWithBatchNormParams:o,extractSeparableConvParams:a}}function wn(t,e){var n,r=[],i=xn(t,r),o=i.extractConvParams,a=i.extractConvWithBatchNormParams,s=i.extractSeparableConvParams;if(e.withSeparableConvs){var u=e.filterSizes&&e.filterSizes.length||9;n={conv0:e.isFirstLayerConv2d?o("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:o("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:o("conv8")};return Dt(t,r),{params:n,paramMappings:r}}(function(t){t[t["XS"]=224]="XS",t[t["SM"]=320]="SM",t[t["MD"]=416]="MD",t[t["LG"]=608]="LG"})(an||(an={}));var En=function(){function t(t){var e=void 0===t?{}:t,n=e.inputSize,r=e.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(t.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),t}(),_n=function(t){function e(e){var n=t.call(this,"TinyYolov2")||this;return dn(e),n._config=e,n}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),e.prototype.runTinyYolov2=function(t,e){var n=vn(t,e.conv0);return n=i["s"](n,[2,2],[2,2],"same"),n=vn(n,e.conv1),n=i["s"](n,[2,2],[2,2],"same"),n=vn(n,e.conv2),n=i["s"](n,[2,2],[2,2],"same"),n=vn(n,e.conv3),n=i["s"](n,[2,2],[2,2],"same"),n=vn(n,e.conv4),n=i["s"](n,[2,2],[2,2],"same"),n=vn(n,e.conv5),n=i["s"](n,[2,2],[1,1],"same"),n=vn(n,e.conv6),n=vn(n,e.conv7),Pt(n,e.conv8,"valid",!1)},e.prototype.runMobilenet=function(t,e){var n=this.config.isFirstLayerConv2d?mn(Pt(t,e.conv0,"valid",!1)):gn(t,e.conv0);return n=i["s"](n,[2,2],[2,2],"same"),n=gn(n,e.conv1),n=i["s"](n,[2,2],[2,2],"same"),n=gn(n,e.conv2),n=i["s"](n,[2,2],[2,2],"same"),n=gn(n,e.conv3),n=i["s"](n,[2,2],[2,2],"same"),n=gn(n,e.conv4),n=i["s"](n,[2,2],[2,2],"same"),n=gn(n,e.conv5),n=i["s"](n,[2,2],[1,1],"same"),n=e.conv6?gn(n,e.conv6):n,n=e.conv7?gn(n,e.conv7):n,Pt(n,e.conv8,"valid",!1)},e.prototype.forwardInput=function(t,e){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return i["L"]((function(){var o=t.toBatchTensor(e,!1).toFloat();return o=n.config.meanRgb?I(o,n.config.meanRgb):o,o=o.div(i["y"](256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)}))},e.prototype.forward=function(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yt(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent()]}}))}))},e.prototype.detect=function(t,e){return void 0===e&&(e={}),Object(a["b"])(this,void 0,void 0,(function(){var n,r,o,s,u,c,l,h,f,p,d,m,v,g,y=this;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=new En(e),r=n.inputSize,o=n.scoreThreshold,[4,yt(t)];case 1:return s=a.sent(),[4,this.forwardInput(s,r)];case 2:return u=a.sent(),c=i["L"]((function(){return i["O"](u)[0].expandDims()})),l={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(c,s.getReshapedInputDimensions(0),o)];case 3:return h=a.sent(),u.dispose(),c.dispose(),f=h.map((function(t){return t.box})),p=h.map((function(t){return t.score})),d=h.map((function(t){return t.classScore})),m=h.map((function(t){return y.config.classes[t.label]})),v=T(f.map((function(t){return t.rescale(r)})),p,this.config.iouThreshold,!0),g=v.map((function(t){return new C(p[t],d[t],m[t],f[t],l)})),[2,g]}}))}))},e.prototype.getDefaultModelName=function(){return""},e.prototype.extractParamsFromWeigthMap=function(t){return wn(t,this.config)},e.prototype.extractParams=function(t){var n=this.config.filterSizes||e.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return bn(t,this.config,this.boxEncodingSize,n)},e.prototype.extractBoxes=function(t,e,n){return Object(a["b"])(this,void 0,void 0,(function(){var r,o,s,u,c,l,h,f,p,d,m,v,g,y,b,x,w,E,C,S,A,k,T,I,P,R,M,F,O,N=this;return Object(a["d"])(this,(function(L){switch(L.label){case 0:return r=e.width,o=e.height,s=Math.max(r,o),u=s/r,c=s/o,l=t.shape[1],h=this.config.anchors.length,f=i["L"]((function(){var e=t.reshape([l,l,h,N.boxEncodingSize]),n=e.slice([0,0,0,0],[l,l,h,4]),r=e.slice([0,0,0,4],[l,l,h,1]),o=N.withClassScores?i["D"](e.slice([0,0,0,5],[l,l,h,N.config.classes.length]),3):i["y"](0);return[n,r,o]})),p=f[0],d=f[1],m=f[2],v=[],[4,d.array()];case 1:return g=L.sent(),[4,p.array()];case 2:y=L.sent(),b=0,L.label=3;case 3:if(!(b<l))return[3,12];x=0,L.label=4;case 4:if(!(x<l))return[3,11];w=0,L.label=5;case 5:return w<h?(E=D(g[b][x][w][0]),!n||E>n?(C=(x+D(y[b][x][w][0]))/l*u,S=(b+D(y[b][x][w][1]))/l*c,A=Math.exp(y[b][x][w][2])*this.config.anchors[w].x/l*u,k=Math.exp(y[b][x][w][3])*this.config.anchors[w].y/l*c,T=C-A/2,I=S-k/2,P={row:b,col:x,anchor:w},this.withClassScores?[4,this.extractPredictedClass(m,P)]:[3,7]):[3,9]):[3,10];case 6:return O=L.sent(),[3,8];case 7:O={classScore:1,label:0},L.label=8;case 8:R=O,M=R.classScore,F=R.label,v.push(Object(a["a"])({box:new _(T,I,T+A,I+k),score:E,classScore:E*M,label:F},P)),L.label=9;case 9:return w++,[3,5];case 10:return x++,[3,4];case 11:return b++,[3,3];case 12:return p.dispose(),d.dispose(),m.dispose(),[2,v]}}))}))},e.prototype.extractPredictedClass=function(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n,r,i,o;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return n=e.row,r=e.col,i=e.anchor,[4,t.array()];case 1:return o=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(t,e){return o[n][r][i][e]})).map((function(t,e){return{classScore:t,label:e}})).reduce((function(t,e){return t.classScore>e.classScore?t:e}))]}}))}))},e.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],e}(At),Cn=function(t){function e(e){void 0===e&&(e=!0);var n=this,r=Object.assign({},{withSeparableConvs:e,iouThreshold:sn,classes:["face"]},e?{anchors:cn,meanRgb:ln}:{anchors:un,withClassScores:!0});return n=t.call(this,r)||this,n}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return[4,this.detect(t,e)];case 1:return n=r.sent(),[2,n.map((function(t){return new S(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return this.withSeparableConvs?fn:hn},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(_n);var Sn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._name="TinyFaceDetectorOptions",e}return Object(a["c"])(e,t),e}(En),An=function(){function t(){}return t.prototype.then=function(t){return Object(a["b"])(this,void 0,void 0,(function(){var e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return e=t,[4,this.run()];case 1:return[2,e.apply(void 0,[n.sent()])]}}))}))},t.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(t){throw new Error("ComposableTask - run is not implemented")}))}))},t}();function kn(t,e,n,r,o){return void 0===o&&(o=function(t){var e=t.alignedRect;return e}),Object(a["b"])(this,void 0,void 0,(function(){var s,u,c,l,h;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return s=t.map((function(t){return ne(t)?o(t):t.detection})),c=r,c?[3,5]:e instanceof i["a"]?[4,xt(e,s)]:[3,2];case 1:return l=a.sent(),[3,4];case 2:return[4,bt(e,s)];case 3:l=a.sent(),a.label=4;case 4:c=l,a.label=5;case 5:return u=c,[4,n(u)];case 6:return h=a.sent(),u.forEach((function(t){return t instanceof i["a"]&&t.dispose()})),[2,h]}}))}))}function Tn(t,e,n,r,i){return Object(a["b"])(this,void 0,void 0,(function(){var o=this;return Object(a["d"])(this,(function(s){return[2,kn([t],e,(function(t){return Object(a["b"])(o,void 0,void 0,(function(){return Object(a["d"])(this,(function(e){return[2,n(t[0])]}))}))}),r,i)]}))}))}function In(t){return i["L"]((function(){return i["E"](i["O"](t,3).reverse(),3)}))}var Pn=2,Dn=12;function Rn(t,e){var n=Rt(t,e),r=Mt(t,e);function o(n,r){var o=i["H"](t(n));return e.push({paramPath:r}),o}function s(t,e,r){void 0===r&&(r=!1);var i=n(t[0],t[1],3,e+"/conv1"),a=o(t[1],e+"/prelu1_alpha"),s=n(t[1],t[2],3,e+"/conv2"),u=o(t[2],e+"/prelu2_alpha"),c=n(t[2],t[3],r?2:3,e+"/conv3"),l=o(t[3],e+"/prelu3_alpha");return{conv1:i,prelu1_alpha:a,conv2:s,prelu2_alpha:u,conv3:c,prelu3_alpha:l}}function u(){var t=s([3,10,16,32],"pnet"),e=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return Object(a["a"])(Object(a["a"])({},t),{conv4_1:e,conv4_2:r})}function c(){var t=s([3,28,48,64],"rnet",!0),e=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),i=r(128,2,"rnet/fc2_1"),u=r(128,4,"rnet/fc2_2");return Object(a["a"])(Object(a["a"])({},t),{fc1:e,prelu4_alpha:n,fc2_1:i,fc2_2:u})}function l(){var t=s([3,32,64,64],"onet"),e=n(64,128,2,"onet/conv4"),i=o(128,"onet/prelu4_alpha"),u=r(1152,256,"onet/fc1"),c=o(256,"onet/prelu5_alpha"),l=r(256,2,"onet/fc2_1"),h=r(256,4,"onet/fc2_2"),f=r(256,10,"onet/fc2_3");return Object(a["a"])(Object(a["a"])({},t),{conv4:e,prelu4_alpha:i,fc1:u,prelu5_alpha:c,fc2_1:l,fc2_2:h,fc2_3:f})}return{extractPNetParams:u,extractRNetParams:c,extractONetParams:l}}function Mn(t){var e=Bt(t),n=e.extractWeights,r=e.getRemainingWeights,i=[],o=Rn(n,i),a=o.extractPNetParams,s=o.extractRNetParams,u=o.extractONetParams,c=a(),l=s(),h=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:h},paramMappings:i}}function Fn(t,e){var n=Lt(t,e);function r(t){var e=n(t+"/weights",4,t+"/filters"),r=n(t+"/bias",1);return{filters:e,bias:r}}function i(t){var e=n(t+"/weights",2),r=n(t+"/bias",1);return{weights:e,bias:r}}function o(t){return n(t,1)}function s(t){var e=r(t+"/conv1"),n=o(t+"/prelu1_alpha"),i=r(t+"/conv2"),a=o(t+"/prelu2_alpha"),s=r(t+"/conv3"),u=o(t+"/prelu3_alpha");return{conv1:e,prelu1_alpha:n,conv2:i,prelu2_alpha:a,conv3:s,prelu3_alpha:u}}function u(){var t=s("pnet"),e=r("pnet/conv4_1"),n=r("pnet/conv4_2");return Object(a["a"])(Object(a["a"])({},t),{conv4_1:e,conv4_2:n})}function c(){var t=s("rnet"),e=i("rnet/fc1"),n=o("rnet/prelu4_alpha"),r=i("rnet/fc2_1"),u=i("rnet/fc2_2");return Object(a["a"])(Object(a["a"])({},t),{fc1:e,prelu4_alpha:n,fc2_1:r,fc2_2:u})}function l(){var t=s("onet"),e=r("onet/conv4"),n=o("onet/prelu4_alpha"),u=i("onet/fc1"),c=o("onet/prelu5_alpha"),l=i("onet/fc2_1"),h=i("onet/fc2_2"),f=i("onet/fc2_3");return Object(a["a"])(Object(a["a"])({},t),{conv4:e,prelu4_alpha:n,fc1:u,prelu5_alpha:c,fc2_1:l,fc2_2:h,fc2_3:f})}return{extractPNetParams:u,extractRNetParams:c,extractONetParams:l}}function On(t){var e=[],n=Fn(t,e),r=n.extractPNetParams,i=n.extractRNetParams,o=n.extractONetParams,a=r(),s=i(),u=o();return Dt(t,e),{params:{pnet:a,rnet:s,onet:u},paramMappings:e}}function Nn(t,e){var n=e[0],r=e[1];return{height:Math.floor(n*t),width:Math.floor(r*t)}}function Ln(t,e,n){var r=n[0],i=n[1],o=Dn/t,a=[],s=Math.min(r,i)*o,u=0;while(s>=12)a.push(o*Math.pow(e,u)),s*=e,u+=1;return a}var Bn=function(t){function e(e,n,r,i){return t.call(this,{left:e,top:n,right:r,bottom:i},!0)||this}return Object(a["c"])(e,t),e}(E);function Vn(t){return i["L"]((function(){return i["t"](i["F"](t,i["y"](127.5)),i["y"](.0078125))}))}function zn(t,e){return i["L"]((function(){return i["c"](i["w"](t),i["t"](e,i["u"](i["w"](i["u"](t)))))}))}function jn(t,e,n){return void 0===n&&(n=!1),i["L"]((function(){var r=Pt(t,e.conv1,"valid");return r=zn(r,e.prelu1_alpha),r=i["s"](r,n?[2,2]:[3,3],[2,2],"same"),r=Pt(r,e.conv2,"valid"),r=zn(r,e.prelu2_alpha),r=n?r:i["s"](r,[3,3],[2,2],"valid"),r=Pt(r,e.conv3,"valid"),r=zn(r,e.prelu3_alpha),r}))}function Wn(t,e){return i["L"]((function(){var n=jn(t,e,!0),r=Pt(n,e.conv4_1,"valid"),o=i["m"](i["r"](r,3),3),a=i["D"](i["F"](r,o),3),s=Pt(n,e.conv4_2,"valid");return{prob:a,regions:s}}))}function Gn(t,e){return i["L"]((function(){var n=Nn(e,t.shape.slice(1)),r=n.height,o=n.width,a=i["o"].resizeBilinear(t,[r,o]),s=Vn(a);return i["N"](s,[0,2,1,3])}))}function Hn(t,e,n,r){for(var i=[],o=t.arraySync(),a=0;a<t.shape[0];a++)for(var s=0;s<t.shape[1];s++)o[a][s]>=r&&i.push(new w(s,a));var u=i.map((function(t){var r=new _(Math.round((t.y*Pn+1)/n),Math.round((t.x*Pn+1)/n),Math.round((t.y*Pn+Dn)/n),Math.round((t.x*Pn+Dn)/n)),i=o[t.y][t.x],a=e.arraySync(),s=new Bn(a[t.y][t.x][0],a[t.y][t.x][1],a[t.y][t.x][2],a[t.y][t.x][3]);return{cell:r,score:i,region:s}}));return u}function Un(t,e,n,r,o){o.stage1=[];var a=e.map((function(e){return i["L"]((function(){var n={scale:e},o=Gn(t,e),a=Date.now(),s=Wn(o,r),u=s.prob,c=s.regions;n.pnet=Date.now()-a;var l=i["O"](i["O"](u,3)[1])[0],h=i["O"](c)[0];return{scoresTensor:l,regionsTensor:h,scale:e,statsForScale:n}}))})),s=a.map((function(t){var e=t.scoresTensor,r=t.regionsTensor,i=t.scale,a=t.statsForScale,s=Hn(e,r,i,n);if(e.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var u=Date.now(),c=T(s.map((function(t){return t.cell})),s.map((function(t){return t.score})),.5);return a.nms=Date.now()-u,a.numBoxes=c.length,o.stage1.push(a),c.map((function(t){return s[t]}))})),u=s.reduce((function(t,e){return t.concat(e)}),[]),c=[],l=[];if(u.length>0){var h=Date.now(),f=T(u.map((function(t){return t.cell})),u.map((function(t){return t.score})),.7);o.stage1_nms=Date.now()-h,l=f.map((function(t){return u[t].score})),c=f.map((function(t){return u[t]})).map((function(t){var e=t.cell,n=t.region;return new _(e.left+n.left*e.width,e.top+n.top*e.height,e.right+n.right*e.width,e.bottom+n.bottom*e.height).toSquare().round()}))}return{boxes:c,scores:l}}function qn(t,e,n){var r=n.width,o=n.height;return Object(a["b"])(this,void 0,void 0,(function(){var n,s,u,c=this;return Object(a["d"])(this,(function(l){switch(l.label){case 0:return n=rt(t),[4,Promise.all(e.map((function(e){return Object(a["b"])(c,void 0,void 0,(function(){var r,i,o,s,u,c,l,h;return Object(a["d"])(this,(function(a){return r=e.padAtBorders(t.height,t.width),i=r.y,o=r.ey,s=r.x,u=r.ex,c=s-1,l=i-1,h=n.getImageData(c,l,u-c,o-l),[2,et.isNodejs()?pt(h):createImageBitmap(h)]}))}))})))];case 1:return s=l.sent(),u=[],s.forEach((function(t){var e=ft({width:r,height:o}),n=rt(e);n.drawImage(t,0,0,r,o);for(var i=n.getImageData(0,0,r,o).data,a=[],s=0;s<i.length;s+=4)a.push(i[s+2]),a.push(i[s+1]),a.push(i[s]);u.push(a)})),[2,u.map((function(t){var e=i["L"]((function(){var e=i["N"](i["K"](t,[1,r,o,3]),[0,2,1,3]).toFloat();return Vn(e)}));return e}))]}}))}))}function $n(t,e){return i["L"]((function(){var n=jn(t,e),r=i["x"](n,[n.shape[0],e.fc1.weights.shape[0]]),o=Ut(r,e.fc1),a=zn(o,e.prelu4_alpha),s=Ut(a,e.fc2_1),u=i["m"](i["r"](s,1),1),c=i["D"](i["F"](s,u),1),l=Ut(a,e.fc2_2),h=i["O"](c,1)[1];return{scores:h,regions:l}}))}function Kn(t,e,n,r,o){return Object(a["b"])(this,void 0,void 0,(function(){var s,u,c,l,h,f,p,d,m,v,g,y,b,x;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return s=Date.now(),[4,qn(t,e,{width:24,height:24})];case 1:return u=a.sent(),o.stage2_extractImagePatches=Date.now()-s,s=Date.now(),c=u.map((function(t){var e=$n(t,r);return t.dispose(),e})),o.stage2_rnet=Date.now()-s,l=c.length>1?i["h"](c.map((function(t){return t.scores}))):c[0].scores,p=(f=Array).from,[4,l.data()];case 2:return h=p.apply(f,[a.sent()]),l.dispose(),d=h.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){var e=t.idx;return e})),m=d.map((function(t){return e[t]})),v=d.map((function(t){return h[t]})),g=[],y=[],m.length>0&&(s=Date.now(),b=T(m,v,.7),o.stage2_nms=Date.now()-s,x=b.map((function(t){var e=c[d[t]].regions.arraySync();return new Bn(e[0][0],e[0][1],e[0][2],e[0][3])})),y=b.map((function(t){return v[t]})),g=b.map((function(t,e){return m[t].calibrate(x[e])}))),c.forEach((function(t){t.regions.dispose(),t.scores.dispose()})),[2,{boxes:g,scores:y}]}}))}))}function Xn(t,e){return i["L"]((function(){var n=jn(t,e);n=i["s"](n,[2,2],[2,2],"same"),n=Pt(n,e.conv4,"valid"),n=zn(n,e.prelu4_alpha);var r=i["x"](n,[n.shape[0],e.fc1.weights.shape[0]]),o=Ut(r,e.fc1),a=zn(o,e.prelu5_alpha),s=Ut(a,e.fc2_1),u=i["m"](i["r"](s,1),1),c=i["D"](i["F"](s,u),1),l=Ut(a,e.fc2_2),h=Ut(a,e.fc2_3),f=i["O"](c,1)[1];return{scores:f,regions:l,points:h}}))}function Yn(t,e,n,r,o){return Object(a["b"])(this,void 0,void 0,(function(){var s,u,c,l,h,f,p,d,m,v,g,y,b,x,E;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return s=Date.now(),[4,qn(t,e,{width:48,height:48})];case 1:return u=a.sent(),o.stage3_extractImagePatches=Date.now()-s,s=Date.now(),c=u.map((function(t){var e=Xn(t,r);return t.dispose(),e})),o.stage3_onet=Date.now()-s,l=c.length>1?i["h"](c.map((function(t){return t.scores}))):c[0].scores,p=(f=Array).from,[4,l.data()];case 2:return h=p.apply(f,[a.sent()]),l.dispose(),d=h.map((function(t,e){return{score:t,idx:e}})).filter((function(t){return t.score>n})).map((function(t){var e=t.idx;return e})),m=d.map((function(t){var e=c[t].regions.arraySync();return new Bn(e[0][0],e[0][1],e[0][2],e[0][3])})),v=d.map((function(t,n){return e[t].calibrate(m[n])})),g=d.map((function(t){return h[t]})),y=[],b=[],x=[],v.length>0&&(s=Date.now(),E=T(v,g,.7,!1),o.stage3_nms=Date.now()-s,y=E.map((function(t){return v[t]})),b=E.map((function(t){return g[t]})),x=E.map((function(t,e){return Array(5).fill(0).map((function(n,r){var i=c[t].points.arraySync();return new w(i[0][r]*(y[e].width+1)+y[e].left,i[0][r+5]*(y[e].height+1)+y[e].top)}))}))),c.forEach((function(t){t.regions.dispose(),t.scores.dispose(),t.points.dispose()})),[2,{boxes:y,scores:b,points:x}]}}))}))}var Jn=function(t){function e(){return t.call(this,"Mtcnn")||this}return Object(a["c"])(e,t),e.prototype.load=function(e){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.load.call(this,e)]}))}))},e.prototype.loadFromDisk=function(e){return Object(a["b"])(this,void 0,void 0,(function(){return Object(a["d"])(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,t.prototype.loadFromDisk.call(this,e)]}))}))},e.prototype.forwardInput=function(t,e){return void 0===e&&(e={}),Object(a["b"])(this,void 0,void 0,(function(){var n,r,o,s,u,c,l,h,f,p,d,m,v,g,y,b,x,E,_,C,A;return Object(a["d"])(this,(function(a){switch(a.label){case 0:if(n=this.params,!n)throw new Error("Mtcnn - load model before inference");if(r=t.canvases[0],!r)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},s=Date.now(),u=i["L"]((function(){return In(i["m"](i["f"].fromPixels(r)).toFloat())})),c=function(t){return u.dispose(),o.total=Date.now()-s,t},l=u.shape.slice(1),h=l[0],f=l[1],p=new ze(e),d=p.minFaceSize,m=p.scaleFactor,v=p.maxNumScales,g=p.scoreThresholds,y=p.scaleSteps,b=(y||Ln(d,m,[h,f])).filter((function(t){var e=Nn(t,[h,f]);return Math.min(e.width,e.height)>Dn})).slice(0,v),o.scales=b,o.pyramid=b.map((function(t){return Nn(t,[h,f])})),x=Date.now(),[4,Un(u,b,g[0],n.pnet,o)];case 1:return E=a.sent(),o.total_stage1=Date.now()-x,E.boxes.length?(o.stage2_numInputBoxes=E.boxes.length,x=Date.now(),[4,Kn(r,E.boxes,g[1],n.rnet,o)]):[2,c({results:[],stats:o})];case 2:return _=a.sent(),o.total_stage2=Date.now()-x,_.boxes.length?(o.stage3_numInputBoxes=_.boxes.length,x=Date.now(),[4,Yn(r,_.boxes,g[2],n.onet,o)]):[2,c({results:[],stats:o})];case 3:return C=a.sent(),o.total_stage3=Date.now()-x,A=C.boxes.map((function(t,e){return re(G({},new S(C.scores[e],new R(t.left/f,t.top/h,t.width/f,t.height/h),{height:h,width:f})),new L(C.points[e].map((function(e){return e.sub(new w(t.left,t.top)).div(new w(t.width,t.height))})),{width:t.width,height:t.height}))})),[2,c({results:A,stats:o})]}}))}))},e.prototype.forward=function(t,e){return void 0===e&&(e={}),Object(a["b"])(this,void 0,void 0,(function(){var n;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yt(t)];case 1:return[4,n.apply(this,[r.sent(),e])];case 2:return[2,r.sent().results]}}))}))},e.prototype.forwardWithStats=function(t,e){return void 0===e&&(e={}),Object(a["b"])(this,void 0,void 0,(function(){var n;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,yt(t)];case 1:return[2,n.apply(this,[r.sent(),e])]}}))}))},e.prototype.getDefaultModelName=function(){return"mtcnn_model"},e.prototype.extractParamsFromWeigthMap=function(t){return On(t)},e.prototype.extractParams=function(t){return Mn(t)},e}(At),Qn=.4,Zn=[new w(1.603231,2.094468),new w(6.041143,7.080126),new w(2.882459,3.518061),new w(4.266906,5.178857),new w(9.041765,10.66308)],tr=[117.001,114.697,97.404],er=function(t){function e(){var e=this,n={withSeparableConvs:!0,iouThreshold:Qn,classes:["face"],anchors:Zn,meanRgb:tr,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e=t.call(this,n)||this,e}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),e.prototype.locateFaces=function(t,e){return Object(a["b"])(this,void 0,void 0,(function(){var n;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return[4,this.detect(t,e)];case 1:return n=r.sent(),[2,n.map((function(t){return new S(t.score,t.relativeBox,{width:t.imageWidth,height:t.imageHeight})}))]}}))}))},e.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},e.prototype.extractParamsFromWeigthMap=function(e){return t.prototype.extractParamsFromWeigthMap.call(this,e)},e}(_n),nr={ssdMobilenetv1:new on,tinyFaceDetector:new er,tinyYolov2:new Cn,mtcnn:new Jn,faceLandmark68Net:new xe,faceLandmark68TinyNet:new Ce,faceRecognitionNet:new Ne,faceExpressionNet:new Qt,ageGenderNet:new ye},rr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return Object(a["c"])(e,t),e}(An),ir=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n=this;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return t=r.sent(),[4,kn(t,this.input,(function(t){return Object(a["b"])(n,void 0,void 0,(function(){return Object(a["d"])(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return nr.faceExpressionNet.predictExpressions(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){return te(t,e[n])}))]}}))}))},e.prototype.withAgeAndGender=function(){return new cr(this,this.input)},e}(rr),or=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return t=n.sent(),t?[4,Tn(t,this.input,(function(t){return nr.faceExpressionNet.predictExpressions(t)}),this.extractedFaces)]:[2];case 2:return e=n.sent(),[2,te(t,e)]}}))}))},e.prototype.withAgeAndGender=function(){return new lr(this,this.input)},e}(rr),ar=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.withAgeAndGender=function(){return new hr(this,this.input)},e.prototype.withFaceDescriptors=function(){return new dr(this,this.input)},e}(ir),sr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.withAgeAndGender=function(){return new fr(this,this.input)},e.prototype.withFaceDescriptor=function(){return new mr(this,this.input)},e}(or),ur=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.extractedFaces=r,i}return Object(a["c"])(e,t),e}(An),cr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n=this;return Object(a["d"])(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return t=r.sent(),[4,kn(t,this.input,(function(t){return Object(a["b"])(n,void 0,void 0,(function(){return Object(a["d"])(this,(function(e){switch(e.label){case 0:return[4,Promise.all(t.map((function(t){return nr.ageGenderNet.predictAgeAndGender(t)})))];case 1:return[2,e.sent()]}}))}))}),this.extractedFaces)];case 2:return e=r.sent(),[2,t.map((function(t,n){var r=e[n],i=r.age,o=r.gender,a=r.genderProbability;return Be(Ve(t,o,a),i)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new ir(this,this.input)},e}(ur),lr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n,r,i;return Object(a["d"])(this,(function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return t=o.sent(),t?[4,Tn(t,this.input,(function(t){return nr.ageGenderNet.predictAgeAndGender(t)}),this.extractedFaces)]:[2];case 2:return e=o.sent(),n=e.age,r=e.gender,i=e.genderProbability,[2,Be(Ve(t,r,i),n)]}}))}))},e.prototype.withFaceExpressions=function(){return new or(this,this.input)},e}(ur),hr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.withFaceExpressions=function(){return new ar(this,this.input)},e.prototype.withFaceDescriptors=function(){return new dr(this,this.input)},e}(cr),fr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.withFaceExpressions=function(){return new sr(this,this.input)},e.prototype.withFaceDescriptor=function(){return new mr(this,this.input)},e}(lr),pr=function(t){function e(e,n){var r=t.call(this)||this;return r.parentTask=e,r.input=n,r}return Object(a["c"])(e,t),e}(An),dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return t=n.sent(),[4,kn(t,this.input,(function(t){return Promise.all(t.map((function(t){return nr.faceRecognitionNet.computeFaceDescriptor(t)})))}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return e=n.sent(),[2,e.map((function(e,n){return Le(t[n],e)}))]}}))}))},e.prototype.withFaceExpressions=function(){return new ar(this,this.input)},e.prototype.withAgeAndGender=function(){return new hr(this,this.input)},e}(pr),mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return t=n.sent(),t?[4,Tn(t,this.input,(function(t){return nr.faceRecognitionNet.computeFaceDescriptor(t)}),null,(function(t){return t.landmarks.align(null,{useDlibAlignment:!0})}))]:[2];case 2:return e=n.sent(),[2,Le(t,e)]}}))}))},e.prototype.withFaceExpressions=function(){return new sr(this,this.input)},e.prototype.withAgeAndGender=function(){return new fr(this,this.input)},e}(pr),vr=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parentTask=e,i.input=n,i.useTinyLandmarkNet=r,i}return Object(a["c"])(e,t),Object.defineProperty(e.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?nr.faceLandmark68TinyNet:nr.faceLandmark68Net},enumerable:!0,configurable:!0}),e}(An),gr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n,r,o,s=this;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),e=t.map((function(t){return t.detection})),this.input instanceof i["a"]?[4,xt(this.input,e)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,bt(this.input,e)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(t){return s.landmarkNet.detectLandmarks(t)})))];case 6:return o=a.sent(),n.forEach((function(t){return t instanceof i["a"]&&t.dispose()})),[2,t.map((function(t,e){return re(t,o[e])}))]}}))}))},e.prototype.withFaceExpressions=function(){return new ar(this,this.input)},e.prototype.withAgeAndGender=function(){return new hr(this,this.input)},e.prototype.withFaceDescriptors=function(){return new dr(this,this.input)},e}(vr),yr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n,r,o;return Object(a["d"])(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return t=a.sent(),t?(e=t.detection,this.input instanceof i["a"]?[4,xt(this.input,[e])]:[3,3]):[2];case 2:return r=a.sent(),[3,5];case 3:return[4,bt(this.input,[e])];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=a.sent(),n.forEach((function(t){return t instanceof i["a"]&&t.dispose()})),[2,re(t,o)]}}))}))},e.prototype.withFaceExpressions=function(){return new sr(this,this.input)},e.prototype.withAgeAndGender=function(){return new fr(this,this.input)},e.prototype.withFaceDescriptor=function(){return new mr(this,this.input)},e}(vr),br=function(t){function e(e,n){void 0===n&&(n=new rn);var r=t.call(this)||this;return r.input=e,r.options=n,r}return Object(a["c"])(e,t),e}(An),xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e,n,r;return Object(a["d"])(this,(function(i){switch(i.label){case 0:return t=this,e=t.input,n=t.options,n instanceof ze?[4,nr.mtcnn.forward(e,n)]:[3,2];case 1:return[2,i.sent().map((function(t){return t.detection}))];case 2:if(r=n instanceof Sn?function(t){return nr.tinyFaceDetector.locateFaces(t,n)}:n instanceof rn?function(t){return nr.ssdMobilenetv1.locateFaces(t,n)}:n instanceof En?function(t){return nr.tinyYolov2.locateFaces(t,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(e)]}}))}))},e.prototype.runAndExtendWithFaceDetections=function(){var t=this;return new Promise((function(e){return Object(a["b"])(t,void 0,void 0,(function(){var t;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t.map((function(t){return G({},t)})))]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new gr(this.runAndExtendWithFaceDetections(),this.input,t)},e.prototype.withFaceExpressions=function(){return new ir(this.runAndExtendWithFaceDetections(),this.input)},e.prototype.withAgeAndGender=function(){return new cr(this.runAndExtendWithFaceDetections(),this.input)},e}(br);(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(a["c"])(e,t),e.prototype.run=function(){return Object(a["b"])(this,void 0,void 0,(function(){var t,e;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,new xr(this.input,this.options)];case 1:return t=n.sent(),e=t[0],t.forEach((function(t){t.score>e.score&&(e=t)})),[2,e]}}))}))},e.prototype.runAndExtendWithFaceDetection=function(){var t=this;return new Promise((function(e){return Object(a["b"])(t,void 0,void 0,(function(){var t;return Object(a["d"])(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return t=n.sent(),[2,e(t?G({},t):void 0)]}}))}))}))},e.prototype.withFaceLandmarks=function(t){return void 0===t&&(t=!1),new yr(this.runAndExtendWithFaceDetection(),this.input,t)},e.prototype.withFaceExpressions=function(){return new or(this.runAndExtendWithFaceDetection(),this.input)},e.prototype.withAgeAndGender=function(){return new lr(this.runAndExtendWithFaceDetection(),this.input)}})(br);function wr(t,e){return void 0===e&&(e=new rn),new xr(t,e)}function Er(t,e){if(t.length!==e.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(t),r=Array.from(e);return Math.sqrt(n.map((function(t,e){return t-r[e]})).reduce((function(t,e){return t+Math.pow(e,2)}),0))}(function(){function t(t,e){void 0===e&&(e=.6),this._distanceThreshold=e;var n=Array.isArray(t)?t:[t];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,i=function(){return"person "+r++};this._labeledDescriptors=n.map((function(t){if(t instanceof j)return t;if(t instanceof Float32Array)return new j(i(),[t]);if(t.descriptor&&t.descriptor instanceof Float32Array)return new j(i(),[t.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}Object.defineProperty(t.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),t.prototype.computeMeanDistance=function(t,e){return e.map((function(e){return Er(e,t)})).reduce((function(t,e){return t+e}),0)/(e.length||1)},t.prototype.matchDescriptor=function(t){var e=this;return this.labeledDescriptors.map((function(n){var r=n.descriptors,i=n.label;return new V(i,e.computeMeanDistance(t,r))})).reduce((function(t,e){return t.distance<e.distance?t:e}))},t.prototype.findBestMatch=function(t){var e=this.matchDescriptor(t);return e.distance<this.distanceThreshold?e:new V("unknown",e.distance)},t.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map((function(t){return t.toJSON()}))}},t.fromJSON=function(e){var n=e.labeledDescriptors.map((function(t){return j.fromJSON(t)}));return new t(n,e.distanceThreshold)}})();function _r(t,e){var n=new s(e.width,e.height),r=n.width,i=n.height;if(r<=0||i<=0)throw new Error("resizeResults - invalid dimensions: "+JSON.stringify({width:r,height:i}));if(Array.isArray(t))return t.map((function(t){return _r(t,{width:r,height:i})}));if(ne(t)){var o=t.detection.forSize(r,i),a=t.unshiftedLandmarks.forSize(o.box.width,o.box.height);return re(G(t,o),a)}return W(t)?G(t,t.detection.forSize(r,i)):t instanceof N||t instanceof S?t.forSize(r,i):t}},abab:function(t,e,n){"use strict";(function(r,i){function o(){return"object"===typeof r&&"undefined"!==typeof t&&"undefined"!==typeof i&&!!i.version}n.d(e,"a",(function(){return o}))}).call(this,n("c8ba"),n("4362"))},ac1f:function(t,e,n){"use strict";var r=n("23e7"),i=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(t,e,n){"use strict";var r=n("825a");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae93:function(t,e,n){"use strict";var r,i,o,a=n("d039"),s=n("e163"),u=n("9112"),c=n("5135"),l=n("b622"),h=n("c430"),f=l("iterator"),p=!1,d=function(){return this};[].keys&&(o=[].keys(),"next"in o?(i=s(s(o)),i!==Object.prototype&&(r=i)):p=!0);var m=void 0==r||a((function(){var t={};return r[f].call(t)!==t}));m&&(r={}),h&&!m||c(r,f)||u(r,f,d),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},b041:function(t,e,n){"use strict";var r=n("00ee"),i=n("f5df");t.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},b0c0:function(t,e,n){var r=n("83ab"),i=n("9bf2").f,o=Function.prototype,a=o.toString,s=/^\s*function ([^ (]*)/,u="name";r&&!(u in o)&&i(o,u,{configurable:!0,get:function(){try{return a.call(this).match(s)[1]}catch(t){return""}}})},b50d:function(t,e,n){"use strict";var r=n("c532"),i=n("467f"),o=n("7aac"),a=n("30b5"),s=n("83b9"),u=n("c345"),c=n("3934"),l=n("2d83");t.exports=function(t){return new Promise((function(e,n){var h=t.data,f=t.headers;r.isFormData(h)&&delete f["Content-Type"];var p=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",m=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";f.Authorization="Basic "+btoa(d+":"+m)}var v=s(t.baseURL,t.url);if(p.open(t.method.toUpperCase(),a(v,t.params,t.paramsSerializer),!0),p.timeout=t.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?u(p.getAllResponseHeaders()):null,o=t.responseType&&"text"!==t.responseType?p.response:p.responseText,a={data:o,status:p.status,statusText:p.statusText,headers:r,config:t,request:p};i(e,n,a),p=null}},p.onabort=function(){p&&(n(l("Request aborted",t,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(l("Network Error",t,null,p)),p=null},p.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(l(e,t,"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var g=(t.withCredentials||c(v))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;g&&(f[t.xsrfHeaderName]=g)}if("setRequestHeader"in p&&r.forEach(f,(function(t,e){"undefined"===typeof h&&"content-type"===e.toLowerCase()?delete f[e]:p.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(p.withCredentials=!!t.withCredentials),t.responseType)try{p.responseType=t.responseType}catch(y){if("json"!==t.responseType)throw y}"function"===typeof t.onDownloadProgress&&p.addEventListener("progress",t.onDownloadProgress),"function"===typeof t.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){p&&(p.abort(),n(t),p=null)})),h||(h=null),p.send(h)}))}},b575:function(t,e,n){var r,i,o,a,s,u,c,l,h=n("da84"),f=n("06cf").f,p=n("2cf4").set,d=n("1cdc"),m=n("a4b4"),v=n("605d"),g=h.MutationObserver||h.WebKitMutationObserver,y=h.document,b=h.process,x=h.Promise,w=f(h,"queueMicrotask"),E=w&&w.value;E||(r=function(){var t,e;v&&(t=b.domain)&&t.exit();while(i){e=i.fn,i=i.next;try{e()}catch(n){throw i?a():o=void 0,n}}o=void 0,t&&t.enter()},d||v||m||!g||!y?x&&x.resolve?(c=x.resolve(void 0),c.constructor=x,l=c.then,a=function(){l.call(c,r)}):a=v?function(){b.nextTick(r)}:function(){p.call(h,r)}:(s=!0,u=y.createTextNode(""),new g(r).observe(u,{characterData:!0}),a=function(){u.data=s=!s})),t.exports=E||function(t){var e={fn:t,next:void 0};o&&(o.next=e),i||(i=e,a()),o=e}},b622:function(t,e,n){var r=n("da84"),i=n("5692"),o=n("5135"),a=n("90e3"),s=n("4930"),u=n("fdbf"),c=i("wks"),l=r.Symbol,h=u?l:l&&l.withoutSetter||a;t.exports=function(t){return o(c,t)&&(s||"string"==typeof c[t])||(s&&o(l,t)?c[t]=l[t]:c[t]=h("Symbol."+t)),c[t]}},b639:function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n("1fb5"),i=n("9152"),o=n("e3db");function a(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=c.prototype):(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?v(t,e,n,r):"string"===typeof e?d(t,e,n):g(t,e)}function h(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e,n,r){return h(e),e<=0?u(t,e):void 0!==n?"string"===typeof r?u(t,e).fill(n,r):u(t,e).fill(n):u(t,e)}function p(t,e){if(h(e),t=u(t,e<0?0:0|y(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function d(t,e,n){if("string"===typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|x(e,n);t=u(t,r);var i=t.write(e,n);return i!==r&&(t=t.slice(0,i)),t}function m(t,e){var n=e.length<0?0:0|y(e.length);t=u(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function v(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),c.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=c.prototype):t=m(t,e),t}function g(t,e){if(c.isBuffer(e)){var n=0|y(e.length);return t=u(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||et(e.length)?u(t,0):m(t,e);if("Buffer"===e.type&&o(e.data))return m(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function b(t){return+t!=t&&(t=0),c.alloc(+t)}function x(t,e){if(c.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Z(t).length;default:if(r)return Y(t).length;e=(""+e).toLowerCase(),r=!0}}function w(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return R(this,e,n);case"ascii":return O(this,e,n);case"latin1":case"binary":return N(this,e,n);case"base64":return D(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function E(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function _(t,e,n,r,i){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:C(t,e,n,r,i);if("number"===typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):C(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function C(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(t,o+f)!==c(e,f)){h=!1;break}if(h)return o}return-1}function S(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r),r>i&&(r=i)):r=i;var o=e.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function A(t,e,n,r){return tt(Y(e,t.length-n),t,n,r)}function k(t,e,n,r){return tt(J(e),t,n,r)}function T(t,e,n,r){return k(t,e,n,r)}function I(t,e,n,r){return tt(Z(e),t,n,r)}function P(t,e,n,r){return tt(Q(e,t.length-n),t,n,r)}function D(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function R(t,e,n){n=Math.min(t.length,n);var r=[],i=e;while(i<n){var o,a,s,u,c=t[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:o=t[i+1],128===(192&o)&&(u=(31&c)<<6|63&o,u>127&&(l=u));break;case 3:o=t[i+1],a=t[i+2],128===(192&o)&&128===(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a,u>2047&&(u<55296||u>57343)&&(l=u));break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128===(192&o)&&128===(192&a)&&128===(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s,u>65535&&u<1114112&&(l=u))}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return F(r)}e.Buffer=c,e.SlowBuffer=b,e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:a(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return l(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return f(null,t,e,n)},c.allocUnsafe=function(t){return p(null,t)},c.allocUnsafeSlow=function(t){return p(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=x,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)E(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)E(this,e,e+3),E(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)E(this,e,e+7),E(this,e+1,e+6),E(this,e+2,e+5),E(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):w.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,i){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var o=i-r,a=n-e,s=Math.min(o,a),u=this.slice(r,i),l=t.slice(e,n),h=0;h<s;++h)if(u[h]!==l[h]){o=u[h],a=l[h];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return _(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return _(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return S(this,t,e,n);case"utf8":case"utf-8":return A(this,t,e,n);case"ascii":return k(this,t,e,n);case"latin1":case"binary":return T(this,t,e,n);case"base64":return I(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function F(t){var e=t.length;if(e<=M)return String.fromCharCode.apply(String,t);var n="",r=0;while(r<e)n+=String.fromCharCode.apply(String,t.slice(r,r+=M));return n}function O(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function N(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function L(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=X(t[o]);return i}function B(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function V(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function z(t,e,n,r,i,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function j(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function W(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function G(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function H(t,e,n,r,o){return o||G(t,e,n,4,34028234663852886e22,-34028234663852886e22),i.write(t,e,n,r,23,4),n+4}function U(t,e,n,r,o){return o||G(t,e,n,8,17976931348623157e292,-17976931348623157e292),i.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=c.prototype;else{var i=e-t;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t+--e],i=1;while(e>0&&(i*=256))r+=this[t+--e]*i;return r},c.prototype.readUInt8=function(t,e){return e||V(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||V(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||V(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||V(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||V(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=this[t],i=1,o=0;while(++o<e&&(i*=256))r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||V(t,e,this.length);var r=e,i=1,o=this[t+--r];while(r>0&&(i*=256))o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return e||V(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||V(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||V(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||V(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||V(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||V(t,4,this.length),i.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||V(t,4,this.length),i.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||V(t,8,this.length),i.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||V(t,8,this.length),i.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;z(this,t,e,n,i,0)}var o=1,a=0;this[e]=255&t;while(++a<n&&(o*=256))this[e+a]=t/o&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var i=Math.pow(2,8*n)-1;z(this,t,e,n,i,0)}var o=n-1,a=1;this[e+o]=255&t;while(--o>=0&&(a*=256))this[e+o]=t/a&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):W(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);z(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;this[e]=255&t;while(++o<n&&(a*=256))t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);z(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;this[e+o]=255&t;while(--o>=0&&(a*=256))t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):W(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return H(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return H(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return U(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return U(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;i>=0;--i)t[i+e]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},c.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=c.isBuffer(t)?t:Y(new c(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var q=/[^+\/0-9A-Za-z-_]/g;function $(t){if(t=K(t).replace(q,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function K(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function X(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if(n=t.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function J(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Q(t,e){for(var n,r,i,o=[],a=0;a<t.length;++a){if((e-=2)<0)break;n=t.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r)}return o}function Z(t){return r.toByteArray($(t))}function tt(t,e,n,r){for(var i=0;i<r;++i){if(i+n>=e.length||i>=t.length)break;e[i+n]=t[i]}return i}function et(t){return t!==t}}).call(this,n("c8ba"))},b64b:function(t,e,n){var r=n("23e7"),i=n("7b0b"),o=n("df75"),a=n("d039"),s=a((function(){o(1)}));r({target:"Object",stat:!0,forced:s},{keys:function(t){return o(i(t))}})},b727:function(t,e,n){var r=n("0366"),i=n("44ad"),o=n("7b0b"),a=n("50c4"),s=n("65f0"),u=[].push,c=function(t){var e=1==t,n=2==t,c=3==t,l=4==t,h=6==t,f=7==t,p=5==t||h;return function(d,m,v,g){for(var y,b,x=o(d),w=i(x),E=r(m,v,3),_=a(w.length),C=0,S=g||s,A=e?S(d,_):n||f?S(d,0):void 0;_>C;C++)if((p||C in w)&&(y=w[C],b=E(y,C,x),t))if(e)A[C]=b;else if(b)switch(t){case 3:return!0;case 5:return y;case 6:return C;case 2:u.call(A,y)}else switch(t){case 4:return!1;case 7:u.call(A,y)}return h?-1:c||l?l:A}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},bb2f:function(t,e,n){var r=n("d039");t.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},bc3a:function(t,e,n){t.exports=n("cee4")},bee2:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},c04e:function(t,e,n){var r=n("861d");t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},c1f9:function(t,e,n){var r=n("23e7"),i=n("2266"),o=n("8418");r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return i(t,(function(t,n){o(e,t,n)}),{AS_ENTRIES:!0}),e}})},c345:function(t,e,n){"use strict";var r=n("c532"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,a={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(a[e]&&i.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([n]):a[e]?a[e]+", "+n:n}})),a):a}},c401:function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},c430:function(t,e){t.exports=!1},c532:function(t,e,n){"use strict";var r=n("1d2b"),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function a(t){return"undefined"===typeof t}function s(t){return null!==t&&!a(t)&&null!==t.constructor&&!a(t.constructor)&&"function"===typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}function u(t){return"[object ArrayBuffer]"===i.call(t)}function c(t){return"undefined"!==typeof FormData&&t instanceof FormData}function l(t){var e;return e="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer,e}function h(t){return"string"===typeof t}function f(t){return"number"===typeof t}function p(t){return null!==t&&"object"===typeof t}function d(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function m(t){return"[object Date]"===i.call(t)}function v(t){return"[object File]"===i.call(t)}function g(t){return"[object Blob]"===i.call(t)}function y(t){return"[object Function]"===i.call(t)}function b(t){return p(t)&&y(t.pipe)}function x(t){return"undefined"!==typeof URLSearchParams&&t instanceof URLSearchParams}function w(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}function E(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)}function _(t,e){if(null!==t&&"undefined"!==typeof t)if("object"!==typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}function C(){var t={};function e(e,n){d(t[n])&&d(e)?t[n]=C(t[n],e):d(e)?t[n]=C({},e):o(e)?t[n]=e.slice():t[n]=e}for(var n=0,r=arguments.length;n<r;n++)_(arguments[n],e);return t}function S(t,e,n){return _(e,(function(e,i){t[i]=n&&"function"===typeof e?r(e,n):e})),t}function A(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}t.exports={isArray:o,isArrayBuffer:u,isBuffer:s,isFormData:c,isArrayBufferView:l,isString:h,isNumber:f,isObject:p,isPlainObject:d,isUndefined:a,isDate:m,isFile:v,isBlob:g,isFunction:y,isStream:b,isURLSearchParams:x,isStandardBrowserEnv:E,forEach:_,merge:C,extend:S,trim:w,stripBOM:A}},c6b6:function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},c6cd:function(t,e,n){var r=n("da84"),i=n("ce4e"),o="__core-js_shared__",a=r[o]||i(o,{});t.exports=a},c894:function(t,e,n){"use strict";
/**
  * vue-custom-element v3.3.0
  * (c) 2021 Karol Fabjańczuk
  * @license MIT
  */function r(t,e){return t.__proto__=e,t}Object.setPrototypeOf=Object.setPrototypeOf||r;r.bind(Object);function i(){return"undefined"!==typeof Symbol&&"undefined"!==typeof Reflect&&"undefined"!==typeof Proxy&&!Object.isSealed(Proxy)}var o=i(),a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function u(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function c(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function l(){return Reflect.construct(HTMLElement,[],this.__proto__.constructor)}function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("undefined"!==typeof customElements){if(o){var n=function(t){function n(t){var e;s(this,n);var r=u(this,(n.__proto__||Object.getPrototypeOf(n)).call(this)),o=t?HTMLElement.call(t):r;return i.call(o),e=o,u(r,e)}return c(n,t),a(n,null,[{key:"observedAttributes",get:function(){return e.observedAttributes||[]}}]),n}(l);return n.prototype.connectedCallback=h,n.prototype.disconnectedCallback=f,n.prototype.attributeChangedCallback=p,d(t,n),n}var r=function(t){var e=t?HTMLElement.call(t):this;return i.call(e),e};return r.observedAttributes=e.observedAttributes||[],r.prototype=Object.create(HTMLElement.prototype,{constructor:{configurable:!0,writable:!0,value:r}}),r.prototype.connectedCallback=h,r.prototype.disconnectedCallback=f,r.prototype.attributeChangedCallback=p,d(t,r),r}function i(){!0===e.shadow&&HTMLElement.prototype.attachShadow&&this.attachShadow({mode:"open"}),"function"===typeof e.constructorCallback&&e.constructorCallback.call(this)}function h(){"function"===typeof e.connectedCallback&&e.connectedCallback.call(this)}function f(){"function"===typeof e.disconnectedCallback&&e.disconnectedCallback.call(this)}function p(t,n,r){"function"===typeof e.attributeChangedCallback&&e.attributeChangedCallback.call(this,t,n,r)}function d(t,e){var n=customElements.get(t);return"undefined"!==typeof n?n:customElements.define(t,e)}}Object.setPrototypeOf(l.prototype,HTMLElement.prototype),Object.setPrototypeOf(l,HTMLElement);var f=/-(\w)/g,p=function(t){return t.replace(f,(function(t,e){return e?e.toUpperCase():""}))},d=/([^-])([A-Z])/g,m=function(t){return t.replace(d,"$1-$2").replace(d,"$1-$2").toLowerCase()};function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=t.length-e,r=new Array(n);while(n--)r[n]=t[n+e];return r}var g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function y(t,e){if(null===t||void 0===t)return e!==Boolean&&void 0;var n=t,r=["true","false"].indexOf(t)>-1,i=parseFloat(n,10),o=!isNaN(i)&&isFinite(n)&&"string"===typeof n&&!n.match(/^0+[^.]\d*$/g);return e&&e!==Boolean&&("undefined"===typeof n?"undefined":g(n))!==e?n=e(t):r||e===Boolean?n=""===n||("true"===n||!0===n):o&&(n=i),n}function b(t,e){if(t&&t.length)t.forEach((function(t){var n=p(t);-1===e.camelCase.indexOf(n)&&e.camelCase.push(n)}));else if(t&&"object"===("undefined"===typeof t?"undefined":g(t)))for(var n in t){var r=p(n);-1===e.camelCase.indexOf(r)&&e.camelCase.push(r),t[r]&&t[r].type&&(e.types[n]=[].concat(t[r].type)[0])}}function x(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={camelCase:[],hyphenate:[],types:{}};if(t.mixins&&t.mixins.forEach((function(t){b(t.props,e)})),t.extends&&t.extends.props){var n=t.extends.props;b(n,e)}return b(t.props,e),e.camelCase.forEach((function(t){e.hyphenate.push(m(t))})),e}function w(t,e){e.camelCase.forEach((function(n,r){Object.defineProperty(t,n,{get:function(){return this.__vue_custom_element__[n]},set:function(t){if("object"!==("undefined"===typeof t?"undefined":g(t))&&"function"!==typeof t||!this.__vue_custom_element__){var n=e.types[e.camelCase[r]];this.setAttribute(e.hyphenate[r],y(t,n))}else{var i=e.camelCase[r];this.__vue_custom_element__[i]=t}}})}))}function E(t,e,n){var r=e.propsData||{};return n.hyphenate.forEach((function(e,i){var o=n.camelCase[i],a=t.attributes[e]||t[o],s=null;n.types[o]&&(s=n.types[o]),a instanceof Attr?r[o]=y(a.value,s):"undefined"!==typeof a&&(r[o]=a)})),r}function _(t){var e={};return v(t.attributes).forEach((function(t){e["vue-slot"===t.nodeName?"slot":t.nodeName]=t.nodeValue})),e}function C(t){if(t.childNodes.length)return t.childNodes;if(t.content&&t.content.childNodes&&t.content.childNodes.length)return t.content.childNodes;var e=document.createElement("div");return e.innerHTML=t.innerHTML,e.childNodes}function S(t,e,n){var r=C(e),i=v(r).map((function(e){return"#text"===e.nodeName?e.nodeValue:t(e.tagName,{attrs:_(e),domProps:{innerHTML:e.innerHTML}})}));return n.slot=e.id,t("template",n,i)}function A(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments[1],n=[];return v(t).forEach((function(t){if("#text"===t.nodeName)t.nodeValue.trim()&&n.push(e("span",t.nodeValue));else if("#comment"!==t.nodeName){var r=_(t),i={attrs:r,domProps:{innerHTML:""===t.innerHTML?t.innerText:t.innerHTML}};r.slot&&(i.slot=r.slot,r.slot=void 0);var o="TEMPLATE"===t.tagName?S(e,t,i):e(t.tagName,i);n.push(o)}})),n}function k(t,e){var n={bubbles:!1,cancelable:!1,detail:e},r=void 0;return"function"===typeof window.CustomEvent?r=new CustomEvent(t,n):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail)),r}function T(t,e){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=k(e,[].concat(r));t.dispatchEvent(o)}function I(t,e,n,r,i){if(t.__vue_custom_element__)return Promise.resolve(t);var o=e.util.extend({},n),a=E(t,o,r),s=e.version&&parseInt(e.version.split(".")[0],10)||0;function u(){this.$emit=function(){for(var e,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];T.apply(void 0,[t].concat(r)),this.__proto__&&(e=this.__proto__.$emit).call.apply(e,[this].concat(r))}}if(o.beforeCreate=[].concat(o.beforeCreate||[],u),o._compiled){var c={},l=o._Ctor;l&&(c=Object.keys(l).map((function(t){return l[t]}))[0].options),c.beforeCreate=o.beforeCreate}var h=void 0;if(s>=2){var f=t.cloneNode(!0).childNodes;h={propsData:a,props:r.camelCase,computed:{reactiveProps:function(){var t=this,e={};return r.camelCase.forEach((function(n){"undefined"!==typeof t[n]&&(e[n]=t[n])})),e}},render:function(t){var e={props:this.reactiveProps};return t(o,e,A(f,t))}}}else if(1===s)h=o,h.propsData=a;else{h=o;var p={};Object.keys(a).forEach((function(t){p[t]={default:a[t]}})),h.props=p}var d=s>=2?"<div></div>":("<div>"+t.innerHTML+"</div>").replace(/vue-slot=/g,"slot=");if(i.shadow&&t.shadowRoot?(t.shadowRoot.innerHTML=d,h.el=t.shadowRoot.children[0]):(t.innerHTML=d,h.el=t.children[0]),i.shadow&&i.shadowCss&&t.shadowRoot){var m=document.createElement("style");m.type="text/css",m.appendChild(document.createTextNode(i.shadowCss)),t.shadowRoot.appendChild(m)}return w(t,r),"function"===typeof i.beforeCreateVueInstance&&(h=i.beforeCreateVueInstance(h)||h),Promise.resolve(h).then((function(n){return t.__vue_custom_element__=new e(n),t.__vue_custom_element_props__=r,t.getVueInstance=function(){var e=t.__vue_custom_element__;return e.$children.length?e.$children[0]:e},t.removeAttribute("vce-cloak"),t.setAttribute("vce-ready",""),T(t,"vce-ready"),t}))}function P(t){t.customElement=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i="function"===typeof n,o=i&&{props:r.props||[]},a=x(i?o:n),s=h(e,{constructorCallback:function(){"function"===typeof r.constructorCallback&&r.constructorCallback.call(this)},connectedCallback:function(){var o=this,s=i&&n(),u=s&&s.then&&"function"===typeof s.then;if("function"===typeof r.connectedCallback&&r.connectedCallback.call(this),i&&!u)throw new Error("Async component "+e+" do not returns Promise");this.__detached__||(u?s.then((function(e){var n=x(e);I(o,t,e,n,r).then((function(){"function"===typeof r.vueInstanceCreatedCallback&&r.vueInstanceCreatedCallback.call(o)}))})):I(this,t,n,a,r).then((function(){"function"===typeof r.vueInstanceCreatedCallback&&r.vueInstanceCreatedCallback.call(o)}))),this.__detached__=!1},disconnectedCallback:function(){var t=this;this.__detached__=!0,"function"===typeof r.disconnectedCallback&&r.disconnectedCallback.call(this),null!==r.destroyTimeout&&setTimeout((function(){t.__detached__&&t.__vue_custom_element__&&(t.__detached__=!1,t.__vue_custom_element__.$destroy(!0),delete t.__vue_custom_element__,delete t.__vue_custom_element_props__)}),r.destroyTimeout||3e3)},attributeChangedCallback:function(t,e,n){if(this.__vue_custom_element__&&"undefined"!==typeof n){var i=p(t);"function"===typeof r.attributeChangedCallback&&r.attributeChangedCallback.call(this,t,e,n);var o=this.__vue_custom_element_props__.types[i];this.__vue_custom_element__[i]=y(n,o)}},observedAttributes:a.hyphenate,shadow:!!r.shadow&&!!HTMLElement.prototype.attachShadow});return s}}"undefined"!==typeof window&&window.Vue&&(window.Vue.use(P),P.installed&&(P.installed=!1)),e["a"]=P},c8af:function(t,e,n){"use strict";var r=n("c532");t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},c8d2:function(t,e,n){var r=n("d039"),i=n("5899"),o="​᠎";t.exports=function(t){return r((function(){return!!i[t]()||o[t]()!=o||i[t].name!==t}))}},ca84:function(t,e,n){var r=n("5135"),i=n("fc6a"),o=n("4d64").indexOf,a=n("d012");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)!r(a,n)&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},cc12:function(t,e,n){var r=n("da84"),i=n("861d"),o=r.document,a=i(o)&&i(o.createElement);t.exports=function(t){return a?o.createElement(t):{}}},cca6:function(t,e,n){var r=n("23e7"),i=n("60da");r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},cdf9:function(t,e,n){var r=n("825a"),i=n("861d"),o=n("f069");t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t),a=n.resolve;return a(e),n.promise}},ce4e:function(t,e,n){var r=n("da84"),i=n("9112");t.exports=function(t,e){try{i(r,t,e)}catch(n){r[t]=e}return e}},cee4:function(t,e,n){"use strict";var r=n("c532"),i=n("1d2b"),o=n("0a06"),a=n("4a7b"),s=n("2444");function u(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var c=u(s);c.Axios=o,c.create=function(t){return u(a(c.defaults,t))},c.Cancel=n("7a77"),c.CancelToken=n("8df4"),c.isCancel=n("2e67"),c.all=function(t){return Promise.all(t)},c.spread=n("0df6"),c.isAxiosError=n("5f02"),t.exports=c,t.exports.default=c},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,n){var r=n("428f"),i=n("da84"),o=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?o(r[t])||o(i[t]):r[t]&&r[t][e]||i[t]&&i[t][e]}},d1e7:function(t,e,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);e.f=o?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},d28b:function(t,e,n){var r=n("746f");r("iterator")},d2bb:function(t,e,n){var r=n("825a"),i=n("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(n,[]),e=n instanceof Array}catch(o){}return function(n,o){return r(n),i(o),e?t.call(n,o):n.__proto__=o,n}}():void 0)},d3b7:function(t,e,n){var r=n("00ee"),i=n("6eeb"),o=n("b041");r||i(Object.prototype,"toString",o,{unsafe:!0})},d44e:function(t,e,n){var r=n("9bf2").f,i=n("5135"),o=n("b622"),a=o("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,a)&&r(t,a,{configurable:!0,value:e})}},d4ec:function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},d784:function(t,e,n){"use strict";n("ac1f");var r=n("6eeb"),i=n("9263"),o=n("d039"),a=n("b622"),s=n("9112"),u=a("species"),c=RegExp.prototype;t.exports=function(t,e,n,l){var h=a(t),f=!o((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),p=f&&!o((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[u]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!f||!p||n){var d=/./[h],m=e(h,""[t],(function(t,e,n,r,o){var a=e.exec;return a===i||a===c.exec?f&&!o?{done:!0,value:d.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}));r(String.prototype,t,m[0]),r(c,h,m[1])}l&&s(c[h],"sham",!0)}},d925:function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},da84:function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(this,n("c8ba"))},ddb0:function(t,e,n){var r=n("da84"),i=n("fdbc"),o=n("e260"),a=n("9112"),s=n("b622"),u=s("iterator"),c=s("toStringTag"),l=o.values;for(var h in i){var f=r[h],p=f&&f.prototype;if(p){if(p[u]!==l)try{a(p,u,l)}catch(m){p[u]=l}if(p[c]||a(p,c,h),i[h])for(var d in o)if(p[d]!==o[d])try{a(p,d,o[d])}catch(m){p[d]=o[d]}}}},df75:function(t,e,n){var r=n("ca84"),i=n("7839");t.exports=Object.keys||function(t){return r(t,i)}},df7c:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t){"string"!==typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}function i(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var a=o>=0?arguments[o]:t.cwd();if("string"!==typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(e=a+"/"+e,r="/"===a.charAt(0))}return e=n(i(e.split("/"),(function(t){return!!t})),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),a="/"===o(t,-1);return t=n(i(t.split("/"),(function(t){return!!t})),!r).join("/"),t||r||(t="."),t&&a&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,(function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var n=t.length-1;n>=0;n--)if(""!==t[n])break;return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),o=r(n.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return c=c.concat(o.slice(s)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!==typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,o=t.length-1;o>=1;--o)if(e=t.charCodeAt(o),47===e){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=r(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!==typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,o=0,a=t.length-1;a>=0;--a){var s=t.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===e?e=a:1!==o&&(o=1):-1!==e&&(o=-1);else if(!i){n=a+1;break}}return-1===e||-1===r||0===o||1===o&&e===r-1&&e===n+1?"":t.slice(e,r)};var o="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n("4362"))},e01a:function(t,e,n){"use strict";var r=n("23e7"),i=n("83ab"),o=n("da84"),a=n("5135"),s=n("861d"),u=n("9bf2").f,c=n("e893"),l=o.Symbol;if(i&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var h={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new l(t):void 0===t?l():l(t);return""===t&&(h[e]=!0),e};c(f,l);var p=f.prototype=l.prototype;p.constructor=f;var d=p.toString,m="Symbol(test)"==String(l("test")),v=/^Symbol\((.*)\)[^)]+$/;u(p,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=d.call(t);if(a(h,t))return"";var n=m?e.slice(7,-1):e.replace(v,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:f})}},e163:function(t,e,n){var r=n("5135"),i=n("7b0b"),o=n("f772"),a=n("e177"),s=o("IE_PROTO"),u=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=i(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},e177:function(t,e,n){var r=n("d039");t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},e260:function(t,e,n){"use strict";var r=n("fc6a"),i=n("44d2"),o=n("3f8c"),a=n("69f3"),s=n("7dd0"),u="Array Iterator",c=a.set,l=a.getterFor(u);t.exports=s(Array,"Array",(function(t,e){c(this,{type:u,target:r(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},e2cc:function(t,e,n){var r=n("6eeb");t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},e3db:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},e538:function(t,e,n){var r=n("b622");e.f=r},e667:function(t,e){t.exports=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}}},e683:function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},e6cf:function(t,e,n){"use strict";var r,i,o,a,s=n("23e7"),u=n("c430"),c=n("da84"),l=n("d066"),h=n("fea9"),f=n("6eeb"),p=n("e2cc"),d=n("d2bb"),m=n("d44e"),v=n("2626"),g=n("861d"),y=n("1c0b"),b=n("19aa"),x=n("8925"),w=n("2266"),E=n("1c7e"),_=n("4840"),C=n("2cf4").set,S=n("b575"),A=n("cdf9"),k=n("44de"),T=n("f069"),I=n("e667"),P=n("69f3"),D=n("94ca"),R=n("b622"),M=n("6069"),F=n("605d"),O=n("2d00"),N=R("species"),L="Promise",B=P.get,V=P.set,z=P.getterFor(L),j=h&&h.prototype,W=h,G=j,H=c.TypeError,U=c.document,q=c.process,$=T.f,K=$,X=!!(U&&U.createEvent&&c.dispatchEvent),Y="function"==typeof PromiseRejectionEvent,J="unhandledrejection",Q="rejectionhandled",Z=0,tt=1,et=2,nt=1,rt=2,it=!1,ot=D(L,(function(){var t=x(W)!==String(W);if(!t&&66===O)return!0;if(u&&!G["finally"])return!0;if(O>=51&&/native code/.test(W))return!1;var e=new W((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))},r=e.constructor={};return r[N]=n,it=e.then((function(){}))instanceof n,!it||!t&&M&&!Y})),at=ot||!E((function(t){W.all(t)["catch"]((function(){}))})),st=function(t){var e;return!(!g(t)||"function"!=typeof(e=t.then))&&e},ut=function(t,e){if(!t.notified){t.notified=!0;var n=t.reactions;S((function(){var r=t.value,i=t.state==tt,o=0;while(n.length>o){var a,s,u,c=n[o++],l=i?c.ok:c.fail,h=c.resolve,f=c.reject,p=c.domain;try{l?(i||(t.rejection===rt&&ft(t),t.rejection=nt),!0===l?a=r:(p&&p.enter(),a=l(r),p&&(p.exit(),u=!0)),a===c.promise?f(H("Promise-chain cycle")):(s=st(a))?s.call(a,h,f):h(a)):f(r)}catch(d){p&&!u&&p.exit(),f(d)}}t.reactions=[],t.notified=!1,e&&!t.rejection&&lt(t)}))}},ct=function(t,e,n){var r,i;X?(r=U.createEvent("Event"),r.promise=e,r.reason=n,r.initEvent(t,!1,!0),c.dispatchEvent(r)):r={promise:e,reason:n},!Y&&(i=c["on"+t])?i(r):t===J&&k("Unhandled promise rejection",n)},lt=function(t){C.call(c,(function(){var e,n=t.facade,r=t.value,i=ht(t);if(i&&(e=I((function(){F?q.emit("unhandledRejection",r,n):ct(J,n,r)})),t.rejection=F||ht(t)?rt:nt,e.error))throw e.value}))},ht=function(t){return t.rejection!==nt&&!t.parent},ft=function(t){C.call(c,(function(){var e=t.facade;F?q.emit("rejectionHandled",e):ct(Q,e,t.value)}))},pt=function(t,e,n){return function(r){t(e,r,n)}},dt=function(t,e,n){t.done||(t.done=!0,n&&(t=n),t.value=e,t.state=et,ut(t,!0))},mt=function(t,e,n){if(!t.done){t.done=!0,n&&(t=n);try{if(t.facade===e)throw H("Promise can't be resolved itself");var r=st(e);r?S((function(){var n={done:!1};try{r.call(e,pt(mt,n,t),pt(dt,n,t))}catch(i){dt(n,i,t)}})):(t.value=e,t.state=tt,ut(t,!1))}catch(i){dt({done:!1},i,t)}}};if(ot&&(W=function(t){b(this,W,L),y(t),r.call(this);var e=B(this);try{t(pt(mt,e),pt(dt,e))}catch(n){dt(e,n)}},G=W.prototype,r=function(t){V(this,{type:L,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:Z,value:void 0})},r.prototype=p(G,{then:function(t,e){var n=z(this),r=$(_(this,W));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=F?q.domain:void 0,n.parent=!0,n.reactions.push(r),n.state!=Z&&ut(n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),i=function(){var t=new r,e=B(t);this.promise=t,this.resolve=pt(mt,e),this.reject=pt(dt,e)},T.f=$=function(t){return t===W||t===o?new i(t):K(t)},!u&&"function"==typeof h&&j!==Object.prototype)){a=j.then,it||(f(j,"then",(function(t,e){var n=this;return new W((function(t,e){a.call(n,t,e)})).then(t,e)}),{unsafe:!0}),f(j,"catch",G["catch"],{unsafe:!0}));try{delete j.constructor}catch(vt){}d&&d(j,G)}s({global:!0,wrap:!0,forced:ot},{Promise:W}),m(W,L,!1,!0),v(L),o=l(L),s({target:L,stat:!0,forced:ot},{reject:function(t){var e=$(this);return e.reject.call(void 0,t),e.promise}}),s({target:L,stat:!0,forced:u||ot},{resolve:function(t){return A(u&&this===o?W:this,t)}}),s({target:L,stat:!0,forced:at},{all:function(t){var e=this,n=$(e),r=n.resolve,i=n.reject,o=I((function(){var n=y(e.resolve),o=[],a=0,s=1;w(t,(function(t){var u=a++,c=!1;o.push(void 0),s++,n.call(e,t).then((function(t){c||(c=!0,o[u]=t,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(t){var e=this,n=$(e),r=n.reject,i=I((function(){var i=y(e.resolve);w(t,(function(t){i.call(e,t).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},e893:function(t,e,n){var r=n("5135"),i=n("56ef"),o=n("06cf"),a=n("9bf2");t.exports=function(t,e){for(var n=i(e),s=a.f,u=o.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||s(t,l,u(e,l))}}},e8b5:function(t,e,n){var r=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==r(t)}},e95a:function(t,e,n){var r=n("b622"),i=n("3f8c"),o=r("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||a[o]===t)}},ec26:function(t,e,n){"use strict";var r,i=new Uint8Array(16);function o(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function s(t){return"string"===typeof t&&a.test(t)}for(var u=s,c=[],l=0;l<256;++l)c.push((l+256).toString(16).substr(1));function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n}var f=h;function p(t,e,n){t=t||{};var r=t.random||(t.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var i=0;i<16;++i)e[n+i]=r[i];return e}return f(r)}e["a"]=p},eea0:function(t,e,n){"use strict";function r(t){var e="";if(!t)try{t=n("3e8f")}catch(i){e=i.toString()}var r=t?function(e){return new Promise((function(n,r){t.readFile(e,(function(t,e){return t?r(t):n(e)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+e)};return{readFile:r}}n.d(e,"a",(function(){return r}))},f069:function(t,e,n){"use strict";var r=n("1c0b"),i=function(t){var e,n;this.promise=new t((function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r})),this.resolve=r(e),this.reject=r(n)};t.exports.f=function(t){return new i(t)}},f183:function(t,e,n){var r=n("d012"),i=n("861d"),o=n("5135"),a=n("9bf2").f,s=n("90e3"),u=n("bb2f"),c=s("meta"),l=0,h=Object.isExtensible||function(){return!0},f=function(t){a(t,c,{value:{objectID:"O"+ ++l,weakData:{}}})},p=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,c)){if(!h(t))return"F";if(!e)return"E";f(t)}return t[c].objectID},d=function(t,e){if(!o(t,c)){if(!h(t))return!0;if(!e)return!1;f(t)}return t[c].weakData},m=function(t){return u&&v.REQUIRED&&h(t)&&!o(t,c)&&f(t),t},v=t.exports={REQUIRED:!1,fastKey:p,getWeakData:d,onFreeze:m};r[c]=!0},f5df:function(t,e,n){var r=n("00ee"),i=n("c6b6"),o=n("b622"),a=o("toStringTag"),s="Arguments"==i(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(n){}};t.exports=r?i:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=u(e=Object(t),a))?n:s?i(e):"Object"==(r=i(e))&&"function"==typeof e.callee?"Arguments":r}},f6b4:function(t,e,n){"use strict";var r=n("c532");function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},f772:function(t,e,n){var r=n("5692"),i=n("90e3"),o=r("keys");t.exports=function(t){return o[t]||(o[t]=i(t))}},fc6a:function(t,e,n){var r=n("44ad"),i=n("1d80");t.exports=function(t){return r(i(t))}},fce3:function(t,e,n){var r=n("d039");t.exports=r((function(){var t=RegExp(".","string".charAt(0));return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,n){var r=n("4930");t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},fea9:function(t,e,n){var r=n("da84");t.exports=r.Promise}}]);
//# sourceMappingURL=chunk-vendors.4bc9d410.js.map